/*!
JW Player version 8.20.0
Copyright (c) 2021, JW Player, All Rights Reserved 
https://github.com/jwplayer/jwplayer/blob/v8.20.0/README.md

This source code and its use and distribution is subject to the terms and conditions of the applicable license agreement. 
https://www.jwplayer.com/tos/

This product includes portions of other software. For the full text of licenses, see below:

JW Player Third Party Software Notices and/or Additional Terms and Conditions

**************************************************************************************************
The following software is used under Apache License 2.0
**************************************************************************************************

vtt.js v0.13.0
Copyright (c) 2021 Mozilla (http://mozilla.org)
https://github.com/mozilla/vtt.js/blob/v0.13.0/LICENSE

* * *

Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License.

You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and
limitations under the License.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

**************************************************************************************************
The following software is used under MIT license
**************************************************************************************************

Underscore.js v1.6.0
Copyright (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative
https://github.com/jashkenas/underscore/blob/1.6.0/LICENSE

Backbone backbone.events.js v1.1.2
Copyright (c) 2010-2014 Jeremy Ashkenas, DocumentCloud
https://github.com/jashkenas/backbone/blob/1.1.2/LICENSE

Promise Polyfill v7.1.1
Copyright (c) 2014 Taylor Hakes and Forbes Lindesay
https://github.com/taylorhakes/promise-polyfill/blob/v7.1.1/LICENSE

can-autoplay.js v3.0.0
Copyright (c) 2017 video-dev
https://github.com/video-dev/can-autoplay/blob/v3.0.0/LICENSE

focus-options-polyfill v1.5.0
Copyright (c) 2018 Juan Valencia
https://github.com/calvellido/focus-options-polyfill/blob/v1.5.0/LICENSE

* * *

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

**************************************************************************************************
The following software is used under W3C license
**************************************************************************************************

Intersection Observer v0.5.0
Copyright (c) 2016 Google Inc. (http://google.com)
https://github.com/w3c/IntersectionObserver/blob/v0.5.0/LICENSE.md

* * *

W3C SOFTWARE AND DOCUMENT NOTICE AND LICENSE
Status: This license takes effect 13 May, 2015.

This work is being provided by the copyright holders under the following license.

License
By obtaining and/or copying this work, you (the licensee) agree that you have read, understood, and will comply with the following terms and conditions.

Permission to copy, modify, and distribute this work, with or without modification, for any purpose and without fee or royalty is hereby granted, provided that you include the following on ALL copies of the work or portions thereof, including modifications:

The full text of this NOTICE in a location viewable to users of the redistributed or derivative work.

Any pre-existing intellectual property disclaimers, notices, or terms and conditions. If none exist, the W3C Software and Document Short Notice should be included.

Notice of any changes or modifications, through a copyright statement on the new code or document such as "This software or document includes material copied from or derived from [title and URI of the W3C document]. Copyright © [YEAR] W3C® (MIT, ERCIM, Keio, Beihang)."

Disclaimers
THIS WORK IS PROVIDED "AS IS," AND COPYRIGHT HOLDERS MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO, WARRANTIES OF MERCHANTABILITY OR FITNESS FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF THE SOFTWARE OR DOCUMENT WILL NOT INFRINGE ANY THIRD PARTY PATENTS, COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS.

COPYRIGHT HOLDERS WILL NOT BE LIABLE FOR ANY DIRECT, INDIRECT, SPECIAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF ANY USE OF THE SOFTWARE OR DOCUMENT.

The name and trademarks of copyright holders may NOT be used in advertising or publicity pertaining to the work without specific, written prior permission. Title to copyright in this work will at all times remain with copyright holders.
*/
(window["webpackJsonpjwplayer"] = window["webpackJsonpjwplayer"] || []).push([["jwplayer.core.controls.polyfills.html5"],{

/***/ "./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js!./node_modules/less-loader/dist/cjs.js?!./src/css/controls.less":
/*!******************************************************************************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js??ref--4-1!./node_modules/postcss-loader/src!./node_modules/less-loader/dist/cjs.js??ref--4-3!./src/css/controls.less ***!
  \******************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(/*! ../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js")(false);
// Module
exports.push([module.i, ".jw-overlays,.jw-controls,.jw-controls-backdrop,.jw-flag-small-player .jw-settings-menu,.jw-settings-submenu{height:100%;width:100%}.jw-settings-menu .jw-icon::after,.jw-icon-settings::after,.jw-icon-volume::after,.jw-settings-menu .jw-icon.jw-button-color::after{position:absolute;right:0}.jw-overlays,.jw-controls,.jw-controls-backdrop,.jw-settings-item-active::before{top:0;position:absolute;left:0}.jw-settings-menu .jw-icon::after,.jw-icon-settings::after,.jw-icon-volume::after,.jw-settings-menu .jw-icon.jw-button-color::after{position:absolute;bottom:0;left:0}.jw-nextup-close{position:absolute;top:0;right:0}.jw-overlays,.jw-controls,.jw-flag-small-player .jw-settings-menu{position:absolute;bottom:0;right:0}.jw-settings-menu .jw-icon::after,.jw-icon-settings::after,.jw-icon-volume::after,.jw-time-tip::after,.jw-settings-menu .jw-icon.jw-button-color::after,.jw-text-live::before,.jw-controlbar .jw-tooltip::after,.jw-settings-menu .jw-tooltip::after{content:\"\";display:block}.jw-svg-icon{height:24px;width:24px;fill:currentColor;pointer-events:none}.jw-icon{height:44px;width:44px;background-color:transparent;outline:none}.jw-icon.jw-tab-focus:focus{border:solid 2px #4d90fe}.jw-icon-airplay .jw-svg-icon-airplay-off{display:none}.jw-off.jw-icon-airplay .jw-svg-icon-airplay-off{display:block}.jw-icon-airplay .jw-svg-icon-airplay-on{display:block}.jw-off.jw-icon-airplay .jw-svg-icon-airplay-on{display:none}.jw-icon-cc .jw-svg-icon-cc-off{display:none}.jw-off.jw-icon-cc .jw-svg-icon-cc-off{display:block}.jw-icon-cc .jw-svg-icon-cc-on{display:block}.jw-off.jw-icon-cc .jw-svg-icon-cc-on{display:none}.jw-icon-fullscreen .jw-svg-icon-fullscreen-off{display:none}.jw-off.jw-icon-fullscreen .jw-svg-icon-fullscreen-off{display:block}.jw-icon-fullscreen .jw-svg-icon-fullscreen-on{display:block}.jw-off.jw-icon-fullscreen .jw-svg-icon-fullscreen-on{display:none}.jw-icon-volume .jw-svg-icon-volume-0{display:none}.jw-off.jw-icon-volume .jw-svg-icon-volume-0{display:block}.jw-icon-volume .jw-svg-icon-volume-100{display:none}.jw-full.jw-icon-volume .jw-svg-icon-volume-100{display:block}.jw-icon-volume .jw-svg-icon-volume-50{display:block}.jw-off.jw-icon-volume .jw-svg-icon-volume-50,.jw-full.jw-icon-volume .jw-svg-icon-volume-50{display:none}.jw-settings-menu .jw-icon::after,.jw-icon-settings::after,.jw-icon-volume::after{height:100%;width:24px;box-shadow:inset 0 -3px 0 -1px currentColor;margin:auto;opacity:0;transition:opacity 150ms cubic-bezier(0, .25, .25, 1)}.jw-settings-menu .jw-icon[aria-checked=\"true\"]::after,.jw-settings-open .jw-icon-settings::after,.jw-icon-volume.jw-open::after{opacity:1}.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-icon-cc,.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-icon-settings,.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-icon-audio-tracks,.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-icon-hd,.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-settings-sharing,.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-icon-fullscreen,.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player).jw-flag-cast-available .jw-icon-airplay,.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player).jw-flag-cast-available .jw-icon-cast{display:none}.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-icon-volume,.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-text-live{bottom:6px}.jwplayer.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-icon-volume::after{display:none}.jw-overlays,.jw-controls{pointer-events:none}.jw-controls-backdrop{display:block;background:linear-gradient(to bottom, transparent, rgba(0,0,0,0.4) 77%, rgba(0,0,0,0.4) 100%) 100% 100% / 100% 240px no-repeat transparent;transition:opacity 250ms cubic-bezier(0, .25, .25, 1),background-size 250ms cubic-bezier(0, .25, .25, 1);pointer-events:none}.jw-overlays{cursor:auto}.jw-controls{overflow:hidden}.jw-flag-small-player .jw-controls{text-align:center}.jw-text{height:1em;font-family:Arial,Helvetica,sans-serif;font-size:.75em;font-style:normal;font-weight:normal;color:#fff;text-align:center;font-variant:normal;font-stretch:normal}.jw-controlbar,.jw-skip,.jw-display-icon-container .jw-icon,.jw-nextup-container,.jw-autostart-mute,.jw-overlays .jw-plugin{pointer-events:all}.jwplayer .jw-display-icon-container,.jw-error .jw-display-icon-container{width:auto;height:auto;box-sizing:content-box}.jw-display{display:flex;flex-direction:column;justify-content:center;height:100%;padding:57px 0;position:relative;width:100%}.jw-flag-dragging .jw-display{display:none}.jw-state-idle:not(.jw-flag-cast-available) .jw-display{padding:0}.jw-display-container{text-align:center}.jw-display-controls{display:inline-block}.jwplayer .jw-display-icon-container{float:left}.jw-display-icon-container{display:inline-block;padding:5.5px;margin:0 22px}.jw-display-icon-container .jw-icon{height:75px;width:75px;cursor:pointer;display:flex;justify-content:center;align-items:center}.jw-display-icon-container .jw-icon .jw-svg-icon{height:33px;width:33px;padding:0;position:relative}.jw-display-icon-container .jw-icon .jw-svg-icon-rewind{padding:.2em .05em}.jw-breakpoint--1 .jw-nextup-container{display:none}.jw-breakpoint-0 .jw-display-icon-next,.jw-breakpoint--1 .jw-display-icon-next,.jw-breakpoint-0 .jw-display-icon-rewind,.jw-breakpoint--1 .jw-display-icon-rewind{display:none}.jw-breakpoint-0.jw-flag-touch .jw-display .jw-icon,.jw-breakpoint--1.jw-flag-touch .jw-display .jw-icon,.jw-breakpoint-0.jw-flag-touch .jw-display .jw-svg-icon,.jw-breakpoint--1.jw-flag-touch .jw-display .jw-svg-icon{z-index:100;position:relative}.jw-breakpoint-0 .jw-display .jw-icon,.jw-breakpoint--1 .jw-display .jw-icon,.jw-breakpoint-0 .jw-display .jw-svg-icon,.jw-breakpoint--1 .jw-display .jw-svg-icon{width:44px;height:44px;line-height:44px}.jw-breakpoint-0 .jw-display .jw-icon:before,.jw-breakpoint--1 .jw-display .jw-icon:before,.jw-breakpoint-0 .jw-display .jw-svg-icon:before,.jw-breakpoint--1 .jw-display .jw-svg-icon:before{width:22px;height:22px}.jw-breakpoint-1 .jw-display .jw-icon,.jw-breakpoint-1 .jw-display .jw-svg-icon{width:44px;height:44px;line-height:44px}.jw-breakpoint-1 .jw-display .jw-icon:before,.jw-breakpoint-1 .jw-display .jw-svg-icon:before{width:22px;height:22px}.jw-breakpoint-1 .jw-display .jw-icon.jw-icon-rewind:before{width:33px;height:33px}.jw-breakpoint-2 .jw-display .jw-icon,.jw-breakpoint-3 .jw-display .jw-icon,.jw-breakpoint-2 .jw-display .jw-svg-icon,.jw-breakpoint-3 .jw-display .jw-svg-icon{width:77px;height:77px;line-height:77px}.jw-breakpoint-2 .jw-display .jw-icon:before,.jw-breakpoint-3 .jw-display .jw-icon:before,.jw-breakpoint-2 .jw-display .jw-svg-icon:before,.jw-breakpoint-3 .jw-display .jw-svg-icon:before{width:38.5px;height:38.5px}.jw-breakpoint-4 .jw-display .jw-icon,.jw-breakpoint-5 .jw-display .jw-icon,.jw-breakpoint-6 .jw-display .jw-icon,.jw-breakpoint-7 .jw-display .jw-icon,.jw-breakpoint-4 .jw-display .jw-svg-icon,.jw-breakpoint-5 .jw-display .jw-svg-icon,.jw-breakpoint-6 .jw-display .jw-svg-icon,.jw-breakpoint-7 .jw-display .jw-svg-icon{width:88px;height:88px;line-height:88px}.jw-breakpoint-4 .jw-display .jw-icon:before,.jw-breakpoint-5 .jw-display .jw-icon:before,.jw-breakpoint-6 .jw-display .jw-icon:before,.jw-breakpoint-7 .jw-display .jw-icon:before,.jw-breakpoint-4 .jw-display .jw-svg-icon:before,.jw-breakpoint-5 .jw-display .jw-svg-icon:before,.jw-breakpoint-6 .jw-display .jw-svg-icon:before,.jw-breakpoint-7 .jw-display .jw-svg-icon:before{width:44px;height:44px}.jw-controlbar{display:flex;flex-flow:row wrap;align-items:center;justify-content:center;position:absolute;left:0;bottom:0;width:100%;border:none;border-radius:0;background-size:auto;box-shadow:none;max-height:72px;transition:250ms cubic-bezier(0, .25, .25, 1);transition-property:opacity, visibility;transition-delay:0s}.jw-flag-touch.jw-breakpoint-0 .jw-controlbar .jw-icon-inline{height:40px}.jw-breakpoint-7 .jw-controlbar{max-height:140px}.jw-breakpoint-7 .jw-controlbar .jw-button-container{padding:0 48px 20px}.jw-breakpoint-7 .jw-controlbar .jw-button-container .jw-tooltip{margin-bottom:-7px}.jw-breakpoint-7 .jw-controlbar .jw-button-container .jw-icon-volume .jw-overlay{padding-bottom:40%}.jw-breakpoint-7 .jw-controlbar .jw-button-container .jw-text{font-size:1em}.jw-breakpoint-7 .jw-controlbar .jw-button-container .jw-text.jw-text-elapsed{justify-content:flex-end}.jw-breakpoint-7 .jw-controlbar .jw-button-container .jw-icon-inline:not(.jw-text-live),.jw-breakpoint-7 .jw-controlbar .jw-button-container .jw-icon-volume{height:60px;width:60px}.jw-breakpoint-7 .jw-controlbar .jw-button-container .jw-icon-inline:not(.jw-text-live) .jw-svg-icon,.jw-breakpoint-7 .jw-controlbar .jw-button-container .jw-icon-volume .jw-svg-icon{height:30px;width:30px}.jw-breakpoint-7 .jw-controlbar .jw-slider-time{padding:0 60px;height:34px}.jw-breakpoint-7 .jw-controlbar .jw-slider-time .jw-slider-container{height:10px}.jw-controlbar .jw-button-image{background:no-repeat 50% 50%;background-size:contain;max-height:24px}.jw-controlbar .jw-spacer{margin:0 auto}.jw-controlbar .jw-icon.jw-button-color:hover{color:#fff}.jw-button-container{display:flex;flex-flow:row nowrap;flex:1 1 auto;align-items:center;justify-content:flex-start;width:100%;padding:0 12px}.jw-slider-horizontal{background-color:transparent}.jw-icon-inline{position:relative}.jw-icon-inline,.jw-icon-tooltip{height:44px;width:44px;align-items:center;display:flex;justify-content:center}.jw-icon-inline:not(.jw-text),.jw-icon-tooltip,.jw-slider-horizontal{cursor:pointer}.jw-text-elapsed,.jw-text-duration{justify-content:flex-start;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.jw-icon-tooltip{position:relative}.jw-knob:hover,.jw-icon-inline:hover,.jw-icon-tooltip:hover,.jw-icon-display:hover,.jw-option:before:hover{color:#fff}.jw-time-tip,.jw-controlbar .jw-tooltip,.jw-settings-menu .jw-tooltip{pointer-events:none}.jw-icon-cast{display:none;margin:0;padding:0}.jw-icon-cast google-cast-launcher{background-color:transparent;border:none;padding:0;width:24px;height:24px;cursor:pointer}.jw-fullscreen-ima{display:none}.jw-icon-inline.jw-icon-volume{display:none}.jwplayer .jw-text-countdown{display:none}.jw-flag-small-player .jw-display{padding-top:0;padding-bottom:0}.jw-flag-small-player:not(.jw-flag-audio-player):not(.jw-flag-ads) .jw-controlbar .jw-button-container>.jw-icon-rewind,.jw-flag-small-player:not(.jw-flag-audio-player):not(.jw-flag-ads) .jw-controlbar .jw-button-container>.jw-icon-next,.jw-flag-small-player:not(.jw-flag-audio-player):not(.jw-flag-ads) .jw-controlbar .jw-button-container>.jw-icon-playback{display:none}.jw-flag-ads-vpaid:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) .jw-controlbar,.jw-flag-user-inactive.jw-state-playing:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) .jw-controlbar,.jw-flag-user-inactive.jw-state-buffering:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) .jw-controlbar{visibility:hidden;pointer-events:none;opacity:0;transition-delay:0s, 250ms}.jw-flag-ads-vpaid:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) .jw-controls-backdrop,.jw-flag-user-inactive.jw-state-playing:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) .jw-controls-backdrop,.jw-flag-user-inactive.jw-state-buffering:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) .jw-controls-backdrop{opacity:0}.jwplayer:not(.jw-flag-ads):not(.jw-flag-live).jw-breakpoint-0 .jw-text-countdown{display:flex}.jwplayer:not(.jw-flag-ads):not(.jw-flag-live).jw-breakpoint--1 .jw-text-elapsed,.jwplayer:not(.jw-flag-ads):not(.jw-flag-live).jw-breakpoint-0 .jw-text-elapsed,.jwplayer:not(.jw-flag-ads):not(.jw-flag-live).jw-breakpoint--1 .jw-text-duration,.jwplayer:not(.jw-flag-ads):not(.jw-flag-live).jw-breakpoint-0 .jw-text-duration{display:none}.jwplayer.jw-breakpoint--1:not(.jw-flag-ads):not(.jw-flag-audio-player) .jw-text-countdown,.jwplayer.jw-breakpoint--1:not(.jw-flag-ads):not(.jw-flag-audio-player) .jw-related-btn,.jwplayer.jw-breakpoint--1:not(.jw-flag-ads):not(.jw-flag-audio-player) .jw-slider-volume{display:none}.jwplayer.jw-breakpoint--1:not(.jw-flag-ads):not(.jw-flag-audio-player) .jw-controlbar{flex-direction:column-reverse}.jwplayer.jw-breakpoint--1:not(.jw-flag-ads):not(.jw-flag-audio-player) .jw-button-container{height:30px}.jw-breakpoint--1.jw-flag-ads:not(.jw-flag-audio-player) .jw-icon-volume,.jw-breakpoint--1.jw-flag-ads:not(.jw-flag-audio-player) .jw-icon-fullscreen{display:none}.jwplayer:not(.jw-breakpoint-0) .jw-text-duration:before,.jwplayer:not(.jw-breakpoint--1) .jw-text-duration:before{content:\"/\";padding-right:1ch;padding-left:1ch}.jwplayer:not(.jw-flag-user-inactive) .jw-controlbar{will-change:transform}.jwplayer:not(.jw-flag-user-inactive) .jw-controlbar .jw-text{-webkit-transform-style:preserve-3d;transform-style:preserve-3d}.jw-slider-container{display:flex;align-items:center;position:relative;touch-action:none}.jw-rail,.jw-buffer,.jw-progress{position:absolute;cursor:pointer}.jw-progress{background-color:#f2f2f2}.jw-rail{background-color:rgba(255,255,255,0.3)}.jw-buffer{background-color:rgba(255,255,255,0.3)}.jw-knob{height:13px;width:13px;background-color:#fff;border-radius:50%;box-shadow:0 0 10px rgba(0,0,0,0.4);opacity:1;pointer-events:none;position:absolute;-webkit-transform:translate(-50%, -50%) scale(0);transform:translate(-50%, -50%) scale(0);transition:150ms cubic-bezier(0, .25, .25, 1);transition-property:opacity, -webkit-transform;transition-property:opacity, transform;transition-property:opacity, transform, -webkit-transform}.jw-flag-dragging .jw-slider-time .jw-knob,.jw-icon-volume:active .jw-slider-volume .jw-knob{box-shadow:0 0 26px rgba(0,0,0,0.2),0 0 10px rgba(0,0,0,0.4),0 0 0 6px rgba(255,255,255,0.2)}.jw-slider-horizontal,.jw-slider-vertical{display:flex}.jw-slider-horizontal .jw-slider-container{height:5px;width:100%}.jw-slider-horizontal .jw-rail,.jw-slider-horizontal .jw-buffer,.jw-slider-horizontal .jw-progress,.jw-slider-horizontal .jw-cue,.jw-slider-horizontal .jw-knob{top:50%}.jw-slider-horizontal .jw-rail,.jw-slider-horizontal .jw-buffer,.jw-slider-horizontal .jw-progress,.jw-slider-horizontal .jw-cue{-webkit-transform:translate(0, -50%);transform:translate(0, -50%)}.jw-slider-horizontal .jw-rail,.jw-slider-horizontal .jw-buffer,.jw-slider-horizontal .jw-progress{height:5px}.jw-slider-horizontal .jw-rail{width:100%}.jw-slider-vertical{align-items:center;flex-direction:column}.jw-slider-vertical .jw-slider-container{height:88px;width:5px}.jw-slider-vertical .jw-rail,.jw-slider-vertical .jw-buffer,.jw-slider-vertical .jw-progress,.jw-slider-vertical .jw-knob{left:50%}.jw-slider-vertical .jw-rail,.jw-slider-vertical .jw-buffer,.jw-slider-vertical .jw-progress{height:100%;width:5px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);transition:-webkit-transform 150ms ease-in-out;transition:transform 150ms ease-in-out;transition:transform 150ms ease-in-out, -webkit-transform 150ms ease-in-out;bottom:0}.jw-slider-vertical .jw-knob{-webkit-transform:translate(-50%, 50%);transform:translate(-50%, 50%)}.jw-slider-time.jw-tab-focus:focus .jw-rail{outline:solid 2px #4d90fe}.jw-slider-time,.jw-horizontal-volume-container .jw-slider-volume{height:17px;width:100%;align-items:center;background:transparent none;padding:0 12px}.jw-slider-time .jw-cue{background-color:rgba(33,33,33,0.8);cursor:pointer;position:absolute;width:6px}.jw-slider-time,.jw-horizontal-volume-container{z-index:1;outline:none}.jw-slider-time .jw-rail,.jw-horizontal-volume-container .jw-rail,.jw-slider-time .jw-buffer,.jw-horizontal-volume-container .jw-buffer,.jw-slider-time .jw-progress,.jw-horizontal-volume-container .jw-progress,.jw-slider-time .jw-cue,.jw-horizontal-volume-container .jw-cue{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;-webkit-transform:translate(0, -50%) scale(1, .6);transform:translate(0, -50%) scale(1, .6);transition:-webkit-transform 150ms ease-in-out;transition:transform 150ms ease-in-out;transition:transform 150ms ease-in-out, -webkit-transform 150ms ease-in-out}.jw-slider-time:hover .jw-rail,.jw-horizontal-volume-container:hover .jw-rail,.jw-slider-time:focus .jw-rail,.jw-horizontal-volume-container:focus .jw-rail,.jw-flag-dragging .jw-slider-time .jw-rail,.jw-flag-dragging .jw-horizontal-volume-container .jw-rail,.jw-flag-touch .jw-slider-time .jw-rail,.jw-flag-touch .jw-horizontal-volume-container .jw-rail,.jw-slider-time:hover .jw-buffer,.jw-horizontal-volume-container:hover .jw-buffer,.jw-slider-time:focus .jw-buffer,.jw-horizontal-volume-container:focus .jw-buffer,.jw-flag-dragging .jw-slider-time .jw-buffer,.jw-flag-dragging .jw-horizontal-volume-container .jw-buffer,.jw-flag-touch .jw-slider-time .jw-buffer,.jw-flag-touch .jw-horizontal-volume-container .jw-buffer,.jw-slider-time:hover .jw-progress,.jw-horizontal-volume-container:hover .jw-progress,.jw-slider-time:focus .jw-progress,.jw-horizontal-volume-container:focus .jw-progress,.jw-flag-dragging .jw-slider-time .jw-progress,.jw-flag-dragging .jw-horizontal-volume-container .jw-progress,.jw-flag-touch .jw-slider-time .jw-progress,.jw-flag-touch .jw-horizontal-volume-container .jw-progress,.jw-slider-time:hover .jw-cue,.jw-horizontal-volume-container:hover .jw-cue,.jw-slider-time:focus .jw-cue,.jw-horizontal-volume-container:focus .jw-cue,.jw-flag-dragging .jw-slider-time .jw-cue,.jw-flag-dragging .jw-horizontal-volume-container .jw-cue,.jw-flag-touch .jw-slider-time .jw-cue,.jw-flag-touch .jw-horizontal-volume-container .jw-cue{-webkit-transform:translate(0, -50%) scale(1, 1);transform:translate(0, -50%) scale(1, 1)}.jw-slider-time:hover .jw-knob,.jw-horizontal-volume-container:hover .jw-knob,.jw-slider-time:focus .jw-knob,.jw-horizontal-volume-container:focus .jw-knob{-webkit-transform:translate(-50%, -50%) scale(1);transform:translate(-50%, -50%) scale(1)}.jw-slider-time .jw-rail,.jw-horizontal-volume-container .jw-rail{background-color:rgba(255,255,255,0.2)}.jw-slider-time .jw-buffer,.jw-horizontal-volume-container .jw-buffer{background-color:rgba(255,255,255,0.4)}.jw-flag-touch .jw-slider-time::before,.jw-flag-touch .jw-horizontal-volume-container::before{height:44px;width:100%;content:\"\";position:absolute;display:block;bottom:calc(100% - 17px);left:0}.jw-breakpoint-0.jw-flag-touch .jw-slider-time::before,.jw-breakpoint-0.jw-flag-touch .jw-horizontal-volume-container::before{height:34px}.jw-slider-time.jw-tab-focus:focus .jw-rail,.jw-horizontal-volume-container.jw-tab-focus:focus .jw-rail{outline:solid 2px #4d90fe}.jw-flag-horizontal-slider .jw-overlay{display:none}.jw-flag-audio-player .jw-flag-horizontal-slider~.jw-horizontal-volume-container,.jwplayer:not(.jw-flag-small-player) .jw-flag-horizontal-slider~.jw-horizontal-volume-container{display:flex;transition:width 300ms cubic-bezier(0, .25, .25, 1);width:0}.jw-flag-audio-player .jw-flag-horizontal-slider~.jw-horizontal-volume-container.jw-open,.jwplayer:not(.jw-flag-small-player) .jw-flag-horizontal-slider~.jw-horizontal-volume-container.jw-open{width:140px}.jw-flag-audio-player .jw-flag-horizontal-slider~.jw-horizontal-volume-container.jw-open .jw-slider-volume,.jwplayer:not(.jw-flag-small-player) .jw-flag-horizontal-slider~.jw-horizontal-volume-container.jw-open .jw-slider-volume{padding-right:24px;opacity:1}.jw-flag-audio-player .jw-flag-horizontal-slider~.jw-horizontal-volume-container .jw-slider-volume,.jwplayer:not(.jw-flag-small-player) .jw-flag-horizontal-slider~.jw-horizontal-volume-container .jw-slider-volume{transition:opacity 300ms;opacity:0}.jw-flag-audio-player .jw-flag-horizontal-slider~.jw-horizontal-volume-container .jw-slider-volume .jw-knob,.jwplayer:not(.jw-flag-small-player) .jw-flag-horizontal-slider~.jw-horizontal-volume-container .jw-slider-volume .jw-knob{-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}.jw-flag-audio-player .jw-button-container .jw-icon,.jwplayer:not(.jw-flag-small-player) .jw-button-container .jw-icon{flex:0 0 auto}.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-slider-time{height:17px;padding:0}.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-slider-time .jw-slider-container{height:10px}.jw-breakpoint--1:not(.jw-flag-audio-player) .jw-slider-time .jw-knob{border-radius:0;border:1px solid rgba(0,0,0,0.75);height:12px;width:10px}.jw-breakpoint-0 .jw-slider-time{height:11px}.jw-horizontal-volume-container{display:none}.jw-modal{width:284px}.jw-breakpoint-7 .jw-modal,.jw-breakpoint-6 .jw-modal,.jw-breakpoint-5 .jw-modal{height:232px}.jw-breakpoint-4 .jw-modal,.jw-breakpoint-3 .jw-modal{height:192px}.jw-breakpoint-2 .jw-modal,.jw-flag-small-player .jw-modal{bottom:0;right:0;height:100%;width:100%;max-height:none;max-width:none;z-index:2}.jwplayer .jw-rightclick{display:none;position:absolute;white-space:nowrap}.jwplayer .jw-rightclick.jw-open{display:block}.jwplayer .jw-rightclick .jw-rightclick-list{border-radius:1px;list-style:none;margin:0;padding:0}.jwplayer .jw-rightclick .jw-rightclick-list .jw-rightclick-item{background-color:rgba(0,0,0,0.8);border-bottom:1px solid #444;margin:0}.jwplayer .jw-rightclick .jw-rightclick-list .jw-rightclick-item .jw-rightclick-logo{color:#fff;display:inline-flex;padding:0 10px 0 0;vertical-align:middle}.jwplayer .jw-rightclick .jw-rightclick-list .jw-rightclick-item .jw-rightclick-logo .jw-svg-icon{height:20px;width:20px}.jwplayer .jw-rightclick .jw-rightclick-list .jw-rightclick-item .jw-rightclick-link{border:none;color:#fff;display:block;font-size:11px;font-weight:400;line-height:1em;padding:15px 23px;text-align:start;text-decoration:none;width:100%}.jwplayer .jw-rightclick .jw-rightclick-list .jw-rightclick-item:last-child{border-bottom:none}.jwplayer .jw-rightclick .jw-rightclick-list .jw-rightclick-item:hover{cursor:pointer}.jwplayer .jw-rightclick .jw-rightclick-list .jw-featured{vertical-align:middle}.jwplayer .jw-rightclick .jw-rightclick-list .jw-featured .jw-rightclick-link{color:#fff}.jwplayer .jw-rightclick .jw-rightclick-list .jw-featured .jw-rightclick-link span{color:#fff;font-size:12px}.jwplayer .jw-rightclick .jw-info-overlay-item,.jwplayer .jw-rightclick .jw-share-item,.jwplayer .jw-rightclick .jw-shortcuts-item{border:none;background-color:transparent;outline:none;cursor:pointer}.jw-icon-tooltip.jw-open .jw-overlay{opacity:1;pointer-events:auto;transition-delay:0s}.jw-icon-tooltip.jw-open .jw-overlay:focus{outline:none}.jw-icon-tooltip.jw-open .jw-overlay:focus.jw-tab-focus{outline:solid 2px #4d90fe}.jw-slider-time .jw-overlay:before{height:1em;top:auto}.jw-slider-time .jw-icon-tooltip.jw-open .jw-overlay{pointer-events:none}.jw-volume-tip{padding:13px 0 26px}.jw-time-tip,.jw-controlbar .jw-tooltip,.jw-settings-menu .jw-tooltip{height:auto;width:100%;box-shadow:0 0 10px rgba(0,0,0,0.4);color:#fff;display:block;margin:0 0 14px;pointer-events:none;position:relative;z-index:0}.jw-time-tip::after,.jw-controlbar .jw-tooltip::after,.jw-settings-menu .jw-tooltip::after{top:100%;position:absolute;left:50%;height:14px;width:14px;border-radius:1px;background-color:currentColor;-webkit-transform-origin:75% 50%;transform-origin:75% 50%;-webkit-transform:translate(-50%, -50%) rotate(45deg);transform:translate(-50%, -50%) rotate(45deg);z-index:-1}.jw-time-tip .jw-text,.jw-controlbar .jw-tooltip .jw-text,.jw-settings-menu .jw-tooltip .jw-text{background-color:#fff;border-radius:1px;color:#000;font-size:10px;height:auto;line-height:1;padding:7px 10px;display:inline-block;min-width:100%;vertical-align:middle;min-height:2.4em}.jw-controlbar .jw-overlay{position:absolute;bottom:100%;left:50%;margin:0;min-height:44px;min-width:44px;opacity:0;pointer-events:none;transition:150ms cubic-bezier(0, .25, .25, 1);transition-property:opacity, visibility;transition-delay:0s, 150ms;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);width:100%;z-index:1}.jw-controlbar .jw-overlay .jw-contents{position:relative}.jw-controlbar .jw-option{position:relative;white-space:nowrap;cursor:pointer;list-style:none;height:1.5em;font-family:inherit;line-height:1.5em;padding:0 .5em;font-size:.8em;margin:0}.jw-controlbar .jw-option::before{padding-right:.125em}.jw-controlbar .jw-tooltip,.jw-settings-menu .jw-tooltip{position:absolute;bottom:100%;left:50%;opacity:0;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);transition:100ms 0s cubic-bezier(0, .25, .25, 1);transition-property:opacity, visibility, -webkit-transform;transition-property:opacity, transform, visibility;transition-property:opacity, transform, visibility, -webkit-transform;visibility:hidden;white-space:nowrap;width:auto;z-index:1}.jw-controlbar .jw-tooltip.jw-open,.jw-settings-menu .jw-tooltip.jw-open{opacity:1;-webkit-transform:translate(-50%, -10px);transform:translate(-50%, -10px);transition-duration:150ms;transition-delay:500ms,0s,500ms;visibility:visible}.jw-controlbar .jw-tooltip.jw-tooltip-fullscreen,.jw-settings-menu .jw-tooltip.jw-tooltip-fullscreen{left:auto;right:0;-webkit-transform:translate(0, 0);transform:translate(0, 0)}.jw-controlbar .jw-tooltip.jw-tooltip-fullscreen.jw-open,.jw-settings-menu .jw-tooltip.jw-tooltip-fullscreen.jw-open{-webkit-transform:translate(0, -10px);transform:translate(0, -10px)}.jw-controlbar .jw-tooltip.jw-tooltip-fullscreen::after,.jw-settings-menu .jw-tooltip.jw-tooltip-fullscreen::after{left:auto;right:9px}.jw-tooltip-time{height:auto;width:0;bottom:100%;line-height:normal;padding:0;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jw-tooltip-time .jw-overlay{bottom:0;min-height:0;width:auto}.jw-tooltip{bottom:57px;display:none;position:absolute}.jw-tooltip .jw-text{height:100%;white-space:nowrap;text-overflow:ellipsis;direction:unset;max-width:246px;overflow:hidden}.jw-flag-audio-player .jw-tooltip{display:none}.jw-flag-small-player .jw-time-thumb{display:none}.jwplayer .jw-shortcuts-tooltip{top:50%;position:absolute;left:50%;background:#333;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);display:none;color:#fff;pointer-events:all;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;overflow:hidden;flex-direction:column;z-index:1}.jwplayer .jw-shortcuts-tooltip.jw-open{display:flex}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-close{flex:0 0 auto;margin:5px 5px 5px auto}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container{display:flex;flex:1 1 auto;flex-flow:column;font-size:12px;margin:0 20px 20px;overflow-y:auto;padding:5px}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container::-webkit-scrollbar{background-color:transparent;width:6px}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container::-webkit-scrollbar-thumb{background-color:#fff;border:1px solid #333;border-radius:6px}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container .jw-shortcuts-title{font-weight:bold}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container .jw-shortcuts-header{align-items:center;display:flex;justify-content:space-between;margin-bottom:10px}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container .jw-shortcuts-tooltip-list{display:flex;max-width:340px;margin:0 10px}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container .jw-shortcuts-tooltip-list .jw-shortcuts-tooltip-descriptions{width:100%}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container .jw-shortcuts-tooltip-list .jw-shortcuts-row{display:flex;align-items:center;justify-content:space-between;margin:10px 0;width:100%}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container .jw-shortcuts-tooltip-list .jw-shortcuts-row .jw-shortcuts-description{margin-right:10px;max-width:70%}.jwplayer .jw-shortcuts-tooltip .jw-shortcuts-container .jw-shortcuts-tooltip-list .jw-shortcuts-row .jw-shortcuts-key{background:#fefefe;color:#333;overflow:hidden;padding:7px 10px;text-overflow:ellipsis;white-space:nowrap}.jw-skip{color:rgba(255,255,255,0.8);cursor:default;position:absolute;display:flex;right:.75em;bottom:56px;padding:.5em;border:1px solid #333;background-color:#000;align-items:center;height:2em}.jw-skip.jw-tab-focus:focus{outline:solid 2px #4d90fe}.jw-skip.jw-skippable{cursor:pointer;padding:.25em .75em}.jw-skip.jw-skippable:hover{cursor:pointer;color:#fff}.jw-skip.jw-skippable .jw-skip-icon{display:inline;height:24px;width:24px;margin:0}.jw-breakpoint-7 .jw-skip{padding:1.35em 1em;bottom:130px}.jw-breakpoint-7 .jw-skip .jw-text{font-size:1em;font-weight:normal}.jw-breakpoint-7 .jw-skip .jw-icon-inline{height:30px;width:30px}.jw-breakpoint-7 .jw-skip .jw-icon-inline .jw-svg-icon{height:30px;width:30px}.jw-skip .jw-skip-icon{display:none;margin-left:-0.75em;padding:0 .5em;pointer-events:none}.jw-skip .jw-skip-icon .jw-svg-icon-next{display:block;padding:0}.jw-skip .jw-text,.jw-skip .jw-skip-icon{vertical-align:middle;font-size:.7em}.jw-skip .jw-text{font-weight:bold}.jw-cast{background-size:cover;display:none;height:100%;position:relative;width:100%}.jw-cast-container{background:linear-gradient(180deg, rgba(25,25,25,0.75), rgba(25,25,25,0.25), rgba(25,25,25,0));left:0;padding:20px 20px 80px;position:absolute;top:0;width:100%}.jw-cast-text{color:#fff;font-size:1.6em}.jw-breakpoint--1 .jw-cast-text,.jw-breakpoint-0 .jw-cast-text{font-size:1.15em}.jw-breakpoint-1 .jw-cast-text,.jw-breakpoint-2 .jw-cast-text,.jw-breakpoint-3 .jw-cast-text{font-size:1.3em}.jw-nextup-container{position:absolute;bottom:66px;left:0;background-color:transparent;cursor:pointer;margin:0 auto;padding:12px;pointer-events:none;right:0;text-align:right;visibility:hidden;width:100%}.jw-settings-open .jw-nextup-container,.jw-info-open .jw-nextup-container{display:none}.jw-breakpoint-7 .jw-nextup-container{padding:60px}.jw-flag-small-player .jw-nextup-container{padding:0 12px 0 0}.jw-flag-small-player .jw-nextup-container .jw-nextup-title,.jw-flag-small-player .jw-nextup-container .jw-nextup-duration,.jw-flag-small-player .jw-nextup-container .jw-nextup-close{display:none}.jw-flag-small-player .jw-nextup-container .jw-nextup-tooltip{height:30px}.jw-flag-small-player .jw-nextup-container .jw-nextup-header{font-size:12px}.jw-flag-small-player .jw-nextup-container .jw-nextup-body{justify-content:center;align-items:center;padding:.75em .3em}.jw-flag-small-player .jw-nextup-container .jw-nextup-thumbnail{width:50%}.jw-flag-small-player .jw-nextup-container .jw-nextup{max-width:65px}.jw-flag-small-player .jw-nextup-container .jw-nextup.jw-nextup-thumbnail-visible{max-width:120px}.jw-nextup{background:#333;border-radius:0;box-shadow:0 0 10px rgba(0,0,0,0.5);color:rgba(255,255,255,0.8);display:inline-block;max-width:280px;overflow:hidden;opacity:0;position:relative;width:64%;pointer-events:all;-webkit-transform:translate(0, -5px);transform:translate(0, -5px);transition:150ms cubic-bezier(0, .25, .25, 1);transition-property:opacity, -webkit-transform;transition-property:opacity, transform;transition-property:opacity, transform, -webkit-transform;transition-delay:0s}.jw-nextup:hover .jw-nextup-tooltip{color:#fff}.jw-nextup.jw-nextup-thumbnail-visible{max-width:400px}.jw-nextup.jw-nextup-thumbnail-visible .jw-nextup-thumbnail{display:block}.jw-nextup-container-visible{visibility:visible}.jw-nextup-container-visible .jw-nextup{opacity:1;-webkit-transform:translate(0, 0);transform:translate(0, 0);transition-delay:0s, 0s, 150ms}.jw-nextup-tooltip{display:flex;height:80px}.jw-nextup-thumbnail{width:120px;background-position:center;background-size:cover;flex:0 0 auto;display:none}.jw-nextup-body{flex:1 1 auto;overflow:hidden;padding:.75em .875em;display:flex;flex-flow:column wrap;justify-content:space-between}.jw-nextup-header,.jw-nextup-title{font-size:14px;line-height:1.35}.jw-nextup-header{font-weight:bold}.jw-nextup-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.jw-nextup-duration{align-self:flex-end;text-align:right;font-size:12px}.jw-nextup-close{height:24px;width:24px;border:none;color:rgba(255,255,255,0.8);cursor:pointer;margin:6px;visibility:hidden}.jw-nextup-close:hover{color:#fff}.jw-nextup-sticky .jw-nextup-close{visibility:visible}.jw-autostart-mute{position:absolute;bottom:0;right:12px;height:44px;width:44px;background-color:rgba(33,33,33,0.4);padding:5px 4px 5px 6px;display:none}.jwplayer.jw-flag-autostart:not(.jw-flag-media-audio) .jw-nextup{display:none}.jw-settings-menu{position:absolute;bottom:57px;right:12px;align-items:flex-start;background-color:#333;display:none;flex-flow:column nowrap;max-width:284px;pointer-events:auto}.jw-settings-open .jw-settings-menu{display:flex}.jw-breakpoint-7 .jw-settings-menu{bottom:130px;right:60px;max-height:none;max-width:none;height:35%;width:25%}.jw-breakpoint-7 .jw-settings-menu .jw-settings-topbar:not(.jw-nested-menu-open) .jw-icon-inline{height:60px;width:60px}.jw-breakpoint-7 .jw-settings-menu .jw-settings-topbar:not(.jw-nested-menu-open) .jw-icon-inline .jw-svg-icon{height:30px;width:30px}.jw-breakpoint-7 .jw-settings-menu .jw-settings-topbar:not(.jw-nested-menu-open) .jw-icon-inline .jw-tooltip .jw-text{font-size:1em}.jw-breakpoint-7 .jw-settings-menu .jw-settings-back{min-width:60px}.jw-breakpoint-6 .jw-settings-menu,.jw-breakpoint-5 .jw-settings-menu{height:232px;width:284px;max-height:232px}.jw-breakpoint-4 .jw-settings-menu,.jw-breakpoint-3 .jw-settings-menu{height:192px;width:284px;max-height:192px}.jw-breakpoint-2 .jw-settings-menu{height:179px;width:284px;max-height:179px}.jw-flag-small-player .jw-settings-menu{max-width:none}.jw-settings-menu .jw-icon.jw-button-color::after{height:100%;width:24px;box-shadow:inset 0 -3px 0 -1px currentColor;margin:auto;opacity:0;transition:opacity 150ms cubic-bezier(0, .25, .25, 1)}.jw-settings-menu .jw-icon.jw-button-color[aria-expanded=\"true\"]::after{opacity:1}.jw-settings-menu .jw-settings-reset{text-decoration:underline}.jw-settings-topbar{align-items:center;background-color:rgba(0,0,0,0.4);display:flex;flex:0 0 auto;padding:3px 5px 0;width:100%}.jw-settings-topbar.jw-nested-menu-open{padding:0}.jw-settings-topbar.jw-nested-menu-open .jw-icon:not(.jw-settings-close):not(.jw-settings-back){display:none}.jw-settings-topbar.jw-nested-menu-open .jw-svg-icon-close{width:20px}.jw-settings-topbar.jw-nested-menu-open .jw-svg-icon-arrow-left{height:12px}.jw-settings-topbar.jw-nested-menu-open .jw-settings-topbar-text{display:block;outline:none}.jw-settings-topbar .jw-settings-back{min-width:44px}.jw-settings-topbar .jw-settings-topbar-buttons{display:inherit;width:100%;height:100%}.jw-settings-topbar .jw-settings-topbar-text{display:none;color:#fff;font-size:13px;width:100%}.jw-settings-topbar .jw-settings-close{margin-left:auto}.jw-settings-submenu{display:none;flex:1 1 auto;overflow-y:auto;padding:8px 20px 0 5px}.jw-settings-submenu::-webkit-scrollbar{background-color:transparent;width:6px}.jw-settings-submenu::-webkit-scrollbar-thumb{background-color:#fff;border:1px solid #333;border-radius:6px}.jw-settings-submenu.jw-settings-submenu-active{display:block}.jw-settings-submenu .jw-submenu-topbar{box-shadow:0 2px 9px 0 #1d1d1d;background-color:#2f2d2d;margin:-8px -20px 0 -5px}.jw-settings-submenu .jw-submenu-topbar .jw-settings-content-item{cursor:pointer;text-align:right;padding-right:15px;text-decoration:underline}.jw-settings-submenu .jw-settings-value-wrapper{float:right;display:flex;align-items:center}.jw-settings-submenu .jw-settings-value-wrapper .jw-settings-content-item-arrow{display:flex}.jw-settings-submenu .jw-settings-value-wrapper .jw-svg-icon-arrow-right{width:8px;margin-left:5px;height:12px}.jw-breakpoint-7 .jw-settings-submenu .jw-settings-content-item{font-size:1em;padding:11px 15px 11px 30px}.jw-breakpoint-7 .jw-settings-submenu .jw-settings-content-item .jw-settings-item-active::before{justify-content:flex-end}.jw-breakpoint-7 .jw-settings-submenu .jw-settings-content-item .jw-auto-label{font-size:.85em;padding-left:10px}.jw-flag-touch .jw-settings-submenu{overflow-y:scroll;-webkit-overflow-scrolling:touch}.jw-auto-label{font-size:10px;font-weight:initial;opacity:.75;padding-left:5px}.jw-settings-content-item{position:relative;color:rgba(255,255,255,0.8);cursor:pointer;font-size:12px;line-height:1;padding:7px 0 7px 15px;width:100%;text-align:left;outline:none}.jw-settings-content-item:hover{color:#fff}.jw-settings-content-item:focus{font-weight:bold}.jw-flag-small-player .jw-settings-content-item{line-height:1.75}.jw-settings-content-item.jw-tab-focus:focus{border:solid 2px #4d90fe}.jw-settings-item-active{font-weight:bold;position:relative}.jw-settings-item-active::before{height:100%;width:1em;align-items:center;content:\"\\2022\";display:inline-flex;justify-content:center}.jw-breakpoint-2 .jw-settings-open .jw-display-container,.jw-flag-small-player .jw-settings-open .jw-display-container,.jw-flag-touch .jw-settings-open .jw-display-container{display:none}.jw-breakpoint-2 .jw-settings-open.jw-controls,.jw-flag-small-player .jw-settings-open.jw-controls,.jw-flag-touch .jw-settings-open.jw-controls{z-index:1}.jw-flag-small-player .jw-settings-open .jw-controlbar{display:none}.jw-settings-open .jw-icon-settings::after{opacity:1}.jw-settings-open .jw-tooltip-settings{display:none}.jw-sharing-link{cursor:pointer}.jw-shortcuts-container .jw-switch{position:relative;display:flex;align-items:center;transition:ease-out .15s;transition-property:opacity, background;border-radius:18px;width:80px;height:20px;padding:10px;background:rgba(80,80,80,0.8);cursor:pointer;font-size:inherit;vertical-align:middle;outline:none}.jw-shortcuts-container .jw-switch.jw-tab-focus{border:solid 2px #4d90fe}.jw-shortcuts-container .jw-switch .jw-switch-knob{position:absolute;left:1px;transition:ease-out .15s;box-shadow:0 0 10px rgba(0,0,0,0.4);border-radius:13px;width:15px;height:15px;background:#fefefe}.jw-shortcuts-container .jw-switch .jw-switch-disabled,.jw-shortcuts-container .jw-switch .jw-switch-enabled{position:absolute;transition:inherit;color:#fefefe}.jw-shortcuts-container .jw-switch .jw-switch-disabled{right:8px}.jw-shortcuts-container .jw-switch .jw-switch-enabled{left:8px;opacity:0}.jw-shortcuts-container .jw-switch[aria-checked=\"true\"]{background:#475470}.jw-shortcuts-container .jw-switch[aria-checked=\"true\"] .jw-switch-disabled{opacity:0}.jw-shortcuts-container .jw-switch[aria-checked=\"true\"] .jw-switch-enabled{opacity:1}.jw-shortcuts-container .jw-switch[aria-checked=\"true\"] .jw-switch-knob{left:60px}.jw-idle-icon-text{display:none;line-height:1;position:absolute;text-align:center;text-indent:.35em;top:100%;white-space:nowrap;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.jw-idle-label{border-radius:50%;color:#fff;-webkit-filter:drop-shadow(1px 1px 5px rgba(12,26,71,0.25));filter:drop-shadow(1px 1px 5px rgba(12,26,71,0.25));font:normal 16px/1 Arial,Helvetica,sans-serif;position:relative;transition:background-color 150ms cubic-bezier(0, .25, .25, 1);transition-property:background-color,-webkit-filter;transition-property:background-color,filter;transition-property:background-color,filter,-webkit-filter;-webkit-font-smoothing:antialiased}.jw-state-idle .jw-icon-display.jw-idle-label .jw-idle-icon-text{display:block}.jw-state-idle .jw-icon-display.jw-idle-label .jw-svg-icon-play{-webkit-transform:scale(.7, .7);transform:scale(.7, .7)}.jw-breakpoint-0.jw-state-idle .jw-icon-display.jw-idle-label,.jw-breakpoint--1.jw-state-idle .jw-icon-display.jw-idle-label{font-size:12px}.jw-info-overlay{top:50%;position:absolute;left:50%;background:#333;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);display:none;color:#fff;pointer-events:all;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;overflow:hidden;flex-direction:column}.jw-info-overlay .jw-info-close{flex:0 0 auto;margin:5px 5px 5px auto}.jw-info-open .jw-info-overlay{display:flex}.jw-info-container{display:flex;flex:1 1 auto;flex-flow:column;margin:0 20px 20px;overflow-y:auto;padding:5px}.jw-info-container [class*=\"jw-info\"]:not(:first-of-type){color:rgba(255,255,255,0.8);padding-top:10px;font-size:12px}.jw-info-container .jw-info-description{margin-bottom:30px;text-align:start}.jw-info-container .jw-info-description:empty{display:none}.jw-info-container .jw-info-duration{text-align:start}.jw-info-container .jw-info-title{text-align:start;font-size:12px;font-weight:bold}.jw-info-container::-webkit-scrollbar{background-color:transparent;width:6px}.jw-info-container::-webkit-scrollbar-thumb{background-color:#fff;border:1px solid #333;border-radius:6px}.jw-info-clientid{align-self:flex-end;font-size:12px;color:rgba(255,255,255,0.8);margin:0 20px 20px 44px;text-align:right}.jw-flag-touch .jw-info-open .jw-display-container{display:none}@supports ((-webkit-filter: drop-shadow(0 0 3px #000)) or (filter: drop-shadow(0 0 3px #000))){.jwplayer.jw-ab-drop-shadow .jw-controls .jw-svg-icon,.jwplayer.jw-ab-drop-shadow .jw-controls .jw-icon.jw-text,.jwplayer.jw-ab-drop-shadow .jw-slider-container .jw-rail,.jwplayer.jw-ab-drop-shadow .jw-title{text-shadow:none;box-shadow:none;-webkit-filter:drop-shadow(0 2px 3px rgba(0,0,0,0.3));filter:drop-shadow(0 2px 3px rgba(0,0,0,0.3))}.jwplayer.jw-ab-drop-shadow .jw-button-color{opacity:.8;transition-property:color, opacity}.jwplayer.jw-ab-drop-shadow .jw-button-color:not(:hover){color:#fff;opacity:.8}.jwplayer.jw-ab-drop-shadow .jw-button-color:hover{opacity:1}.jwplayer.jw-ab-drop-shadow .jw-controls-backdrop{background-image:linear-gradient(to bottom, hsla(0, 0%, 0%, 0), hsla(0, 0%, 0%, 0.00787) 10.79%, hsla(0, 0%, 0%, 0.02963) 21.99%, hsla(0, 0%, 0%, 0.0625) 33.34%, hsla(0, 0%, 0%, 0.1037) 44.59%, hsla(0, 0%, 0%, 0.15046) 55.48%, hsla(0, 0%, 0%, 0.2) 65.75%, hsla(0, 0%, 0%, 0.24954) 75.14%, hsla(0, 0%, 0%, 0.2963) 83.41%, hsla(0, 0%, 0%, 0.3375) 90.28%, hsla(0, 0%, 0%, 0.37037) 95.51%, hsla(0, 0%, 0%, 0.39213) 98.83%, hsla(0, 0%, 0%, 0.4));mix-blend-mode:multiply;transition-property:opacity}.jw-state-idle.jwplayer.jw-ab-drop-shadow .jw-controls-backdrop{background-image:linear-gradient(to bottom, hsla(0, 0%, 0%, 0.2), hsla(0, 0%, 0%, 0.19606) 1.17%, hsla(0, 0%, 0%, 0.18519) 4.49%, hsla(0, 0%, 0%, 0.16875) 9.72%, hsla(0, 0%, 0%, 0.14815) 16.59%, hsla(0, 0%, 0%, 0.12477) 24.86%, hsla(0, 0%, 0%, 0.1) 34.25%, hsla(0, 0%, 0%, 0.07523) 44.52%, hsla(0, 0%, 0%, 0.05185) 55.41%, hsla(0, 0%, 0%, 0.03125) 66.66%, hsla(0, 0%, 0%, 0.01481) 78.01%, hsla(0, 0%, 0%, 0.00394) 89.21%, hsla(0, 0%, 0%, 0));background-size:100% 7rem;background-position:50% 0}.jwplayer.jw-ab-drop-shadow.jw-state-idle .jw-controls{background-color:transparent}}.jw-video-thumbnail-container{position:relative;overflow:hidden}.jw-video-thumbnail-container:not(.jw-related-shelf-item-image){height:100%;width:100%}.jw-video-thumbnail-container.jw-video-thumbnail-generated{position:absolute;top:0;left:0}.jw-video-thumbnail-container:hover,.jw-related-item-content:hover .jw-video-thumbnail-container,.jw-related-shelf-item:hover .jw-video-thumbnail-container{cursor:pointer}.jw-video-thumbnail-container:hover .jw-video-thumbnail:not(.jw-video-thumbnail-completed),.jw-related-item-content:hover .jw-video-thumbnail-container .jw-video-thumbnail:not(.jw-video-thumbnail-completed),.jw-related-shelf-item:hover .jw-video-thumbnail-container .jw-video-thumbnail:not(.jw-video-thumbnail-completed){opacity:1}.jw-video-thumbnail-container .jw-video-thumbnail{position:absolute;top:50%;left:50%;bottom:unset;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);width:100%;height:auto;min-width:100%;min-height:100%;opacity:0;transition:opacity .3s ease;object-fit:cover;background:#000}.jw-related-item-next-up .jw-video-thumbnail-container .jw-video-thumbnail{height:100%;width:auto}.jw-video-thumbnail-container .jw-video-thumbnail.jw-video-thumbnail-visible:not(.jw-video-thumbnail-completed){opacity:1}.jw-video-thumbnail-container .jw-video-thumbnail.jw-video-thumbnail-completed{opacity:0}.jw-video-thumbnail-container .jw-video-thumbnail~.jw-svg-icon-play{display:none}.jw-video-thumbnail-container .jw-video-thumbnail+.jw-related-shelf-item-aspect{pointer-events:none}.jw-video-thumbnail-container .jw-video-thumbnail+.jw-related-item-poster-content{pointer-events:none}.jw-preview{overflow:hidden}.jw-preview .jw-ab-zoom-thumbnail{all:inherit;-webkit-animation:jw-ab-zoom-thumbnail-animation 10s infinite;animation:jw-ab-zoom-thumbnail-animation 10s infinite}@-webkit-keyframes jw-ab-zoom-thumbnail-animation{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}50%{-webkit-transform:scale(1.25, 1.25);transform:scale(1.25, 1.25)}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}}@keyframes jw-ab-zoom-thumbnail-animation{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}50%{-webkit-transform:scale(1.25, 1.25);transform:scale(1.25, 1.25)}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}}.jw-state-idle:not(.jw-flag-cast-available) .jw-display{padding:0}.jw-state-idle .jw-controls{background:rgba(0,0,0,0.4)}.jw-state-idle.jw-flag-cast-available:not(.jw-flag-audio-player) .jw-controlbar .jw-slider-time,.jw-state-idle.jw-flag-cardboard-available .jw-controlbar .jw-slider-time,.jw-state-idle.jw-flag-cast-available:not(.jw-flag-audio-player) .jw-controlbar .jw-icon:not(.jw-icon-cardboard):not(.jw-icon-cast):not(.jw-icon-airplay),.jw-state-idle.jw-flag-cardboard-available .jw-controlbar .jw-icon:not(.jw-icon-cardboard):not(.jw-icon-cast):not(.jw-icon-airplay){display:none}.jwplayer.jw-state-buffering .jw-display-icon-display .jw-icon:focus{border:none}.jwplayer.jw-state-buffering .jw-display-icon-display .jw-icon .jw-svg-icon-buffer{-webkit-animation:jw-spin 2s linear infinite;animation:jw-spin 2s linear infinite;display:block}@-webkit-keyframes jw-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes jw-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.jwplayer.jw-state-buffering .jw-icon-playback .jw-svg-icon-play{display:none}.jwplayer.jw-state-buffering .jw-icon-display .jw-svg-icon-pause{display:none}.jwplayer.jw-state-playing .jw-display .jw-icon-display .jw-svg-icon-play,.jwplayer.jw-state-playing .jw-icon-playback .jw-svg-icon-play{display:none}.jwplayer.jw-state-playing .jw-display .jw-icon-display .jw-svg-icon-pause,.jwplayer.jw-state-playing .jw-icon-playback .jw-svg-icon-pause{display:block}.jwplayer.jw-state-playing.jw-flag-user-inactive:not(.jw-flag-audio-player):not(.jw-flag-casting):not(.jw-flag-media-audio) .jw-controls-backdrop{opacity:0}.jwplayer.jw-state-playing.jw-flag-user-inactive:not(.jw-flag-audio-player):not(.jw-flag-casting):not(.jw-flag-media-audio) .jw-logo-bottom-left,.jwplayer.jw-state-playing.jw-flag-user-inactive:not(.jw-flag-audio-player):not(.jw-flag-casting):not(.jw-flag-media-audio):not(.jw-flag-autostart) .jw-logo-bottom-right{bottom:0}.jwplayer .jw-icon-playback .jw-svg-icon-stop{display:none}.jwplayer.jw-state-paused .jw-svg-icon-pause,.jwplayer.jw-state-idle .jw-svg-icon-pause,.jwplayer.jw-state-error .jw-svg-icon-pause,.jwplayer.jw-state-complete .jw-svg-icon-pause{display:none}.jwplayer.jw-state-error .jw-icon-display .jw-svg-icon-play,.jwplayer.jw-state-complete .jw-icon-display .jw-svg-icon-play,.jwplayer.jw-state-buffering .jw-icon-display .jw-svg-icon-play{display:none}.jwplayer:not(.jw-state-buffering) .jw-svg-icon-buffer{display:none}.jwplayer:not(.jw-state-complete) .jw-svg-icon-replay{display:none}.jwplayer:not(.jw-state-error) .jw-svg-icon-error{display:none}.jwplayer.jw-state-complete .jw-display .jw-icon-display .jw-svg-icon-replay{display:block}.jwplayer.jw-state-complete .jw-display .jw-text{display:none}.jwplayer.jw-state-complete .jw-controls{background:rgba(0,0,0,0.4);height:100%}.jw-state-idle .jw-icon-display .jw-svg-icon-pause,.jwplayer.jw-state-paused .jw-icon-playback .jw-svg-icon-pause,.jwplayer.jw-state-paused .jw-icon-display .jw-svg-icon-pause,.jwplayer.jw-state-complete .jw-icon-playback .jw-svg-icon-pause{display:none}.jw-state-idle .jw-display-icon-rewind,.jwplayer.jw-state-buffering .jw-display-icon-rewind,.jwplayer.jw-state-complete .jw-display-icon-rewind,body .jw-error .jw-display-icon-rewind,body .jwplayer.jw-state-error .jw-display-icon-rewind,.jw-state-idle .jw-display-icon-next,.jwplayer.jw-state-buffering .jw-display-icon-next,.jwplayer.jw-state-complete .jw-display-icon-next,body .jw-error .jw-display-icon-next,body .jwplayer.jw-state-error .jw-display-icon-next{display:none}body .jw-error .jw-icon-display,body .jwplayer.jw-state-error .jw-icon-display{cursor:default}body .jw-error .jw-icon-display .jw-svg-icon-error,body .jwplayer.jw-state-error .jw-icon-display .jw-svg-icon-error{display:block}body .jw-error .jw-icon-container{position:absolute;width:100%;height:100%;top:0;left:0;bottom:0;right:0}body .jwplayer.jw-state-error.jw-flag-audio-player .jw-preview{display:none}body .jwplayer.jw-state-error.jw-flag-audio-player .jw-title{padding-top:4px}body .jwplayer.jw-state-error.jw-flag-audio-player .jw-title-primary{width:auto;display:inline-block;padding-right:.5ch}body .jwplayer.jw-state-error.jw-flag-audio-player .jw-title-secondary{width:auto;display:inline-block;padding-left:0}body .jwplayer.jw-state-error .jw-controlbar,.jwplayer.jw-state-idle:not(.jw-flag-audio-player):not(.jw-flag-cast-available):not(.jw-flag-cardboard-available) .jw-controlbar{display:none}body .jwplayer.jw-state-error .jw-settings-menu,.jwplayer.jw-state-idle:not(.jw-flag-audio-player):not(.jw-flag-cast-available):not(.jw-flag-cardboard-available) .jw-settings-menu{height:100%;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}body .jwplayer.jw-state-error .jw-display,.jwplayer.jw-state-idle:not(.jw-flag-audio-player):not(.jw-flag-cast-available):not(.jw-flag-cardboard-available) .jw-display{padding:0}body .jwplayer.jw-state-error .jw-logo-bottom-left,.jwplayer.jw-state-idle:not(.jw-flag-audio-player):not(.jw-flag-cast-available):not(.jw-flag-cardboard-available) .jw-logo-bottom-left,body .jwplayer.jw-state-error .jw-logo-bottom-right,.jwplayer.jw-state-idle:not(.jw-flag-audio-player):not(.jw-flag-cast-available):not(.jw-flag-cardboard-available) .jw-logo-bottom-right{bottom:0}.jwplayer.jw-state-playing.jw-flag-user-inactive .jw-display{visibility:hidden;pointer-events:none;opacity:0}.jwplayer.jw-state-playing:not(.jw-flag-touch):not(.jw-flag-small-player):not(.jw-flag-casting) .jw-display,.jwplayer.jw-state-paused:not(.jw-flag-touch):not(.jw-flag-small-player):not(.jw-flag-casting):not(.jw-flag-play-rejected) .jw-display{display:none}.jwplayer.jw-state-paused.jw-flag-play-rejected:not(.jw-flag-touch):not(.jw-flag-small-player):not(.jw-flag-casting) .jw-display-icon-rewind,.jwplayer.jw-state-paused.jw-flag-play-rejected:not(.jw-flag-touch):not(.jw-flag-small-player):not(.jw-flag-casting) .jw-display-icon-next{display:none}.jwplayer.jw-state-buffering .jw-display-icon-display .jw-text,.jwplayer.jw-state-complete .jw-display .jw-text{display:none}.jwplayer.jw-flag-casting:not(.jw-flag-audio-player) .jw-cast{display:block}.jwplayer.jw-flag-casting.jw-flag-airplay-casting .jw-display-icon-container{display:none}.jwplayer.jw-flag-casting .jw-icon-hd,.jwplayer.jw-flag-casting .jw-captions,.jwplayer.jw-flag-casting .jw-icon-fullscreen,.jwplayer.jw-flag-casting .jw-icon-audio-tracks{display:none}.jwplayer.jw-flag-casting.jw-flag-airplay-casting .jw-icon-volume{display:none}.jwplayer.jw-flag-casting.jw-flag-airplay-casting .jw-icon-airplay{color:#fff}.jw-state-playing.jw-flag-casting:not(.jw-flag-audio-player) .jw-display,.jw-state-paused.jw-flag-casting:not(.jw-flag-audio-player) .jw-display{display:flex}.jwplayer.jw-flag-cast-available .jw-icon-cast,.jwplayer.jw-flag-cast-available .jw-icon-airplay{display:flex}.jwplayer.jw-flag-cardboard-available .jw-icon-cardboard{display:flex}.jwplayer.jw-flag-live .jw-display-icon-rewind{visibility:hidden}.jwplayer.jw-flag-live .jw-controlbar .jw-text-elapsed,.jwplayer.jw-flag-live .jw-controlbar .jw-text-duration,.jwplayer.jw-flag-live .jw-controlbar .jw-text-countdown,.jwplayer.jw-flag-live .jw-controlbar .jw-slider-time{display:none}.jwplayer.jw-flag-live .jw-controlbar .jw-text-alt{display:flex}.jwplayer.jw-flag-live .jw-controlbar .jw-overlay:after{display:none}.jwplayer.jw-flag-live .jw-nextup-container{bottom:44px}.jwplayer.jw-flag-live .jw-text-elapsed,.jwplayer.jw-flag-live .jw-text-duration{display:none}.jwplayer.jw-flag-live .jw-text-live{cursor:default}.jwplayer.jw-flag-live .jw-text-live:hover{color:rgba(255,255,255,0.8)}.jwplayer.jw-flag-live.jw-state-playing .jw-icon-playback .jw-svg-icon-stop,.jwplayer.jw-flag-live.jw-state-buffering .jw-icon-playback .jw-svg-icon-stop{display:block}.jwplayer.jw-flag-live.jw-state-playing .jw-icon-playback .jw-svg-icon-pause,.jwplayer.jw-flag-live.jw-state-buffering .jw-icon-playback .jw-svg-icon-pause{display:none}.jw-text-live{height:24px;width:auto;align-items:center;border-radius:1px;color:rgba(255,255,255,0.8);display:flex;font-size:12px;font-weight:bold;margin-right:10px;padding:0 1ch;text-rendering:geometricPrecision;text-transform:uppercase;transition:150ms cubic-bezier(0, .25, .25, 1);transition-property:box-shadow,color}.jw-text-live::before{height:8px;width:8px;background-color:currentColor;border-radius:50%;margin-right:6px;opacity:1;transition:opacity 150ms cubic-bezier(0, .25, .25, 1)}.jw-text-live.jw-dvr-live{box-shadow:inset 0 0 0 2px currentColor}.jw-text-live.jw-dvr-live::before{opacity:.5}.jw-text-live.jw-dvr-live:hover{color:#fff}.jwplayer.jw-flag-controls-hidden .jw-logo.jw-hide{visibility:hidden;pointer-events:none;opacity:0}.jwplayer.jw-flag-controls-hidden:not(.jw-flag-casting) .jw-logo-top-right{top:0}.jwplayer.jw-flag-controls-hidden .jw-plugin{bottom:.5em}.jwplayer.jw-flag-controls-hidden:not(.jw-flag-touch.jw-breakpoint-4):not(.jw-flag-touch.jw-breakpoint-5):not(.jw-flag-touch.jw-breakpoint-6):not(.jw-flag-touch.jw-breakpoint-7) .jw-nextup-container{-webkit-transform:translateY(66px);transform:translateY(66px)}.jwplayer.jw-flag-controls-hidden.jw-flag-touch.jw-state-playing.jw-breakpoint-7 .jw-nextup-container,.jwplayer.jw-flag-controls-hidden.jw-flag-touch.jw-state-playing.jw-breakpoint-6 .jw-nextup-container,.jwplayer.jw-flag-controls-hidden.jw-flag-touch.jw-state-playing.jw-breakpoint-5 .jw-nextup-container,.jwplayer.jw-flag-controls-hidden.jw-flag-touch.jw-state-playing.jw-breakpoint-4 .jw-nextup-container{-webkit-transform:translateY(4.25em);transform:translateY(4.25em)}.jw-flag-controls-hidden .jw-controlbar,.jw-flag-controls-hidden .jw-display{visibility:hidden;pointer-events:none;opacity:0;transition-delay:0s, 250ms}.jw-flag-controls-hidden .jw-controls-backdrop{opacity:0}.jw-flag-controls-hidden .jw-logo{visibility:visible}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing .jw-logo.jw-hide{visibility:hidden;pointer-events:none;opacity:0}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing:not(.jw-flag-casting) .jw-logo-top-right{top:0}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing .jw-plugin{bottom:.5em}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing:not(.jw-flag-touch.jw-breakpoint-4):not(.jw-flag-touch.jw-breakpoint-5):not(.jw-flag-touch.jw-breakpoint-6):not(.jw-flag-touch.jw-breakpoint-7) .jw-nextup-container{-webkit-transform:translateY(66px);transform:translateY(66px)}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing.jw-flag-touch.jw-state-playing.jw-breakpoint-7 .jw-nextup-container,.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing.jw-flag-touch.jw-state-playing.jw-breakpoint-6 .jw-nextup-container,.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing.jw-flag-touch.jw-state-playing.jw-breakpoint-5 .jw-nextup-container,.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing.jw-flag-touch.jw-state-playing.jw-breakpoint-4 .jw-nextup-container{-webkit-transform:translateY(4.25em);transform:translateY(4.25em)}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing:not(.jw-flag-controls-hidden) .jw-media{cursor:none;-webkit-cursor-visibility:auto-hide}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing.jw-flag-casting .jw-display{display:flex}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-state-playing:not(.jw-flag-ads) .jw-autostart-mute{display:flex}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-flag-casting .jw-nextup-container{bottom:66px}.jwplayer.jw-flag-user-inactive:not(.jw-flag-media-audio).jw-flag-casting.jw-state-idle .jw-nextup-container{display:none}.jw-flag-media-audio .jw-preview{display:block}.jwplayer.jw-flag-ads .jw-preview,.jwplayer.jw-flag-ads .jw-logo,.jwplayer.jw-flag-ads .jw-captions.jw-captions-enabled,.jwplayer.jw-flag-ads .jw-nextup-container,.jwplayer.jw-flag-ads .jw-text-duration,.jwplayer.jw-flag-ads .jw-text-elapsed{display:none}.jwplayer.jw-flag-ads video::-webkit-media-text-track-container{display:none}.jwplayer.jw-flag-ads.jw-flag-small-player .jw-display-icon-rewind,.jwplayer.jw-flag-ads.jw-flag-small-player .jw-display-icon-next,.jwplayer.jw-flag-ads.jw-flag-small-player .jw-display-icon-display{display:none}.jwplayer.jw-flag-ads.jw-flag-small-player.jw-state-buffering .jw-display-icon-display{display:inline-block}.jwplayer.jw-flag-ads .jw-controlbar{flex-direction:column-reverse}.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-time{height:auto;padding:0;pointer-events:none}.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-time .jw-slider-container{height:5px}.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-time .jw-rail,.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-time .jw-knob,.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-time .jw-buffer,.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-time .jw-cue,.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-time .jw-icon-settings{display:none}.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-time .jw-progress{-webkit-transform:none;transform:none;top:auto}.jwplayer.jw-flag-ads .jw-controlbar .jw-tooltip,.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-tooltip:not(.jw-icon-volume),.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-inline:not(.jw-icon-playback):not(.jw-icon-fullscreen):not(.jw-icon-volume){display:none}.jwplayer.jw-flag-ads .jw-controlbar .jw-volume-tip{padding:13px 0}.jwplayer.jw-flag-ads .jw-controlbar .jw-text-alt{display:flex}.jwplayer.jw-flag-ads .jw-fullscreen-ima{display:none}.jwplayer.jw-flag-ads.jw-flag-ads.jw-state-playing.jw-flag-touch:not(.jw-flag-ads-vpaid) .jw-controls .jw-controlbar,.jwplayer.jw-flag-ads.jw-flag-ads.jw-state-playing.jw-flag-touch:not(.jw-flag-ads-vpaid).jw-flag-autostart .jw-controls .jw-controlbar{display:flex;pointer-events:all;visibility:visible;opacity:1}.jwplayer.jw-flag-ads.jw-flag-ads.jw-state-playing.jw-flag-touch:not(.jw-flag-ads-vpaid).jw-flag-user-inactive .jw-controls-backdrop,.jwplayer.jw-flag-ads.jw-flag-ads.jw-state-playing.jw-flag-touch:not(.jw-flag-ads-vpaid).jw-flag-autostart.jw-flag-user-inactive .jw-controls-backdrop{opacity:1;background-size:100% 60px}.jwplayer.jw-flag-ads-vpaid .jw-display-container,.jwplayer.jw-flag-touch.jw-flag-ads-vpaid .jw-display-container,.jwplayer.jw-flag-ads-vpaid .jw-skip,.jwplayer.jw-flag-touch.jw-flag-ads-vpaid .jw-skip{display:none}.jwplayer.jw-flag-ads-vpaid.jw-flag-small-player .jw-controls{background:none}.jwplayer.jw-flag-ads-vpaid.jw-flag-small-player .jw-controls::after{content:none}.jwplayer.jw-flag-ads-hide-controls .jw-controls-backdrop,.jwplayer.jw-flag-ads-hide-controls .jw-controls{display:none !important}.jw-flag-overlay-open-related .jw-controls,.jw-flag-overlay-open-related .jw-title,.jw-flag-overlay-open-related .jw-logo{display:none}.jwplayer.jw-flag-rightclick-open{overflow:visible}.jwplayer.jw-flag-rightclick-open .jw-rightclick{z-index:16777215}.jw-flag-touch.jw-breakpoint-7 .jw-captions,.jw-flag-touch.jw-breakpoint-6 .jw-captions,.jw-flag-touch.jw-breakpoint-5 .jw-captions,.jw-flag-touch.jw-breakpoint-4 .jw-captions,.jw-flag-touch.jw-breakpoint-7 .jw-nextup-container,.jw-flag-touch.jw-breakpoint-6 .jw-nextup-container,.jw-flag-touch.jw-breakpoint-5 .jw-nextup-container,.jw-flag-touch.jw-breakpoint-4 .jw-nextup-container{bottom:4.25em}.jw-flag-touch .jw-controlbar .jw-icon-volume{display:flex}.jw-flag-touch .jw-display,.jw-flag-touch .jw-display-container,.jw-flag-touch .jw-display-controls{pointer-events:none}.jw-flag-touch.jw-state-paused:not(.jw-breakpoint-1) .jw-display-icon-next,.jw-flag-touch.jw-state-playing:not(.jw-breakpoint-1) .jw-display-icon-next,.jw-flag-touch.jw-state-paused:not(.jw-breakpoint-1) .jw-display-icon-rewind,.jw-flag-touch.jw-state-playing:not(.jw-breakpoint-1) .jw-display-icon-rewind{display:none}.jw-flag-touch.jw-state-paused.jw-flag-dragging .jw-display{display:none}.jw-flag-audio-player{background-color:#000}.jw-flag-audio-player .jw-media{visibility:hidden}.jw-flag-audio-player .jw-title{background:none}.jw-flag-audio-player:not(.jw-flag-live) .jw-spacer{display:none}.jw-flag-audio-player .jw-preview,.jw-flag-audio-player .jw-display,.jw-flag-audio-player .jw-title,.jw-flag-audio-player .jw-nextup-container{display:none}.jw-flag-audio-player .jw-controlbar{position:relative}.jw-flag-audio-player .jw-controlbar .jw-button-container{padding-right:3px;padding-left:0;justify-content:flex-start}.jw-flag-audio-player .jw-controlbar .jw-icon-tooltip,.jw-flag-audio-player .jw-controlbar .jw-icon-inline{display:none}.jw-flag-audio-player .jw-controlbar .jw-icon-volume,.jw-flag-audio-player .jw-controlbar .jw-icon-playback,.jw-flag-audio-player .jw-controlbar .jw-icon-next,.jw-flag-audio-player .jw-controlbar .jw-icon-rewind,.jw-flag-audio-player .jw-controlbar .jw-icon-cast,.jw-flag-audio-player .jw-controlbar .jw-text-live,.jw-flag-audio-player .jw-controlbar .jw-icon-airplay,.jw-flag-audio-player .jw-controlbar .jw-logo-button,.jw-flag-audio-player .jw-controlbar .jw-text-elapsed,.jw-flag-audio-player .jw-controlbar .jw-text-duration{display:flex;flex:0 0 auto}.jw-flag-audio-player .jw-controlbar .jw-text-duration,.jw-flag-audio-player .jw-controlbar .jw-text-countdown{padding-right:10px}.jw-flag-audio-player .jw-controlbar .jw-slider-time{flex:0 1 auto;align-items:center;display:flex;order:1}.jw-flag-audio-player .jw-controlbar .jw-icon-volume{margin-right:0;transition:margin-right 150ms cubic-bezier(0, .25, .25, 1)}.jw-flag-audio-player .jw-controlbar .jw-icon-volume .jw-overlay{display:none}.jw-flag-audio-player .jw-controlbar .jw-horizontal-volume-container~.jw-slider-time{transition:opacity 300ms,width 300ms}.jw-flag-audio-player .jw-controlbar .jw-horizontal-volume-container.jw-open~.jw-slider-time{flex:1 1 auto;width:auto}.jw-flag-audio-player .jw-controlbar .jw-slider-volume~.jw-icon-volume{margin-right:140px}.jw-flag-audio-player.jw-breakpoint-1 .jw-horizontal-volume-container.jw-open~.jw-slider-time,.jw-flag-audio-player.jw-breakpoint-2 .jw-horizontal-volume-container.jw-open~.jw-slider-time{opacity:0}.jw-flag-audio-player.jw-flag-small-player .jw-text-elapsed,.jw-flag-audio-player.jw-flag-small-player .jw-text-duration{display:none}.jw-flag-audio-player.jw-flag-ads .jw-slider-time{display:none}.jw-hidden{display:none}", ""]);



/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js!./node_modules/less-loader/dist/cjs.js?!./src/css/jwplayer.less":
/*!******************************************************************************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js??ref--4-1!./node_modules/postcss-loader/src!./node_modules/less-loader/dist/cjs.js??ref--4-3!./src/css/jwplayer.less ***!
  \******************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(/*! ../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js")(false);
// Module
exports.push([module.i, ".jw-reset{text-align:left;direction:ltr}.jw-reset-text,.jw-reset{color:inherit;background-color:transparent;padding:0;margin:0;float:none;font-family:Arial,Helvetica,sans-serif;font-size:1em;line-height:1em;list-style:none;text-transform:none;vertical-align:baseline;border:0;font-variant:inherit;font-stretch:inherit;-webkit-tap-highlight-color:rgba(255,255,255,0)}body .jw-error,body .jwplayer.jw-state-error{height:100%;width:100%}.jw-title{position:absolute;top:0}.jw-background-color{background:rgba(0,0,0,0.4)}.jw-text{color:rgba(255,255,255,0.8)}.jw-knob{color:rgba(255,255,255,0.8);background-color:#fff}.jw-button-color{color:rgba(255,255,255,0.8)}:not(.jw-flag-touch) .jw-button-color:not(.jw-logo-button):focus,:not(.jw-flag-touch) .jw-button-color:not(.jw-logo-button):hover{color:#fff}.jw-toggle{color:#fff}.jw-toggle.jw-off{color:rgba(255,255,255,0.8)}.jw-toggle.jw-off:focus{color:#fff}.jw-toggle:focus{outline:none}:not(.jw-flag-touch) .jw-toggle.jw-off:hover{color:#fff}.jw-rail{background:rgba(255,255,255,0.3)}.jw-buffer{background:rgba(255,255,255,0.3)}.jw-progress{background:#f2f2f2}.jw-time-tip,.jw-volume-tip{border:0}.jw-slider-volume.jw-volume-tip.jw-background-color.jw-slider-vertical{background:none}.jw-skip{padding:.5em;outline:none}.jw-skip .jw-skiptext,.jw-skip .jw-skip-icon{color:rgba(255,255,255,0.8)}.jw-skip.jw-skippable:hover .jw-skip-icon,.jw-skip.jw-skippable:focus .jw-skip-icon{color:#fff}.jw-icon-cast google-cast-launcher{--connected-color:#fff;--disconnected-color:rgba(255,255,255,0.8)}.jw-icon-cast google-cast-launcher:focus{outline:none}.jw-icon-cast google-cast-launcher.jw-off{--connected-color:rgba(255,255,255,0.8)}.jw-icon-cast:focus google-cast-launcher{--connected-color:#fff;--disconnected-color:#fff}.jw-icon-cast:hover google-cast-launcher{--connected-color:#fff;--disconnected-color:#fff}.jw-nextup-container{bottom:2.5em;padding:5px .5em}.jw-nextup{border-radius:0}.jw-color-active{color:#fff;stroke:#fff;border-color:#fff}:not(.jw-flag-touch) .jw-color-active-hover:hover,:not(.jw-flag-touch) .jw-color-active-hover:focus{color:#fff;stroke:#fff;border-color:#fff}.jw-color-inactive{color:rgba(255,255,255,0.8);stroke:rgba(255,255,255,0.8);border-color:rgba(255,255,255,0.8)}:not(.jw-flag-touch) .jw-color-inactive-hover:hover{color:rgba(255,255,255,0.8);stroke:rgba(255,255,255,0.8);border-color:rgba(255,255,255,0.8)}.jw-option{color:rgba(255,255,255,0.8)}.jw-option.jw-active-option{color:#fff;background-color:rgba(255,255,255,0.1)}:not(.jw-flag-touch) .jw-option:hover{color:#fff}.jwplayer{width:100%;font-size:16px;position:relative;display:block;min-height:0;overflow:hidden;box-sizing:border-box;font-family:Arial,Helvetica,sans-serif;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:none}.jwplayer *{box-sizing:inherit}.jwplayer.jw-tab-focus:focus{outline:solid 2px #4d90fe}.jwplayer.jw-flag-aspect-mode{height:auto !important}.jwplayer.jw-flag-aspect-mode .jw-aspect{display:block}.jwplayer .jw-aspect{display:none}.jw-media,.jw-preview{position:absolute;width:100%;height:100%;top:0;left:0;bottom:0;right:0}.jw-media{overflow:hidden;cursor:pointer}.jw-plugin{position:absolute;bottom:66px}.jw-breakpoint-7 .jw-plugin{bottom:132px}.jw-plugin .jw-banner{max-width:100%;opacity:0;cursor:pointer;position:absolute;margin:auto auto 0;left:0;right:0;bottom:0;display:block}.jw-preview,.jw-captions,.jw-title{pointer-events:none}.jw-media,.jw-logo{pointer-events:all}.jw-wrapper{background-color:#000;position:absolute;top:0;left:0;right:0;bottom:0}.jw-hidden-accessibility{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.jw-contract-trigger::before{content:\"\";overflow:hidden;width:200%;height:200%;display:block;position:absolute;top:0;left:0}.jwplayer .jw-media video{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;margin:auto;background:transparent;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-focus-ring-color:rgba(0,0,0,0);outline:none}.jwplayer .jw-media video::-webkit-media-controls-start-playback-button{display:none}.jwplayer.jw-stretch-uniform .jw-media video{object-fit:contain}.jwplayer.jw-stretch-none .jw-media video{object-fit:none}.jwplayer.jw-stretch-fill .jw-media video{object-fit:cover}.jwplayer.jw-stretch-exactfit .jw-media video{object-fit:fill}.jw-preview{position:absolute;display:none;opacity:1;visibility:visible;width:100%;height:100%;background:#000 no-repeat 50% 50%}.jwplayer .jw-preview,.jw-error .jw-preview{background-size:contain}.jw-stretch-none .jw-preview{background-size:auto auto}.jw-stretch-fill .jw-preview{background-size:cover}.jw-stretch-exactfit .jw-preview{background-size:100% 100%}.jw-title{display:none;padding-top:20px;width:100%;z-index:1}.jw-title-primary,.jw-title-secondary{color:#fff;padding-left:20px;padding-right:20px;padding-bottom:.5em;overflow:hidden;text-overflow:ellipsis;direction:unset;white-space:nowrap;width:100%}.jw-title-primary{font-size:1.625em}.jw-breakpoint-2 .jw-title-primary,.jw-breakpoint-3 .jw-title-primary{font-size:1.5em}.jw-flag-small-player .jw-title-primary{font-size:1.25em}.jw-breakpoint-0 .jw-ab-truncated .jw-title-primary,.jw-breakpoint-1 .jw-ab-truncated .jw-title-primary,.jw-breakpoint-2 .jw-ab-truncated .jw-title-primary{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;padding-bottom:0;margin-bottom:.5em;white-space:pre-wrap;line-height:1.2}.jw-breakpoint-1 .jw-ab-truncated .jw-title-primary{font-size:1.25em}.jw-breakpoint-0 .jw-ab-truncated .jw-title-primary{font-size:1em}.jw-flag-small-player .jw-title-secondary,.jw-breakpoint-0 .jw-ab-truncated .jw-title-secondary,.jw-breakpoint-1 .jw-ab-truncated .jw-title-secondary,.jw-breakpoint-2 .jw-ab-truncated .jw-title-secondary,.jw-title-secondary:empty{display:none}.jw-captions{position:absolute;width:100%;height:100%;text-align:center;display:none;letter-spacing:normal;word-spacing:normal;text-transform:none;text-indent:0;text-decoration:none;pointer-events:none;overflow:hidden;top:0}.jw-captions.jw-captions-enabled{display:block}.jw-captions-window{display:none;padding:.25em;border-radius:.25em}.jw-captions-window.jw-captions-window-active{display:inline-block}.jw-captions-text{display:inline-block;color:#fff;background-color:#000;word-wrap:normal;word-break:normal;white-space:pre-line;font-style:normal;font-weight:normal;text-align:center;text-decoration:none}.jw-text-track-display{font-size:inherit;line-height:1.5}.jw-text-track-cue{background-color:rgba(0,0,0,0.5);color:#fff;padding:.1em .3em}.jwplayer video::-webkit-media-controls{display:none;justify-content:flex-start}.jwplayer video::-webkit-media-text-track-display{min-width:-webkit-min-content}.jwplayer video::cue{background-color:rgba(0,0,0,0.5)}.jwplayer video::-webkit-media-controls-panel-container{display:none}.jwplayer:not(.jw-flag-controls-hidden):not(.jw-state-playing) .jw-captions,.jwplayer.jw-flag-media-audio.jw-state-playing .jw-captions,.jwplayer.jw-state-playing:not(.jw-flag-user-inactive):not(.jw-flag-controls-hidden) .jw-captions{max-height:calc(100% - 60px)}.jwplayer:not(.jw-flag-controls-hidden):not(.jw-state-playing):not(.jw-flag-ios-fullscreen) video::-webkit-media-text-track-container,.jwplayer.jw-flag-media-audio.jw-state-playing:not(.jw-flag-ios-fullscreen) video::-webkit-media-text-track-container,.jwplayer.jw-state-playing:not(.jw-flag-user-inactive):not(.jw-flag-controls-hidden):not(.jw-flag-ios-fullscreen) video::-webkit-media-text-track-container{max-height:calc(100% - 60px)}.jw-logo{position:absolute;margin:20px;cursor:pointer;pointer-events:all;background-repeat:no-repeat;background-size:contain;top:auto;right:auto;left:auto;bottom:auto;outline:none}.jw-logo.jw-tab-focus:focus{outline:solid 2px #4d90fe}.jw-flag-audio-player .jw-logo{display:none}.jw-logo-top-right{top:0;right:0}.jw-logo-top-left{top:0;left:0}.jw-logo-bottom-left{left:0}.jw-logo-bottom-right{right:0}.jw-logo-bottom-left,.jw-logo-bottom-right{bottom:44px;transition:bottom 150ms cubic-bezier(0, .25, .25, 1)}.jw-state-idle .jw-logo{z-index:1}.jw-state-setup .jw-wrapper{background-color:inherit}.jw-state-setup .jw-logo,.jw-state-setup .jw-controls,.jw-state-setup .jw-controls-backdrop{visibility:hidden}span.jw-break{display:block}body .jw-error,body .jwplayer.jw-state-error{background-color:#333;color:#fff;font-size:16px;display:table;opacity:1;position:relative}body .jw-error .jw-display,body .jwplayer.jw-state-error .jw-display{display:none}body .jw-error .jw-media,body .jwplayer.jw-state-error .jw-media{cursor:default}body .jw-error .jw-preview,body .jwplayer.jw-state-error .jw-preview{background-color:#333}body .jw-error .jw-error-msg,body .jwplayer.jw-state-error .jw-error-msg{background-color:#000;border-radius:2px;display:flex;flex-direction:row;align-items:stretch;padding:20px}body .jw-error .jw-error-msg .jw-icon,body .jwplayer.jw-state-error .jw-error-msg .jw-icon{height:30px;width:30px;margin-right:20px;flex:0 0 auto;align-self:center}body .jw-error .jw-error-msg .jw-icon:empty,body .jwplayer.jw-state-error .jw-error-msg .jw-icon:empty{display:none}body .jw-error .jw-error-msg .jw-info-container,body .jwplayer.jw-state-error .jw-error-msg .jw-info-container{margin:0;padding:0}body .jw-error:not(.jw-flag-audio-player).jw-flag-small-player .jw-error-msg,body .jwplayer.jw-state-error:not(.jw-flag-audio-player).jw-flag-small-player .jw-error-msg,body .jw-error:not(.jw-flag-audio-player).jw-breakpoint-2 .jw-error-msg,body .jwplayer.jw-state-error:not(.jw-flag-audio-player).jw-breakpoint-2 .jw-error-msg{flex-direction:column}body .jw-error:not(.jw-flag-audio-player).jw-flag-small-player .jw-error-msg .jw-error-text,body .jwplayer.jw-state-error:not(.jw-flag-audio-player).jw-flag-small-player .jw-error-msg .jw-error-text,body .jw-error:not(.jw-flag-audio-player).jw-breakpoint-2 .jw-error-msg .jw-error-text,body .jwplayer.jw-state-error:not(.jw-flag-audio-player).jw-breakpoint-2 .jw-error-msg .jw-error-text{text-align:center}body .jw-error:not(.jw-flag-audio-player).jw-flag-small-player .jw-error-msg .jw-icon,body .jwplayer.jw-state-error:not(.jw-flag-audio-player).jw-flag-small-player .jw-error-msg .jw-icon,body .jw-error:not(.jw-flag-audio-player).jw-breakpoint-2 .jw-error-msg .jw-icon,body .jwplayer.jw-state-error:not(.jw-flag-audio-player).jw-breakpoint-2 .jw-error-msg .jw-icon{flex:.5 0 auto;margin-right:0;margin-bottom:20px}.jwplayer.jw-state-error.jw-flag-audio-player .jw-error-msg .jw-break,.jwplayer.jw-state-error.jw-flag-small-player .jw-error-msg .jw-break,.jwplayer.jw-state-error.jw-breakpoint-2 .jw-error-msg .jw-break{display:inline}.jwplayer.jw-state-error.jw-flag-audio-player .jw-error-msg .jw-break:before,.jwplayer.jw-state-error.jw-flag-small-player .jw-error-msg .jw-break:before,.jwplayer.jw-state-error.jw-breakpoint-2 .jw-error-msg .jw-break:before{content:\" \"}.jwplayer.jw-state-error.jw-flag-audio-player .jw-error-msg{height:100%;width:100%;top:0;position:absolute;left:0;background:#000;-webkit-transform:none;transform:none;padding:4px 16px;z-index:1}.jwplayer.jw-state-error.jw-flag-audio-player .jw-error-msg.jw-info-overlay{max-width:none;max-height:none}body .jwplayer.jw-state-error .jw-title,.jw-state-idle .jw-title,.jwplayer.jw-state-complete:not(.jw-flag-casting):not(.jw-flag-audio-player):not(.jw-flag-overlay-open-related) .jw-title{display:block}body .jwplayer.jw-state-error .jw-preview,.jw-state-idle .jw-preview,.jwplayer.jw-state-complete:not(.jw-flag-casting):not(.jw-flag-audio-player):not(.jw-flag-overlay-open-related) .jw-preview{display:block}.jw-state-idle .jw-captions,.jwplayer.jw-state-complete .jw-captions,body .jwplayer.jw-state-error .jw-captions{display:none}.jw-state-idle video::-webkit-media-text-track-container,.jwplayer.jw-state-complete video::-webkit-media-text-track-container,body .jwplayer.jw-state-error video::-webkit-media-text-track-container{display:none}.jwplayer.jw-flag-fullscreen{width:100% !important;height:100% !important;top:0;right:0;bottom:0;left:0;z-index:1000;margin:0;position:fixed}.jwplayer.jw-flag-controls-hidden .jw-media{cursor:default}.jw-flag-audio-player .jw-media{visibility:hidden}.jw-flag-audio-player .jw-title{background:none}.jw-flag-floating{background-size:cover;background-color:#000}.jw-flag-floating .jw-wrapper{position:fixed;z-index:2147483647;top:auto;bottom:1rem;left:auto;right:1rem;max-width:400px;max-height:400px;margin:0 auto}@media screen and (min-width:481px){.jw-flag-floating .jw-wrapper:not(.jw-floating-dragged){-webkit-animation:jw-float-to-bottom 150ms cubic-bezier(0, .25, .25, 1) forwards 1;animation:jw-float-to-bottom 150ms cubic-bezier(0, .25, .25, 1) forwards 1}}@media screen and (max-width:480px){.jw-flag-floating .jw-wrapper{width:100%;left:0;right:0}}.jw-flag-floating .jw-wrapper.jw-floating-dragging{transition:none!important}.jw-flag-floating .jw-wrapper .jw-media{touch-action:none}@media screen and (max-device-width:480px) and (orientation:portrait){.jw-flag-touch.jw-flag-floating .jw-wrapper{-webkit-animation:none;animation:none;top:0;margin-top:62px;bottom:auto;max-width:none;max-height:none}}.jw-flag-floating .jw-float-icon{pointer-events:all;cursor:pointer;display:none}.jw-flag-floating .jw-float-icon .jw-svg-icon{-webkit-filter:drop-shadow(0 0 1px #000);filter:drop-shadow(0 0 1px #000)}.jw-flag-floating.jw-floating-dismissible .jw-dismiss-icon{display:none}.jw-flag-floating.jw-floating-dismissible.jw-flag-ads .jw-float-icon{display:flex}.jw-flag-floating.jw-floating-dismissible.jw-state-paused .jw-logo,.jw-flag-floating.jw-floating-dismissible:not(.jw-flag-user-inactive) .jw-logo{display:none}.jw-flag-floating.jw-floating-dismissible.jw-state-paused .jw-float-icon,.jw-flag-floating.jw-floating-dismissible:not(.jw-flag-user-inactive) .jw-float-icon{display:flex}.jw-float-icon{display:none;position:absolute;top:3px;right:5px;align-items:center;justify-content:center}@-webkit-keyframes jw-float-to-bottom{from{-webkit-transform:translateY(100%);transform:translateY(100%)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes jw-float-to-bottom{from{-webkit-transform:translateY(100%);transform:translateY(100%)}to{-webkit-transform:translateY(0);transform:translateY(0)}}.jw-flag-top{margin-top:2em;overflow:visible}.jw-top{height:2em;line-height:2;pointer-events:none;text-align:center;opacity:.8;position:absolute;top:-2em;width:100%}.jw-top .jw-icon{cursor:pointer;pointer-events:all;height:auto;width:auto}.jw-top .jw-text{color:#555}", ""]);



/***/ }),

/***/ "./node_modules/css-loader/dist/runtime/api.js":
/*!*****************************************************!*\
  !*** ./node_modules/css-loader/dist/runtime/api.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
module.exports = function (useSourceMap) {
  var list = []; // return the list of modules as css string

  list.toString = function toString() {
    return this.map(function (item) {
      var content = cssWithMappingToString(item, useSourceMap);

      if (item[2]) {
        return '@media ' + item[2] + '{' + content + '}';
      } else {
        return content;
      }
    }).join('');
  }; // import a list of modules into the list


  list.i = function (modules, mediaQuery) {
    if (typeof modules === 'string') {
      modules = [[null, modules, '']];
    }

    var alreadyImportedModules = {};

    for (var i = 0; i < this.length; i++) {
      var id = this[i][0];

      if (id != null) {
        alreadyImportedModules[id] = true;
      }
    }

    for (i = 0; i < modules.length; i++) {
      var item = modules[i]; // skip already imported module
      // this implementation is not 100% perfect for weird media query combinations
      // when a module is imported multiple times with different media queries.
      // I hope this will never occur (Hey this way we have smaller bundles)

      if (item[0] == null || !alreadyImportedModules[item[0]]) {
        if (mediaQuery && !item[2]) {
          item[2] = mediaQuery;
        } else if (mediaQuery) {
          item[2] = '(' + item[2] + ') and (' + mediaQuery + ')';
        }

        list.push(item);
      }
    }
  };

  return list;
};

function cssWithMappingToString(item, useSourceMap) {
  var content = item[1] || '';
  var cssMapping = item[3];

  if (!cssMapping) {
    return content;
  }

  if (useSourceMap && typeof btoa === 'function') {
    var sourceMapping = toComment(cssMapping);
    var sourceURLs = cssMapping.sources.map(function (source) {
      return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */';
    });
    return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
  }

  return [content].join('\n');
} // Adapted from convert-source-map (MIT)


function toComment(sourceMap) {
  // eslint-disable-next-line no-undef
  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;
  return '/*# ' + data + ' */';
}

/***/ }),

/***/ "./node_modules/focus-options-polyfill/index.js":
/*!******************************************************!*\
  !*** ./node_modules/focus-options-polyfill/index.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// focus - focusOptions - preventScroll polyfill
(function() {
  if (
    typeof window === "undefined" ||
    typeof document === "undefined" ||
    typeof HTMLElement === "undefined"
  ) {
    return;
  }

  var supportsPreventScrollOption = false;
  try {
    var focusElem = document.createElement("div");
    focusElem.addEventListener(
      "focus",
      function(event) {
        event.preventDefault();
        event.stopPropagation();
      },
      true
    );
    focusElem.focus(
      Object.defineProperty({}, "preventScroll", {
        get: function() {
          supportsPreventScrollOption = true;
        }
      })
    );
  } catch (e) {}

  if (
    HTMLElement.prototype.nativeFocus === undefined &&
    !supportsPreventScrollOption
  ) {
    HTMLElement.prototype.nativeFocus = HTMLElement.prototype.focus;

    var calcScrollableElements = function(element) {
      var parent = element.parentNode;
      var scrollableElements = [];
      var rootScrollingElement =
        document.scrollingElement || document.documentElement;

      while (parent && parent !== rootScrollingElement) {
        if (
          parent.offsetHeight < parent.scrollHeight ||
          parent.offsetWidth < parent.scrollWidth
        ) {
          scrollableElements.push([
            parent,
            parent.scrollTop,
            parent.scrollLeft
          ]);
        }
        parent = parent.parentNode;
      }
      parent = rootScrollingElement;
      scrollableElements.push([parent, parent.scrollTop, parent.scrollLeft]);

      return scrollableElements;
    };

    var restoreScrollPosition = function(scrollableElements) {
      for (var i = 0; i < scrollableElements.length; i++) {
        scrollableElements[i][0].scrollTop = scrollableElements[i][1];
        scrollableElements[i][0].scrollLeft = scrollableElements[i][2];
      }
      scrollableElements = [];
    };

    var patchedFocus = function(args) {
      if (args && args.preventScroll) {
        var evScrollableElements = calcScrollableElements(this);
        this.nativeFocus();
        if (typeof setTimeout === 'function') {
          setTimeout(function () {
            restoreScrollPosition(evScrollableElements);
          }, 0);
        } else {
          restoreScrollPosition(evScrollableElements);          
        }
      }
      else {
        this.nativeFocus();
      }
    };

    HTMLElement.prototype.focus = patchedFocus;
  }
})();


/***/ }),

/***/ "./node_modules/intersection-observer/intersection-observer.js":
/*!*********************************************************************!*\
  !*** ./node_modules/intersection-observer/intersection-observer.js ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * Copyright 2016 Google Inc. All Rights Reserved.
 *
 * Licensed under the W3C SOFTWARE AND DOCUMENT NOTICE AND LICENSE.
 *
 *  https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document
 *
 */

(function(window, document) {
'use strict';


// Exits early if all IntersectionObserver and IntersectionObserverEntry
// features are natively supported.
if ('IntersectionObserver' in window &&
    'IntersectionObserverEntry' in window &&
    'intersectionRatio' in window.IntersectionObserverEntry.prototype) {

  // Minimal polyfill for Edge 15's lack of `isIntersecting`
  // See: https://github.com/w3c/IntersectionObserver/issues/211
  if (!('isIntersecting' in window.IntersectionObserverEntry.prototype)) {
    Object.defineProperty(window.IntersectionObserverEntry.prototype,
      'isIntersecting', {
      get: function () {
        return this.intersectionRatio > 0;
      }
    });
  }
  return;
}


/**
 * An IntersectionObserver registry. This registry exists to hold a strong
 * reference to IntersectionObserver instances currently observering a target
 * element. Without this registry, instances without another reference may be
 * garbage collected.
 */
var registry = [];


/**
 * Creates the global IntersectionObserverEntry constructor.
 * https://w3c.github.io/IntersectionObserver/#intersection-observer-entry
 * @param {Object} entry A dictionary of instance properties.
 * @constructor
 */
function IntersectionObserverEntry(entry) {
  this.time = entry.time;
  this.target = entry.target;
  this.rootBounds = entry.rootBounds;
  this.boundingClientRect = entry.boundingClientRect;
  this.intersectionRect = entry.intersectionRect || getEmptyRect();
  this.isIntersecting = !!entry.intersectionRect;

  // Calculates the intersection ratio.
  var targetRect = this.boundingClientRect;
  var targetArea = targetRect.width * targetRect.height;
  var intersectionRect = this.intersectionRect;
  var intersectionArea = intersectionRect.width * intersectionRect.height;

  // Sets intersection ratio.
  if (targetArea) {
    this.intersectionRatio = intersectionArea / targetArea;
  } else {
    // If area is zero and is intersecting, sets to 1, otherwise to 0
    this.intersectionRatio = this.isIntersecting ? 1 : 0;
  }
}


/**
 * Creates the global IntersectionObserver constructor.
 * https://w3c.github.io/IntersectionObserver/#intersection-observer-interface
 * @param {Function} callback The function to be invoked after intersection
 *     changes have queued. The function is not invoked if the queue has
 *     been emptied by calling the `takeRecords` method.
 * @param {Object=} opt_options Optional configuration options.
 * @constructor
 */
function IntersectionObserver(callback, opt_options) {

  var options = opt_options || {};

  if (typeof callback != 'function') {
    throw new Error('callback must be a function');
  }

  if (options.root && options.root.nodeType != 1) {
    throw new Error('root must be an Element');
  }

  // Binds and throttles `this._checkForIntersections`.
  this._checkForIntersections = throttle(
      this._checkForIntersections.bind(this), this.THROTTLE_TIMEOUT);

  // Private properties.
  this._callback = callback;
  this._observationTargets = [];
  this._queuedEntries = [];
  this._rootMarginValues = this._parseRootMargin(options.rootMargin);

  // Public properties.
  this.thresholds = this._initThresholds(options.threshold);
  this.root = options.root || null;
  this.rootMargin = this._rootMarginValues.map(function(margin) {
    return margin.value + margin.unit;
  }).join(' ');
}


/**
 * The minimum interval within which the document will be checked for
 * intersection changes.
 */
IntersectionObserver.prototype.THROTTLE_TIMEOUT = 100;


/**
 * The frequency in which the polyfill polls for intersection changes.
 * this can be updated on a per instance basis and must be set prior to
 * calling `observe` on the first target.
 */
IntersectionObserver.prototype.POLL_INTERVAL = null;

/**
 * Use a mutation observer on the root element
 * to detect intersection changes.
 */
IntersectionObserver.prototype.USE_MUTATION_OBSERVER = true;


/**
 * Starts observing a target element for intersection changes based on
 * the thresholds values.
 * @param {Element} target The DOM element to observe.
 */
IntersectionObserver.prototype.observe = function(target) {
  var isTargetAlreadyObserved = this._observationTargets.some(function(item) {
    return item.element == target;
  });

  if (isTargetAlreadyObserved) {
    return;
  }

  if (!(target && target.nodeType == 1)) {
    throw new Error('target must be an Element');
  }

  this._registerInstance();
  this._observationTargets.push({element: target, entry: null});
  this._monitorIntersections();
  this._checkForIntersections();
};


/**
 * Stops observing a target element for intersection changes.
 * @param {Element} target The DOM element to observe.
 */
IntersectionObserver.prototype.unobserve = function(target) {
  this._observationTargets =
      this._observationTargets.filter(function(item) {

    return item.element != target;
  });
  if (!this._observationTargets.length) {
    this._unmonitorIntersections();
    this._unregisterInstance();
  }
};


/**
 * Stops observing all target elements for intersection changes.
 */
IntersectionObserver.prototype.disconnect = function() {
  this._observationTargets = [];
  this._unmonitorIntersections();
  this._unregisterInstance();
};


/**
 * Returns any queue entries that have not yet been reported to the
 * callback and clears the queue. This can be used in conjunction with the
 * callback to obtain the absolute most up-to-date intersection information.
 * @return {Array} The currently queued entries.
 */
IntersectionObserver.prototype.takeRecords = function() {
  var records = this._queuedEntries.slice();
  this._queuedEntries = [];
  return records;
};


/**
 * Accepts the threshold value from the user configuration object and
 * returns a sorted array of unique threshold values. If a value is not
 * between 0 and 1 and error is thrown.
 * @private
 * @param {Array|number=} opt_threshold An optional threshold value or
 *     a list of threshold values, defaulting to [0].
 * @return {Array} A sorted list of unique and valid threshold values.
 */
IntersectionObserver.prototype._initThresholds = function(opt_threshold) {
  var threshold = opt_threshold || [0];
  if (!Array.isArray(threshold)) threshold = [threshold];

  return threshold.sort().filter(function(t, i, a) {
    if (typeof t != 'number' || isNaN(t) || t < 0 || t > 1) {
      throw new Error('threshold must be a number between 0 and 1 inclusively');
    }
    return t !== a[i - 1];
  });
};


/**
 * Accepts the rootMargin value from the user configuration object
 * and returns an array of the four margin values as an object containing
 * the value and unit properties. If any of the values are not properly
 * formatted or use a unit other than px or %, and error is thrown.
 * @private
 * @param {string=} opt_rootMargin An optional rootMargin value,
 *     defaulting to '0px'.
 * @return {Array<Object>} An array of margin objects with the keys
 *     value and unit.
 */
IntersectionObserver.prototype._parseRootMargin = function(opt_rootMargin) {
  var marginString = opt_rootMargin || '0px';
  var margins = marginString.split(/\s+/).map(function(margin) {
    var parts = /^(-?\d*\.?\d+)(px|%)$/.exec(margin);
    if (!parts) {
      throw new Error('rootMargin must be specified in pixels or percent');
    }
    return {value: parseFloat(parts[1]), unit: parts[2]};
  });

  // Handles shorthand.
  margins[1] = margins[1] || margins[0];
  margins[2] = margins[2] || margins[0];
  margins[3] = margins[3] || margins[1];

  return margins;
};


/**
 * Starts polling for intersection changes if the polling is not already
 * happening, and if the page's visibilty state is visible.
 * @private
 */
IntersectionObserver.prototype._monitorIntersections = function() {
  if (!this._monitoringIntersections) {
    this._monitoringIntersections = true;

    // If a poll interval is set, use polling instead of listening to
    // resize and scroll events or DOM mutations.
    if (this.POLL_INTERVAL) {
      this._monitoringInterval = setInterval(
          this._checkForIntersections, this.POLL_INTERVAL);
    }
    else {
      addEvent(window, 'resize', this._checkForIntersections, true);
      addEvent(document, 'scroll', this._checkForIntersections, true);

      if (this.USE_MUTATION_OBSERVER && 'MutationObserver' in window) {
        this._domObserver = new MutationObserver(this._checkForIntersections);
        this._domObserver.observe(document, {
          attributes: true,
          childList: true,
          characterData: true,
          subtree: true
        });
      }
    }
  }
};


/**
 * Stops polling for intersection changes.
 * @private
 */
IntersectionObserver.prototype._unmonitorIntersections = function() {
  if (this._monitoringIntersections) {
    this._monitoringIntersections = false;

    clearInterval(this._monitoringInterval);
    this._monitoringInterval = null;

    removeEvent(window, 'resize', this._checkForIntersections, true);
    removeEvent(document, 'scroll', this._checkForIntersections, true);

    if (this._domObserver) {
      this._domObserver.disconnect();
      this._domObserver = null;
    }
  }
};


/**
 * Scans each observation target for intersection changes and adds them
 * to the internal entries queue. If new entries are found, it
 * schedules the callback to be invoked.
 * @private
 */
IntersectionObserver.prototype._checkForIntersections = function() {
  var rootIsInDom = this._rootIsInDom();
  var rootRect = rootIsInDom ? this._getRootRect() : getEmptyRect();

  this._observationTargets.forEach(function(item) {
    var target = item.element;
    var targetRect = getBoundingClientRect(target);
    var rootContainsTarget = this._rootContainsTarget(target);
    var oldEntry = item.entry;
    var intersectionRect = rootIsInDom && rootContainsTarget &&
        this._computeTargetAndRootIntersection(target, rootRect);

    var newEntry = item.entry = new IntersectionObserverEntry({
      time: now(),
      target: target,
      boundingClientRect: targetRect,
      rootBounds: rootRect,
      intersectionRect: intersectionRect
    });

    if (!oldEntry) {
      this._queuedEntries.push(newEntry);
    } else if (rootIsInDom && rootContainsTarget) {
      // If the new entry intersection ratio has crossed any of the
      // thresholds, add a new entry.
      if (this._hasCrossedThreshold(oldEntry, newEntry)) {
        this._queuedEntries.push(newEntry);
      }
    } else {
      // If the root is not in the DOM or target is not contained within
      // root but the previous entry for this target had an intersection,
      // add a new record indicating removal.
      if (oldEntry && oldEntry.isIntersecting) {
        this._queuedEntries.push(newEntry);
      }
    }
  }, this);

  if (this._queuedEntries.length) {
    this._callback(this.takeRecords(), this);
  }
};


/**
 * Accepts a target and root rect computes the intersection between then
 * following the algorithm in the spec.
 * TODO(philipwalton): at this time clip-path is not considered.
 * https://w3c.github.io/IntersectionObserver/#calculate-intersection-rect-algo
 * @param {Element} target The target DOM element
 * @param {Object} rootRect The bounding rect of the root after being
 *     expanded by the rootMargin value.
 * @return {?Object} The final intersection rect object or undefined if no
 *     intersection is found.
 * @private
 */
IntersectionObserver.prototype._computeTargetAndRootIntersection =
    function(target, rootRect) {

  // If the element isn't displayed, an intersection can't happen.
  if (window.getComputedStyle(target).display == 'none') return;

  var targetRect = getBoundingClientRect(target);
  var intersectionRect = targetRect;
  var parent = getParentNode(target);
  var atRoot = false;

  while (!atRoot) {
    var parentRect = null;
    var parentComputedStyle = parent.nodeType == 1 ?
        window.getComputedStyle(parent) : {};

    // If the parent isn't displayed, an intersection can't happen.
    if (parentComputedStyle.display == 'none') return;

    if (parent == this.root || parent == document) {
      atRoot = true;
      parentRect = rootRect;
    } else {
      // If the element has a non-visible overflow, and it's not the <body>
      // or <html> element, update the intersection rect.
      // Note: <body> and <html> cannot be clipped to a rect that's not also
      // the document rect, so no need to compute a new intersection.
      if (parent != document.body &&
          parent != document.documentElement &&
          parentComputedStyle.overflow != 'visible') {
        parentRect = getBoundingClientRect(parent);
      }
    }

    // If either of the above conditionals set a new parentRect,
    // calculate new intersection data.
    if (parentRect) {
      intersectionRect = computeRectIntersection(parentRect, intersectionRect);

      if (!intersectionRect) break;
    }
    parent = getParentNode(parent);
  }
  return intersectionRect;
};


/**
 * Returns the root rect after being expanded by the rootMargin value.
 * @return {Object} The expanded root rect.
 * @private
 */
IntersectionObserver.prototype._getRootRect = function() {
  var rootRect;
  if (this.root) {
    rootRect = getBoundingClientRect(this.root);
  } else {
    // Use <html>/<body> instead of window since scroll bars affect size.
    var html = document.documentElement;
    var body = document.body;
    rootRect = {
      top: 0,
      left: 0,
      right: html.clientWidth || body.clientWidth,
      width: html.clientWidth || body.clientWidth,
      bottom: html.clientHeight || body.clientHeight,
      height: html.clientHeight || body.clientHeight
    };
  }
  return this._expandRectByRootMargin(rootRect);
};


/**
 * Accepts a rect and expands it by the rootMargin value.
 * @param {Object} rect The rect object to expand.
 * @return {Object} The expanded rect.
 * @private
 */
IntersectionObserver.prototype._expandRectByRootMargin = function(rect) {
  var margins = this._rootMarginValues.map(function(margin, i) {
    return margin.unit == 'px' ? margin.value :
        margin.value * (i % 2 ? rect.width : rect.height) / 100;
  });
  var newRect = {
    top: rect.top - margins[0],
    right: rect.right + margins[1],
    bottom: rect.bottom + margins[2],
    left: rect.left - margins[3]
  };
  newRect.width = newRect.right - newRect.left;
  newRect.height = newRect.bottom - newRect.top;

  return newRect;
};


/**
 * Accepts an old and new entry and returns true if at least one of the
 * threshold values has been crossed.
 * @param {?IntersectionObserverEntry} oldEntry The previous entry for a
 *    particular target element or null if no previous entry exists.
 * @param {IntersectionObserverEntry} newEntry The current entry for a
 *    particular target element.
 * @return {boolean} Returns true if a any threshold has been crossed.
 * @private
 */
IntersectionObserver.prototype._hasCrossedThreshold =
    function(oldEntry, newEntry) {

  // To make comparing easier, an entry that has a ratio of 0
  // but does not actually intersect is given a value of -1
  var oldRatio = oldEntry && oldEntry.isIntersecting ?
      oldEntry.intersectionRatio || 0 : -1;
  var newRatio = newEntry.isIntersecting ?
      newEntry.intersectionRatio || 0 : -1;

  // Ignore unchanged ratios
  if (oldRatio === newRatio) return;

  for (var i = 0; i < this.thresholds.length; i++) {
    var threshold = this.thresholds[i];

    // Return true if an entry matches a threshold or if the new ratio
    // and the old ratio are on the opposite sides of a threshold.
    if (threshold == oldRatio || threshold == newRatio ||
        threshold < oldRatio !== threshold < newRatio) {
      return true;
    }
  }
};


/**
 * Returns whether or not the root element is an element and is in the DOM.
 * @return {boolean} True if the root element is an element and is in the DOM.
 * @private
 */
IntersectionObserver.prototype._rootIsInDom = function() {
  return !this.root || containsDeep(document, this.root);
};


/**
 * Returns whether or not the target element is a child of root.
 * @param {Element} target The target element to check.
 * @return {boolean} True if the target element is a child of root.
 * @private
 */
IntersectionObserver.prototype._rootContainsTarget = function(target) {
  return containsDeep(this.root || document, target);
};


/**
 * Adds the instance to the global IntersectionObserver registry if it isn't
 * already present.
 * @private
 */
IntersectionObserver.prototype._registerInstance = function() {
  if (registry.indexOf(this) < 0) {
    registry.push(this);
  }
};


/**
 * Removes the instance from the global IntersectionObserver registry.
 * @private
 */
IntersectionObserver.prototype._unregisterInstance = function() {
  var index = registry.indexOf(this);
  if (index != -1) registry.splice(index, 1);
};


/**
 * Returns the result of the performance.now() method or null in browsers
 * that don't support the API.
 * @return {number} The elapsed time since the page was requested.
 */
function now() {
  return window.performance && performance.now && performance.now();
}


/**
 * Throttles a function and delays its executiong, so it's only called at most
 * once within a given time period.
 * @param {Function} fn The function to throttle.
 * @param {number} timeout The amount of time that must pass before the
 *     function can be called again.
 * @return {Function} The throttled function.
 */
function throttle(fn, timeout) {
  var timer = null;
  return function () {
    if (!timer) {
      timer = setTimeout(function() {
        fn();
        timer = null;
      }, timeout);
    }
  };
}


/**
 * Adds an event handler to a DOM node ensuring cross-browser compatibility.
 * @param {Node} node The DOM node to add the event handler to.
 * @param {string} event The event name.
 * @param {Function} fn The event handler to add.
 * @param {boolean} opt_useCapture Optionally adds the even to the capture
 *     phase. Note: this only works in modern browsers.
 */
function addEvent(node, event, fn, opt_useCapture) {
  if (typeof node.addEventListener == 'function') {
    node.addEventListener(event, fn, opt_useCapture || false);
  }
  else if (typeof node.attachEvent == 'function') {
    node.attachEvent('on' + event, fn);
  }
}


/**
 * Removes a previously added event handler from a DOM node.
 * @param {Node} node The DOM node to remove the event handler from.
 * @param {string} event The event name.
 * @param {Function} fn The event handler to remove.
 * @param {boolean} opt_useCapture If the event handler was added with this
 *     flag set to true, it should be set to true here in order to remove it.
 */
function removeEvent(node, event, fn, opt_useCapture) {
  if (typeof node.removeEventListener == 'function') {
    node.removeEventListener(event, fn, opt_useCapture || false);
  }
  else if (typeof node.detatchEvent == 'function') {
    node.detatchEvent('on' + event, fn);
  }
}


/**
 * Returns the intersection between two rect objects.
 * @param {Object} rect1 The first rect.
 * @param {Object} rect2 The second rect.
 * @return {?Object} The intersection rect or undefined if no intersection
 *     is found.
 */
function computeRectIntersection(rect1, rect2) {
  var top = Math.max(rect1.top, rect2.top);
  var bottom = Math.min(rect1.bottom, rect2.bottom);
  var left = Math.max(rect1.left, rect2.left);
  var right = Math.min(rect1.right, rect2.right);
  var width = right - left;
  var height = bottom - top;

  return (width >= 0 && height >= 0) && {
    top: top,
    bottom: bottom,
    left: left,
    right: right,
    width: width,
    height: height
  };
}


/**
 * Shims the native getBoundingClientRect for compatibility with older IE.
 * @param {Element} el The element whose bounding rect to get.
 * @return {Object} The (possibly shimmed) rect of the element.
 */
function getBoundingClientRect(el) {
  var rect;

  try {
    rect = el.getBoundingClientRect();
  } catch (err) {
    // Ignore Windows 7 IE11 "Unspecified error"
    // https://github.com/w3c/IntersectionObserver/pull/205
  }

  if (!rect) return getEmptyRect();

  // Older IE
  if (!(rect.width && rect.height)) {
    rect = {
      top: rect.top,
      right: rect.right,
      bottom: rect.bottom,
      left: rect.left,
      width: rect.right - rect.left,
      height: rect.bottom - rect.top
    };
  }
  return rect;
}


/**
 * Returns an empty rect object. An empty rect is returned when an element
 * is not in the DOM.
 * @return {Object} The empty rect.
 */
function getEmptyRect() {
  return {
    top: 0,
    bottom: 0,
    left: 0,
    right: 0,
    width: 0,
    height: 0
  };
}

/**
 * Checks to see if a parent element contains a child elemnt (including inside
 * shadow DOM).
 * @param {Node} parent The parent element.
 * @param {Node} child The child element.
 * @return {boolean} True if the parent node contains the child node.
 */
function containsDeep(parent, child) {
  var node = child;
  while (node) {
    if (node == parent) return true;

    node = getParentNode(node);
  }
  return false;
}


/**
 * Gets the parent node of an element or its host element if the parent node
 * is a shadow root.
 * @param {Node} node The node whose parent to get.
 * @return {Node|null} The parent node or null if no parent exists.
 */
function getParentNode(node) {
  var parent = node.parentNode;

  if (parent && parent.nodeType == 11 && parent.host) {
    // If the parent is a shadow root, return the host element.
    return parent.host;
  }
  return parent;
}


// Exposes the constructors globally.
window.IntersectionObserver = IntersectionObserver;
window.IntersectionObserverEntry = IntersectionObserverEntry;

}(window, document));


/***/ }),

/***/ "./src/assets/SVG/airplay-off.svg":
/*!****************************************!*\
  !*** ./src/assets/SVG/airplay-off.svg ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-airplay-off\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M210,55v100h-50l20,20h45c2.6,0.2,4.8-1.8,5-4.4c0-0.2,0-0.4,0-0.6V40c0.2-2.6-1.8-4.8-4.4-5c-0.2,0-0.4,0-0.6,0H15c-2.6-0.2-4.8,1.8-5,4.4c0,0.2,0,0.4,0,0.6v130c-0.2,2.6,1.8,4.8,4.4,5c0.2,0,0.4,0,0.6,0h45l20-20H30V55H210 M60,205l60-70l60,70H60L60,205z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/airplay-on.svg":
/*!***************************************!*\
  !*** ./src/assets/SVG/airplay-on.svg ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-airplay-on\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M229.9,40v130c0.2,2.6-1.8,4.8-4.4,5c-0.2,0-0.4,0-0.6,0h-44l-17-20h46V55H30v100h47l-17,20h-45c-2.6,0.2-4.8-1.8-5-4.4c0-0.2,0-0.4,0-0.6V40c-0.2-2.6,1.8-4.8,4.4-5c0.2,0,0.4,0,0.6,0h209.8c2.6-0.2,4.8,1.8,5,4.4C229.9,39.7,229.9,39.9,229.9,40z M104.9,122l15-18l15,18l11,13h44V75H50v60h44L104.9,122z M179.9,205l-60-70l-60,70H179.9z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/arrow-left.svg":
/*!***************************************!*\
  !*** ./src/assets/SVG/arrow-left.svg ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-arrow-left\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M55.4,104.4c-1.1,1.1-2.2,2.3-3.1,3.6c-6.9,9.9-4.4,23.5,5.5,30.4L159.7,240l33.9-33.9l-84.9-84.9l84.9-84.9L157.3,0L55.4,104.4L55.4,104.4z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/arrow-right.svg":
/*!****************************************!*\
  !*** ./src/assets/SVG/arrow-right.svg ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-arrow-right\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M183.6,104.4L81.8,0L45.4,36.3l84.9,84.9l-84.9,84.9L79.3,240l101.9-101.7c9.9-6.9,12.4-20.4,5.5-30.4C185.8,106.7,184.8,105.4,183.6,104.4L183.6,104.4z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/audio-tracks.svg":
/*!*****************************************!*\
  !*** ./src/assets/SVG/audio-tracks.svg ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-audio-tracks\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M35,34h160v20H35V34z M35,94h160V74H35V94z M35,134h60v-20H35V134z M160,114c-23.4-1.3-43.6,16.5-45,40v50h20c5.2,0.3,9.7-3.6,10-8.9c0-0.4,0-0.7,0-1.1v-20c0.3-5.2-3.6-9.7-8.9-10c-0.4,0-0.7,0-1.1,0h-10v-10c1.5-17.9,17.1-31.3,35-30c17.9-1.3,33.6,12.1,35,30v10H185c-5.2-0.3-9.7,3.6-10,8.9c0,0.4,0,0.7,0,1.1v20c-0.3,5.2,3.6,9.7,8.9,10c0.4,0,0.7,0,1.1,0h20v-50C203.5,130.6,183.4,112.7,160,114z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/buffer.svg":
/*!***********************************!*\
  !*** ./src/assets/SVG/buffer.svg ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-buffer\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M120,186.667a66.667,66.667,0,0,1,0-133.333V40a80,80,0,1,0,80,80H186.667A66.846,66.846,0,0,1,120,186.667Z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/captions-off.svg":
/*!*****************************************!*\
  !*** ./src/assets/SVG/captions-off.svg ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-cc-off\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M99.4,97.8c-2.4-0.2-4.8,0.7-6.6,2.3c-1.7,1.7-2.5,4.1-2.4,6.5v25.6c0,9.6,11.6,11.4,17.7,5.5c0.7-0.7,1.5-1.5,2.4-2.3l6.6,7.8c-2.2,2.4-5,4.4-8,5.8c-8,3.5-17.3,2.4-24.3-2.9c-3.9-3.6-5.9-8.7-5.5-14v-25.6c0-2.7,0.5-5.3,1.5-7.8c0.9-2.2,2.4-4.3,4.2-5.9c5.7-4.5,13.2-6.2,20.3-4.6c3.3,0.5,6.3,2,8.7,4.3c1.3,1.3,2.5,2.6,3.5,4.2l-7.1,6.9C107.9,100,103.8,97.8,99.4,97.8z M144.1,97.8c-2.4-0.2-4.8,0.7-6.6,2.3c-1.7,1.7-2.5,4.1-2.4,6.5v25.6c0,9.6,11.6,11.4,17.7,5.5c0.7-0.7,1.5-1.5,2.4-2.3l6.6,7.8c-2.2,2.4-5,4.4-8,5.8c-8,3.5-17.3,2.4-24.3-2.9c-3.9-3.6-5.9-8.7-5.5-14v-25.6c0-2.7,0.5-5.3,1.5-7.8c0.9-2.2,2.4-4.3,4.2-5.9c5.7-4.5,13.2-6.2,20.3-4.6c3.3,0.5,6.3,2,8.7,4.3c1.3,1.3,2.5,2.6,3.5,4.2l-7.1,6.9C152.6,100,148.5,97.8,144.1,97.8L144.1,97.8z M200,60v120H40V60H200 M215,40H25c-2.7,0-5,2.2-5,5v150c0,2.7,2.2,5,5,5h190c2.7,0,5-2.2,5-5V45C220,42.2,217.8,40,215,40z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/captions-on.svg":
/*!****************************************!*\
  !*** ./src/assets/SVG/captions-on.svg ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-cc-on\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M215,40H25c-2.7,0-5,2.2-5,5v150c0,2.7,2.2,5,5,5h190c2.7,0,5-2.2,5-5V45C220,42.2,217.8,40,215,40z M108.1,137.7c0.7-0.7,1.5-1.5,2.4-2.3l6.6,7.8c-2.2,2.4-5,4.4-8,5.8c-8,3.5-17.3,2.4-24.3-2.9c-3.9-3.6-5.9-8.7-5.5-14v-25.6c0-2.7,0.5-5.3,1.5-7.8c0.9-2.2,2.4-4.3,4.2-5.9c5.7-4.5,13.2-6.2,20.3-4.6c3.3,0.5,6.3,2,8.7,4.3c1.3,1.3,2.5,2.6,3.5,4.2l-7.1,6.9c-2.4-3.7-6.5-5.9-10.9-5.9c-2.4-0.2-4.8,0.7-6.6,2.3c-1.7,1.7-2.5,4.1-2.4,6.5v25.6C90.4,141.7,102,143.5,108.1,137.7z M152.9,137.7c0.7-0.7,1.5-1.5,2.4-2.3l6.6,7.8c-2.2,2.4-5,4.4-8,5.8c-8,3.5-17.3,2.4-24.3-2.9c-3.9-3.6-5.9-8.7-5.5-14v-25.6c0-2.7,0.5-5.3,1.5-7.8c0.9-2.2,2.4-4.3,4.2-5.9c5.7-4.5,13.2-6.2,20.3-4.6c3.3,0.5,6.3,2,8.7,4.3c1.3,1.3,2.5,2.6,3.5,4.2l-7.1,6.9c-2.4-3.7-6.5-5.9-10.9-5.9c-2.4-0.2-4.8,0.7-6.6,2.3c-1.7,1.7-2.5,4.1-2.4,6.5v25.6C135.2,141.7,146.8,143.5,152.9,137.7z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/close.svg":
/*!**********************************!*\
  !*** ./src/assets/SVG/close.svg ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-close\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M134.8,120l48.6-48.6c2-1.9,2.1-5.2,0.2-7.2c0,0-0.1-0.1-0.2-0.2l-7.4-7.4c-1.9-2-5.2-2.1-7.2-0.2c0,0-0.1,0.1-0.2,0.2L120,105.2L71.4,56.6c-1.9-2-5.2-2.1-7.2-0.2c0,0-0.1,0.1-0.2,0.2L56.6,64c-2,1.9-2.1,5.2-0.2,7.2c0,0,0.1,0.1,0.2,0.2l48.6,48.7l-48.6,48.6c-2,1.9-2.1,5.2-0.2,7.2c0,0,0.1,0.1,0.2,0.2l7.4,7.4c1.9,2,5.2,2.1,7.2,0.2c0,0,0.1-0.1,0.2-0.2l48.7-48.6l48.6,48.6c1.9,2,5.2,2.1,7.2,0.2c0,0,0.1-0.1,0.2-0.2l7.4-7.4c2-1.9,2.1-5.2,0.2-7.2c0,0-0.1-0.1-0.2-0.2L134.8,120z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/fullscreen-not.svg":
/*!*******************************************!*\
  !*** ./src/assets/SVG/fullscreen-not.svg ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-fullscreen-off\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M109.2,134.9l-8.4,50.1c-0.4,2.7-2.4,3.3-4.4,1.4L82,172l-27.9,27.9l-14.2-14.2l27.9-27.9l-14.4-14.4c-1.9-1.9-1.3-3.9,1.4-4.4l50.1-8.4c1.8-0.5,3.6,0.6,4.1,2.4C109.4,133.7,109.4,134.3,109.2,134.9L109.2,134.9z M172.1,82.1L200,54.2L185.8,40l-27.9,27.9l-14.4-14.4c-1.9-1.9-3.9-1.3-4.4,1.4l-8.4,50.1c-0.5,1.8,0.6,3.6,2.4,4.1c0.5,0.2,1.2,0.2,1.7,0l50.1-8.4c2.7-0.4,3.3-2.4,1.4-4.4L172.1,82.1z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/fullscreen.svg":
/*!***************************************!*\
  !*** ./src/assets/SVG/fullscreen.svg ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-fullscreen-on\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M96.3,186.1c1.9,1.9,1.3,4-1.4,4.4l-50.6,8.4c-1.8,0.5-3.7-0.6-4.2-2.4c-0.2-0.6-0.2-1.2,0-1.7l8.4-50.6c0.4-2.7,2.4-3.4,4.4-1.4l14.5,14.5l28.2-28.2l14.3,14.3l-28.2,28.2L96.3,186.1z M195.8,39.1l-50.6,8.4c-2.7,0.4-3.4,2.4-1.4,4.4l14.5,14.5l-28.2,28.2l14.3,14.3l28.2-28.2l14.5,14.5c1.9,1.9,4,1.3,4.4-1.4l8.4-50.6c0.5-1.8-0.6-3.6-2.4-4.2C197,39,196.4,39,195.8,39.1L195.8,39.1z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/jw-logo.svg":
/*!************************************!*\
  !*** ./src/assets/SVG/jw-logo.svg ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-jwplayer-logo\" viewBox=\"0 0 992 1024\" focusable=\"false\"><path d=\"M144 518.4c0 6.4-6.4 6.4-6.4 0l-3.2-12.8c0 0-6.4-19.2-12.8-38.4 0-6.4-6.4-12.8-9.6-22.4-6.4-6.4-16-9.6-28.8-6.4-9.6 3.2-16 12.8-16 22.4s0 16 0 25.6c3.2 25.6 22.4 121.6 32 140.8 9.6 22.4 35.2 32 54.4 22.4 22.4-9.6 28.8-35.2 38.4-54.4 9.6-25.6 60.8-166.4 60.8-166.4 6.4-12.8 9.6-12.8 9.6 0 0 0 0 140.8-3.2 204.8 0 25.6 0 67.2 9.6 89.6 6.4 16 12.8 28.8 25.6 38.4s28.8 12.8 44.8 12.8c6.4 0 16-3.2 22.4-6.4 9.6-6.4 16-12.8 25.6-22.4 16-19.2 28.8-44.8 38.4-64 25.6-51.2 89.6-201.6 89.6-201.6 6.4-12.8 9.6-12.8 9.6 0 0 0-9.6 256-9.6 355.2 0 25.6 6.4 48 12.8 70.4 9.6 22.4 22.4 38.4 44.8 48s48 9.6 70.4-3.2c16-9.6 28.8-25.6 38.4-38.4 12.8-22.4 25.6-48 32-70.4 19.2-51.2 35.2-102.4 51.2-153.6s153.6-540.8 163.2-582.4c0-6.4 0-9.6 0-12.8 0-9.6-6.4-19.2-16-22.4-16-6.4-32 0-38.4 12.8-6.4 16-195.2 470.4-195.2 470.4-6.4 12.8-9.6 12.8-9.6 0 0 0 0-156.8 0-288 0-70.4-35.2-108.8-83.2-118.4-22.4-3.2-44.8 0-67.2 12.8s-35.2 32-48 54.4c-16 28.8-105.6 297.6-105.6 297.6-6.4 12.8-9.6 12.8-9.6 0 0 0-3.2-115.2-6.4-144-3.2-41.6-12.8-108.8-67.2-115.2-51.2-3.2-73.6 57.6-86.4 99.2-9.6 25.6-51.2 163.2-51.2 163.2v3.2z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/next.svg":
/*!*********************************!*\
  !*** ./src/assets/SVG/next.svg ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-next\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M165,60v53.3L59.2,42.8C56.9,41.3,55,42.3,55,45v150c0,2.7,1.9,3.8,4.2,2.2L165,126.6v53.3h20v-120L165,60L165,60z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/pause.svg":
/*!**********************************!*\
  !*** ./src/assets/SVG/pause.svg ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-pause\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M100,194.9c0.2,2.6-1.8,4.8-4.4,5c-0.2,0-0.4,0-0.6,0H65c-2.6,0.2-4.8-1.8-5-4.4c0-0.2,0-0.4,0-0.6V45c-0.2-2.6,1.8-4.8,4.4-5c0.2,0,0.4,0,0.6,0h30c2.6-0.2,4.8,1.8,5,4.4c0,0.2,0,0.4,0,0.6V194.9z M180,45.1c0.2-2.6-1.8-4.8-4.4-5c-0.2,0-0.4,0-0.6,0h-30c-2.6-0.2-4.8,1.8-5,4.4c0,0.2,0,0.4,0,0.6V195c-0.2,2.6,1.8,4.8,4.4,5c0.2,0,0.4,0,0.6,0h30c2.6,0.2,4.8-1.8,5-4.4c0-0.2,0-0.4,0-0.6V45.1z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/play.svg":
/*!*********************************!*\
  !*** ./src/assets/SVG/play.svg ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-play\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M62.8,199.5c-1,0.8-2.4,0.6-3.3-0.4c-0.4-0.5-0.6-1.1-0.5-1.8V42.6c-0.2-1.3,0.7-2.4,1.9-2.6c0.7-0.1,1.3,0.1,1.9,0.4l154.7,77.7c2.1,1.1,2.1,2.8,0,3.8L62.8,199.5z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/playback-error.svg":
/*!*******************************************!*\
  !*** ./src/assets/SVG/playback-error.svg ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-error\" viewBox=\"0 0 36 36\" style=\"width:100%;height:100%;\" focusable=\"false\"><path d=\"M34.6 20.2L10 33.2 27.6 16l7 3.7a.4.4 0 0 1 .2.5.4.4 0 0 1-.2.2zM33.3 0L21 12.2 9 6c-.2-.3-.6 0-.6.5V25L0 33.6 2.5 36 36 2.7z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/playback-rate.svg":
/*!******************************************!*\
  !*** ./src/assets/SVG/playback-rate.svg ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"jw-svg-icon jw-svg-icon-playback-rate\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M158.83,48.83A71.17,71.17,0,1,0,230,120,71.163,71.163,0,0,0,158.83,48.83Zm45.293,77.632H152.34V74.708h12.952v38.83h38.83ZM35.878,74.708h38.83V87.66H35.878ZM10,113.538H61.755V126.49H10Zm25.878,38.83h38.83V165.32H35.878Z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/quality-100.svg":
/*!****************************************!*\
  !*** ./src/assets/SVG/quality-100.svg ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-quality-100\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M55,200H35c-3,0-5-2-5-4c0,0,0,0,0-1v-30c0-3,2-5,4-5c0,0,0,0,1,0h20c3,0,5,2,5,4c0,0,0,0,0,1v30C60,198,58,200,55,200L55,200z M110,195v-70c0-3-2-5-4-5c0,0,0,0-1,0H85c-3,0-5,2-5,4c0,0,0,0,0,1v70c0,3,2,5,4,5c0,0,0,0,1,0h20C108,200,110,198,110,195L110,195z M160,195V85c0-3-2-5-4-5c0,0,0,0-1,0h-20c-3,0-5,2-5,4c0,0,0,0,0,1v110c0,3,2,5,4,5c0,0,0,0,1,0h20C158,200,160,198,160,195L160,195z M210,195V45c0-3-2-5-4-5c0,0,0,0-1,0h-20c-3,0-5,2-5,4c0,0,0,0,0,1v150c0,3,2,5,4,5c0,0,0,0,1,0h20C208,200,210,198,210,195L210,195z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/replay.svg":
/*!***********************************!*\
  !*** ./src/assets/SVG/replay.svg ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-replay\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M120,41.9v-20c0-5-4-8-8-4l-44,28a5.865,5.865,0,0,0-3.3,7.6A5.943,5.943,0,0,0,68,56.8l43,29c5,4,9,1,9-4v-20a60,60,0,1,1-60,60H40a80,80,0,1,0,80-79.9Z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/rewind-10.svg":
/*!**************************************!*\
  !*** ./src/assets/SVG/rewind-10.svg ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-rewind\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M113.2,131.078a21.589,21.589,0,0,0-17.7-10.6,21.589,21.589,0,0,0-17.7,10.6,44.769,44.769,0,0,0,0,46.3,21.589,21.589,0,0,0,17.7,10.6,21.589,21.589,0,0,0,17.7-10.6,44.769,44.769,0,0,0,0-46.3Zm-17.7,47.2c-7.8,0-14.4-11-14.4-24.1s6.6-24.1,14.4-24.1,14.4,11,14.4,24.1S103.4,178.278,95.5,178.278Zm-43.4,9.7v-51l-4.8,4.8-6.8-6.8,13-13a4.8,4.8,0,0,1,8.2,3.4v62.7l-9.6-.1Zm162-130.2v125.3a4.867,4.867,0,0,1-4.8,4.8H146.6v-19.3h48.2v-96.4H79.1v19.3c0,5.3-3.6,7.2-8,4.3l-41.8-27.9a6.013,6.013,0,0,1-2.7-8,5.887,5.887,0,0,1,2.7-2.7l41.8-27.9c4.4-2.9,8-1,8,4.3v19.3H209.2A4.974,4.974,0,0,1,214.1,57.778Z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/settings.svg":
/*!*************************************!*\
  !*** ./src/assets/SVG/settings.svg ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-settings\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M204,145l-25-14c0.8-3.6,1.2-7.3,1-11c0.2-3.7-0.2-7.4-1-11l25-14c2.2-1.6,3.1-4.5,2-7l-16-26c-1.2-2.1-3.8-2.9-6-2l-25,14c-6-4.2-12.3-7.9-19-11V35c0.2-2.6-1.8-4.8-4.4-5c-0.2,0-0.4,0-0.6,0h-30c-2.6-0.2-4.8,1.8-5,4.4c0,0.2,0,0.4,0,0.6v28c-6.7,3.1-13,6.7-19,11L56,60c-2.2-0.9-4.8-0.1-6,2L35,88c-1.6,2.2-1.3,5.3,0.9,6.9c0,0,0.1,0,0.1,0.1l25,14c-0.8,3.6-1.2,7.3-1,11c-0.2,3.7,0.2,7.4,1,11l-25,14c-2.2,1.6-3.1,4.5-2,7l16,26c1.2,2.1,3.8,2.9,6,2l25-14c5.7,4.6,12.2,8.3,19,11v28c-0.2,2.6,1.8,4.8,4.4,5c0.2,0,0.4,0,0.6,0h30c2.6,0.2,4.8-1.8,5-4.4c0-0.2,0-0.4,0-0.6v-28c7-2.3,13.5-6,19-11l25,14c2.5,1.3,5.6,0.4,7-2l15-26C206.7,149.4,206,146.7,204,145z M120,149.9c-16.5,0-30-13.4-30-30s13.4-30,30-30s30,13.4,30,30c0.3,16.3-12.6,29.7-28.9,30C120.7,149.9,120.4,149.9,120,149.9z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/stop.svg":
/*!*********************************!*\
  !*** ./src/assets/SVG/stop.svg ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-stop\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M190,185c0.2,2.6-1.8,4.8-4.4,5c-0.2,0-0.4,0-0.6,0H55c-2.6,0.2-4.8-1.8-5-4.4c0-0.2,0-0.4,0-0.6V55c-0.2-2.6,1.8-4.8,4.4-5c0.2,0,0.4,0,0.6,0h130c2.6-0.2,4.8,1.8,5,4.4c0,0.2,0,0.4,0,0.6V185z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/volume-0.svg":
/*!*************************************!*\
  !*** ./src/assets/SVG/volume-0.svg ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-volume-0\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M116.4,42.8v154.5c0,2.8-1.7,3.6-3.8,1.7l-54.1-48.1H28.9c-2.8,0-5.2-2.3-5.2-5.2V94.2c0-2.8,2.3-5.2,5.2-5.2h29.6l54.1-48.1C114.6,39.1,116.4,39.9,116.4,42.8z M212.3,96.4l-14.6-14.6l-23.6,23.6l-23.6-23.6l-14.6,14.6l23.6,23.6l-23.6,23.6l14.6,14.6l23.6-23.6l23.6,23.6l14.6-14.6L188.7,120L212.3,96.4z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/volume-100.svg":
/*!***************************************!*\
  !*** ./src/assets/SVG/volume-100.svg ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-volume-100\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M116.5,42.8v154.4c0,2.8-1.7,3.6-3.8,1.7l-54.1-48H29c-2.8,0-5.2-2.3-5.2-5.2V94.3c0-2.8,2.3-5.2,5.2-5.2h29.6l54.1-48C114.8,39.2,116.5,39.9,116.5,42.8z\"></path><path d=\"M136.2,160v-20c11.1,0,20-8.9,20-20s-8.9-20-20-20V80c22.1,0,40,17.9,40,40S158.3,160,136.2,160z\"></path><path d=\"M216.2,120c0-44.2-35.8-80-80-80v20c33.1,0,60,26.9,60,60s-26.9,60-60,60v20C180.4,199.9,216.1,164.1,216.2,120z\"></path></svg>"

/***/ }),

/***/ "./src/assets/SVG/volume-50.svg":
/*!**************************************!*\
  !*** ./src/assets/SVG/volume-50.svg ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg class=\"jw-svg-icon jw-svg-icon-volume-50\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 240 240\" focusable=\"false\"><path d=\"M116.4,42.8v154.5c0,2.8-1.7,3.6-3.8,1.7l-54.1-48.1H28.9c-2.8,0-5.2-2.3-5.2-5.2V94.2c0-2.8,2.3-5.2,5.2-5.2h29.6l54.1-48.1C114.7,39.1,116.4,39.9,116.4,42.8z M178.2,120c0-22.7-18.5-41.2-41.2-41.2v20.6c11.4,0,20.6,9.2,20.6,20.6c0,11.4-9.2,20.6-20.6,20.6v20.6C159.8,161.2,178.2,142.7,178.2,120z\"></path></svg>"

/***/ }),

/***/ "./src/css/controls.less":
/*!*******************************!*\
  !*** ./src/css/controls.less ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {


var content = __webpack_require__(/*! !../../node_modules/css-loader/dist/cjs.js??ref--4-1!../../node_modules/postcss-loader/src!../../node_modules/less-loader/dist/cjs.js??ref--4-3!./controls.less */ "./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js!./node_modules/less-loader/dist/cjs.js?!./src/css/controls.less");
if(typeof content === 'string') content = [['all-players', content, '']];

__webpack_require__(/*! ../../node_modules/simple-style-loader/addStyles.js */ "./node_modules/simple-style-loader/addStyles.js").style(content,'all-players');
if(content.locals) module.exports = content.locals;

/***/ }),

/***/ "./src/css/jwplayer.less":
/*!*******************************!*\
  !*** ./src/css/jwplayer.less ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {


var content = __webpack_require__(/*! !../../node_modules/css-loader/dist/cjs.js??ref--4-1!../../node_modules/postcss-loader/src!../../node_modules/less-loader/dist/cjs.js??ref--4-3!./jwplayer.less */ "./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js!./node_modules/less-loader/dist/cjs.js?!./src/css/jwplayer.less");
if(typeof content === 'string') content = [['all-players', content, '']];

__webpack_require__(/*! ../../node_modules/simple-style-loader/addStyles.js */ "./node_modules/simple-style-loader/addStyles.js").style(content,'all-players');
if(content.locals) module.exports = content.locals;

/***/ }),

/***/ "./src/js/api/set-config.js":
/*!**********************************!*\
  !*** ./src/js/api/set-config.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var api_config_normalization__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! api/config-normalization */ "./src/js/api/config-normalization.ts");


var FLOAT_ENUM = ['notVisible', 'always', 'never'];

function setAutoStart(model, controller, autoStart) {
  model.setAutoStart(autoStart);

  if (model.get('state') === 'idle' && autoStart === true) {
    controller.play({
      reason: 'autostart'
    });
  }
}

/* harmony default export */ __webpack_exports__["default"] = (function (controller, newConfig) {
  var model = controller._model;
  var attributes = model.attributes;

  if (newConfig.height) {
    // Prepare width and height for view.resize()
    newConfig.height = Object(api_config_normalization__WEBPACK_IMPORTED_MODULE_1__["normalizeSize"])(newConfig.height);
    newConfig.width = newConfig.width || attributes.width;
  }

  if (newConfig.width) {
    newConfig.width = Object(api_config_normalization__WEBPACK_IMPORTED_MODULE_1__["normalizeSize"])(newConfig.width);

    if (newConfig.aspectratio) {
      // Silently set width on the model for aspectratio update
      attributes.width = newConfig.width;
      delete newConfig.width;
    } else {
      // Prepare width and height for view.resize()
      newConfig.height = attributes.height;
    }
  } // Call view.resize() for width and height when aspectratio is not defined


  if (newConfig.width && newConfig.height && !newConfig.aspectratio) {
    controller._view.resize(newConfig.width, newConfig.height);
  }

  if (newConfig.floating) {
    var currFloatCfg = model.get('floating') || {};

    var newFloatCfg = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, currFloatCfg, newConfig.floating);

    if (FLOAT_ENUM.indexOf(newFloatCfg.mode) === -1) {
      delete newConfig.floating;
    } else {
      newConfig.floating = newFloatCfg;
    }
  }

  Object.keys(newConfig).forEach(function (field) {
    var newValue = newConfig[field];

    if (newValue === undefined) {
      return;
    }

    switch (field) {
      case 'aspectratio':
        model.set(field, Object(api_config_normalization__WEBPACK_IMPORTED_MODULE_1__["normalizeAspectRatio"])(newValue, attributes.width));
        break;

      case 'autostart':
        setAutoStart(model, controller, newValue);
        break;

      case 'mute':
        controller.setMute(newValue);
        break;

      case 'volume':
        controller.setVolume(newValue);
        break;

      case 'playbackRateControls':
      case 'playbackRates':
      case 'repeat':
      case 'stretching':
      case 'floating':
        model.set(field, newValue);
        break;

      default:
    }
  });
});

/***/ }),

/***/ "./src/js/controller/async-item.ts":
/*!*****************************************!*\
  !*** ./src/js/controller/async-item.ts ***!
  \*****************************************/
/*! exports provided: AsyncItemController */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AsyncItemController", function() { return AsyncItemController; });
/* harmony import */ var playlist_playlist__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! playlist/playlist */ "./src/js/playlist/playlist.js");
/* harmony import */ var api_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! api/errors */ "./src/js/api/errors.ts");
/* harmony import */ var playlist_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! playlist/item */ "./src/js/playlist/item.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }


 // Type only imports



var AsyncItemError = /*#__PURE__*/function (_Error) {
  _inheritsLoose(AsyncItemError, _Error);

  function AsyncItemError(message) {
    var _this;

    _this = _Error.call(this, message) || this;
    _this.code = api_errors__WEBPACK_IMPORTED_MODULE_1__["ASYNC_PLAYLIST_ITEM_REJECTED"];
    return _this;
  }

  return AsyncItemError;
}(_wrapNativeSuper(Error));

var AsyncItemController = /*#__PURE__*/function () {
  function AsyncItemController(index, model, api) {
    var _this2 = this;

    this.index = index;
    this.model = model;
    this.api = api;
    this.promise = new Promise(function (resolve, reject) {
      _this2.resolve = resolve;
      _this2.reject = reject;
    });
    this.async = null;
    this.asyncPromise = null;
    this.rejected = false;
  }

  var _proto = AsyncItemController.prototype;

  _proto.run = function run() {
    var _this3 = this;

    var api = this.api,
        async = this.async,
        index = this.index,
        model = this.model,
        resolve = this.resolve,
        reject = this.reject,
        promise = this.promise;
    var playlist = model.get('playlist');
    var playlistItem = this.getItem(index);

    if (!playlistItem) {
      var message = index === -1 ? 'No recs item' : "No playlist item at index " + index;
      this.rejected = true;
      reject(new Error(message));
    }

    if (async) {
      this.clear();
      var asyncPromise = this.asyncPromise = async.call(api, playlistItem, index);

      if (asyncPromise && asyncPromise.then) {
        asyncPromise.then(function (item) {
          if (item && item !== playlistItem && playlist === model.get('playlist')) {
            var newItem = _this3.replace(item);

            if (newItem) {
              resolve(newItem);
              return;
            }
          }

          resolve(playlistItem);
        }).catch(function (error) {
          var setActiveItemError = new AsyncItemError('Item skipped by playlist item callback');
          setActiveItemError.sourceError = error;
          _this3.rejected = true;
          reject(setActiveItemError);
        });
      } else {
        this.asyncPromise = null;
      }
    }

    if (!this.asyncPromise) {
      resolve(playlistItem);
    }

    return promise;
  };

  _proto.getItem = function getItem(index) {
    var model = this.model;

    if (index === -1) {
      return model.get('nextUp');
    }

    var playlist = model.get('playlist');
    return playlist[index];
  };

  _proto.replace = function replace(item) {
    var index = this.index,
        model = this.model;
    var newItem = Object(playlist_playlist__WEBPACK_IMPORTED_MODULE_0__["normalizePlaylistItem"])(model, new playlist_item__WEBPACK_IMPORTED_MODULE_2__["default"](item), item.feedData || {});

    if (newItem) {
      if (index === -1) {
        model.set('nextUp', newItem);
      } else {
        var playlist = model.get('playlist');
        playlist[index] = newItem;
      }

      return newItem;
    }
  };

  _proto.clear = function clear() {
    this.async = null;
  };

  _createClass(AsyncItemController, [{
    key: "callback",
    set: function set(handler) {
      this.async = handler;
    }
  }, {
    key: "skipped",
    get: function get() {
      return this.rejected;
    }
  }]);

  return AsyncItemController;
}();

/***/ }),

/***/ "./src/js/controller/captions.js":
/*!***************************************!*\
  !*** ./src/js/controller/captions.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var controller_tracks_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! controller/tracks-loader */ "./src/js/controller/tracks-loader.ts");
/* harmony import */ var controller_tracks_helper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! controller/tracks-helper */ "./src/js/controller/tracks-helper.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");





/* Displays closed captions or subtitles on top of the video */

var Captions = function Captions(_model) {
  var _this = this;

  var _tracks = [];
  var _tracksById = {};
  var _unknownCount = 0;
  var _defaultIndex = 0; // Reset and load external captions on playlist item

  _model.on('change:playlistItem', function (model) {
    _tracks = [];
    _tracksById = {};
    _unknownCount = 0; // Update model without dispatching events

    var attributes = model.attributes;
    attributes.captionsIndex = 0;
    attributes.captionsList = _captionsMenu();
    model.set('captionsTrack', null);
  }, this); // Update tracks once we know "renderCaptionsNatively" based on provider


  _model.on('change:itemReady', function () {
    // Sideload tracks when not rendering natively
    var item = _model.get('playlistItem');

    var tracks = item.tracks;
    var len = tracks && tracks.length;

    if (len && !_model.get('renderCaptionsNatively')) {
      var _loop = function _loop(i) {
        /* eslint-disable no-loop-func */
        var track = tracks[i];

        if (!track.includedInManifest && _kindSupported(track.kind) && !_tracksById[track._id]) {
          track.sideloaded = true;

          _addTrack(track);

          Object(controller_tracks_loader__WEBPACK_IMPORTED_MODULE_1__["loadFile"])(track, function (vttCues) {
            _addVTTCuesToTrack(track, vttCues);
          }, function (error) {
            _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["WARNING"], error);
          });
        }
      };

      for (var i = 0; i < len; i++) {
        _loop(i);
      }
    }

    _setCaptionsList();
  }, this); // Listen for captions menu index changes from the view


  _model.on('change:captionsIndex', function (model, captionsMenuIndex) {
    var track = null;

    if (captionsMenuIndex !== 0) {
      track = _tracks[captionsMenuIndex - 1];
    }

    model.set('captionsTrack', track);
  }, this);

  function _setSubtitlesTracks(tracks) {
    if (!Array.isArray(tracks)) {
      return;
    }

    if (!tracks.length) {
      _tracks = [];
      _tracksById = {};
      _unknownCount = 0;
    } else {
      tracks.forEach(function (track) {
        return _addTrack(track);
      }); // Make _tracks order match (video) tracks

      _tracks.sort(function (trackA, trackB) {
        var videoTracksIndexOfA = tracks.indexOf(trackA);

        if (videoTracksIndexOfA === -1) {
          return 1;
        }

        var videoTracksIndexOfB = tracks.indexOf(trackB);

        if (videoTracksIndexOfB === -1) {
          return -1;
        }

        return videoTracksIndexOfA - videoTracksIndexOfB;
      });
    }

    _setCaptionsList();
  }

  function _kindSupported(kind) {
    return kind === 'subtitles' || kind === 'captions';
  }

  function _addVTTCuesToTrack(track, vttCues) {
    track.data = vttCues;
  }

  function _addTrack(track) {
    track.data = track.data || [];
    track.name = track.label || track.name || track.language;
    var id = Object(controller_tracks_helper__WEBPACK_IMPORTED_MODULE_2__["createId"])(track, _tracks.length);

    if (!track.name) {
      var labelInfo = Object(controller_tracks_helper__WEBPACK_IMPORTED_MODULE_2__["createLabel"])(track, _unknownCount);
      track.name = labelInfo.label;
      _unknownCount = labelInfo.unknownCount;
    } // During the same playlist we may re-add tracks with the same _id; allow the new track to replace the old


    track._id = id;
    _tracksById[id] = track;
    _tracks = _tracks.filter(function (tr) {
      return tr._id !== id;
    });

    _tracks.push(track);
  }

  function _captionsMenu() {
    var list = [{
      id: 'off',
      label: 'Off'
    }];

    for (var i = 0; i < _tracks.length; i++) {
      list.push({
        id: _tracks[i]._id,
        label: _tracks[i].name || 'Unknown CC',
        language: _tracks[i].language
      });
    }

    return list;
  }

  function _selectDefaultIndex(defaultIndex) {
    var captionsMenuIndex = _defaultIndex = defaultIndex;

    var label = _model.get('captionLabel'); // Because there is no explicit track for "Off"
    //  it is the implied zeroth track


    if (label === 'Off') {
      _model.set('captionsIndex', 0);

      return;
    }

    for (var i = 0; i < _tracks.length; i++) {
      var track = _tracks[i];

      if (label && label === track.name) {
        captionsMenuIndex = i + 1;
        break;
      } else if (track.default || track.defaulttrack || track._id === 'default') {
        captionsMenuIndex = i + 1;
      } else if (track.autoselect) {// TODO: auto select track by comparing track.language to system lang
      }
    } // set the index without the side effect of storing the Off label in _selectCaptions


    _setCurrentIndex(captionsMenuIndex);
  }

  function _setCurrentIndex(index) {
    if (_tracks.length) {
      _model.setVideoSubtitleTrack(index, _tracks);
    } else {
      _model.set('captionsIndex', index);
    }
  }

  function _setCaptionsList() {
    var captionsList = _captionsMenu();

    if (listIdentity(captionsList) !== listIdentity(_model.get('captionsList'))) {
      _model.set('captionsList', captionsList);

      _selectDefaultIndex(_defaultIndex);
    }
  }

  function listIdentity(list) {
    return list.map(function (item) {
      return item.id + "-" + item.label;
    }).join(',');
  }

  this.setSubtitlesTracks = _setSubtitlesTracks;
  this.selectDefaultIndex = _selectDefaultIndex;

  this.getCurrentIndex = function () {
    return _model.get('captionsIndex');
  };

  this.getCaptionsList = function () {
    return _model.get('captionsList');
  };

  this.destroy = function () {
    this.off(null, null, this);
  };
};

Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(Captions.prototype, utils_backbone_events__WEBPACK_IMPORTED_MODULE_3__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (Captions);

/***/ }),

/***/ "./src/js/controller/controller.js":
/*!*****************************************!*\
  !*** ./src/js/controller/controller.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var api_players__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! api/players */ "./src/js/api/players.js");
/* harmony import */ var api_core_shim__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! api/core-shim */ "./src/js/api/core-shim.js");
/* harmony import */ var api_set_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! api/set-config */ "./src/js/api/set-config.js");
/* harmony import */ var api_api_queue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! api/api-queue */ "./src/js/api/api-queue.ts");
/* harmony import */ var playlist_loader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! playlist/loader */ "./src/js/playlist/loader.ts");
/* harmony import */ var playlist_playlist__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! playlist/playlist */ "./src/js/playlist/playlist.js");
/* harmony import */ var controller_instream_adapter__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! controller/instream-adapter */ "./src/js/controller/instream-adapter.js");
/* harmony import */ var controller_captions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! controller/captions */ "./src/js/controller/captions.js");
/* harmony import */ var controller_model__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! controller/model */ "./src/js/controller/model.ts");
/* harmony import */ var view_view__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! view/view */ "./src/js/view/view.js");
/* harmony import */ var view_view_model__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! view/view-model */ "./src/js/view/view-model.ts");
/* harmony import */ var events_change_state_event__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! events/change-state-event */ "./src/js/events/change-state-event.ts");
/* harmony import */ var controller_events_middleware__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! controller/events-middleware */ "./src/js/controller/events-middleware.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var utils_can_autoplay__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! utils/can-autoplay */ "./src/js/utils/can-autoplay.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! providers/utils/stream-type */ "./src/js/providers/utils/stream-type.ts");
/* harmony import */ var utils_cancelable__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! utils/cancelable */ "./src/js/utils/cancelable.ts");
/* harmony import */ var utils_in_interaction_event__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! utils/in-interaction-event */ "./src/js/utils/in-interaction-event.ts");
/* harmony import */ var model_player_model__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! model/player-model */ "./src/js/model/player-model.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var program_program_controller__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! program/program-controller */ "./src/js/program/program-controller.js");
/* harmony import */ var controller_qoe__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! controller/qoe */ "./src/js/controller/qoe.ts");
/* harmony import */ var program_program_constants__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! program/program-constants */ "./src/js/program/program-constants.ts");
/* harmony import */ var api_errors__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! api/errors */ "./src/js/api/errors.ts");




























 // The model stores a different state than the provider

function normalizeState(newstate) {
  if (newstate === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_LOADING"] || newstate === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_STALLED"]) {
    return events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_BUFFERING"];
  }

  return newstate;
}

var Controller = function Controller() {};

var noop = function noop() {};

if (false) {}

Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(Controller.prototype, {
  setup: function setup(config, _api, originalContainer, eventListeners, commandQueue, mediaPool) {
    var _this2 = this;

    var _this = this;

    var _model = _this._model = new controller_model__WEBPACK_IMPORTED_MODULE_9__["default"]();

    var _view;

    var _captions;

    var _beforePlay = false;

    var _actionOnAttach;

    var _stopPlaylist = false;

    var _interruptPlay;

    var _resumeAfterScrubbing = null;
    var checkAutoStartCancelable = Object(utils_cancelable__WEBPACK_IMPORTED_MODULE_18__["default"])(_checkAutoStart);
    var updatePlaylistCancelable = Object(utils_cancelable__WEBPACK_IMPORTED_MODULE_18__["default"])(noop);
    _this.originalContainer = _this.currentContainer = originalContainer;
    _this._events = eventListeners; // Delegate trigger so we can run a middleware function before any event is bubbled through the API

    _this.trigger = function (type, args) {
      var data = Object(controller_events_middleware__WEBPACK_IMPORTED_MODULE_13__["default"])(_model, type, args);
      return utils_backbone_events__WEBPACK_IMPORTED_MODULE_14__["default"].trigger.call(this, type, data);
    };

    var eventsReadyQueue = new api_api_queue__WEBPACK_IMPORTED_MODULE_4__["default"](_this, ['trigger'], function () {
      return true;
    });

    var _trigger = function _trigger(type, event) {
      _this.trigger(type, event);
    };

    _model.setup(config);

    var _backgroundLoading = _model.get('backgroundLoading');

    if (false) {} else {
      var viewModel = new view_view_model__WEBPACK_IMPORTED_MODULE_11__["default"](_model);
      _view = this._view = new view_view__WEBPACK_IMPORTED_MODULE_10__["default"](_api, viewModel);

      _view.on('all', function (type, event) {
        if (event && event.doNotForward) {
          return;
        }

        _trigger(type, event);
      }, _this);

      viewModel.on('viewSetup', function (viewElement) {
        Object(api_core_shim__WEBPACK_IMPORTED_MODULE_2__["showView"])(_this2, viewElement);
      });
    }

    var _programController = this._programController = new program_program_controller__WEBPACK_IMPORTED_MODULE_22__["default"](_model, mediaPool, _api._publicApi);

    updateProgramSoundSettings();
    addProgramControllerListeners();
    Object(controller_qoe__WEBPACK_IMPORTED_MODULE_23__["default"])(_model, _programController);

    _model.on(events_events__WEBPACK_IMPORTED_MODULE_21__["ERROR"], _this.triggerError, _this);

    _model.on('change:state', function (model, newstate, oldstate) {
      var adState = _getAdState();

      if (!adState) {
        events_change_state_event__WEBPACK_IMPORTED_MODULE_12__["default"].call(_this2, model, newstate, oldstate);
      }
    }, this);

    _model.on('change:castState', function (model, evt) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["CAST_SESSION"], evt);
    });

    _model.on('change:fullscreen', function (model, bool) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["FULLSCREEN"], {
        fullscreen: bool
      });

      if (bool) {
        // Stop autoplay behavior when the player enters fullscreen
        model.set('playOnViewable', false);
      }
    });

    _model.on('change:volume', function (model, vol) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["MEDIA_VOLUME"], {
        volume: vol
      });
    });

    _model.on('change:mute', function (model) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["MEDIA_MUTE"], {
        mute: model.getMute()
      });
    });

    _model.on('change:playbackRate', function (model, rate) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["PLAYBACK_RATE_CHANGED"], {
        playbackRate: rate,
        position: model.get('position')
      });
    });

    var changeReason = function changeReason(model, reason) {
      // Stop autoplay behavior if the video is started by the user or an api call
      if (reason === 'clickthrough' || reason === 'interaction' || reason === 'external') {
        _model.set('playOnViewable', false);

        _model.off('change:playReason change:pauseReason', changeReason);
      }
    };

    _model.on('change:playReason change:pauseReason', changeReason); // Listen for play and pause reasons from instream.


    _this.on(events_events__WEBPACK_IMPORTED_MODULE_21__["AD_PLAY"], function (event) {
      return changeReason(null, event.playReason);
    });

    _this.on(events_events__WEBPACK_IMPORTED_MODULE_21__["AD_PAUSE"], function (event) {
      return changeReason(null, event.pauseReason);
    });

    _model.on('change:scrubbing', function (model, state) {
      if (state) {
        _resumeAfterScrubbing = _model.get('state') !== events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_PAUSED"];

        _pause();
      } else if (_resumeAfterScrubbing) {
        _play({
          reason: 'interaction'
        });
      }
    }); // For onCaptionsList and onCaptionsChange


    _model.on('change:captionsList', function (model, captionsList) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["CAPTIONS_LIST"], {
        tracks: captionsList,
        track: _model.get('captionsIndex') || 0
      });
    });

    _model.on('change:mediaModel', function (model, mediaModel) {
      var _this3 = this;

      model.set('errorEvent', undefined);
      mediaModel.change('mediaState', function (changedMediaModel, state) {
        if (!model.get('errorEvent')) {
          model.set(events_events__WEBPACK_IMPORTED_MODULE_21__["PLAYER_STATE"], normalizeState(state));
        }
      }, this);
      mediaModel.change('duration', function (changedMediaModel, duration) {
        if (duration === 0) {
          return;
        }

        var minDvrWindow = model.get('minDvrWindow');
        var type = Object(providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_17__["streamType"])(duration, minDvrWindow);
        model.setStreamType(type);
      }, this);
      var recsAuto = (model.get('related') || {}).oncomplete === 'autoplay';
      var index = model.get('item') + 1;
      var item = model.get('playlist')[index];

      if (item || recsAuto) {
        var onPosition = function onPosition(changedMediaModel, position) {
          if (recsAuto && !item) {
            index = -1;
            item = _model.get('nextUp');
          } // Do not background load DAI items because that item will be dynamically replaced before play


          var allowPreload = item && !item.daiSetting;

          if (!allowPreload) {
            return;
          }

          var duration = mediaModel.get('duration');

          if (position && duration > 0 && position >= duration - program_program_constants__WEBPACK_IMPORTED_MODULE_24__["BACKGROUND_LOAD_OFFSET"]) {
            mediaModel.off('change:position', onPosition, _this3);

            if (_backgroundLoading) {
              _programController.backgroundLoad(item, index);
            } else {
              _programController.getAsyncItem(index).run();
            }
          }
        };

        mediaModel.on('change:position', onPosition, this);
      }
    }); // Ensure captionsList event is raised after playlistItem


    if (true) {
      _captions = new controller_captions__WEBPACK_IMPORTED_MODULE_8__["default"](_model);

      _captions.on('all', _trigger, _this);
    }

    this.playerReady = function () {
      if (false) {} else {
        // Fire 'ready' once the view has resized so that player width and height are available
        // (requires the container to be in the DOM)
        _view.once(events_events__WEBPACK_IMPORTED_MODULE_21__["RESIZE"], function () {
          try {
            playerReadyNotify();
          } catch (error) {
            _this.triggerError(Object(api_errors__WEBPACK_IMPORTED_MODULE_25__["convertToPlayerError"])(api_errors__WEBPACK_IMPORTED_MODULE_25__["MSG_TECHNICAL_ERROR"], api_errors__WEBPACK_IMPORTED_MODULE_25__["ERROR_COMPLETING_SETUP"], error));
          }
        });

        _view.init();
      }
    };

    function playerReadyNotify() {
      _model.change('visibility', _updateViewable);

      eventsReadyQueue.off(); // Tell the api that we are loaded

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["READY"], {
        // this will be updated by Api
        setupTime: 0
      });

      _model.change('playlist', function (model, playlist) {
        if (playlist.length) {
          var eventData = {
            playlist: playlist
          };

          var feedData = _model.get('feedData');

          if (feedData) {
            eventData.feedData = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, feedData);
          }

          _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["PLAYLIST_LOADED"], eventData);
        }
      });

      _model.change('playlistItem', function (model, playlistItem) {
        if (playlistItem) {
          var title = playlistItem.title,
              image = playlistItem.image;

          if ('mediaSession' in navigator && window.MediaMetadata && (title || image)) {
            try {
              navigator.mediaSession.metadata = new window.MediaMetadata({
                title: title,
                artist: window.location.hostname,
                artwork: [{
                  src: image || ''
                }]
              });
            } catch (error) {// catch error that occurs when mediaSession fails to setup
            }
          }

          model.set('cues', []);

          _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["PLAYLIST_ITEM"], {
            index: _model.get('item'),
            item: playlistItem
          });
        }
      });

      eventsReadyQueue.flush();
      eventsReadyQueue.destroy();
      eventsReadyQueue = null;

      _model.change('viewable', viewableChange);

      _model.change('viewable', _checkPlayOnViewable);

      if (_model.get('autoPause').viewability) {
        _model.change('viewable', _checkPauseOnViewable);
      } else {
        _model.once('change:autostartFailed change:mute', function (model) {
          model.off('change:viewable', _checkPlayOnViewable);
        });
      } // Run _checkAutoStart() last
      // 'viewable' changes can result in preload() being called on the initial provider instance


      _checkAutoStart();

      _model.on('change:itemReady', function (changeModel, itemReady) {
        if (itemReady) {
          apiQueue.flush();
        }
      });
    }

    function _updateViewable(model, visibility) {
      if (!Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isUndefined"])(visibility)) {
        _model.set('viewable', Math.round(visibility));
      }
    }

    function _checkAutoStart() {
      if (!apiQueue) {
        // this player has been destroyed
        return;
      } // Autostart immediately if we're not waiting for the player to become viewable first.


      if (_model.get('autostart') === true && !_model.get('playOnViewable')) {
        _autoStart('autostart');
      }

      apiQueue.flush();
    }

    function viewableChange(model, viewable) {
      _this.trigger('viewable', {
        viewable: viewable
      });

      preload();
    }

    function preload() {
      // Only attempt to preload if this is the first player on the page or viewable
      if (api_players__WEBPACK_IMPORTED_MODULE_1__["default"][0] !== _api && _model.get('viewable') !== 1) {
        return;
      }

      if (_model.get('state') === 'idle' && _model.get('autostart') === false) {
        // If video has not been primed on Android, test that video will play before preloading
        // This ensures we always prime the tag on play when necessary
        if ( true && !mediaPool.primed() && environment_environment__WEBPACK_IMPORTED_MODULE_16__["OS"].android) {
          var video = mediaPool.getTestElement();

          var muted = _this.getMute();

          Promise.resolve().then(function () {
            return Object(utils_can_autoplay__WEBPACK_IMPORTED_MODULE_15__["startPlayback"])(video, {
              muted: muted
            });
          }).then(function () {
            if (_model.get('state') === 'idle') {
              _programController.preloadVideo();
            }
          }).catch(noop);
        } else {
          _programController.preloadVideo();
        }
      }
    }

    function _pauseAfterAd(viewable) {
      _this._instreamAdapter.noResume = !viewable;

      if (!viewable) {
        _updatePauseReason({
          reason: 'viewable'
        });
      }
    }

    function _pauseWhenNotViewable(viewable) {
      if (!viewable) {
        _this.pause({
          reason: 'viewable'
        });

        _model.set('playOnViewable', !viewable);
      }
    }

    function _checkPlayOnViewable(model, viewable) {
      var adState = _getAdState();

      if (model.get('playOnViewable')) {
        if (viewable) {
          var reason = 'viewable';
          var autoPauseAds = model.get('autoPause').pauseAds;
          var pauseReason = model.get('pauseReason');

          if (_getState() === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_IDLE"]) {
            _autoStart(reason);
          } else if ((!adState || autoPauseAds) && pauseReason !== 'interaction') {
            // resume normal playback or ads if pauseAds is true
            _play({
              reason: reason
            });
          }
        } else if (environment_environment__WEBPACK_IMPORTED_MODULE_16__["OS"].mobile && !adState) {
          _this.pause({
            reason: 'autostart'
          });

          _model.set('playOnViewable', true);
        }

        if (environment_environment__WEBPACK_IMPORTED_MODULE_16__["OS"].mobile && adState) {
          // If during an ad on mobile, we should always be paused after the ad,
          // if not viewable, regardless of autoPause setting.
          _pauseAfterAd(viewable);
        }
      }
    }

    function _checkPauseOnViewable(model, viewable) {
      var playerState = model.get('state');

      var adState = _getAdState();

      var playReason = model.get('playReason');

      if (adState) {
        if (model.get('autoPause').pauseAds) {
          _pauseWhenNotViewable(viewable);
        } else {
          _pauseAfterAd(viewable);
        }
      } else if (playerState === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_PLAYING"] || playerState === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_BUFFERING"]) {
        _pauseWhenNotViewable(viewable);
      } else if (playerState === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_IDLE"] && playReason === 'playlist') {
        // After VAST ads, instream is destroyed and player state is 'idle'
        model.once('change:state', function () {
          _pauseWhenNotViewable(viewable);
        });
      }
    }

    function _load(item, feedData) {
      var instream = _this._instreamAdapter;

      if (instream) {
        instream.noResume = true;
      }

      _this.trigger('destroyPlugin', {});

      _stop(true);

      _programController.clearItemPromises();

      checkAutoStartCancelable.cancel();
      checkAutoStartCancelable = Object(utils_cancelable__WEBPACK_IMPORTED_MODULE_18__["default"])(_checkAutoStart);
      updatePlaylistCancelable.cancel();

      if (Object(utils_in_interaction_event__WEBPACK_IMPORTED_MODULE_19__["inInteraction"])()) {
        mediaPool.prime();
      }

      var loadPromise;

      switch (typeof item) {
        case 'string':
          {
            _model.attributes.item = 0;
            _model.attributes.itemReady = false;
            updatePlaylistCancelable = Object(utils_cancelable__WEBPACK_IMPORTED_MODULE_18__["default"])(function (data) {
              if (data) {
                return _this.updatePlaylist(Object(playlist_playlist__WEBPACK_IMPORTED_MODULE_6__["default"])(data.playlist), data);
              }
            });
            loadPromise = _loadPlaylist(item).then(updatePlaylistCancelable.async);
            break;
          }

        case 'object':
          _model.attributes.item = 0;
          loadPromise = _this.updatePlaylist(Object(playlist_playlist__WEBPACK_IMPORTED_MODULE_6__["default"])(item), feedData || {});
          break;

        case 'number':
          loadPromise = _this.setItemIndex(item);
          break;

        default:
          return;
      } // Catch playlist exceptions. Item exceptions are caught first from setActiveItem.


      loadPromise.catch(function (error) {
        _this.triggerError(Object(api_errors__WEBPACK_IMPORTED_MODULE_25__["composePlayerError"])(error, api_errors__WEBPACK_IMPORTED_MODULE_25__["ERROR_LOADING_PLAYLIST"]));
      });
      loadPromise.then(checkAutoStartCancelable.async).catch(noop);
    }

    function _loadPlaylist(toLoad) {
      var _this4 = this;

      return new Promise(function (resolve, reject) {
        var loader = new playlist_loader__WEBPACK_IMPORTED_MODULE_5__["default"]();
        loader.on(events_events__WEBPACK_IMPORTED_MODULE_21__["PLAYLIST_LOADED"], function (data) {
          resolve(data);
        });
        loader.on(events_events__WEBPACK_IMPORTED_MODULE_21__["ERROR"], reject, _this4);
        loader.load(toLoad);
      });
    }

    function _getAdState() {
      var instream = _this._instreamAdapter;

      if (instream) {
        return instream.getState();
      }

      return false;
    }

    function _getState() {
      var adState = _getAdState();

      if (adState) {
        return adState;
      }

      return _model.get('state');
    }

    function _play(meta) {
      checkAutoStartCancelable.cancel();
      _stopPlaylist = false;

      if (_model.get('state') === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_ERROR"]) {
        return Promise.resolve();
      }

      var playReason = _getReason(meta);

      _model.set('playReason', playReason);

      var adState = _getAdState();

      if (adState) {
        // this will resume the ad. _api.playAd would load a new ad
        _api.pauseAd(false, meta);

        return Promise.resolve();
      }

      if (_model.get('state') === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_COMPLETE"]) {
        _stop(true);

        return _this.setItemIndex(0).then(function () {
          return _playAttempt(meta, playReason);
        });
      }

      return _playAttempt(meta, playReason);
    }

    function _playAttempt(meta, playReason) {
      if (!_beforePlay) {
        _beforePlay = true;

        _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["MEDIA_BEFOREPLAY"], {
          playReason: playReason,
          startTime: meta && meta.startTime ? meta.startTime : _model.get('playlistItem').starttime
        });

        _beforePlay = false;

        if (Object(utils_in_interaction_event__WEBPACK_IMPORTED_MODULE_19__["inInteraction"])() && !mediaPool.primed()) {
          mediaPool.prime();
        }

        if (playReason === 'playlist' && _model.get('autoPause').viewability) {
          _checkPauseOnViewable(_model, _model.get('viewable'));
        }

        if (_interruptPlay) {
          // Force tags to prime if we're about to play an ad
          // Resetting the source in order to prime is OK since we'll be switching it anyway
          if (Object(utils_in_interaction_event__WEBPACK_IMPORTED_MODULE_19__["inInteraction"])() && !_backgroundLoading) {
            var video = _model.get('mediaElement');

            if (_this._instreamAdapter) {
              video.src = '';
            }

            video.load();
          }

          _interruptPlay = false;
          _actionOnAttach = null;
          return Promise.resolve();
        }
      }

      return _programController.playVideo(playReason) // If playback succeeded that means we captured a gesture (and used it to prime the pool)
      // Avoid priming again in beforePlay because it could cause BGL'd media to be source reset
      .then(mediaPool.played);
    }

    function _getReason(meta) {
      if (meta && meta.reason) {
        return meta.reason;
      }

      return 'unknown';
    }

    function _autoStart(reason) {
      var state = _getState();

      if (state !== events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_IDLE"]) {
        return;
      } // Reset cancelable for new autoplay test below.


      checkAutoStartCancelable = Object(utils_cancelable__WEBPACK_IMPORTED_MODULE_18__["default"])(_checkAutoStart); // Detect and store browser autoplay setting in the model.

      var adConfig = _model.get('advertising');

      var autoPlayCheck =  false ? undefined : utils_can_autoplay__WEBPACK_IMPORTED_MODULE_15__["canAutoplay"];
      autoPlayCheck(mediaPool, {
        cancelable: checkAutoStartCancelable,
        muted: _this.getMute(),
        allowMuted: adConfig ? adConfig.autoplayadsmuted : true
      }).then(function (result) {
        _model.set('canAutoplay', result); // Only apply autostartMuted on un-muted autostart attempt.


        if (result === ( false || utils_can_autoplay__WEBPACK_IMPORTED_MODULE_15__["AUTOPLAY_MUTED"]) && !_this.getMute()) {
          _model.set('autostartMuted', true);

          updateProgramSoundSettings();

          _model.once('change:autostartMuted', function (model) {
            model.off('change:viewable', _checkPlayOnViewable);

            _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["MEDIA_MUTE"], {
              mute: _model.getMute()
            });
          });
        }

        if (_captions && _this.getMute() && _model.get('enableDefaultCaptions')) {
          _captions.selectDefaultIndex(1);
        }

        return _play({
          reason: reason
        }).catch(function () {
          if (!_this._instreamAdapter) {
            _model.set('autostartFailed', true);
          }

          _actionOnAttach = null;
        });
      }).catch(function (error) {
        _model.set('canAutoplay',  false || utils_can_autoplay__WEBPACK_IMPORTED_MODULE_15__["AUTOPLAY_DISABLED"]);

        _model.set('autostart', false); // Emit event unless test was explicitly canceled.


        if (!checkAutoStartCancelable.cancelled()) {
          var code = Object(api_errors__WEBPACK_IMPORTED_MODULE_25__["getPlayAttemptFailedErrorCode"])(error);

          _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["AUTOSTART_NOT_ALLOWED"], {
            reason: error.reason,
            code: code,
            error: error
          });
        }
      });
    }

    function _stop(internal) {
      checkAutoStartCancelable.cancel();
      apiQueue.empty();

      var adState = _getAdState();

      if (adState) {
        var instream = _this._instreamAdapter;

        if (instream) {
          instream.noResume = true;
        }

        _actionOnAttach = function _actionOnAttach() {
          return _programController.stopVideo();
        };

        return;
      }

      var fromApi = !internal;
      _actionOnAttach = null;

      if (fromApi) {
        _stopPlaylist = true;
      }

      if (_beforePlay) {
        _interruptPlay = true;
      }

      _model.set('errorEvent', undefined);

      _programController.stopVideo();
    }

    function _updatePauseReason(meta) {
      var pauseReason = _getReason(meta);

      _model.set('pauseReason', pauseReason);

      _model.set('playOnViewable', pauseReason === 'viewable');
    }

    function _pause(meta) {
      _actionOnAttach = null;
      checkAutoStartCancelable.cancel();

      var adState = _getAdState();

      if (adState && adState !== events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_PAUSED"]) {
        _updatePauseReason(meta);

        _api.pauseAd(true, meta);

        return;
      }

      switch (_model.get('state')) {
        case events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_ERROR"]:
          return;

        case events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_PLAYING"]:
        case events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_BUFFERING"]:
          {
            _updatePauseReason(meta);

            _programController.pause();

            break;
          }

        default:
          if (_beforePlay) {
            _interruptPlay = true;
          }

      }
    }

    function _isIdle() {
      var state = _model.get('state');

      return state === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_IDLE"] || state === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_COMPLETE"] || state === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_ERROR"];
    }

    function _seek(pos, meta) {
      var state = _model.get('state');

      if (state === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_ERROR"]) {
        return;
      }

      _programController.position = pos;
      var isIdle = state === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_IDLE"];

      if (!_model.get('scrubbing') && (isIdle || state === events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_COMPLETE"])) {
        if (isIdle) {
          meta = meta || {};
          meta.startTime = pos;
        }

        this.play(meta);
      }
    }

    function _item(index, meta) {
      _this.instreamDestroy();

      _stop(true);

      _this.setItemIndex(index); // Use this.play() so that command is queued until after "playlistItem" event


      _this.play(meta);
    }

    function _prev(meta) {
      _item(_model.get('item') - 1, meta);
    }

    function _next(meta) {
      _item(_model.get('item') + 1, meta);
    }

    function _completeCancelled() {
      if (!_isIdle()) {
        // Something has made an API call before the complete handler has fired.
        return true;
      } else if (_stopPlaylist) {
        // Stop called in onComplete event listener
        _stopPlaylist = false;
        return true;
      }

      return false;
    }

    function _shouldAutoAdvance() {
      // If it's the last item in the playlist
      var idx = _model.get('item');

      return idx !== _model.get('playlist').length - 1;
    }

    function _completeHandler() {
      if (_this.completeCancelled()) {
        return;
      }

      _actionOnAttach = _this.completeHandler;

      if (!_this.shouldAutoAdvance()) {
        if (_model.get('repeat')) {
          _next({
            reason: 'repeat'
          });
        } else {
          // Exit fullscreen on IOS so that our overlays show to the user
          if (environment_environment__WEBPACK_IMPORTED_MODULE_16__["OS"].iOS) {
            _setFullscreen(false);
          } // Autoplay/pause no longer needed since there's no more media to play
          // This prevents media from replaying when a completed video scrolls into view


          _model.set('playOnViewable', false);

          _model.set('state', events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_COMPLETE"]);

          _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["PLAYLIST_COMPLETE"], {});
        }

        return;
      }

      _this.nextItem();
    }

    function _setCurrentQuality(index) {
      _programController.quality = index;
    }

    function _getCurrentQuality() {
      return _programController.quality;
    }

    function _getConfig() {
      return this._model ? this._model.getConfiguration() : undefined;
    }

    function _getVisualQuality() {
      var mediaModel = this._model.get('mediaModel');

      if (mediaModel) {
        return mediaModel.get(events_events__WEBPACK_IMPORTED_MODULE_21__["MEDIA_VISUAL_QUALITY"]);
      }

      return null;
    }

    function _getQualityLevels() {
      return _programController.qualities;
    }

    function _setCurrentAudioTrack(index) {
      _programController.audioTrack = index;
    }

    function _getCurrentAudioTrack() {
      return _programController.audioTrack;
    }

    function _getAudioTracks() {
      return _programController.audioTracks;
    }

    function _setCurrentCaptions(index, tracks) {
      index = parseInt(index, 10) || 0;

      _model.persistVideoSubtitleTrack(index, tracks);

      _programController.subtitles = index;

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["CAPTIONS_CHANGED"], {
        tracks: _getCaptionsList(),
        track: index
      });
    }

    function _getCurrentCaptions() {
      return _captions ? _captions.getCurrentIndex() : -1;
    }

    function _getCaptionsList() {
      return _captions ? _captions.getCaptionsList() : [];
    }
    /* Used for the InStream API */


    function _detachMedia() {
      if (_beforePlay) {
        _interruptPlay = true;
      }

      if (_model.get('autoPause').viewability) {
        _checkPauseOnViewable(_model, _model.get('viewable'));
      }

      if (_backgroundLoading) {
        _programController.backgroundActiveMedia();
      } else {
        return _programController.setAttached(false);
      }
    }

    function _attachMedia() {
      // Called after instream ends
      if (_backgroundLoading) {
        _programController.restoreBackgroundMedia();
      } else {
        _programController.setAttached(true);
      }

      if (typeof _actionOnAttach === 'function') {
        _actionOnAttach();
      }
    }

    function _setFullscreen(state) {
      if (!Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isBoolean"])(state)) {
        state = !_model.get('fullscreen');
      } // TODO: rather than the player responding to this state change this should be view / provider based with
      //  Promise resolution for modern browsers


      _model.set('fullscreen', state);

      if (_this._instreamAdapter && _this._instreamAdapter._adModel) {
        _this._instreamAdapter._adModel.set('fullscreen', state);
      }
    }

    function addProgramControllerListeners() {
      _programController.on('all', _trigger, _this).on('subtitlesTracks', function (e) {
        if (!_captions) {
          return;
        }

        _captions.setSubtitlesTracks(e.tracks);

        var defaultCaptionsIndex = _captions.getCurrentIndex(); // set the current captions if the default index isn't 0 or "Off"


        if (defaultCaptionsIndex > 0) {
          _setCurrentCaptions(defaultCaptionsIndex, e.tracks);
        }
      }, _this).on(events_events__WEBPACK_IMPORTED_MODULE_21__["MEDIA_COMPLETE"], function () {
        // Insert a small delay here so that other complete handlers can execute
        Promise.resolve().then(_completeHandler);
      }, _this).on(events_events__WEBPACK_IMPORTED_MODULE_21__["MEDIA_ERROR"], _this.triggerError, _this);
    }

    function updateProgramSoundSettings() {
      _programController.setMute(_model.getMute());

      _programController.setVolume(_model.get('volume'));
    }

    this.preload = preload;
    /* Controller API / public methods */

    this.load = _load;

    this.play = function (meta) {
      return _play(meta).catch(noop);
    };

    this.pause = _pause;
    this.seek = _seek;
    this.stop = _stop;
    this.playlistItem = _item;
    this.playlistNext = _next;
    this.playlistPrev = _prev;
    this.setCurrentCaptions = _setCurrentCaptions;
    this.setCurrentQuality = _setCurrentQuality;
    this.setFullscreen = _setFullscreen;
    this.getCurrentQuality = _getCurrentQuality;
    this.getQualityLevels = _getQualityLevels;
    this.setCurrentAudioTrack = _setCurrentAudioTrack;
    this.getCurrentAudioTrack = _getCurrentAudioTrack;
    this.getAudioTracks = _getAudioTracks;
    this.getCurrentCaptions = _getCurrentCaptions;
    this.getCaptionsList = _getCaptionsList;
    this.getVisualQuality = _getVisualQuality;
    this.getConfig = _getConfig;
    this.getState = _getState;
    this.next = noop;
    this.completeHandler = _completeHandler;
    this.completeCancelled = _completeCancelled;
    this.shouldAutoAdvance = _shouldAutoAdvance;

    this.nextItem = function () {
      _next({
        reason: 'playlist'
      });
    };

    this.setConfig = function (newConfig) {
      Object(api_set_config__WEBPACK_IMPORTED_MODULE_3__["default"])(_this, newConfig);
    };

    this.setItemIndex = function (index) {
      _programController.stopVideo();

      var playlist = _model.get('playlist');

      var length = playlist.length;
      var wrappedIndex = Object(playlist_playlist__WEBPACK_IMPORTED_MODULE_6__["wrapPlaylistIndex"])(index, length);
      return _programController.setActiveItem(wrappedIndex).catch(function (error) {
        if (error.code === api_errors__WEBPACK_IMPORTED_MODULE_25__["ASYNC_PLAYLIST_ITEM_REJECTED"]) {
          // If all items were rejected throw. This will fail setup with setupError code 102700
          var allSkipped = _programController.asyncItems.reduce(function (skipped, asyncItem) {
            return skipped && asyncItem.skipped;
          }, true);

          if (allSkipped) {
            throw error;
          } // If the last item is rejected we need to stop and complete playlist playback. Otherwise,
          // shouldAutoAdvance will return true because "nextUp" is out of date.
          // "related could not update "nextUp" since we've skipped over "playlistItem" events.
          // We'll need to move "nextUp" logic out of "related" and into here or the program-controller
          // So that "nextUp" can be updated when rejecting item playback with `setPlaylistItemCallback`.


          var restoreAutoAdvance = _this2.shouldAutoAdvance;

          _this2.shouldAutoAdvance = function () {
            return false;
          };

          _completeHandler();

          _model.attributes.itemReady = true;
          _this2.shouldAutoAdvance = restoreAutoAdvance;
          return;
        }

        if (error.code >= 151 && error.code <= 162) {
          error = Object(api_errors__WEBPACK_IMPORTED_MODULE_25__["composePlayerError"])(error, api_errors__WEBPACK_IMPORTED_MODULE_25__["ERROR_LOADING_PROVIDER"]);
        }

        _this2.triggerError(Object(api_errors__WEBPACK_IMPORTED_MODULE_25__["convertToPlayerError"])(api_errors__WEBPACK_IMPORTED_MODULE_25__["MSG_CANT_PLAY_VIDEO"], api_errors__WEBPACK_IMPORTED_MODULE_25__["ERROR_LOADING_PLAYLIST_ITEM"], error));
      });
    };

    this.detachMedia = _detachMedia;
    this.attachMedia = _attachMedia; // Program Controller passthroughs

    this.routeEvents = function (target) {
      return _programController.routeEvents(target);
    };

    this.forwardEvents = function () {
      return _programController.forwardEvents();
    };

    this.playVideo = function (playReason) {
      return _programController.playVideo(playReason);
    };

    this.stopVideo = function () {
      return _programController.stopVideo();
    };

    this.castVideo = function (castProvider, item) {
      return _programController.castVideo(castProvider, item);
    };

    this.stopCast = function () {
      return _programController.stopCast();
    };

    this.backgroundActiveMedia = function () {
      return _programController.backgroundActiveMedia();
    };

    this.restoreBackgroundMedia = function () {
      return _programController.restoreBackgroundMedia();
    };

    this.preloadNextItem = function () {
      if (_programController.background.currentMedia) {
        // Instruct the background media to preload if it's already been loaded
        _programController.preloadVideo();
      }
    };

    this.isBeforeComplete = function () {
      return _programController.beforeComplete;
    }; // Model passthroughs


    this.setVolume = function (volume) {
      _model.setVolume(volume);

      updateProgramSoundSettings();
    };

    this.setMute = function (mute) {
      _model.setMute(mute);

      updateProgramSoundSettings();
    };

    this.setPlaybackRate = function (playbackRate) {
      _model.setPlaybackRate(playbackRate);
    };

    this.getProvider = function () {
      return _model.get('provider');
    };

    this.getWidth = function () {
      return _model.get('containerWidth');
    };

    this.getHeight = function () {
      return _model.get('containerHeight');
    };

    this.getItemQoe = function () {
      return _model._qoeItem;
    };

    this.setItemCallback = function (callback) {
      _programController.itemCallback = callback;
    };

    this.getItemPromise = function (index) {
      var playlist = _model.get('playlist');

      if (index < -1 || index > playlist.length - 1 || isNaN(index)) {
        return null;
      }

      var asyncItem = _programController.getAsyncItem(index);

      if (!asyncItem) {
        return null;
      }

      return asyncItem.promise;
    };

    this.addButton = function (img, tooltip, callback, id, btnClass) {
      var customButtons = _model.get('customButtons') || [];
      var replaced = false;
      var newButton = {
        img: img,
        tooltip: tooltip,
        callback: callback,
        id: id,
        btnClass: btnClass
      };
      customButtons = customButtons.reduce(function (buttons, button) {
        if (button.id === id) {
          replaced = true;
          buttons.push(newButton);
        } else {
          buttons.push(button);
        }

        return buttons;
      }, []);

      if (!replaced) {
        customButtons.unshift(newButton);
      }

      _model.set('customButtons', customButtons);
    };

    this.removeButton = function (id) {
      var customButtons = _model.get('customButtons') || [];
      customButtons = customButtons.filter(function (button) {
        return button.id !== id;
      });

      _model.set('customButtons', customButtons);
    }; // View passthroughs


    if (false) {} else {
      this.resize = _view.resize;
      this.getSafeRegion = _view.getSafeRegion;
      this.setCaptions = _view.setCaptions;
    }

    this.checkBeforePlay = function () {
      return _beforePlay;
    };

    this.setControls = function (mode) {
      if (false) {}

      if (!Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isBoolean"])(mode)) {
        mode = !_model.get('controls');
      }

      _model.set('controls', mode);

      _programController.controls = mode;
    };

    this.addCues = function (cues) {
      this.setCues(_model.get('cues').concat(cues));
    };

    this.setCues = function (cues) {
      _model.set('cues', cues);
    };

    this.updatePlaylist = function (playlist, feedData) {
      try {
        var filteredPlaylist = Object(playlist_playlist__WEBPACK_IMPORTED_MODULE_6__["filterPlaylist"])(playlist, _model, feedData); // Throw exception if playlist is empty

        Object(playlist_playlist__WEBPACK_IMPORTED_MODULE_6__["validatePlaylist"])(filteredPlaylist);

        var sanitizedFeedData = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, feedData);

        delete sanitizedFeedData.playlist;

        _model.set('feedData', sanitizedFeedData);

        _model.set('playlist', filteredPlaylist);
      } catch (error) {
        return Promise.reject(error);
      }

      return this.setItemIndex(_model.get('item'));
    };

    this.setPlaylistItem = function (index, item) {
      var playlist = _model.get('playlist');

      var wrappedIndex = Object(playlist_playlist__WEBPACK_IMPORTED_MODULE_6__["wrapPlaylistIndex"])(index, playlist.length);

      var asyncItemController = _programController.getAsyncItem(wrappedIndex);

      var newItem = asyncItemController.replace(item);

      if (!newItem) {
        return;
      }

      var playlistItem = playlist[wrappedIndex];

      if (item && item !== playlistItem) {
        _programController.asyncItems[wrappedIndex] = null;
        asyncItemController.reject(new Error('Item replaced'));
      } // If the current item was replaced, and the player is idle, reload it


      if (wrappedIndex === _model.get('item') && _model.get('state') === 'idle') {
        this.setItemIndex(wrappedIndex);
      }
    };

    this.playerDestroy = function () {
      this.off();
      this.stop();
      Object(api_core_shim__WEBPACK_IMPORTED_MODULE_2__["showView"])(this, this.originalContainer);

      if (_view) {
        _view.destroy();
      }

      if (_model) {
        _model.destroy();
      }

      if (apiQueue) {
        apiQueue.destroy();
      }

      if (_captions) {
        _captions.destroy();
      }

      if (_programController) {
        _programController.destroy();
      }

      this.instreamDestroy();
    };

    this.isBeforePlay = this.checkBeforePlay;

    this.createInstream = function () {
      this.instreamDestroy();
      this._instreamAdapter = new controller_instream_adapter__WEBPACK_IMPORTED_MODULE_7__["default"](this, _model, _view, mediaPool);
      return this._instreamAdapter;
    };

    this.instreamDestroy = function () {
      if (_this._instreamAdapter) {
        _this._instreamAdapter.destroy();

        _this._instreamAdapter = null;
      }
    }; // Setup ApiQueueDecorator after instance methods have been assigned


    var apiQueue = new api_api_queue__WEBPACK_IMPORTED_MODULE_4__["default"](this, ['play', 'pause', 'setCurrentAudioTrack', 'setCurrentCaptions', 'setCurrentQuality', 'setFullscreen'], function () {
      return !_this2._model.get('itemReady') || eventsReadyQueue;
    }); // Add commands from CoreLoader to queue

    apiQueue.queue.push.apply(apiQueue.queue, commandQueue);

    if (_view) {
      _view.setup();
    }
  },
  get: function get(property) {
    if (property in model_player_model__WEBPACK_IMPORTED_MODULE_20__["INITIAL_MEDIA_STATE"]) {
      var mediaModel = this._model.get('mediaModel');

      if (mediaModel) {
        return mediaModel.get(property);
      }

      return model_player_model__WEBPACK_IMPORTED_MODULE_20__["INITIAL_MEDIA_STATE"][property];
    }

    return this._model.get(property);
  },
  getContainer: function getContainer() {
    return this.currentContainer || this.originalContainer;
  },
  getMute: function getMute() {
    return this._model.getMute();
  },
  triggerError: function triggerError(evt) {
    var model = this._model;
    evt.message = model.get('localization').errors[evt.key];
    delete evt.key;
    model.set('errorEvent', evt);
    model.set('state', events_events__WEBPACK_IMPORTED_MODULE_21__["STATE_ERROR"]);
    model.once('change:state', function () {
      this.set('errorEvent', undefined);
    }, model);
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_21__["ERROR"], evt);
  }
});

/* harmony default export */ __webpack_exports__["default"] = (Controller);

/***/ }),

/***/ "./src/js/controller/events-middleware.ts":
/*!************************************************!*\
  !*** ./src/js/controller/events-middleware.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return middleware; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");

function middleware(model, type, currentState) {
  var newState = currentState;

  switch (type) {
    case 'time':
    case 'beforePlay':
    case 'pause':
    case 'play':
    case 'ready':
      {
        var viewable = model.get('viewable'); // Don't add viewable to events if we don't know we're viewable

        if (viewable !== undefined) {
          // Emit viewable as 0 or 1
          newState = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, currentState, {
            viewable: viewable
          });
        }

        break;
      }

    default:
      {
        break;
      }
  }

  return newState;
}

/***/ }),

/***/ "./src/js/controller/instream-adapter.js":
/*!***********************************************!*\
  !*** ./src/js/controller/instream-adapter.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var _program_program_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../program/program-constants */ "./src/js/program/program-constants.ts");
/* harmony import */ var utils_strings__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/strings */ "./src/js/utils/strings.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var program_ad_program_controller__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! program/ad-program-controller */ "./src/js/program/ad-program-controller.js");









var _defaultOptions = {
  skipoffset: null,
  tag: null
};
/**
 * InstreamAdapter JW Player instream API. Instantiated via jwplayer().createInstream(). Only one instance can be
 * created per player. It is destroyed via jwplayer().instreamDestroy().
 * @param {Controller} _controller - The player controller instance
 * @param {Model} _model - The player model instance
 * @param {View} _view - The player view instance
 * @param {MediaPool} _mediaPool - The player media pool
 * @constructor
 */

var InstreamAdapter = function InstreamAdapter(_controller, _model, _view, _mediaPool) {
  var _this2 = this;

  var _this = this;

  var _adProgram = new program_ad_program_controller__WEBPACK_IMPORTED_MODULE_5__["default"](_model, _mediaPool);

  var _array;

  var _arrayOptions;

  var _arrayIndex = 0;
  var _data = {};
  var _detachPromise = null;
  var _options = {};
  var _skipAd = _instreamItemNext;
  var _backgroundLoadTriggered = false;

  var _skipOffset;

  var _backgroundLoadStart;

  var _destroyed = false;
  var _inited = false;
  var _beforeComplete = false;

  var _clickHandler = function _clickHandler(evt) {
    if (_destroyed) {
      return;
    }

    evt = evt || {};
    evt.hasControls = !!_model.get('controls');

    _this2.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["INSTREAM_CLICK"], evt); // toggle playback after click event


    if (_adProgram.model.get('state') === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PAUSED"]) {
      if (evt.hasControls) {
        _adProgram.playVideo().catch(function () {});
      }
    } else {
      _adProgram.pause();
    }
  };

  var _doubleClickHandler = function _doubleClickHandler() {
    if (_destroyed) {
      return;
    }

    if (_adProgram.model.get('state') === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PAUSED"]) {
      if (_model.get('controls')) {
        _controller.setFullscreen();

        _controller.play();
      }
    }
  };
  /**
   * Put the player in instream ads mode, detaching media, and preparing the ad program for
   * instream playback
   * @return {InstreamAdapter} - chainable
   */


  this.init = function () {
    if (_inited || _destroyed) {
      return;
    }

    _inited = true;
    _data = {}; // Keep track of the original player state

    _adProgram.setup();

    _adProgram.on('all', _instreamForward, this);

    _adProgram.on(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_PLAY_ATTEMPT_FAILED"], triggerPlayRejected, this);

    _adProgram.on(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_TIME"], _instreamTime, this);

    _adProgram.on(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_COMPLETE"], _instreamItemComplete, this);

    _adProgram.on(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_META"], _instreamMeta, this);

    _adProgram.on(events_events__WEBPACK_IMPORTED_MODULE_1__["PLAYER_STATE"], _handleStateChange, this); // Make sure the original player's provider stops broadcasting events (pseudo-lock...)


    _detachPromise = _controller.detachMedia();

    if (true) {
      var mediaElement = _adProgram.primedElement;

      var mediaContainer = _model.get('mediaContainer');

      mediaContainer.appendChild(mediaElement);
    } // This enters the player into instream mode


    _model.set('instream', _adProgram);

    _adProgram.model.set('state', events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_BUFFERING"]); // don't trigger api play/pause on display click


    if (_view) {
      var clickHandler = _view.clickHandler();

      if (clickHandler) {
        clickHandler.setAlternateClickHandlers(function () {}, null);
      }
    }

    this.setText(_model.get('localization').loadingAd); // We need to know if we're beforeComplete before we reattach, since re-attaching will toggle the beforeComplete flag back if set

    _beforeComplete = _controller.isBeforeComplete() || _model.get('state') === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_COMPLETE"];
    return this;
  };
  /**
   * Put the player in SSAI ad mode. Detaches media listeners
   * to prevent player events from being triggered during a break.
   * @param {string} clickThroughUrl - Url to open on click while playing
   * @return {InstreamAdapter} - chainable
   */


  this.enableAdsMode = function (clickThroughUrl) {
    var _this3 = this;

    if (_inited || _destroyed) {
      return;
    } // Forward current provider events through instream


    _controller.routeEvents({
      mediaControllerListener: function mediaControllerListener(type, data) {
        _this3.trigger(type, data);
      }
    });

    _model.set('instream', _adProgram);

    _adProgram.model.set('state', events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PLAYING"]);

    _addClickHandler(clickThroughUrl);

    return this;
  };

  function _addClickHandler(clickThroughUrl) {
    if (!_view) {
      return;
    } // don't trigger api play/pause on display click


    var clickHandler = _view.clickHandler();

    if (clickHandler) {
      clickHandler.setAlternateClickHandlers(function (evt) {
        if (_destroyed) {
          return;
        }

        evt = evt || {};
        evt.hasControls = !!_model.get('controls');

        _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["INSTREAM_CLICK"], evt);

        if (clickThroughUrl) {
          if (_model.get('state') === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PAUSED"]) {
            _controller.playVideo();
          } else {
            _controller.pause();

            if (clickThroughUrl) {
              _controller.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["AD_CLICK"], {
                clickThroughUrl: clickThroughUrl
              });

              window.open(clickThroughUrl);
            }
          }
        }
      }, null);
    }
  }

  function triggerPlayRejected() {
    _adProgram.model.set('playRejected', true);
  }

  function _loadNextItem() {
    _arrayIndex++;

    _this.loadItem(_array).catch(function () {});
  }

  function _instreamForward(type, data) {
    if (type === 'complete') {
      return;
    }

    data = data || {};

    if (_options.tag && !data.tag) {
      data.tag = _options.tag;
    }

    this.trigger(type, data);

    if (type === 'mediaError' || type === 'error') {
      this.loadNextItemOnError();
    }
  }

  function _handleStateChange(event) {
    var newstate = event.newstate;

    var oldstate = event.oldstate || _adProgram.model.get('state');

    if (oldstate !== newstate) {
      _triggerAdPlayPause(Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({
        oldstate: oldstate
      }, _data, event));
    }
  }

  function _triggerAdPlayPause(event) {
    var newstate = event.newstate;

    if (newstate === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PLAYING"]) {
      _controller.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["AD_PLAY"], event);
    } else if (newstate === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PAUSED"]) {
      _controller.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["AD_PAUSE"], event);
    }
  }

  this.setEventData = function (data) {
    _data = data;
  };
  /**
   * Update instream player state. If `event.newstate` is 'playing' trigger an 'adPlay' event.
   * If `event.newstate` is 'paused' trigger and 'adPause' event.
   * @param {AdPlayEvent|AdPauseEvent} event - An ad event object containing relevant ad data.
   * @return {void}
   */


  this.setState = function (event) {
    var newstate = event.newstate;
    var adModel = _adProgram.model;
    event.oldstate = adModel.get('state');
    adModel.set('state', newstate);

    _triggerAdPlayPause(event);
  };
  /**
   * Update instream time and trigger 'adTime' event.
   * @param {AdTimeEvent} event - An ad event object containing relavant ad data.
   * @return {void}
   */


  this.setTime = function (event) {
    _instreamTime(event);

    _controller.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["AD_TIME"], event);
  };

  function _instreamTime(evt) {
    var duration = evt.duration,
        position = evt.position;
    var mediaModel = _adProgram.model.mediaModel || _adProgram.model;
    mediaModel.set('duration', duration);
    mediaModel.set('position', position); // Start background loading once the skip button is clickable
    // If no skipoffset is set, default to background loading 5 seconds before the end

    if (!_backgroundLoadStart) {
      // Ensure background loading doesn't degrade ad performance by starting too early
      _backgroundLoadStart = (Object(utils_strings__WEBPACK_IMPORTED_MODULE_3__["offsetToSeconds"])(_skipOffset, duration) || duration) - _program_program_constants__WEBPACK_IMPORTED_MODULE_2__["BACKGROUND_LOAD_OFFSET"];
    }

    if (!_backgroundLoadTriggered && position >= Math.max(_backgroundLoadStart, _program_program_constants__WEBPACK_IMPORTED_MODULE_2__["BACKGROUND_LOAD_MIN_OFFSET"])) {
      _controller.preloadNextItem();

      _backgroundLoadTriggered = true;
    }
  }

  function _instreamItemComplete(e) {
    var data = {};

    if (_options.tag) {
      data.tag = _options.tag;
    }

    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_COMPLETE"], data);

    _instreamItemNext.call(this, e);
  }

  function _instreamItemNext(e) {
    _data = {};

    if (_array && _arrayIndex + 1 < _array.length) {
      _loadNextItem();
    } else {
      if (e.type === events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_COMPLETE"]) {
        // Dispatch playlist complete event for ad pods
        this.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["PLAYLIST_COMPLETE"], {});
      }

      this.destroy();
    }
  }
  /**
   * Called when an error occurs to load the next instream ad if it exists.
   * @return {void}
   */


  this.loadNextItemOnError = function () {
    if (_array && _arrayIndex + 1 < _array.length) {
      _loadNextItem();
    }
  };
  /**
   * Load an Item, playing it as an insteam ad.
   * @param {Item|Array.<Item>} item - The ad item or ad pod array of items to be played.
   * @param {Object|Array.<Object>} options - The ad options or ad pod array of options.
   * @return {Promise} - The ad playback promise.
   */


  this.loadItem = function (item, options) {
    if (_destroyed || !_inited) {
      return Promise.reject(new Error('Instream not setup'));
    }

    _data = {}; // Copy the playlist item passed in and make sure it's formatted as a proper playlist item

    var playlist = item;

    if (Array.isArray(item)) {
      _array = item;
      _arrayOptions = options || _arrayOptions;
      item = _array[_arrayIndex];

      if (_arrayOptions) {
        options = _arrayOptions[_arrayIndex];
      }
    } else {
      playlist = [item];
    }

    if (false) {}

    var adModel = _adProgram.model;
    adModel.set('playlist', playlist);

    _model.set('hideAdsControls', false); // Reset starttime so that if the same ad is replayed by a plugin, it reloads from the start


    item.starttime = 0; // Dispatch playlist item event for ad pods

    _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["PLAYLIST_ITEM"], {
      index: _arrayIndex,
      item: item
    });

    _options = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, _defaultOptions, options);

    _setDefaultClickHandler();

    adModel.set('skipButton', false); // Await detachment if video tag is shared.

    var playPromise = !_model.get('backgroundLoading') && _detachPromise ? _detachPromise.then(function () {
      return _adProgram.setActiveItem(_arrayIndex);
    }) : _adProgram.setActiveItem(_arrayIndex);
    _backgroundLoadTriggered = false; // Need to use item.skipoffset since _options is undefined for subsequent ads in pods

    _skipOffset = item.skipoffset || _options.skipoffset;

    if (_skipOffset !== undefined) {
      _this.setupSkipButton(_skipOffset, _options);
    }

    return playPromise;
  };
  /**
   * Add a skip button.
   * @param {Number} skipoffset - The number of seconds from the start where the ad becomes skippable.
   * @param {Object} options - Custom skip button text and message.
   * @param {function} [customNext] - The skip callback.
   * @return {void}
   */


  this.setupSkipButton = function (skipoffset, options, customNext) {
    var adModel = _adProgram.model;

    if (customNext) {
      _skipAd = customNext;
    } else {
      _skipAd = _instreamItemNext;
    }

    adModel.set('skipMessage', options.skipMessage);
    adModel.set('skipText', options.skipText);
    adModel.set('skipOffset', skipoffset);
    adModel.attributes.skipButton = false;
    adModel.set('skipButton', true);
  };
  /**
   * Attach the provider handling ad playback.
   * @param {Object} provider - The provider that will accept media commands and trigger media events.
   * @return {void}
   */


  this.applyProviderListeners = function (provider) {
    _adProgram.usePsuedoProvider(provider);

    _setDefaultClickHandler();
  };
  /**
   * Resume ad playback.
   * @return {void}
   */


  this.play = function () {
    _data = {};

    _adProgram.playVideo();
  };
  /**
   * Pause ad playback.
   * @return {void}
   */


  this.pause = function () {
    _data = {};

    _adProgram.pause();
  };

  function _setDefaultClickHandler() {
    if (_destroyed || !_view) {
      return;
    } // start listening for ad click


    if (_view.clickHandler()) {
      _view.clickHandler().setAlternateClickHandlers(_clickHandler, _doubleClickHandler);
    }
  }
  /**
   * Skip the current Ad.
   * @param {Object} event - The 'adSkipped' event object.
   * @return {void}
   */


  this.skipAd = function (event) {
    var autoPauseAds = _model.get('autoPause').pauseAds;

    var didAutostart = _model.get('playReason') === 'autostart';

    var viewable = _model.get('viewable');

    if (autoPauseAds && !didAutostart && !viewable) {
      // If autoPause.pauseAds is enabled and player is not viewable
      // when skipAd() is called, do not resume playback unless player
      // was autostarted out of view and never came in to view
      this.noResume = true;
    }

    var skipAdType = events_events__WEBPACK_IMPORTED_MODULE_1__["AD_SKIPPED"];
    this.trigger(skipAdType, event);

    _skipAd.call(this, {
      type: skipAdType
    });
  };

  function _instreamMeta(evt) {
    // If we're getting video dimension metadata from the provider, allow the view to resize the media
    if (evt.width && evt.height && _view) {
      _view.resizeMedia();
    }
  }
  /**
   * Replace the current playlist item, with a new source. Used with SSAI plugins.
   * @param {Item} item - The new playlist item.
   * @return {void}
   */


  this.replacePlaylistItem = function (item) {
    if (_destroyed) {
      return;
    }

    _model.set('playlistItem', item);

    _adProgram.srcReset();
  };
  /**
   * Destroy this instream instance, reattach media and resume playback.
   * @return {void}
   */


  this.destroy = function () {
    if (_destroyed) {
      return;
    }

    _destroyed = true;
    this.trigger('destroyed');
    this.off();

    if (_view && _view.clickHandler()) {
      _view.clickHandler().revertAlternateClickHandlers();
    }

    _model.off(null, null, _adProgram);

    _adProgram.off(null, null, _this);

    _adProgram.destroy(); // Force player state with ad to pause for model "change:state" events to trigger


    if (_inited && _adProgram.model) {
      _model.attributes.state = events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PAUSED"];
    }

    _controller.forwardEvents();

    _model.set('instream', null);

    _adProgram = null;
    _data = {};
    _detachPromise = null;

    if (!_inited || _model.attributes._destroyed) {
      return;
    } // Re-attach the controller & resume playback
    // when instream was inited and the player was not destroyed\


    _controller.attachMedia();

    if (this.noResume) {
      return;
    }

    if (_beforeComplete) {
      _controller.stopVideo();
    } else {
      _controller.playVideo();
    }
  };
  /**
   * Get the ad playback state. Returns false if destroyed.
   * @return {string|boolean} The ad player's playback state
   */


  this.getState = function () {
    if (_destroyed) {
      // api expects false to know we aren't in instreamMode
      return false;
    }

    return _adProgram.model.get('state');
  };
  /**
   * Update the ads mode controlbar message.
   * @param {string} text - The message to display in the controlbar.
   * @return {InstreamAdapter} - chainable
   */


  this.setText = function (text) {
    if (_destroyed || !_view) {
      return this;
    }

    _view.setAltText(text || '');

    return this;
  };
  /**
   * Hide the ads mode controls
   * @return {void}
   */


  this.hide = function () {
    if (_destroyed) {
      return;
    }

    _model.set('hideAdsControls', true);
  };
  /**
   * Extracts the video tag in the foreground.
   * @returns {Element|undefined} videoTag - the HTML <video> element in the foreground.
   */


  this.getMediaElement = function () {
    if (_destroyed) {
      return null;
    }

    return _adProgram.primedElement;
  };
  /**
   * Sets the internal skip offset used for preloading content. Does not setup the skip button.
   * @param {Number} skipOffset - The number of seconds from the start where the ad becomes skippable.
   * @returns {void}
   */


  this.setSkipOffset = function (skipOffset) {
    // IMA will pass -1 if it doesn't know the skipoffset, or if the ad is unskippable
    _skipOffset = skipOffset > 0 ? skipOffset : null;

    if (_adProgram) {
      _adProgram.model.set('skipOffset', _skipOffset);
    }
  };
};

Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(InstreamAdapter.prototype, utils_backbone_events__WEBPACK_IMPORTED_MODULE_4__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (InstreamAdapter);

/***/ }),

/***/ "./src/js/controller/model.ts":
/*!************************************!*\
  !*** ./src/js/controller/model.ts ***!
  \************************************/
/*! exports provided: MediaModel, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MediaModel", function() { return MediaModel; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var model_simplemodel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! model/simplemodel */ "./src/js/model/simplemodel.ts");
/* harmony import */ var model_player_model__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! model/player-model */ "./src/js/model/player-model.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/strings */ "./src/js/utils/strings.ts");
/* harmony import */ var providers_providers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! providers/providers */ "./src/js/providers/providers.js");



function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }









// Represents the state of the player
var Model = /*#__PURE__*/function (_SimpleModel) {
  _inheritsLoose(Model, _SimpleModel);

  // These properties are assigned as attribute getters
  function Model() {
    var _this;

    _this = _SimpleModel.call(this) || this;
    _this.providerController = null;
    _this._provider = null;

    _this.addAttributes({
      mediaModel: new MediaModel(),
      minDvrWindow: model_player_model__WEBPACK_IMPORTED_MODULE_3__["DEFAULT_MIN_DVR_WINDOW"],
      dvrSeekLimit: model_player_model__WEBPACK_IMPORTED_MODULE_3__["DEFAULT_DVR_SEEK_LIMIT"]
    });

    return _this;
  }

  var _proto = Model.prototype;

  _proto.setup = function setup(config) {
    config = config || {};

    this._normalizeConfig(config);

    Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(this.attributes, config, model_player_model__WEBPACK_IMPORTED_MODULE_3__["INITIAL_PLAYER_STATE"]);

    this.providerController = new providers_providers__WEBPACK_IMPORTED_MODULE_6__["default"](this.getConfiguration());
    this.setAutoStart();
    return this;
  };

  _proto.getConfiguration = function getConfiguration() {
    var config = this.clone();
    var mediaModelAttributes = config.mediaModel.attributes;
    Object.keys(model_player_model__WEBPACK_IMPORTED_MODULE_3__["INITIAL_MEDIA_STATE"]).forEach(function (key) {
      config[key] = mediaModelAttributes[key];
    });
    config.instreamMode = !!config.instream;
    delete config.instream;
    delete config.mediaModel;
    return config;
  };

  _proto.persistQualityLevel = function persistQualityLevel(quality, levels) {
    var currentLevel = levels[quality] || {};
    var label = currentLevel.label; // Default to null if bitrate is bad, or when the quality to persist is "auto" (bitrate is undefined in this case)

    var bitrate = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isValidNumber"])(currentLevel.bitrate) ? currentLevel.bitrate : null;
    this.set('bitrateSelection', bitrate);
    this.set('qualityLabel', label);
  };

  _proto.setActiveItem = function setActiveItem(index) {
    var item = this.get('playlist')[index];
    this.resetItem(item);
    this.attributes.playlistItem = null;
    this.set('item', index);
    this.set('minDvrWindow', item.minDvrWindow);
    this.set('dvrSeekLimit', item.dvrSeekLimit || model_player_model__WEBPACK_IMPORTED_MODULE_3__["DEFAULT_DVR_SEEK_LIMIT"]);
    this.set('playlistItem', item);
  };

  _proto.setMediaModel = function setMediaModel(mediaModel) {
    if (this.mediaModel && this.mediaModel !== mediaModel) {
      this.mediaModel.off();
    }

    mediaModel = mediaModel || new MediaModel();
    this.mediaModel = mediaModel;
    syncPlayerWithMediaModel(mediaModel);
  };

  _proto.destroy = function destroy() {
    this.attributes._destroyed = true;
    this.off();

    if (this._provider) {
      this._provider.off(null, null, this);

      this._provider.destroy();
    }
  };

  _proto.getVideo = function getVideo() {
    return this._provider;
  };

  _proto.setFullscreen = function setFullscreen(state) {
    state = !!state;

    if (state !== this.get('fullscreen')) {
      this.set('fullscreen', state);
    }
  };

  _proto.getProviders = function getProviders() {
    return this.providerController;
  };

  _proto.setVolume = function setVolume(volume) {
    if (!Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isValidNumber"])(volume)) {
      return;
    }

    var vol = Math.min(Math.max(0, volume), 100);
    this.set('volume', vol);
    var mute = vol === 0;

    if (mute !== this.getMute()) {
      this.setMute(mute);
    }
  };

  _proto.getMute = function getMute() {
    return this.get('autostartMuted') || this.get('mute');
  };

  _proto.setMute = function setMute(mute) {
    if (mute === undefined) {
      mute = !this.getMute();
    }

    this.set('mute', !!mute);

    if (!mute) {
      var volume = Math.max(10, this.get('volume'));
      this.set('autostartMuted', false);
      this.setVolume(volume);
    }
  };

  _proto.setStreamType = function setStreamType(streamType) {
    this.set('streamType', streamType);

    if (streamType === 'LIVE') {
      this.setPlaybackRate(1);
    }
  };

  _proto.setProvider = function setProvider(provider) {
    this._provider = provider;
    syncProviderProperties(this, provider);
  };

  _proto.resetProvider = function resetProvider() {
    this._provider = null;
    this.set('provider', undefined);
  };

  _proto.setPlaybackRate = function setPlaybackRate(playbackRate) {
    if (!Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isNumber"])(playbackRate)) {
      return;
    } // Clamp the rate between 0.25x and 4x


    playbackRate = Math.max(Math.min(playbackRate, 4), 0.25);

    if (this.get('streamType') === 'LIVE') {
      playbackRate = 1;
    }

    this.set('defaultPlaybackRate', playbackRate);

    if (this._provider && this._provider.setPlaybackRate) {
      this._provider.setPlaybackRate(playbackRate);
    }
  };

  _proto.persistCaptionsTrack = function persistCaptionsTrack() {
    var track = this.get('captionsTrack');

    if (track) {
      // update preference if an option was selected
      this.set('captionLabel', track.name);
    } else {
      this.set('captionLabel', 'Off');
    }
  };

  _proto.setVideoSubtitleTrack = function setVideoSubtitleTrack(trackIndex, tracks) {
    this.set('captionsIndex', trackIndex);
    /*
     * Tracks could have changed even if the index hasn't.
     * Need to ensure track has data for captionsrenderer.
     */

    if (trackIndex && tracks && trackIndex <= tracks.length && tracks[trackIndex - 1].data) {
      this.set('captionsTrack', tracks[trackIndex - 1]);
    }
  };

  _proto.persistVideoSubtitleTrack = function persistVideoSubtitleTrack(trackIndex, tracks) {
    this.setVideoSubtitleTrack(trackIndex, tracks);
    this.persistCaptionsTrack();
  } // Mobile players always wait to become viewable.
  // Desktop players must have autostart set to viewable
  ;

  _proto.setAutoStart = function setAutoStart(autoStart) {
    if (autoStart !== undefined) {
      this.set('autostart', autoStart);
    }

    var autoStartOnMobile = !!(environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].mobile && this.get('autostart'));
    this.set('playOnViewable', autoStartOnMobile || this.get('autostart') === 'viewable');
  };

  _proto.resetItem = function resetItem(item) {
    var position = item ? Object(utils_strings__WEBPACK_IMPORTED_MODULE_5__["seconds"])(item.starttime) : 0;
    var duration = item ? Object(utils_strings__WEBPACK_IMPORTED_MODULE_5__["seconds"])(item.duration) : 0;
    var mediaModel = this.mediaModel;
    this.set('playRejected', false);
    this.attributes.itemMeta = {};
    mediaModel.set('position', position);
    mediaModel.set('currentTime', 0);
    mediaModel.set('duration', duration);
  };

  _proto.persistBandwidthEstimate = function persistBandwidthEstimate(bwEstimate) {
    if (!Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isValidNumber"])(bwEstimate)) {
      return;
    }

    this.set('bandwidthEstimate', bwEstimate);
  };

  _proto._normalizeConfig = function _normalizeConfig(cfg) {
    var floating = cfg.floating;

    if (floating && !!floating.disabled) {
      delete cfg.floating;
    }
  };

  return Model;
}(model_simplemodel__WEBPACK_IMPORTED_MODULE_2__["default"]);

var syncProviderProperties = function syncProviderProperties(model, provider) {
  model.set('provider', provider.getName());

  if (model.get('instreamMode') === true) {
    provider.instreamMode = true;
  } // Attempt setting the playback rate to be the user selected value


  model.setPlaybackRate(model.get('defaultPlaybackRate')); // Set playbackRate because provider support for playbackRate may have changed and not sent an update

  model.set('supportsPlaybackRate', provider.supportsPlaybackRate);
  model.set('playbackRate', provider.getPlaybackRate());
  model.set('renderCaptionsNatively', provider.renderNatively);
};

function syncPlayerWithMediaModel(mediaModel) {
  // Sync player state with mediaModel state
  var mediaState = mediaModel.get('mediaState');
  mediaModel.trigger('change:mediaState', mediaModel, mediaState, mediaState);
}

// Represents the state of the provider/media element
var MediaModel = /*#__PURE__*/function (_SimpleModel2) {
  _inheritsLoose(MediaModel, _SimpleModel2);

  function MediaModel() {
    var _this2;

    _this2 = _SimpleModel2.call(this) || this;

    _this2.addAttributes({
      mediaState: events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_IDLE"]
    });

    return _this2;
  }

  var _proto2 = MediaModel.prototype;

  _proto2.srcReset = function srcReset() {
    Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(this.attributes, {
      setup: false,
      started: false,
      preloaded: false,
      visualQuality: null,
      buffer: 0,
      currentTime: 0
    });
  };

  return MediaModel;
}(model_simplemodel__WEBPACK_IMPORTED_MODULE_2__["default"]);


/* harmony default export */ __webpack_exports__["default"] = (Model);

/***/ }),

/***/ "./src/js/controller/qoe.ts":
/*!**********************************!*\
  !*** ./src/js/controller/qoe.ts ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var api_timer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! api/timer */ "./src/js/api/timer.ts");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }



var TAB_HIDDEN = 'tabHidden';
var TAB_VISIBLE = 'tabVisible';

var QoeItem = /*#__PURE__*/function (_Timer) {
  _inheritsLoose(QoeItem, _Timer);

  function QoeItem() {
    return _Timer.apply(this, arguments) || this;
  }

  var _proto = QoeItem.prototype;

  _proto.getFirstFrame = function getFirstFrame() {
    var time = this.between(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_PLAY_ATTEMPT"], events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_FIRST_FRAME"]); // If time between the tab becoming visible and first frame is valid
    // and less than the time since play attempt, play was not attempted until the tab became visible

    var timeActive = this.between(TAB_VISIBLE, events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_FIRST_FRAME"]);

    if (timeActive && time && timeActive > 0 && timeActive < time) {
      return timeActive;
    }

    return time;
  };

  return QoeItem;
}(api_timer__WEBPACK_IMPORTED_MODULE_1__["default"]); // This is to provide a first frame event even when
//  a provider does not give us one.


var onTimeIncreasesGenerator = function onTimeIncreasesGenerator(callback) {
  var lastVal = 0;
  return function (evt) {
    var pos = evt.position;

    if (pos > lastVal) {
      callback(evt);
    } // sometimes the number will wrap around (ie 100 down to 0)
    //  so always update


    lastVal = pos;
  };
};

function unbindFirstFrameEvents(model, programController) {
  programController.off(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_PLAY_ATTEMPT"], model._onPlayAttempt);
  programController.off(events_events__WEBPACK_IMPORTED_MODULE_0__["PROVIDER_FIRST_FRAME"], model._triggerFirstFrame);
  programController.off(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_TIME"], model._onTime);
  model.off('change:activeTab', model._onTabVisible);
}

function trackFirstFrame(model, programController) {
  if (model._onTabVisible) {
    unbindFirstFrameEvents(model, programController);
  } // When it occurs, send the event, and unbind all listeners


  var once = false;

  model._triggerFirstFrame = function (evt) {
    if (once || !programController.mediaController) {
      return;
    } // Only trigger firstFrame while playing or paused or providerFirstFrame
    // (ignores "time" events while loading/stalling/idle/complete)


    var mediaModel = programController.mediaController.mediaModel;
    var state = mediaModel.attributes.mediaState;

    if (state !== events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_PLAYING"] && state !== events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_PAUSED"] && evt.type !== events_events__WEBPACK_IMPORTED_MODULE_0__["PROVIDER_FIRST_FRAME"]) {
      return;
    }

    once = true;
    var qoeItem = model._qoeItem;
    qoeItem.tick(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_FIRST_FRAME"]);
    var time = qoeItem.getFirstFrame();
    programController.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_FIRST_FRAME"], {
      loadTime: time
    }); // Start firing visualQuality once playback has started

    mediaModel.off("change:" + events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_VISUAL_QUALITY"], null, mediaModel);
    mediaModel.change(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_VISUAL_QUALITY"], function (changedMediaModel, eventData) {
      if (eventData) {
        programController.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_VISUAL_QUALITY"], eventData);
      }
    }, mediaModel);
    unbindFirstFrameEvents(model, programController);
  };

  model._onTime = onTimeIncreasesGenerator(model._triggerFirstFrame);

  model._onPlayAttempt = function () {
    model._qoeItem.tick(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_PLAY_ATTEMPT"]);
  }; // track visibility change


  model._onTabVisible = function (modelChanged, activeTab) {
    if (activeTab) {
      model._qoeItem.tick(TAB_VISIBLE);
    } else {
      model._qoeItem.tick(TAB_HIDDEN);
    }
  };

  model.on('change:activeTab', model._onTabVisible);
  programController.on(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_PLAY_ATTEMPT"], model._onPlayAttempt);
  programController.once(events_events__WEBPACK_IMPORTED_MODULE_0__["PROVIDER_FIRST_FRAME"], model._triggerFirstFrame);
  programController.on(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_TIME"], model._onTime);
}

var initQoe = function initQoe(initialModel, programController) {
  function onMediaModel(model, mediaModel, oldMediaModel) {
    // finish previous item
    if (model._qoeItem && oldMediaModel) {
      model._qoeItem.end(oldMediaModel.get('mediaState'));
    } // reset item level qoe


    model._qoeItem = new QoeItem();

    model._qoeItem.tick(events_events__WEBPACK_IMPORTED_MODULE_0__["PLAYLIST_ITEM"]);

    model._qoeItem.start(mediaModel.get('mediaState'));

    trackFirstFrame(model, programController);
    mediaModel.on('change:mediaState', function (changeMediaModel, newstate, oldstate) {
      if (newstate !== oldstate) {
        model._qoeItem.end(oldstate);

        model._qoeItem.start(newstate);
      }
    });
  }

  initialModel.change('mediaModel', onMediaModel);
};

/* harmony default export */ __webpack_exports__["default"] = (initQoe);

/***/ }),

/***/ "./src/js/controller/tracks-helper.ts":
/*!********************************************!*\
  !*** ./src/js/controller/tracks-helper.ts ***!
  \********************************************/
/*! exports provided: createId, createLabel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createId", function() { return createId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createLabel", function() { return createLabel; });
function createId(track, tracksCount) {
  var trackId;
  var prefix = track.kind || 'cc';

  if (track.default || track.defaulttrack) {
    trackId = 'default';
  } else {
    trackId = track._id || track.file || prefix + tracksCount;
  }

  return trackId;
}
function createLabel(track, unknownCount) {
  var label = track.label || track.name || track.language;

  if (!label) {
    label = 'Unknown CC';
    unknownCount += 1;

    if (unknownCount > 1) {
      label += ' [' + unknownCount + ']';
    }
  }

  return {
    label: label,
    unknownCount: unknownCount
  };
}

/***/ }),

/***/ "./src/js/controller/tracks-loader.ts":
/*!********************************************!*\
  !*** ./src/js/controller/tracks-loader.ts ***!
  \********************************************/
/*! exports provided: loadFile, cancelXhr */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadFile", function() { return loadFile; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cancelXhr", function() { return cancelXhr; });
/* harmony import */ var parsers_captions_vttcue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! parsers/captions/vttcue */ "./src/js/parsers/captions/vttcue.js");
/* harmony import */ var _api_core_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../api/core-loader */ "./src/js/api/core-loader.js");
/* harmony import */ var utils_ajax__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/ajax */ "./src/js/utils/ajax.js");
/* harmony import */ var parsers_parsers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! parsers/parsers */ "./src/js/parsers/parsers.ts");
/* harmony import */ var parsers_captions_srt__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! parsers/captions/srt */ "./src/js/parsers/captions/srt.ts");
/* harmony import */ var parsers_captions_dfxp__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! parsers/captions/dfxp */ "./src/js/parsers/captions/dfxp.ts");
/* harmony import */ var api_errors__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! api/errors */ "./src/js/api/errors.ts");







function loadFile(track, successHandler, errorHandler) {
  track.xhr = Object(utils_ajax__WEBPACK_IMPORTED_MODULE_2__["ajax"])(track.file, function (xhr) {
    xhrSuccess(xhr, track, successHandler, errorHandler);
  }, function (key, url, xhr, error) {
    errorHandler(Object(api_errors__WEBPACK_IMPORTED_MODULE_6__["composePlayerError"])(error, api_errors__WEBPACK_IMPORTED_MODULE_6__["ERROR_LOADING_CAPTIONS"]));
  });
}
function cancelXhr(tracks) {
  if (tracks) {
    tracks.forEach(function (track) {
      var xhr = track.xhr;

      if (xhr) {
        xhr.onload = null;
        xhr.onreadystatechange = null;
        xhr.onerror = null;

        if ('abort' in xhr) {
          xhr.abort();
        }
      }

      delete track.xhr;
    });
  }
}

function convertToVTTCues(cues) {
  // VTTCue is available natively or polyfilled where necessary
  return cues.map(function (cue) {
    return new parsers_captions_vttcue__WEBPACK_IMPORTED_MODULE_0__["default"](cue.begin, cue.end, cue.text);
  });
}

function xhrSuccess(xhr, track, successHandler, errorHandler) {
  var xmlRoot = xhr.responseXML ? xhr.responseXML.firstChild : null;
  var cues;
  var vttCues; // IE9 sets the firstChild element to the root <xml> tag

  if (xmlRoot) {
    if (Object(parsers_parsers__WEBPACK_IMPORTED_MODULE_3__["localName"])(xmlRoot) === 'xml') {
      xmlRoot = xmlRoot.nextSibling;
    } // Ignore all comments


    while (xmlRoot && xmlRoot.nodeType === xmlRoot.COMMENT_NODE) {
      xmlRoot = xmlRoot.nextSibling;
    }
  }

  try {
    if (xmlRoot && Object(parsers_parsers__WEBPACK_IMPORTED_MODULE_3__["localName"])(xmlRoot) === 'tt') {
      // parse dfxp track
      if (!xhr.responseXML) {
        throw new Error('Empty XML response');
      }

      cues = Object(parsers_captions_dfxp__WEBPACK_IMPORTED_MODULE_5__["default"])(xhr.responseXML);
      vttCues = convertToVTTCues(cues);
      delete track.xhr;
      successHandler(vttCues);
    } else {
      // parse VTT/SRT track
      var responseText = xhr.responseText;

      if (responseText.indexOf('WEBVTT') >= 0) {
        // make VTTCues from VTT track
        loadVttParser().then(function (VttParser) {
          var parser = new VttParser(window);
          vttCues = [];

          parser.oncue = function (cue) {
            vttCues.push(cue);
          };

          parser.onflush = function () {
            delete track.xhr;
            successHandler(vttCues);
          }; // Parse calls onflush internally


          parser.parse(responseText);
        }).catch(function (error) {
          delete track.xhr;
          errorHandler(Object(api_errors__WEBPACK_IMPORTED_MODULE_6__["convertToPlayerError"])(null, api_errors__WEBPACK_IMPORTED_MODULE_6__["ERROR_LOADING_CAPTIONS"], error));
        });
      } else {
        // make VTTCues from SRT track
        cues = Object(parsers_captions_srt__WEBPACK_IMPORTED_MODULE_4__["default"])(responseText);
        vttCues = convertToVTTCues(cues);
        delete track.xhr;
        successHandler(vttCues);
      }
    }
  } catch (error) {
    delete track.xhr;
    errorHandler(Object(api_errors__WEBPACK_IMPORTED_MODULE_6__["convertToPlayerError"])(null, api_errors__WEBPACK_IMPORTED_MODULE_6__["ERROR_LOADING_CAPTIONS"], error));
  }
}

function loadVttParser() {
  // eslint-disable-next-line @typescript-eslint/ban-ts-ignore
  // @ts-ignore
  return __webpack_require__.e(/*! require.ensure | vttparser */ "vttparser").then((function (require) {
    return __webpack_require__(/*! parsers/captions/vttparser */ "./src/js/parsers/captions/vttparser.js").default;
  }).bind(null, __webpack_require__)).catch(Object(_api_core_loader__WEBPACK_IMPORTED_MODULE_1__["chunkLoadWarningHandler"])(301131));
}

/***/ }),

/***/ "./src/js/events/change-state-event.ts":
/*!*********************************************!*\
  !*** ./src/js/events/change-state-event.ts ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return ChangeStateEvent; });
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");


// The api should dispatch an idle event when the model's state changes to complete
// This is to avoid conflicts with the complete event and to maintain legacy event flow
function normalizeApiState(newstate) {
  if (newstate === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_COMPLETE"] || newstate === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_ERROR"]) {
    return events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_IDLE"];
  }

  return newstate;
}

function normalizeReason(newstate, reason) {
  if (newstate === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_BUFFERING"]) {
    return reason === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_STALLED"] ? reason : events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_LOADING"];
  }

  return reason;
}

function ChangeStateEvent(model, newstate, oldstate) {
  newstate = normalizeApiState(newstate);
  oldstate = normalizeApiState(oldstate); // do not dispatch idle a second time after complete

  if (newstate !== oldstate) {
    // buffering, playing and paused states become:
    // buffer, play and pause events
    var type = newstate.replace(/(?:ing|d)$/, '');
    var reason = normalizeReason(newstate, model.mediaModel.get('mediaState'));
    var evt = {
      type: type,
      newstate: newstate,
      oldstate: oldstate,
      reason: reason
    }; // add reason for play/pause events

    if (type === 'play') {
      evt.playReason = model.get('playReason');
    } else if (type === 'pause') {
      evt.pauseReason = model.get('pauseReason');
    }

    this.trigger(type, evt);
  }
}

/***/ }),

/***/ "./src/js/parsers/captions/dfxp.ts":
/*!*****************************************!*\
  !*** ./src/js/parsers/captions/dfxp.ts ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Dfxp; });
/* harmony import */ var utils_strings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/strings */ "./src/js/utils/strings.ts");
/* harmony import */ var api_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! api/errors */ "./src/js/api/errors.ts");


function Dfxp(xmlDoc) {
  if (!xmlDoc) {
    parseError(306007);
  }

  var _captions = [];
  var paragraphs = xmlDoc.getElementsByTagName('p'); // Default frameRate is 30

  var frameRate = 30;
  var tt = xmlDoc.getElementsByTagName('tt');

  if (tt && tt[0]) {
    var parsedFrameRate = parseFloat(tt[0].getAttribute('ttp:frameRate') || '');

    if (!isNaN(parsedFrameRate)) {
      frameRate = parsedFrameRate;
    }
  }

  if (!paragraphs) {
    parseError(306005);
  }

  if (!paragraphs.length) {
    paragraphs = xmlDoc.getElementsByTagName('tt:p');

    if (!paragraphs.length) {
      paragraphs = xmlDoc.getElementsByTagName('tts:p');
    }
  }

  for (var i = 0; i < paragraphs.length; i++) {
    var p = paragraphs[i];
    var breaks = p.getElementsByTagName('br');

    for (var j = 0; j < breaks.length; j++) {
      var b = breaks[j];

      if (b && b.parentNode) {
        b.parentNode.replaceChild(xmlDoc.createTextNode('\r\n'), b);
      }
    }

    var rawText = p.innerHTML || p.textContent || p.text || '';
    var text = Object(utils_strings__WEBPACK_IMPORTED_MODULE_0__["trim"])(rawText).replace(/>\s+</g, '><').replace(/(<\/?)tts?:/g, '$1').replace(/<br.*?\/>/g, '\r\n');

    if (text) {
      var begin = p.getAttribute('begin') || '';
      var dur = p.getAttribute('dur') || '';
      var end = p.getAttribute('end') || '';
      var entry = {
        begin: Object(utils_strings__WEBPACK_IMPORTED_MODULE_0__["seconds"])(begin, frameRate),
        text: text
      };

      if (end) {
        entry.end = Object(utils_strings__WEBPACK_IMPORTED_MODULE_0__["seconds"])(end, frameRate);
      } else if (dur) {
        entry.end = (entry.begin || 0) + Object(utils_strings__WEBPACK_IMPORTED_MODULE_0__["seconds"])(dur, frameRate);
      }

      _captions.push(entry);
    }
  }

  if (!_captions.length) {
    parseError(306005);
  }

  return _captions;
}

function parseError(code) {
  throw new api_errors__WEBPACK_IMPORTED_MODULE_1__["PlayerError"](null, code);
}

/***/ }),

/***/ "./src/js/parsers/captions/srt.ts":
/*!****************************************!*\
  !*** ./src/js/parsers/captions/srt.ts ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Srt; });
/* harmony import */ var utils_strings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/strings */ "./src/js/utils/strings.ts");

// Component that loads and parses an SRT file
function Srt(data) {
  // Trim whitespace and split the list by returns.
  var _captions = [];
  data = Object(utils_strings__WEBPACK_IMPORTED_MODULE_0__["trim"])(data);
  var list = data.split('\r\n\r\n');

  if (list.length === 1) {
    list = data.split('\n\n');
  }

  for (var i = 0; i < list.length; i++) {
    if (list[i] === 'WEBVTT') {
      continue;
    } // Parse each entry


    var entry = _entry(list[i]);

    if (entry.text) {
      _captions.push(entry);
    }
  }

  return _captions;
}
/* Parse a single captions entry. */

function _entry(data) {
  var entry = {};
  var array = data.split('\r\n');

  if (array.length === 1) {
    array = data.split('\n');
  }

  var idx = 1;

  if (array[0].indexOf(' --> ') > 0) {
    idx = 0;
  }

  if (array.length > idx + 1 && array[idx + 1]) {
    // This line contains the start and end.
    var line = array[idx];
    var index = line.indexOf(' --> ');

    if (index > 0) {
      entry.begin = Object(utils_strings__WEBPACK_IMPORTED_MODULE_0__["seconds"])(line.substr(0, index));
      entry.end = Object(utils_strings__WEBPACK_IMPORTED_MODULE_0__["seconds"])(line.substr(index + 5)); // Remaining lines contain the text

      entry.text = array.slice(idx + 1).join('\r\n');
    }
  }

  return entry;
}

/***/ }),

/***/ "./src/js/parsers/captions/vttcue.js":
/*!*******************************************!*\
  !*** ./src/js/parsers/captions/vttcue.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/**
 * Copyright 2013 vtt.js Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/
var VTTCue = window.VTTCue;

function findDirectionSetting(value) {
  if (typeof value !== 'string') {
    return false;
  }

  var directionSetting = {
    '': true,
    lr: true,
    rl: true
  };
  var dir = directionSetting[value.toLowerCase()];
  return dir ? value.toLowerCase() : false;
}

function findAlignSetting(value) {
  if (typeof value !== 'string') {
    return false;
  }

  var alignSetting = {
    start: true,
    middle: true,
    end: true,
    left: true,
    right: true
  };
  var align = alignSetting[value.toLowerCase()];
  return align ? value.toLowerCase() : false;
}

if (!VTTCue) {
  var autoKeyword = 'auto';

  VTTCue = function VTTCue(startTime, endTime, text) {
    var cue = this;
    /**
     * Shim implementation specific properties. These properties are not in
     * the spec.
     */
    // Lets us know when the VTTCue's data has changed in such a way that we need
    // to recompute its display state. This lets us compute its display state
    // lazily.

    cue.hasBeenReset = false;
    /**
     * VTTCue and TextTrackCue properties
     * http://dev.w3.org/html5/webvtt/#vttcue-interface
     */

    var _id = '';
    var _pauseOnExit = false;
    var _startTime = startTime;
    var _endTime = endTime;
    var _text = text;
    var _region = null;
    var _vertical = '';
    var _snapToLines = true;
    var _line = autoKeyword;
    var _lineAlign = 'start';
    var _position = autoKeyword;
    var _size = 100;
    var _align = 'middle';
    Object.defineProperty(cue, 'id', {
      enumerable: true,
      get: function get() {
        return _id;
      },
      set: function set(value) {
        _id = '' + value;
      }
    });
    Object.defineProperty(cue, 'pauseOnExit', {
      enumerable: true,
      get: function get() {
        return _pauseOnExit;
      },
      set: function set(value) {
        _pauseOnExit = !!value;
      }
    });
    Object.defineProperty(cue, 'startTime', {
      enumerable: true,
      get: function get() {
        return _startTime;
      },
      set: function set(value) {
        if (typeof value !== 'number') {
          throw new TypeError('Start time must be set to a number.');
        }

        _startTime = value;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'endTime', {
      enumerable: true,
      get: function get() {
        return _endTime;
      },
      set: function set(value) {
        if (typeof value !== 'number') {
          throw new TypeError('End time must be set to a number.');
        }

        _endTime = value;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'text', {
      enumerable: true,
      get: function get() {
        return _text;
      },
      set: function set(value) {
        _text = '' + value;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'region', {
      enumerable: true,
      get: function get() {
        return _region;
      },
      set: function set(value) {
        _region = value;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'vertical', {
      enumerable: true,
      get: function get() {
        return _vertical;
      },
      set: function set(value) {
        var setting = findDirectionSetting(value); // Have to check for false because the setting an be an empty string.

        if (setting === false) {
          throw new SyntaxError('An invalid or illegal string was specified.');
        }

        _vertical = setting;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'snapToLines', {
      enumerable: true,
      get: function get() {
        return _snapToLines;
      },
      set: function set(value) {
        _snapToLines = !!value;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'line', {
      enumerable: true,
      get: function get() {
        return _line;
      },
      set: function set(value) {
        if (typeof value !== 'number' && value !== autoKeyword) {
          throw new SyntaxError('An invalid number or illegal string was specified.');
        }

        _line = value;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'lineAlign', {
      enumerable: true,
      get: function get() {
        return _lineAlign;
      },
      set: function set(value) {
        var setting = findAlignSetting(value);

        if (!setting) {
          throw new SyntaxError('An invalid or illegal string was specified.');
        }

        _lineAlign = setting;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'position', {
      enumerable: true,
      get: function get() {
        return _position;
      },
      set: function set(value) {
        if (value < 0 || value > 100) {
          throw new Error('Position must be between 0 and 100.');
        }

        _position = value;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'size', {
      enumerable: true,
      get: function get() {
        return _size;
      },
      set: function set(value) {
        if (value < 0 || value > 100) {
          throw new Error('Size must be between 0 and 100.');
        }

        _size = value;
        this.hasBeenReset = true;
      }
    });
    Object.defineProperty(cue, 'align', {
      enumerable: true,
      get: function get() {
        return _align;
      },
      set: function set(value) {
        var setting = findAlignSetting(value);

        if (!setting) {
          throw new SyntaxError('An invalid or illegal string was specified.');
        }

        _align = setting;
        this.hasBeenReset = true;
      }
    });
    /**
     * Other <track> spec defined properties
     */
    // http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#text-track-cue-display-state

    cue.displayState = undefined;
  };
  /**
   * VTTCue methods
   */


  VTTCue.prototype.getCueAsHTML = function () {
    // Assume WebVTT.convertCueToDOMTree is on the global.
    var WebVTT = window.WebVTT;
    return WebVTT.convertCueToDOMTree(window, this.text);
  };
}

/* harmony default export */ __webpack_exports__["default"] = (VTTCue);

/***/ }),

/***/ "./src/js/program/ad-program-controller.js":
/*!*************************************************!*\
  !*** ./src/js/program/ad-program-controller.js ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return AdProgramController; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var program_program_controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! program/program-controller */ "./src/js/program/program-controller.js");
/* harmony import */ var controller_model__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! controller/model */ "./src/js/controller/model.ts");
/* harmony import */ var events_change_state_event__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! events/change-state-event */ "./src/js/events/change-state-event.ts");
/* harmony import */ var program_shared_media_pool__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! program/shared-media-pool */ "./src/js/program/shared-media-pool.ts");


function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }







var AdProgramController = /*#__PURE__*/function (_ProgramController) {
  _inheritsLoose(AdProgramController, _ProgramController);

  function AdProgramController(model, mediaPool) {
    var _this;

    _this = _ProgramController.call(this, model, mediaPool) || this;
    var adModel = _this.model = new controller_model__WEBPACK_IMPORTED_MODULE_3__["default"]();
    _this.playerModel = model;
    _this.provider = null;
    _this.backgroundLoading = model.get('backgroundLoading');
    adModel.mediaModel.attributes.mediaType = 'video';

    if (true) {
      // Ad plugins must use only one element, and must use the same element during playback of an item
      // (i.e. prerolls, midrolls, and postrolls must use the same tag)
      var mediaElement;

      if (_this.backgroundLoading) {
        mediaElement = mediaPool.getAdElement();
      } else {
        // Take the tag that we're using to play the current item. The tag has been freed before reaching this point
        mediaElement = model.get('mediaElement');
        adModel.attributes.mediaElement = mediaElement;
        adModel.attributes.mediaSrc = mediaElement.src; // Listen to media element for events that indicate src was reset or load() was called

        var srcResetListener = _this.srcResetListener = function () {
          _this.srcReset();
        };

        mediaElement.addEventListener('emptied', srcResetListener);
        mediaElement.playbackRate = mediaElement.defaultPlaybackRate = 1;
      }

      _this.mediaPool = Object(program_shared_media_pool__WEBPACK_IMPORTED_MODULE_5__["default"])(mediaElement, mediaPool);
    }

    return _this;
  }

  var _proto = AdProgramController.prototype;

  _proto.setup = function setup() {
    var model = this.model,
        playerModel = this.playerModel,
        primedElement = this.primedElement;
    var playerAttributes = playerModel.attributes;
    var mediaModelContext = playerModel.mediaModel;
    model.setup({
      id: playerAttributes.id,
      volume: playerAttributes.volume,
      instreamMode: true,
      edition: playerAttributes.edition,
      mediaContext: mediaModelContext,
      mute: playerAttributes.mute,
      streamType: 'VOD',
      autostartMuted: playerAttributes.autostartMuted,
      autostart: playerAttributes.autostart,
      advertising: playerAttributes.advertising,
      sdkplatform: playerAttributes.sdkplatform,
      skipButton: false
    });
    model.on('change:state', events_change_state_event__WEBPACK_IMPORTED_MODULE_4__["default"], this);
    model.on(events_events__WEBPACK_IMPORTED_MODULE_1__["ERROR"], function (data) {
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["ERROR"], data);
    }, this);

    if (true) {
      if (!primedElement.paused) {
        primedElement.pause();
      }
    }
  };

  _proto.setActiveItem = function setActiveItem(index) {
    var _this2 = this;

    this.stopVideo();
    this.provider = null;
    return _ProgramController.prototype.setActiveItem.call(this, index).then(function (mediaController) {
      _this2.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["AD_MEDIA_LOADED"]);

      _this2._setProvider(mediaController.provider);

      return _this2.playVideo();
    });
  };

  _proto.usePsuedoProvider = function usePsuedoProvider(provider) {
    if (!provider) {
      return;
    }

    this._setProvider(provider); // Match the main player's controls state


    provider.off(events_events__WEBPACK_IMPORTED_MODULE_1__["ERROR"]);
    provider.on(events_events__WEBPACK_IMPORTED_MODULE_1__["ERROR"], function (data) {
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["ERROR"], data);
    }, this);
  };

  _proto._setProvider = function _setProvider(provider) {
    var _this3 = this;

    // Clear current provider when applyProviderListeners(null) is called
    if (!provider || !this.mediaPool) {
      return;
    }

    this.provider = provider;
    var model = this.model,
        playerModel = this.playerModel;
    var isVpaidProvider = provider.type === 'vpaid';
    provider.off();
    provider.on('all', function (type, data) {
      if (isVpaidProvider && type === events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_COMPLETE"]) {
        return;
      }

      this.trigger(type, Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, data, {
        type: type
      }));
    }, this);
    var adMediaModelContext = model.mediaModel;
    provider.on(events_events__WEBPACK_IMPORTED_MODULE_1__["PLAYER_STATE"], function (event) {
      event.oldstate = event.oldstate || model.get(events_events__WEBPACK_IMPORTED_MODULE_1__["PLAYER_STATE"]);
      adMediaModelContext.set('mediaState', event.newstate);
    });
    provider.on(events_events__WEBPACK_IMPORTED_MODULE_1__["NATIVE_FULLSCREEN"], this._nativeFullscreenHandler, this);
    adMediaModelContext.on('change:mediaState', function (changeAdModel, state) {
      _this3._stateHandler(state);
    });
    provider.attachMedia();

    if (false) { var mediaContainer; }

    provider.volume(playerModel.get('volume'));
    provider.mute(playerModel.getMute());

    if (provider.setPlaybackRate) {
      provider.setPlaybackRate(1);
    }

    playerModel.on('change:volume', function (data, value) {
      this.volume = value;
    }, this);
    playerModel.on('change:mute', function (data, mute) {
      this.mute = mute;

      if (!mute) {
        this.volume = playerModel.get('volume');
      }
    }, this);
    playerModel.on('change:autostartMuted', function (data, value) {
      if (!value) {
        model.set('autostartMuted', value);
        this.mute = playerModel.get('mute');
      }
    }, this);
  };

  _proto.destroy = function destroy() {
    var mediaController = this.mediaController,
        model = this.model,
        mediaPool = this.mediaPool,
        playerModel = this.playerModel;
    model.off();

    if (false) {} // Do not destroy or remove provider event listeners since non-linear ads may continue to run after this point


    this.provider = null; // We only use one media element from ads; getPrimedElement will return it

    var mediaElement = mediaPool.getPrimedElement();

    if (!this.backgroundLoading) {
      if (mediaElement) {
        mediaElement.removeEventListener('emptied', this.srcResetListener); // Reset the player media model if the src was changed externally

        if (mediaElement.src !== model.get('mediaSrc')) {
          this.srcReset();
        }
      }
    } else {
      mediaPool.clean();
      var mediaContainer = playerModel.get('mediaContainer');

      if (mediaElement.parentNode === mediaContainer) {
        mediaContainer.removeChild(mediaElement);
      }
    }
  };

  _proto.srcReset = function srcReset() {
    var playerModel = this.playerModel;
    var mediaModel = playerModel.get('mediaModel');
    var provider = playerModel.getVideo();
    mediaModel.srcReset(); // Set hlsjs.src to null so that it reloads it's item source

    if (provider) {
      provider.src = null;
    }
  };

  _proto._nativeFullscreenHandler = function _nativeFullscreenHandler(evt) {
    this.model.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["NATIVE_FULLSCREEN"], evt);
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["FULLSCREEN"], {
      fullscreen: evt.jwstate
    });
  };

  _proto._stateHandler = function _stateHandler(state) {
    var model = this.model;

    switch (state) {
      case events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PLAYING"]:
      case events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PAUSED"]:
        model.set(events_events__WEBPACK_IMPORTED_MODULE_1__["PLAYER_STATE"], state);
        break;

      default:
        break;
    }
  };

  _createClass(AdProgramController, [{
    key: "mute",
    set: function set(mute) {
      var mediaController = this.mediaController,
          model = this.model,
          provider = this.provider;
      model.set('mute', mute);

      _ProgramController.prototype.setMute.call(this, mute);

      if (!mediaController) {
        provider.mute(mute);
      }
    }
  }, {
    key: "volume",
    set: function set(volume) {
      var mediaController = this.mediaController,
          model = this.model,
          provider = this.provider;
      model.set('volume', volume);

      _ProgramController.prototype.setVolume.call(this, volume);

      if (!mediaController) {
        provider.volume(volume);
      }
    }
  }]);

  return AdProgramController;
}(program_program_controller__WEBPACK_IMPORTED_MODULE_2__["default"]);



/***/ }),

/***/ "./src/js/program/background-media.ts":
/*!********************************************!*\
  !*** ./src/js/program/background-media.ts ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return BackgroundMedia; });
/**
 * A simple data structure for containing both of the background loading objects.
 * currentMedia is the currently active item which has been put into the background during ad playback.
 * nextMedia is an item which is preloading in the background which may be selected in the future. It is usually the
 * next item in the playlist, or the next up item in a recommendations feed.
 * @returns {BackgroundMedia}
 */

/**
 * @typedef {Object} BackgroundMedia
 * @property {MediaController} currentMedia - The mediaController which has been placed into the background during playback.
 * @property {Item} nextItem - The playlist item loading in the background.
 * @property {Promise} nextMedia - A promise representing the media loading in the background. Resolves with the mediaController.
 * @constructor
 */
function BackgroundMedia() {
  var currentMedia = null;
  var nextMedia = null;
  return Object.defineProperties({
    setNext: function setNext(item, loadPromise) {
      nextMedia = {
        item: item,
        loadPromise: loadPromise
      };
    },
    isNext: function isNext(item) {
      return !!(nextMedia && JSON.stringify(nextMedia.item.sources[0]) === JSON.stringify(item.sources[0]));
    },
    updateNext: function updateNext(item) {
      if (nextMedia) {
        nextMedia.item = item;
      }
    },
    clearNext: function clearNext() {
      nextMedia = null;
    }
  }, {
    nextLoadPromise: {
      get: function get() {
        return nextMedia ? nextMedia.loadPromise : null;
      }
    },
    currentMedia: {
      get: function get() {
        return currentMedia;
      },
      set: function set(mediaController) {
        currentMedia = mediaController;
      }
    }
  });
}

/***/ }),

/***/ "./src/js/program/media-controller.js":
/*!********************************************!*\
  !*** ./src/js/program/media-controller.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return MediaController; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var utils_cancelable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/cancelable */ "./src/js/utils/cancelable.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var api_api_queue__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! api/api-queue */ "./src/js/api/api-queue.ts");
/* harmony import */ var api_errors__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! api/errors */ "./src/js/api/errors.ts");
/* harmony import */ var program_program_listeners__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! program/program-listeners */ "./src/js/program/program-listeners.ts");
/* harmony import */ var controller_model__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! controller/model */ "./src/js/controller/model.ts");
/* harmony import */ var utils_strings__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! utils/strings */ "./src/js/utils/strings.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");


function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }










var MediaController = /*#__PURE__*/function (_Events) {
  _inheritsLoose(MediaController, _Events);

  function MediaController(provider, model) {
    var _this;

    _this = _Events.call(this) || this;
    _this.attached = true;
    _this.beforeComplete = false;
    _this.item = null;
    _this.mediaModel = new controller_model__WEBPACK_IMPORTED_MODULE_6__["MediaModel"]();
    _this.model = model;
    _this.provider = provider;
    _this.providerListener = new program_program_listeners__WEBPACK_IMPORTED_MODULE_5__["ProviderListener"](_assertThisInitialized(_assertThisInitialized(_this)));
    _this.thenPlayPromise = Object(utils_cancelable__WEBPACK_IMPORTED_MODULE_1__["default"])(function () {});
    provider.off();
    provider.on('all', _this.providerListener, _assertThisInitialized(_assertThisInitialized(_this)));
    _this.eventQueue = new api_api_queue__WEBPACK_IMPORTED_MODULE_3__["default"](_assertThisInitialized(_assertThisInitialized(_this)), ['trigger'], function () {
      return !_this.attached || _this.background;
    });
    return _this;
  }

  var _proto = MediaController.prototype;

  _proto.play = function play(playReason) {
    var item = this.item,
        model = this.model,
        mediaModel = this.mediaModel,
        provider = this.provider;

    if (!playReason) {
      playReason = model.get('playReason');
    }

    model.set('playRejected', false); // If play has already been called, then only return provider.play

    if (mediaModel.get('setup')) {
      return provider.play() || Promise.resolve();
    }

    mediaModel.set('setup', true); // If this is the first call to play, load the media and play

    var playPromise = this._loadAndPlay(item, provider); // Trigger "playAttempt" if playback has not yet started


    if (mediaModel.get('started')) {
      return playPromise;
    }

    return this._playAttempt(playPromise, playReason);
  };

  _proto.stop = function stop() {
    var provider = this.provider;
    this.beforeComplete = false;
    provider.stop();
  };

  _proto.pause = function pause() {
    var provider = this.provider;
    provider.pause();
  };

  _proto.preload = function preload() {
    var item = this.item,
        mediaModel = this.mediaModel,
        provider = this.provider;

    if (!item || item && item.preload === 'none') {
      return;
    } // The provider has a video tag, but has not started nor preloaded


    if (this.attached && !this.setup && !this.preloaded) {
      mediaModel.set('preloaded', true);
      provider.preload(item);
    }
  };

  _proto.destroy = function destroy() {
    var provider = this.provider,
        mediaModel = this.mediaModel;
    this.off();
    mediaModel.off();
    provider.off();
    this.eventQueue.destroy();
    this.detach();

    if (provider.getContainer()) {
      provider.remove();
    }

    delete provider.instreamMode;
    this.provider = null;
    this.item = null;
  };

  _proto.attach = function attach() {
    var model = this.model,
        provider = this.provider; // Restore the playback rate to the provider in case it changed while detached and we reused a video tag.

    model.setPlaybackRate(model.get('defaultPlaybackRate'));
    provider.attachMedia();
    this.attached = true;
    this.eventQueue.flush();

    if (this.beforeComplete) {
      this._playbackComplete();
    }
  };

  _proto.detach = function detach() {
    var provider = this.provider;
    this.thenPlayPromise.cancel();
    var result = provider.detachMedia();
    this.attached = false;
    return result;
  } // Extends the playPromise
  ;

  _proto._playAttempt = function _playAttempt(playPromise, playReason) {
    var _this2 = this;

    var item = this.item,
        mediaModel = this.mediaModel,
        model = this.model,
        provider = this.provider;
    var video = provider ? provider.video : null;
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_8__["MEDIA_PLAY_ATTEMPT"], {
      item: item,
      playReason: playReason
    }); // Immediately set player state to buffering if these conditions are met

    if (video ? !video.paused : model.get(events_events__WEBPACK_IMPORTED_MODULE_8__["PLAYER_STATE"]) === events_events__WEBPACK_IMPORTED_MODULE_8__["STATE_PLAYING"]) {
      model.set(events_events__WEBPACK_IMPORTED_MODULE_8__["PLAYER_STATE"], events_events__WEBPACK_IMPORTED_MODULE_8__["STATE_BUFFERING"]);
    }

    return playPromise.then(function () {
      if (!mediaModel.get('setup')) {
        // Exit if model state was reset
        return;
      }

      mediaModel.set('started', true);

      if (mediaModel === model.mediaModel) {
        syncPlayerWithMediaModel(mediaModel);
      }
    }).catch(function (error) {
      if (_this2.item && mediaModel === model.mediaModel) {
        model.set('playRejected', true);
        var videoTagPaused = video && video.paused;

        if (videoTagPaused) {
          // Check if the video.src was set to empty, resolving to location.href and loaded.
          // This can be caused by 3rd party ads libraries after an ad break.
          if (video.src === location.href) {
            // Attempt to reload the video once within the play promise chain.
            return _this2._loadAndPlay(item, provider);
          }

          mediaModel.set('mediaState', events_events__WEBPACK_IMPORTED_MODULE_8__["STATE_PAUSED"]);
        }

        var playerError = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(new api_errors__WEBPACK_IMPORTED_MODULE_4__["PlayerError"](null, Object(api_errors__WEBPACK_IMPORTED_MODULE_4__["getPlayAttemptFailedErrorCode"])(error), error), {
          error: error,
          item: item,
          playReason: playReason
        });

        delete playerError.key;

        _this2.trigger(events_events__WEBPACK_IMPORTED_MODULE_8__["MEDIA_PLAY_ATTEMPT_FAILED"], playerError);

        throw error;
      }
    });
  };

  _proto._playbackComplete = function _playbackComplete() {
    var item = this.item,
        provider = this.provider;

    if (item) {
      delete item.starttime;
    }

    this.beforeComplete = false;
    provider.setState(events_events__WEBPACK_IMPORTED_MODULE_8__["STATE_COMPLETE"]);
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_8__["MEDIA_COMPLETE"], {});
  };

  _proto._loadAndPlay = function _loadAndPlay() {
    var item = this.item,
        provider = this.provider; // Calling load() on Shaka may return a player setup promise

    var providerSetupPromise = provider.load(item);

    if (providerSetupPromise) {
      var thenPlayPromise = Object(utils_cancelable__WEBPACK_IMPORTED_MODULE_1__["default"])(function () {
        return provider.play() || Promise.resolve();
      });
      this.thenPlayPromise = thenPlayPromise;
      return providerSetupPromise.then(thenPlayPromise.async);
    }

    return provider.play() || Promise.resolve();
  };

  _createClass(MediaController, [{
    key: "audioTrack",
    get: function get() {
      return this.provider.getCurrentAudioTrack();
    },
    set: function set(index) {
      this.provider.setCurrentAudioTrack(index);
    }
  }, {
    key: "quality",
    get: function get() {
      return this.provider.getCurrentQuality();
    },
    set: function set(index) {
      this.provider.setCurrentQuality(index);
    }
  }, {
    key: "audioTracks",
    get: function get() {
      return this.provider.getAudioTracks();
    }
  }, {
    key: "background",
    get: function get() {
      // A backgrounded provider is attached to a video tag
      if (!this.attached) {
        return false;
      }

      var provider = this.provider;

      if (false) {}

      if (!provider.video) {
        // A provider without a video tag cannot be backgrounded
        return false;
      } // A backgrounded provider does not have a parent container, or has one, but without the media tag as a child


      var container = provider.getContainer();
      return !container || container && !container.contains(provider.video);
    },
    set: function set(shouldBackground) {
      var provider = this.provider; // A provider without a video tag must use attach and detach

      if (!provider.video && !false) {
        if (shouldBackground) {
          this.detach();
        } else {
          this.attach();
        }

        return;
      }

      var container = provider.getContainer();

      if (!container) {
        return;
      }

      if (shouldBackground) {
        if (!this.background) {
          this.thenPlayPromise.cancel();
          this.pause();

          if (provider.removeFromContainer) {
            provider.removeFromContainer();
          } else {
            if (false) {} else {
              container.removeChild(provider.video);
            }
          }

          this.container = null;
        }
      } else {
        this.eventQueue.flush();

        if (this.beforeComplete) {
          this._playbackComplete();
        }
      }
    }
  }, {
    key: "container",
    get: function get() {
      return this.provider.getContainer();
    },
    set: function set(element) {
      var provider = this.provider;
      provider.setContainer(element);
    }
  }, {
    key: "mediaElement",
    get: function get() {
      return this.provider.video;
    }
  }, {
    key: "preloaded",
    get: function get() {
      return this.mediaModel.get('preloaded');
    }
  }, {
    key: "qualities",
    get: function get() {
      return this.provider.getQualityLevels();
    }
  }, {
    key: "setup",
    get: function get() {
      return this.mediaModel.get('setup');
    }
  }, {
    key: "started",
    get: function get() {
      return this.mediaModel.get('started');
    }
  }, {
    key: "activeItem",
    set: function set(item) {
      var mediaModel = this.mediaModel = new controller_model__WEBPACK_IMPORTED_MODULE_6__["MediaModel"]();
      var position = item ? Object(utils_strings__WEBPACK_IMPORTED_MODULE_7__["seconds"])(item.starttime) : 0;
      var duration = item ? Object(utils_strings__WEBPACK_IMPORTED_MODULE_7__["seconds"])(item.duration) : 0;
      var mediaModelState = mediaModel.attributes;
      mediaModel.srcReset();
      mediaModelState.position = position;
      mediaModelState.duration = duration;
      this.item = item;
      this.provider.init(item);

      if (false) {}
    }
  }, {
    key: "controls",
    set: function set(mode) {
      this.provider.setControls(mode);
    }
  }, {
    key: "mute",
    set: function set(mute) {
      this.provider.mute(mute);
    }
  }, {
    key: "position",
    set: function set(pos) {
      var provider = this.provider;

      if (this.model.get('scrubbing') && provider.fastSeek) {
        provider.fastSeek(pos);
      } else {
        provider.seek(pos);
      }
    }
  }, {
    key: "subtitles",
    set: function set(index) {
      if (this.provider.setSubtitlesTrack) {
        this.provider.setSubtitlesTrack(index);
      }
    }
  }, {
    key: "volume",
    set: function set(volume) {
      this.provider.volume(volume);
    }
  }]);

  return MediaController;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_2__["default"]);



function syncPlayerWithMediaModel(mediaModel) {
  // Sync player state with mediaModel state
  var mediaState = mediaModel.get('mediaState');
  mediaModel.trigger('change:mediaState', mediaModel, mediaState, mediaState);
}

/***/ }),

/***/ "./src/js/program/program-controller.js":
/*!**********************************************!*\
  !*** ./src/js/program/program-controller.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var providers_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! providers/providers */ "./src/js/providers/providers.js");
/* harmony import */ var program_media_controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! program/media-controller */ "./src/js/program/media-controller.js");
/* harmony import */ var utils_cancelable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/cancelable */ "./src/js/utils/cancelable.ts");
/* harmony import */ var program_program_listeners__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! program/program-listeners */ "./src/js/program/program-listeners.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var program_background_media__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! program/background-media */ "./src/js/program/background-media.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var api_errors__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! api/errors */ "./src/js/api/errors.ts");
/* harmony import */ var controller_async_item__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! controller/async-item */ "./src/js/controller/async-item.ts");
/* harmony import */ var controller_model__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! controller/model */ "./src/js/controller/model.ts");


function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }












var ProgramController = /*#__PURE__*/function (_Events) {
  _inheritsLoose(ProgramController, _Events);

  /**
   * ProgramController constructor
   * @param {Model} model - The player's model
   * @param {MediaElementPool} mediaPool - The player's media element pool
   * @param {PublicApi} publicApi - The player API applied as context in async playlist item promise callback execution
   */
  function ProgramController(model, mediaPool, publicApi) {
    var _this;

    _this = _Events.call(this) || this;
    _this.adPlaying = false;
    _this.apiContext = publicApi;
    _this.background = Object(program_background_media__WEBPACK_IMPORTED_MODULE_6__["default"])();
    _this.mediaPool = mediaPool;
    _this.mediaController = null;
    _this.mediaControllerListener = Object(program_program_listeners__WEBPACK_IMPORTED_MODULE_4__["MediaControllerListener"])(model);
    _this.model = model;
    _this.providers = new providers_providers__WEBPACK_IMPORTED_MODULE_1__["default"](model.getConfiguration());
    _this.loadPromise = null;
    _this.backgroundLoading = model.get('backgroundLoading');
    _this.asyncItems = [];
    _this.itemSetContext = 0;

    if (false) {}

    if (!_this.backgroundLoading) {
      // If background loading is not supported, set the shared media element
      model.set('mediaElement', _this.mediaPool.getPrimedElement());
    }

    return _this;
  }
  /**
   * Runs the async playlist item callback / promise
   * @param {number} index - The playlist index of the item
   * @returns {Promise<PlaylistItem>} The ItemPromise run promise
   * @memberOf ProgramController
   */


  var _proto = ProgramController.prototype;

  _proto.asyncActiveItem = function asyncActiveItem(index) {
    var _this2 = this;

    var model = this.model; // Set the player state to buffering if there is a playlist item callback

    var deferBufferingState =  false ? undefined : setTimeout(function () {
      model.set(events_events__WEBPACK_IMPORTED_MODULE_7__["PLAYER_STATE"], events_events__WEBPACK_IMPORTED_MODULE_7__["STATE_BUFFERING"]);
    }, 50);
    return this.getAsyncItem(index).run().then(function (playlistItem) {
      clearTimeout(deferBufferingState);
      return playlistItem;
    }).catch(function (itemPromiseError) {
      clearTimeout(deferBufferingState);

      if (index < model.get('playlist').length - 1) {
        return _this2.setActiveItem(index + 1).then(function () {
          return null;
        });
      }

      throw itemPromiseError;
    });
  }
  /**
   * Activates a playlist item, loading it into the foreground.
   * This method will either load a new Provider or reuse the active one.
   * @param {number} index - The playlist index of the item
   * @returns {Promise<MediaController>} The Provider promise. Resolves with the active Media Controller
   * @memberOf ProgramController
   */
  ;

  _proto.setActiveItem = function setActiveItem(index) {
    var _this3 = this;

    var background = this.background,
        mediaController = this.mediaController,
        model = this.model;
    var item = model.get('playlist')[index];
    model.attributes.itemReady = false; // Reset the mediaModel now to synchronously "cancel" play promise callbacks
    // that check `mediaModel === model.mediaModel`

    if (mediaController) {
      mediaController.mediaModel.off();
      model.attributes.mediaModel = new controller_model__WEBPACK_IMPORTED_MODULE_10__["MediaModel"]();
      model.mediaModel.attributes = mediaController.mediaModel.clone();
    } // Destroy background loading item early so we can reuse the media elements in asyncItem


    if (!background.isNext(item)) {
      // Loading a new item invalidates all background loading media
      this._destroyBackgroundMedia();
    } // Set a context for this async call. If asyncActiveItem resolves and this.itemSetContext has changed exit early.


    var itemSetContext = this.itemSetContext = Math.random();
    return this.loadPromise = this.asyncActiveItem(index).then(function (playlistItem) {
      // Resolve and exit on asyncActiveItem() itemPromiseError,
      // or if setActiveItem was called again changing itemSetContext
      if (playlistItem === null || itemSetContext !== _this3.itemSetContext) {
        return null;
      }

      model.setActiveItem(index);
      var source = getSource(playlistItem);

      if (!source) {
        return Promise.reject(new api_errors__WEBPACK_IMPORTED_MODULE_8__["PlayerError"](api_errors__WEBPACK_IMPORTED_MODULE_8__["MSG_CANT_PLAY_VIDEO"], api_errors__WEBPACK_IMPORTED_MODULE_8__["ERROR_PLAYLIST_ITEM_MISSING_SOURCE"]));
      } // Activate the background media if it's loading the item we want to play


      if (background.isNext(playlistItem)) {
        // First destroy the active item so that the BGL provider can enter the foreground
        _this3._destroyActiveMedia(); // Attach the BGL provider into the load/play chain


        return _this3._activateBackgroundMedia();
      }

      if (mediaController) {
        var casting = model.get('castActive');

        if (casting || _this3._providerCanPlay(mediaController.provider, source)) {
          // We can synchronously reuse the current mediaController
          // Reinitialize the mediaController with the new item, allowing a new playback session
          mediaController.activeItem = playlistItem;

          _this3._setActiveMedia(mediaController);

          return mediaController;
        } // If we can't play the source with the current provider, reset the current one and
        // prime the next tag within the gesture


        _this3._destroyActiveMedia();
      }

      return _this3._setupMediaController(source).then(function (nextMediaController) {
        // Don't do anything if we've tried to load another provider while this promise was resolving
        // We check using the mediaModel because it is unique per item, and per instance of that item
        if (itemSetContext === _this3.itemSetContext) {
          nextMediaController.activeItem = playlistItem;

          _this3._setActiveMedia(nextMediaController);

          return nextMediaController;
        }
      }).catch(function (err) {
        _this3._destroyActiveMedia();

        throw err;
      });
    });
  }
  /**
   * Attaches or detaches the current media
   * @param {boolean} shouldAttach - Attach or detach?
   * @returns {Promise|void} A detach promise. Resolves when media is detached.
   */
  ;

  _proto.setAttached = function setAttached(shouldAttach) {
    var mediaController = this.mediaController;
    this.attached = shouldAttach;

    if (!mediaController) {
      return;
    }

    if (shouldAttach) {
      mediaController.attach();
    } else {
      var result = mediaController.detach();
      var item = mediaController.item,
          mediaModel = mediaController.mediaModel; // If detaching to play a midroll (pos > 0), ensure that the player resumes at the detached time by setting starttime
      // We don't need to do this for prerolls because the player re-attaches at time 0 by default

      var pos = mediaModel.get('position');

      if (pos) {
        item.starttime = pos;
      }

      return result;
    }
  }
  /**
   * Plays the active item.
   * Will wait for the Provider promise to resolve before any play attempt.
   * @param {string} playReason - The reason playback is beginning.
   * @returns {Promise} The Play promise. Resolves when playback begins; rejects upon failure.
   */
  ;

  _proto.playVideo = function playVideo(playReason) {
    var _this4 = this;

    var mediaController = this.mediaController,
        model = this.model;
    var item = model.get('playlistItem');
    var playPromise;

    if (!item) {
      return Promise.reject(new Error('No media'));
    }

    if (!playReason) {
      playReason = model.get('playReason');
    } // Start playback immediately if we have already loaded a mediaController


    if (mediaController) {
      playPromise = mediaController.play(playReason);
    } else {
      // Wait for the provider to load before starting initial playback
      model.set(events_events__WEBPACK_IMPORTED_MODULE_7__["PLAYER_STATE"], events_events__WEBPACK_IMPORTED_MODULE_7__["STATE_BUFFERING"]); // Make the subsequent promise cancelable so that we can avoid playback when no longer wanted

      var thenPlayPromise = Object(utils_cancelable__WEBPACK_IMPORTED_MODULE_3__["default"])(function (nextMediaController) {
        if (_this4.mediaController && _this4.mediaController.mediaModel === nextMediaController.mediaModel) {
          return nextMediaController.play(playReason);
        }

        throw new Error('Playback cancelled.');
      });
      playPromise = (this.loadPromise || Promise.resolve()).catch(function (error) {
        thenPlayPromise.cancel(); // Fail the playPromise to trigger "playAttemptFailed"

        throw error;
      }).then(thenPlayPromise.async);
    }

    return playPromise;
  }
  /**
   * Stops playback of the active item, and sets the player state to IDLE.
   * @returns {void}
   */
  ;

  _proto.stopVideo = function stopVideo() {
    var mediaController = this.mediaController,
        model = this.model;
    var item = model.get('playlist')[model.get('item')];
    model.attributes.playlistItem = item;
    model.resetItem(item);

    if (mediaController) {
      mediaController.stop();
    }
  }
  /**
   * Preloads the active item, which loads and buffers some content.
   * @returns {void}
   */
  ;

  _proto.preloadVideo = function preloadVideo() {
    var background = this.background,
        mediaController = this.mediaController;
    var media = mediaController || background.currentMedia;

    if (!media) {
      return;
    }

    media.preload();
  }
  /**
   * Pauses playback of the current video, and sets the player state to PAUSED.
   * @returns {void}
   */
  ;

  _proto.pause = function pause() {
    var mediaController = this.mediaController;

    if (!mediaController) {
      return;
    }

    mediaController.pause();
  }
  /**
   * Casts a video. The Cast Controller will control the Cast Provider.
   * @param {CastProvider} castProvider - The playback provider instance (Casting is implemented in jwplayer-commercial).
   * @param {Item} item - The playlist Item instance to cast.
   * @returns {void}
   */
  ;

  _proto.castVideo = function castVideo(castProvider, item) {
    var model = this.model;
    model.attributes.itemReady = false;

    var playlistItem = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, item);

    var currentTime = playlistItem.starttime = model.mediaModel.get('currentTime');

    this._destroyActiveMedia();

    var castMediaController = new program_media_controller__WEBPACK_IMPORTED_MODULE_2__["default"](castProvider, model);
    castMediaController.activeItem = playlistItem;

    this._setActiveMedia(castMediaController);

    model.mediaModel.set('currentTime', currentTime);
  }
  /**
   * Stops casting. The Player is expected to restore video playback afterwards.
   * @returns {void}
   */
  ;

  _proto.stopCast = function stopCast() {
    var model = this.model;
    var index = model.get('item');
    var item = model.get('playlist')[index];
    item.starttime = model.mediaModel.get('currentTime');
    this.stopVideo();
    this.setActiveItem(index).catch(function () {
      /* noop */
    });
  }
  /**
   * Places the currently active Media Controller into the background.
   * The media is still attached to a media element, but is removed from the Player's container.
   * Background media still emits events, but we stop listening to them.
   * Background media can (and will) be updated via it's API.
   * @returns {void}
   */
  ;

  _proto.backgroundActiveMedia = function backgroundActiveMedia() {
    this.adPlaying = true;
    var background = this.background,
        mediaController = this.mediaController;

    if (!mediaController) {
      return;
    } // Destroy any existing background media


    if (background.currentMedia) {
      this._destroyMediaController(background.currentMedia);
    }

    mediaController.background = true;
    background.currentMedia = mediaController;
    this.mediaController = null;
  }
  /**
   * Restores the background media to the foreground.
   * Its media element is reattached to the Player container.
   * We start listening to its events again.
   * @returns {void}
   */
  ;

  _proto.restoreBackgroundMedia = function restoreBackgroundMedia() {
    this.adPlaying = false;
    var background = this.background,
        mediaController = this.mediaController;
    var backgroundMediaController = background.currentMedia;

    if (!backgroundMediaController) {
      return;
    } else if (mediaController && mediaController !== backgroundMediaController) {
      // An existing media controller means that we've changed the active item
      // The current background media is no longer relevant, so destroy it
      this._destroyMediaController(backgroundMediaController);

      background.currentMedia = null;
      return;
    }

    var attributes = backgroundMediaController.mediaModel.attributes;

    if (attributes.mediaState === events_events__WEBPACK_IMPORTED_MODULE_7__["STATE_IDLE"]) {
      attributes.mediaState = events_events__WEBPACK_IMPORTED_MODULE_7__["STATE_PAUSED"];
    } else if (attributes.mediaState !== events_events__WEBPACK_IMPORTED_MODULE_7__["STATE_PAUSED"]) {
      attributes.mediaState = events_events__WEBPACK_IMPORTED_MODULE_7__["STATE_BUFFERING"];
    }

    this._setActiveMedia(backgroundMediaController);

    backgroundMediaController.background = false;
    background.currentMedia = null;
  }
  /**
   * Loads the next playlist item in the background.
   * @param {Item} item - The playlist item to load.
   * @param {number} index - The playlist item promise index.
   *
   * @returns {void}
   */
  ;

  _proto.backgroundLoad = function backgroundLoad(item, index) {
    var _this5 = this;

    var background = this.background;
    var loadPromise = this.getAsyncItem(index).run().then(function (playlistItem) {
      background.updateNext(playlistItem);
      var source = getSource(playlistItem);
      return _this5._setupMediaController(source).then(function (nextMediaController) {
        nextMediaController.activeItem = playlistItem;
        nextMediaController.preload();
        return nextMediaController;
      });
    }).catch(function () {
      background.clearNext();
    });
    background.setNext(item, loadPromise);
  }
  /**
   * Add the 'all' events listener that forwards events from the media-controller
   * @returns {void}
   */
  ;

  _proto.forwardEvents = function forwardEvents() {
    var mediaController = this.mediaController;

    if (!mediaController) {
      return;
    }

    _forwardEvents(mediaController, this);
  }
  /**
   * Remove the 'all' events listener that forwards events from the media-controller.
   * If a target is specified, route all events to target.mediaControllerListener.
   * @param {Object} [target] - Optional argument that must contain a mediaControllerListener method.
   * @returns {void}
   */
  ;

  _proto.routeEvents = function routeEvents(target) {
    var mediaController = this.mediaController;

    if (!mediaController) {
      return;
    }

    mediaController.off();

    if (target) {
      _forwardEvents(mediaController, target);
    }
  }
  /**
   * Removes all event listeners and destroys all media.
   * @returns {void}
   */
  ;

  _proto.destroy = function destroy() {
    this.off();

    this._destroyBackgroundMedia();

    this._destroyActiveMedia();

    this.apiContext = null;
  }
  /**
   * Activates the provided media controller, placing it into the foreground.
   * Events fired from the media controller will be forwarded through the program controller.
   * @param {MediaController} mediaController - The media controller to activate.
   * @returns {void}
   * @private
   */
  ;

  _proto._setActiveMedia = function _setActiveMedia(mediaController) {
    var model = this.model;
    var mediaModel = mediaController.mediaModel,
        provider = mediaController.provider;
    assignMediaContainer(model, mediaController);
    this.mediaController = mediaController;
    model.set('mediaElement', mediaController.mediaElement);
    model.setMediaModel(mediaModel);
    model.setProvider(provider);

    _forwardEvents(mediaController, this);

    model.set('itemReady', true);
  }
  /**
   * Destroys the active media controller and current playback.
   * @returns {void}
   * @private
   */
  ;

  _proto._destroyActiveMedia = function _destroyActiveMedia() {
    var mediaController = this.mediaController,
        model = this.model;

    if (!mediaController || !mediaController.provider) {
      return;
    }

    mediaController.detach();

    this._destroyMediaController(mediaController);

    model.resetProvider();
    this.mediaController = null;
  }
  /**
   * Destroys all background media.
   * @returns {void}
   * @private
   */
  ;

  _proto._destroyBackgroundMedia = function _destroyBackgroundMedia() {
    var background = this.background;

    this._destroyMediaController(background.currentMedia);

    background.currentMedia = null;

    this._destroyBackgroundLoadingMedia();
  }
  /**
   * Destroys a mediaController, and returns it's tag to the pool.
   * @param {MediaController} mediaController - The media controller to destroy and recycle.
   * @returns {void}
   * @private
   */
  ;

  _proto._destroyMediaController = function _destroyMediaController(mediaController) {
    var mediaPool = this.mediaPool;

    if (!mediaController || !mediaController.provider) {
      return;
    }

    mediaPool.recycle(mediaController.mediaElement);
    mediaController.destroy();
  }
  /**
   * Constructs a new media controller with the provider whose able to play the current source.
   * Will wait and load the provider constructor if it has not already been loaded.
   * If the required provider cannot be loaded, the subsequent promise rejection will destroy playback.
   * @param {Source} source - The playlist item Source for which a provider is needed.
   * @returns {Promise} The Provider constructor promise.
   * @private
   */
  ;

  _proto._setupMediaController = function _setupMediaController(source) {
    var _this6 = this;

    var model = this.model,
        providers = this.providers;

    var makeMediaController = function makeMediaController(ProviderConstructor) {
      return new program_media_controller__WEBPACK_IMPORTED_MODULE_2__["default"](new ProviderConstructor(model.get('id'), model.getConfiguration(), _this6.primedElement), model);
    };

    var _providers$choose = providers.choose(source),
        provider = _providers$choose.provider,
        name = _providers$choose.name;

    if (provider) {
      return Promise.resolve(makeMediaController(provider));
    }

    return providers.load(name).then(function (ProviderConstructor) {
      return makeMediaController(ProviderConstructor);
    });
  }
  /**
   * Places the background loading media into the foreground. Will wait for the provider promise to resolve.
   * If the program controller has been placed into ads mode, the background loading media will replace the background
   * loaded media. When the ad is over, the loaded media will be placed into the foreground via _restoreBackgroundMedia().
   * This is done to avoid a race condition where we have activated the loading item, but switch to ads mode before the
   * promise resovles, resulting in two tags in the foreground (since _backgroundActiveMedia "misses" the pending promise).
   * @returns {Promise} The Provider promise. Resolves with preloaded media controller.
   * @memberOf ProgramController
   */
  ;

  _proto._activateBackgroundMedia = function _activateBackgroundMedia() {
    var _this7 = this;

    var background = this.background,
        nextLoadPromise = this.background.nextLoadPromise,
        model = this.model; // Activating this item means that any media already loaded in the background will no longer be needed

    this._destroyMediaController(background.currentMedia);

    background.currentMedia = null;
    return nextLoadPromise.then(function (nextMediaController) {
      if (!nextMediaController) {
        return;
      }

      background.clearNext();

      if (_this7.adPlaying) {
        model.attributes.itemReady = true;
        background.currentMedia = nextMediaController;
      } else {
        _this7._setActiveMedia(nextMediaController);

        nextMediaController.background = false;
      }

      return nextMediaController;
    }); // The catch is chained as part of the play promise chain
  }
  /**
   * Destroys the mediaController which was constructed and loading in the background (nextMedia).
   * Does not destroy the mediaController which was already playing and subsequently placed into the background (currentMedia).
   * @returns {void}
   * @private
   */
  ;

  _proto._destroyBackgroundLoadingMedia = function _destroyBackgroundLoadingMedia() {
    var _this8 = this;

    var background = this.background,
        nextLoadPromise = this.background.nextLoadPromise;

    if (!nextLoadPromise) {
      return;
    }

    nextLoadPromise.then(function (nextMediaController) {
      _this8._destroyMediaController(nextMediaController);

      background.clearNext();
    });
  };

  _proto._providerCanPlay = function _providerCanPlay(_provider, source) {
    var _this$providers$choos = this.providers.choose(source),
        provider = _this$providers$choos.provider;

    return provider && _provider && _provider instanceof provider;
  }
  /**
   * Returns the active audio track index.
   * @returns {number} The active audio track index.
   */
  ;

  /**
   * Mutes or unmutes the activate media.
   * Syncs across all media elements.
   * @param {boolean} mute - Mute or unmute media?
   * @returns {void}
   */
  _proto.setMute = function setMute(mute) {
    var background = this.background,
        mediaController = this.mediaController,
        mediaPool = this.mediaPool;

    if (mediaController) {
      mediaController.mute = mute;
    }

    if (background.currentMedia) {
      background.currentMedia.mute = mute;
    }

    if (true) {
      mediaPool.syncMute(mute);
    }
  }
  /**
   * Sets the volume level.
   * Syncs across all media elements.
   * @param {number} volume - A number from 0 to 1.
   * @returns {void}
   */
  ;

  _proto.setVolume = function setVolume(volume) {
    var background = this.background,
        mediaController = this.mediaController,
        mediaPool = this.mediaPool;

    if (mediaController) {
      mediaController.volume = volume;
    }

    if (background.currentMedia) {
      background.currentMedia.volume = volume;
    }

    if (true) {
      mediaPool.syncVolume(volume);
    }
  };

  _proto.getAsyncItem = function getAsyncItem(index) {
    var asyncItem = this.asyncItems[index];

    if (!asyncItem) {
      asyncItem = this.asyncItems[index] = new controller_async_item__WEBPACK_IMPORTED_MODULE_9__["AsyncItemController"](index, this.model, this.apiContext);
      asyncItem.callback = this.model.get('playlistItemCallback');
    }

    return asyncItem;
  };

  _proto.clearItemPromises = function clearItemPromises() {
    this.asyncItems.forEach(function (asyncItemController) {
      if (asyncItemController) {
        asyncItemController.reject(new Error('Item playback aborted'));
      }
    });
    this.asyncItems.length = 0;
  };

  _createClass(ProgramController, [{
    key: "audioTrack",
    get: function get() {
      var mediaController = this.mediaController;

      if (!mediaController) {
        return -1;
      }

      return mediaController.audioTrack;
    }
    /**
     * Returns the list of audio tracks.
     * @returns {Array<AudioTrackOption>} An array of AudioTrackOption instances.
     */
    ,

    /**
     * Sets the active audio index.
     * @param {number} index - The index of the audio track to select.
     * @returns {void}
     */
    set: function set(index) {
      var mediaController = this.mediaController;

      if (!mediaController) {
        return;
      }

      mediaController.audioTrack = parseInt(index, 10) || 0;
    }
    /**
     * Seeks the media to the provided position.
     * Set the item's starttime so that if detached while seeking it resumes from the correct time.
     * ALso set the item's starttime so that if we seek before loading, we load and begin at the correct time.
     * @param {number} pos - The position to start at or seek to.
     * @returns {void}
     */

  }, {
    key: "audioTracks",
    get: function get() {
      var mediaController = this.mediaController;

      if (!mediaController) {
        return undefined;
      }

      return mediaController.audioTracks;
    }
    /**
     * Returns whether the current media has completed playback.
     * @returns {boolean} Is the "beforeComplete" event being propagated
     * or did it result in the media being detached or backgrounded?
     */

  }, {
    key: "beforeComplete",
    get: function get() {
      var mediaController = this.mediaController,
          currentMedia = this.background.currentMedia;

      if (!mediaController && !currentMedia) {
        return false;
      }

      return mediaController ? mediaController.beforeComplete : currentMedia.beforeComplete;
    }
    /**
     * Returns a primed element from the media pool.
     * @returns {HTMLVideoElement|null} The first video element in the pool, or null if the pool is empty.
     */

  }, {
    key: "primedElement",
    get: function get() {
      if (!this.backgroundLoading) {
        // If background loading is not supported, the model will always contain the shared media element
        // Prime it so that playback after changing the active item does not require further gestures
        var model = this.model;
        return model.get('mediaElement');
      }

      return this.mediaPool.getPrimedElement();
    }
    /**
     * Returns the active quality index.
     * @returns {number} The active quality level index.
     */

  }, {
    key: "quality",
    get: function get() {
      if (!this.mediaController) {
        return -1;
      }

      return this.mediaController.quality;
    }
    /**
     * Returns the list of quality levels.
     * @returns {Array<QualityOption>} An array of QualityOption objects.
     */
    ,

    /**
     * Sets the current quality level.
     * @param {number} index - The index of the quality level to select.
     * @returns {void}
     */
    set: function set(index) {
      var mediaController = this.mediaController;

      if (!mediaController) {
        return;
      }

      mediaController.quality = parseInt(index, 10) || 0;
    }
    /**
     * Sets the current subtitles track.
     * @param {number} index - The index of the subtitle track to select.
     * @returns {void}
     */

  }, {
    key: "qualities",
    get: function get() {
      var mediaController = this.mediaController;

      if (!mediaController) {
        return null;
      }

      return mediaController.qualities;
    }
  }, {
    key: "position",
    set: function set(pos) {
      var mediaController = this.mediaController;

      if (!mediaController) {
        return;
      }

      mediaController.item.starttime = pos;

      if (mediaController.attached) {
        mediaController.position = pos;
      }
    }
  }, {
    key: "subtitles",
    set: function set(index) {
      var mediaController = this.mediaController;

      if (!mediaController) {
        return;
      }

      mediaController.subtitles = index;
    }
  }, {
    key: "itemCallback",
    set: function set(callback) {
      this.model.set('playlistItemCallback', callback);
      this.asyncItems.forEach(function (asyncItem) {
        if (asyncItem) {
          asyncItem.callback = callback;
        }
      });
    }
  }]);

  return ProgramController;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_5__["default"]);

function assignMediaContainer(model, mediaController) {
  var container = model.get('mediaContainer');

  if (container) {
    mediaController.container = container;
  } else {
    model.once('change:mediaContainer', function (changedModel, changedContainer) {
      mediaController.container = changedContainer;
    });
  }
}

function _forwardEvents(mediaController, target) {
  var mediaControllerListener = target.mediaControllerListener;
  mediaController.off().on('all', mediaControllerListener, target);
}

function getSource(item) {
  return item && item.sources && item.sources[0];
}

/* harmony default export */ __webpack_exports__["default"] = (ProgramController);

/***/ }),

/***/ "./src/js/program/program-listeners.ts":
/*!*********************************************!*\
  !*** ./src/js/program/program-listeners.ts ***!
  \*********************************************/
/*! exports provided: ProviderListener, MediaControllerListener */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProviderListener", function() { return ProviderListener; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MediaControllerListener", function() { return MediaControllerListener; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");





function ProviderListener(mediaController) {
  return function (type, data) {
    var mediaModel = mediaController.mediaModel;

    var event = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, data, {
      type: type
    });

    switch (type) {
      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_TYPE"]:
        if (mediaModel.get(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_TYPE"]) === event.mediaType) {
          return;
        }

        mediaModel.set(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_TYPE"], event.mediaType);
        break;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_VISUAL_QUALITY"]:
        mediaModel.set(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_VISUAL_QUALITY"], Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, data));
        return;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_MUTE"]:
        // Only forward and queue mute changes
        if (data[events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_MUTE"]] === mediaController.model.getMute()) {
          return;
        }

        break;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["PLAYER_STATE"]:
        {
          var _ref = data,
              newstate = _ref.newstate;

          if (newstate === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_IDLE"]) {
            mediaController.thenPlayPromise.cancel();
            mediaModel.srcReset();
          } // Always fire change:mediaState to keep player model in sync


          var previousState = mediaModel.attributes.mediaState;
          mediaModel.attributes.mediaState = newstate;
          mediaModel.trigger('change:mediaState', mediaModel, newstate, previousState);
          break;
        }

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_COMPLETE"]:
        mediaController.beforeComplete = true;
        mediaController.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_BEFORECOMPLETE"], event);

        if (mediaController.attached && !mediaController.background) {
          mediaController._playbackComplete();
        }

        return;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_ERROR"]:
        if (mediaModel.get('setup')) {
          mediaController.thenPlayPromise.cancel();
          mediaModel.srcReset();
        } else {
          // A MEDIA_ERROR received before setup is a preload error
          // We stop propagation here allow the player to try loading once more when playback is initiated
          // MEDIA_ERROR codes are in the 200,000 range; adding 100,000 puts it in the 300,000 warning range.
          type = events_events__WEBPACK_IMPORTED_MODULE_1__["WARNING"];
          event.code += 100000;
        }

        break;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_META"]:
        {
          var _ref2 = data,
              duration = _ref2.duration,
              metadataType = _ref2.metadataType,
              seekRange = _ref2.seekRange;

          if (!metadataType) {
            event.metadataType = 'unknown';
          }

          if (Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isValidNumber"])(duration)) {
            mediaModel.set('seekRange', seekRange);
            mediaModel.set('duration', duration);
          }

          break;
        }

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_BUFFER"]:
        mediaModel.set('buffer', data.bufferPercent);

      /* falls through to update duration while media is loaded */

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_TIME"]:
        {
          var timeData = data;
          mediaModel.set('seekRange', timeData.seekRange);
          mediaModel.set('position', timeData.position);
          mediaModel.set('currentTime', timeData.currentTime);
          var _duration = timeData.duration;

          if (Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isValidNumber"])(_duration)) {
            mediaModel.set('duration', _duration);
          }

          if (type === events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_TIME"] && 'starttime' in mediaController.item) {
            delete mediaController.item.starttime;
          }

          break;
        }

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_SEEKED"]:
        {
          // After seeking, if the video tag is in a paused state, update the player state to "paused"
          var mediaElement = mediaController.mediaElement;

          if (mediaElement && mediaElement.paused) {
            mediaModel.set('mediaState', 'paused');
          }

          break;
        }

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_LEVELS"]:
        mediaModel.set(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_LEVELS"], data.levels);

      /* falls through to update current level */

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_LEVEL_CHANGED"]:
        {
          var _ref3 = data,
              currentQuality = _ref3.currentQuality,
              levels = _ref3.levels;

          if (currentQuality > -1 && levels.length > 1) {
            mediaModel.set('currentLevel', parseInt(currentQuality));
          }

          break;
        }

      case events_events__WEBPACK_IMPORTED_MODULE_1__["AUDIO_TRACKS"]:
        mediaModel.set(events_events__WEBPACK_IMPORTED_MODULE_1__["AUDIO_TRACKS"], data.tracks);

      /* falls through to update current track */

      case events_events__WEBPACK_IMPORTED_MODULE_1__["AUDIO_TRACK_CHANGED"]:
        {
          var _ref4 = data,
              currentTrack = _ref4.currentTrack,
              tracks = _ref4.tracks;

          if (currentTrack > -1 && tracks.length > 0 && currentTrack < tracks.length) {
            mediaModel.set('currentAudioTrack', parseInt(currentTrack));
          }

          break;
        }

      default:
        break;
    }

    mediaController.trigger(type, event);
  };
}
function MediaControllerListener(model) {
  return function (type, event) {
    switch (type) {
      case events_events__WEBPACK_IMPORTED_MODULE_1__["PLAYER_STATE"]:
        // This "return" is important because
        //  we are choosing to not propagate model event.
        //  Instead letting the master controller do so
        return;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_VOLUME"]:
        model.set(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_VOLUME"], event[events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_VOLUME"]]);
        return;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_MUTE"]:
        model.set(events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_MUTE"], event[events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_MUTE"]]);
        return;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_RATE_CHANGE"]:
        model.set('playbackRate', event.playbackRate);
        return;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_META"]:
        {
          Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(model.get('itemMeta'), event.metadata);

          break;
        }

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_LEVEL_CHANGED"]:
        model.persistQualityLevel(event.currentQuality, event.levels);
        break;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["SUBTITLES_TRACK_CHANGED"]:
        model.persistVideoSubtitleTrack(event.currentTrack, event.tracks);
        break;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_TIME"]:
        if (event.targetLatency) {
          model.set('dvrSeekLimit', event.targetLatency);
        }

      /* falls through to to trigger model event off model */

      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_SEEK"]:
      case events_events__WEBPACK_IMPORTED_MODULE_1__["MEDIA_SEEKED"]:
      case events_events__WEBPACK_IMPORTED_MODULE_1__["NATIVE_FULLSCREEN"]:
      case events_events__WEBPACK_IMPORTED_MODULE_1__["SUBTITLES_TRACKS"]:
      case 'subtitlesTracksData':
        model.trigger(type, event);
        break;

      case events_events__WEBPACK_IMPORTED_MODULE_1__["BANDWIDTH_ESTIMATE"]:
        {
          model.persistBandwidthEstimate(event.bandwidthEstimate);
          return;
        }

      default:
    }

    this.trigger(type, event);
  };
}

/***/ }),

/***/ "./src/js/providers/data-normalizer.ts":
/*!*********************************************!*\
  !*** ./src/js/providers/data-normalizer.ts ***!
  \*********************************************/
/*! exports provided: qualityLevel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "qualityLevel", function() { return qualityLevel; });
function qualityLevel(level) {
  return {
    bitrate: level.bitrate,
    label: level.label,
    width: level.width,
    height: level.height
  };
}

/***/ }),

/***/ "./src/js/providers/html5.ts":
/*!***********************************!*\
  !*** ./src/js/providers/html5.ts ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var providers_data_normalizer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! providers/data-normalizer */ "./src/js/providers/data-normalizer.ts");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var providers_html5_android_hls__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! providers/html5-android-hls */ "./src/js/providers/html5-android-hls.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! providers/video-listener-mixin */ "./src/js/providers/video-listener-mixin.ts");
/* harmony import */ var providers_video_actions_mixin__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! providers/video-actions-mixin */ "./src/js/providers/video-actions-mixin.ts");
/* harmony import */ var providers_video_attached_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! providers/video-attached-mixin */ "./src/js/providers/video-attached-mixin.ts");
/* harmony import */ var providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! providers/utils/stream-type */ "./src/js/providers/utils/stream-type.ts");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var providers_default__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! providers/default */ "./src/js/providers/default.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var providers_tracks_mixin__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! providers/tracks-mixin */ "./src/js/providers/tracks-mixin.ts");
/* harmony import */ var utils_time_ranges__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! utils/time-ranges */ "./src/js/utils/time-ranges.ts");
/* harmony import */ var providers_utils_play_promise__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! providers/utils/play-promise */ "./src/js/providers/utils/play-promise.ts");
/* harmony import */ var utils_date__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! utils/date */ "./src/js/utils/date.ts");
/* harmony import */ var api_errors__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! api/errors */ "./src/js/api/errors.ts");





















/** @module */

/**
 @enum {ErrorCode} - The HTML5 media element encountered an error.
 */
var HTML5_BASE_MEDIA_ERROR = 224000;
/**
 @enum {ErrorCode} - The HTML5 media element's src was emptied or set to the page's location.
 */

var HTML5_SRC_RESET = 224005;
/**
 @enum {ErrorCode} - The HTML5 media element encountered a network error.
 */

var HTML5_NETWORK_ERROR = 221000;
/**
 @enum {ErrorCode} - The HTML5 media element encountered an error, resulting in an attempt to recover.
 */

var HTML5_BASE_WARNING = 324000;
var clearTimeout = window.clearTimeout;
var _name = 'html5';

var noop = function noop() {
  /* noop */
};

function _setupListeners(eventsHash, videoTag) {
  Object.keys(eventsHash).forEach(function (eventName) {
    videoTag.removeEventListener(eventName, eventsHash[eventName]);
    videoTag.addEventListener(eventName, eventsHash[eventName]);
  });
}

function _removeListeners(eventsHash, videoTag) {
  Object.keys(eventsHash).forEach(function (eventName) {
    videoTag.removeEventListener(eventName, eventsHash[eventName]);
  });
}

function VideoProvider(_playerId, _playerConfig, mediaElement) {
  // eslint-disable-next-line @typescript-eslint/no-this-alias
  var _this = this; // Current media state


  _this.state = events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_IDLE"]; // Are we buffering due to seek, or due to playback?

  _this.seeking = false; // Value of mediaElement.currentTime on last "timeupdate" used for decode error retry workaround

  _this.currentTime = -1; // Attempt to reload video on error

  _this.retries = 0;
  _this.maxRetries = 3;
  var loadAndParseHlsMetadata = _playerConfig.loadAndParseHlsMetadata,
      minDvrWindow = _playerConfig.minDvrWindow;
  _this.loadAndParseHlsMetadata = loadAndParseHlsMetadata === undefined ? true : !!loadAndParseHlsMetadata; // Always render natively in iOS and Safari, where HLS is supported.
  // Otherwise, use native rendering when set in the config for browsers that have adequate support.
  // FF, IE & Edge are excluded due to styling/positioning drawbacks.
  // The following issues need to be addressed before we enable native rendering in Edge:
  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8120475/
  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12079271/

  function renderNatively(configRenderNatively) {
    if (environment_environment__WEBPACK_IMPORTED_MODULE_2__["OS"].iOS || environment_environment__WEBPACK_IMPORTED_MODULE_2__["Browser"].safari) {
      return true;
    }

    return configRenderNatively && environment_environment__WEBPACK_IMPORTED_MODULE_2__["Browser"].chrome;
  }

  var MediaEvents = {
    progress: function progress() {
      providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__["default"].progress.call(_this);
      checkStaleStream();
    },
    timeupdate: function timeupdate() {
      if (_this.currentTime >= 0) {
        // Reset error retries after concurrent timeupdate events
        _this.retries = 0;
      }

      _this.currentTime = _videotag.currentTime; // Keep track of position before seek in iOS fullscreen

      if (_iosFullscreenState && _timeBeforeSeek !== _videotag.currentTime) {
        setTimeBeforeSeek(_videotag.currentTime);
      }

      providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__["default"].timeupdate.call(_this);
      checkStaleStream();

      if (environment_environment__WEBPACK_IMPORTED_MODULE_2__["Browser"].ie) {
        checkVisualQuality();
      }
    },
    resize: checkVisualQuality,
    ended: function ended() {
      _currentQuality = -1;
      clearTimeouts();
      providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__["default"].ended.call(_this);
    },
    loadedmetadata: function loadedmetadata() {
      var duration = _this.getDuration();

      if (_androidHls && duration === Infinity) {
        duration = 0;
      }

      var metadata = {
        metadataType: 'media',
        duration: duration,
        height: _videotag.videoHeight,
        width: _videotag.videoWidth,
        seekRange: _this.getSeekRange()
      };

      if (_this.fairplay) {
        metadata.drm = 'fairplay';
      }

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_META"], metadata);

      checkVisualQuality();
    },
    durationchange: function durationchange() {
      if (_androidHls) {
        return;
      }

      providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__["default"].progress.call(_this);
    },
    loadeddata: function loadeddata() {
      checkStartDateTime();

      _setAudioTracks(_videotag.audioTracks);

      _checkDelayedSeek(_this.getDuration());
    },
    canplay: function canplay() {
      _canSeek = true;

      if (!_androidHls) {
        _setMediaType();
      }

      checkVisualQuality();
      providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__["default"].canplay.call(_this);
    },
    seeking: function seeking() {
      var timeBeforeSeek = _timeBeforeSeek;
      var offset = _seekToTime !== null ? timeToPosition(_seekToTime) : _this.getCurrentTime();
      var position = timeToPosition(timeBeforeSeek);
      _timeBeforeSeek = _seekToTime;
      _seekToTime = null;
      _delayedSeek = 0;
      _this.seeking = true;

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_SEEK"], {
        position: position,
        offset: offset,
        duration: _this.getDuration(),
        currentTime: timeBeforeSeek,
        seekRange: _this.getSeekRange(),
        metadata: {
          currentTime: timeBeforeSeek
        }
      });
    },
    seeked: function seeked() {
      providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__["default"].seeked.call(_this);

      _this.ensureMetaTracksActive();
    },
    waiting: function waiting() {
      if (_this.seeking || _this.video.seeking) {
        _this.setState(events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_LOADING"]);
      } else if (_this.state === events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_PLAYING"]) {
        if (_this.atEdgeOfLiveStream()) {
          _this.setPlaybackRate(1);
        }

        _this.stallTime = _this.video.currentTime;

        _this.setState(events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_STALLED"]);
      }
    },
    webkitbeginfullscreen: function webkitbeginfullscreen(e) {
      _iosFullscreenState = true;

      _sendFullscreen(e);
    },
    webkitendfullscreen: function webkitendfullscreen(e) {
      _iosFullscreenState = false;

      _sendFullscreen(e);
    },
    error: function error() {
      var video = _this.video;
      var error = video.error;
      var errorCode = error && error.code || -1;

      if ((errorCode === 3 || errorCode === 4) && _this.retries < _this.maxRetries) {
        // Workaround Safari bug https://bugs.webkit.org/show_bug.cgi?id=195452
        //  and stale manifests
        _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["WARNING"], new api_errors__WEBPACK_IMPORTED_MODULE_17__["PlayerError"](null, HTML5_BASE_WARNING + errorCode - 1, error));

        _this.retries++;

        _videotag.load();

        if (_this.currentTime !== -1) {
          _canSeek = false;

          _this.seek(_this.currentTime);

          _this.currentTime = -1;
        }

        return;
      }

      var code = HTML5_BASE_MEDIA_ERROR;
      var key = api_errors__WEBPACK_IMPORTED_MODULE_17__["MSG_CANT_PLAY_VIDEO"];

      if (errorCode === 1) {
        code += errorCode;
      } else if (errorCode === 2) {
        key = api_errors__WEBPACK_IMPORTED_MODULE_17__["MSG_BAD_CONNECTION"];
        code = HTML5_NETWORK_ERROR;
      } else if (errorCode === 3 || errorCode === 4) {
        code += errorCode - 1;

        if (errorCode === 4 && video.src === location.href) {
          code = HTML5_SRC_RESET;
        }
      } else {
        key = api_errors__WEBPACK_IMPORTED_MODULE_17__["MSG_TECHNICAL_ERROR"];
      }

      _clearVideotagSource();

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_ERROR"], new api_errors__WEBPACK_IMPORTED_MODULE_17__["PlayerError"](key, code, error));
    }
  };
  Object.keys(providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__["default"]).forEach(function (eventName) {
    if (!MediaEvents[eventName]) {
      var mixinEventHandler = providers_video_listener_mixin__WEBPACK_IMPORTED_MODULE_5__["default"][eventName];

      MediaEvents[eventName] = function (e) {
        mixinEventHandler.call(_this, e);
      };
    }
  });

  Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(this, utils_backbone_events__WEBPACK_IMPORTED_MODULE_12__["default"], providers_video_actions_mixin__WEBPACK_IMPORTED_MODULE_6__["default"], providers_video_attached_mixin__WEBPACK_IMPORTED_MODULE_7__["default"], providers_tracks_mixin__WEBPACK_IMPORTED_MODULE_13__["default"], {
    renderNatively: renderNatively(_playerConfig.renderCaptionsNatively),
    eventsOn_: function eventsOn_() {
      _setupListeners(MediaEvents, _videotag);
    },
    eventsOff_: function eventsOff_() {
      _removeListeners(MediaEvents, _videotag);
    },
    detachMedia: function detachMedia() {
      providers_video_attached_mixin__WEBPACK_IMPORTED_MODULE_7__["default"].detachMedia.call(_this);
      clearTimeouts(); // Stop listening to track changes so disabling the current track doesn't update the model

      this.removeTracksListener(_videotag.textTracks, 'change', this.textTrackChangeHandler);
      this.removeTracksListener(_videotag.textTracks, 'addtrack', this.addTrackHandler);

      if (this.videoLoad) {
        _videotag.load = this.videoLoad;
      } // Prevent sideloaded tracks from showing during ad playback


      if (_shouldToggleTrackOnDetach()) {
        this.disableTextTrack();
      }
    },
    attachMedia: function attachMedia() {
      providers_video_attached_mixin__WEBPACK_IMPORTED_MODULE_7__["default"].attachMedia.call(_this);
      _canSeek = false; // If we were mid-seek when detached, we want to allow it to resume

      this.seeking = false; // In case the video tag was modified while we shared it

      _videotag.loop = false; // override load so that it's not used to reset the video tag by external JavaScript (iOS ads)

      if (environment_environment__WEBPACK_IMPORTED_MODULE_2__["OS"].iOS && !this.videoLoad) {
        var videoLoad = this.videoLoad = _videotag.load;

        _videotag.load = function () {
          if (_videotag.src === location.href) {
            if (_currentQuality === -1) {
              _currentQuality = _pickInitialQuality(_levels);
            }

            _setVideotagSource(_levels[_currentQuality]);

            if (_this.state === events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_PLAYING"]) {
              _videotag.play();
            }

            _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["WARNING"], new api_errors__WEBPACK_IMPORTED_MODULE_17__["PlayerError"](null, HTML5_BASE_WARNING + 5, new Error('video.load() was called after setting video.src to empty while playing video')));

            return;
          }

          return videoLoad.call(_videotag);
        };
      } // If there was a showing sideloaded track disabled in detached, re-enable it


      if (_shouldToggleTrackOnDetach()) {
        this.enableTextTrack();
      }

      if (this.renderNatively) {
        this.setTextTracks(this.video.textTracks);
      }

      this.addTracksListener(_videotag.textTracks, 'change', this.textTrackChangeHandler);
    },
    isLive: function isLive() {
      return _videotag.duration === Infinity;
    }
  });

  var _videotag = mediaElement; // wait for maria's quality level changes to merge

  var visualQuality = {
    level: {}
  }; // Prefer the config timeout, which is allowed to be 0 and null by default

  var _staleStreamDuration = _playerConfig.liveTimeout !== null ? _playerConfig.liveTimeout : 3 * 10 * 1000;

  var _canSeek = false; // true on valid time event

  var _delayedSeek = 0;
  var _seekToTime = null;
  var _timeBeforeSeek = null;

  var _levels;

  var _currentQuality = -1;

  var _iosFullscreenState = false;
  var _beforeResumeHandler = noop;
  var _audioTracks = null;

  var _currentAudioTrackIndex = -1;

  var _staleStreamTimeout = -1;

  var _stale = false;
  var _lastEndOfBuffer = null;
  var _androidHls = false;
  var dvrEnd = null;
  var dvrPosition = null;
  var dvrUpdatedTime = 0;
  this.video = _videotag;
  this.supportsPlaybackRate = true;
  this.startDateTime = 0;

  function checkVisualQuality() {
    var level = visualQuality.level;

    if (level.width !== _videotag.videoWidth || level.height !== _videotag.videoHeight) {
      // Exit if we're not certain that the stream is audio or the level is unknown
      if (!_videotag.videoWidth && !isAudioStream() || _currentQuality === -1) {
        return;
      }

      _this.ensureMetaTracksActive();

      level.width = _videotag.videoWidth;
      level.height = _videotag.videoHeight;

      _setMediaType();

      visualQuality.reason = visualQuality.reason || 'auto';
      var mode = _levels[_currentQuality].type === 'hls' ? 'auto' : 'manual';
      level.index = _currentQuality;
      level.label = _levels[_currentQuality].label;

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_VISUAL_QUALITY"], {
        reason: visualQuality.reason,
        mode: mode,
        bitrate: 0,
        level: {
          width: level.width,
          height: level.height,
          index: level.index,
          label: level.label
        }
      });

      visualQuality.reason = '';
    }
  }

  function checkStartDateTime() {
    var vtag = _videotag;

    if (vtag.getStartDate) {
      var startDate = vtag.getStartDate();
      var startDateTime = startDate.getTime ? startDate.getTime() : NaN;

      if (startDateTime !== _this.startDateTime && !isNaN(startDateTime)) {
        _this.setStartDateTime(startDateTime);
      }
    }
  }

  _this.setStartDateTime = function (startDateTime) {
    _this.startDateTime = startDateTime;
    var programDateTime = new Date(startDateTime).toISOString();

    var _this$getSeekRange = _this.getSeekRange(),
        start = _this$getSeekRange.start,
        end = _this$getSeekRange.end;

    start = Math.max(0, start);
    end = Math.max(start, end + 10);
    var metadataType = 'program-date-time';
    var metadata = {
      metadataType: metadataType,
      programDateTime: programDateTime,
      start: start,
      end: end
    };

    var cue = _this.createCue(start, end, JSON.stringify(metadata));

    _this.addVTTCue({
      type: 'metadata',
      cue: cue
    });
  };

  function setTimeBeforeSeek(currentTime) {
    _timeBeforeSeek = currentTime;
  }

  _this.getCurrentTime = function () {
    return getPosition(_videotag.currentTime);
  };

  function timeToPosition(currentTime) {
    var seekRange = _this.getSeekRange();

    if (_this.isLive() && Object(providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_8__["isDvr"])(seekRange.end - seekRange.start, minDvrWindow)) {
      return Math.min(0, currentTime - seekRange.end);
    }

    return currentTime;
  }

  function getPosition(currentTime) {
    var seekRange = _this.getSeekRange();

    if (_this.isLive()) {
      var rangeUpdated = !dvrPosition || Math.abs(dvrEnd - seekRange.end) > 1;

      if (rangeUpdated) {
        updateDvrPosition(seekRange);

        _this.ensureMetaTracksActive();
      }

      if (Object(providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_8__["isDvr"])(seekRange.end - seekRange.start, minDvrWindow)) {
        return dvrPosition;
      }
    }

    return currentTime;
  }

  function updateDvrPosition(seekRange) {
    dvrEnd = seekRange.end;
    dvrPosition = Math.min(0, _videotag.currentTime - dvrEnd);
    dvrUpdatedTime = Object(utils_date__WEBPACK_IMPORTED_MODULE_16__["now"])();
  }

  _this.getDuration = function () {
    var duration = _videotag.duration; // Don't sent time event on Android before real duration is known

    if (_androidHls && duration === Infinity && _videotag.currentTime === 0 || isNaN(duration)) {
      return 0;
    }

    var end = _getSeekableEnd();

    if (_this.isLive() && end) {
      var seekableDuration = end - _getSeekableStart();

      if (Object(providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_8__["isDvr"])(seekableDuration, minDvrWindow)) {
        // Player interprets negative duration as DVR
        duration = -seekableDuration;
      }
    }

    return duration;
  };

  _this.getSeekRange = function () {
    var seekRange = {
      start: 0,
      end: 0
    };
    var seekable = _videotag.seekable;

    if (seekable.length) {
      seekRange.end = _getSeekableEnd();
      seekRange.start = _getSeekableStart();
    } else if (Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isFinite"])(_videotag.duration)) {
      seekRange.end = _videotag.duration;
    }

    return seekRange;
  };

  _this.getLiveLatency = function () {
    var latency = null;

    var end = _getSeekableEnd();

    if (_this.isLive() && end) {
      latency = end + (Object(utils_date__WEBPACK_IMPORTED_MODULE_16__["now"])() - dvrUpdatedTime) / 1000 - _videotag.currentTime;
    }

    return latency;
  };

  function _checkDelayedSeek(duration) {
    // Don't seek when _delayedSeek is set to -1 in _completeLoad
    if (_delayedSeek && _delayedSeek !== -1 && duration && duration !== Infinity) {
      _this.seek(_delayedSeek);
    }
  } // Wait for quality levels work to merge


  function _getPublicLevels(levels) {
    var publicLevels;

    if (Array.isArray(levels) && levels.length > 0) {
      publicLevels = levels.map(function (level, i) {
        return {
          label: level.label || i
        };
      });
    }

    return publicLevels;
  }

  function setPlaylistItem(item) {
    _this.currentTime = -1;
    minDvrWindow = item.minDvrWindow;
    _levels = item.sources;
    _currentQuality = _pickInitialQuality(_levels);
  }

  function _pickInitialQuality(levels) {
    var currentQuality = Math.max(0, _currentQuality);
    var label = _playerConfig.qualityLabel;

    if (levels) {
      for (var i = 0; i < levels.length; i++) {
        if (levels[i].default) {
          currentQuality = i;
        }

        if (label && levels[i].label === label) {
          return i;
        }
      }
    }

    visualQuality.reason = 'initial choice';

    if (!visualQuality.level.width || !visualQuality.level.height) {
      visualQuality.level = {};
    }

    return currentQuality;
  }

  function _play() {
    var resumingPlayback = _videotag.paused && _videotag.played && _videotag.played.length;

    if (resumingPlayback && _this.isLive() && !Object(providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_8__["isDvr"])(_getSeekableEnd() - _getSeekableStart(), minDvrWindow)) {
      _this.clearTracks();

      _videotag.load();
    }

    return _videotag.play() || Object(providers_utils_play_promise__WEBPACK_IMPORTED_MODULE_15__["default"])(_videotag);
  }

  function _completeLoad(startTime) {
    _this.currentTime = -1;
    _delayedSeek = 0;
    clearTimeouts();
    var previousSource = _videotag.src;
    var sourceElement = document.createElement('source');
    sourceElement.src = _levels[_currentQuality].file;
    var sourceChanged = sourceElement.src !== previousSource;

    if (sourceChanged) {
      _setVideotagSource(_levels[_currentQuality]); // Do not call load if src was not set. load() will cancel any active play promise.


      if (previousSource) {
        _videotag.load();
      }
    } else if (startTime === 0 && _videotag.currentTime > 0) {
      // Load event is from the same video as before
      // restart video without dispatching seek event
      _delayedSeek = -1;

      _this.seek(startTime);
    } // Check if we have already seeked the mediaElement before _completeLoad has been called


    if (startTime > 0 && _videotag.currentTime !== startTime) {
      _this.seek(startTime);
    }

    var publicLevels = _getPublicLevels(_levels);

    if (publicLevels) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_LEVELS"], {
        levels: publicLevels,
        currentQuality: _currentQuality
      });
    }

    if (_levels.length && _levels[0].type !== 'hls') {
      _setMediaType();
    }
  } // Safari has a bug where our disable of an embedded rendered track causes
  //  the track to not display when we re-attach the media. We can avoid this
  //  by only disabling the track if sideloaded in safari


  function _shouldToggleTrackOnDetach() {
    if (!environment_environment__WEBPACK_IMPORTED_MODULE_2__["Browser"].safari) {
      return true;
    }

    var track = _this.getCurrentTextTrack();

    return track && track.sideloaded;
  }

  function _setVideotagSource(source) {
    _audioTracks = null;
    _currentAudioTrackIndex = -1;

    if (!visualQuality.reason) {
      visualQuality.reason = 'initial choice';
      visualQuality.level = {};
    }

    _canSeek = false;
    var sourceElement = document.createElement('source');
    sourceElement.src = source.file;
    var sourceChanged = _videotag.src !== sourceElement.src;

    if (sourceChanged) {
      _videotag.src = source.file;
    }
  }

  function _clearVideotagSource() {
    if (_videotag) {
      _this.disableTextTrack();

      _videotag.removeAttribute('preload');

      _videotag.removeAttribute('src');

      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["emptyElement"])(_videotag);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_9__["style"])(_videotag, {
        objectFit: ''
      });
      _currentQuality = -1; // Don't call load in iE9/10

      if (!environment_environment__WEBPACK_IMPORTED_MODULE_2__["Browser"].msie && 'load' in _videotag) {
        _videotag.load();
      }
    }
  }

  function _getSeekableStart() {
    var start = Infinity;
    ['buffered', 'seekable'].forEach(function (range) {
      var timeRange = _videotag[range];
      var index = timeRange ? timeRange.length : 0;

      while (index--) {
        var rangeStart = Math.min(start, timeRange.start(index));

        if (Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isFinite"])(rangeStart)) {
          start = rangeStart;
        }
      }
    });
    return start;
  }

  function _getSeekableEnd() {
    var end = 0;
    ['buffered', 'seekable'].forEach(function (range) {
      var timeRange = _videotag[range];
      var index = timeRange ? timeRange.length : 0;

      while (index--) {
        var rangeEnd = Math.max(end, timeRange.end(index));

        if (Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isFinite"])(rangeEnd)) {
          end = rangeEnd;
        }
      }
    });
    return end;
  }

  this.stop = function () {
    clearTimeouts();

    _clearVideotagSource();

    this.clearTracks(); // IE/Edge continue to play a video after changing video.src and calling video.load()
    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/5383483/ (not fixed in Edge 14)

    if (environment_environment__WEBPACK_IMPORTED_MODULE_2__["Browser"].ie) {
      _videotag.pause();
    }

    this.setState(events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_IDLE"]);
  };

  this.destroy = function () {
    var addTrackHandler = _this.addTrackHandler,
        cueChangeHandler = _this.cueChangeHandler,
        textTrackChangeHandler = _this.textTrackChangeHandler;
    var textTracks = _videotag.textTracks;

    _this.off();

    if (_this.videoLoad) {
      _videotag.load = _this.videoLoad;
    }

    _beforeResumeHandler = noop;

    _removeListeners(MediaEvents, _videotag);

    _this.removeTracksListener(_videotag.audioTracks, 'change', _audioTrackChangeHandler);

    _this.removeTracksListener(textTracks, 'change', textTrackChangeHandler);

    _this.removeTracksListener(textTracks, 'addtrack', addTrackHandler);

    if (cueChangeHandler) {
      for (var i = 0, len = textTracks.length; i < len; i++) {
        textTracks[i].removeEventListener('cuechange', cueChangeHandler);
      }
    }
  };

  this.init = function (item) {
    _this.retries = 0;
    _this.maxRetries = item.adType ? 0 : 3;
    setPlaylistItem(item);
    var source = _levels[_currentQuality];
    _androidHls = Object(providers_html5_android_hls__WEBPACK_IMPORTED_MODULE_3__["isAndroidHls"])(source);

    if (_androidHls) {
      // Playback rate is broken on Android HLS
      _this.supportsPlaybackRate = false; // Android HLS doesnt update its times correctly so it always falls in here.  Do not allow it to stall.

      MediaEvents.waiting = noop;
    }

    _this.eventsOn_(); // the loadeddata event determines the mediaType for HLS sources


    if (_levels.length && _levels[0].type !== 'hls') {
      this.sendMediaType(_levels);
    }

    visualQuality.reason = '';
  };

  this.preload = function (item) {
    setPlaylistItem(item);
    var source = _levels[_currentQuality];
    var preload = source.preload || 'metadata';

    if (preload !== 'none') {
      _videotag.setAttribute('preload', preload);

      _setVideotagSource(source);
    }
  };

  this.load = function (item) {
    setPlaylistItem(item);

    _completeLoad(item.starttime);

    this.setupSideloadedTracks(item.tracks);
  };

  this.play = function () {
    _beforeResumeHandler();

    return _play();
  };

  this.pause = function () {
    clearTimeouts();

    _beforeResumeHandler = function _beforeResumeHandler() {
      var unpausing = _videotag.paused && _videotag.currentTime;

      if (unpausing && _this.isLive()) {
        var end = _getSeekableEnd();

        var seekableDuration = end - _getSeekableStart();

        var isLiveNotDvr = !Object(providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_8__["isDvr"])(seekableDuration, minDvrWindow);
        var behindLiveEdge = end - _videotag.currentTime;

        if (isLiveNotDvr && end && (behindLiveEdge > 15 || behindLiveEdge < 0)) {
          // resume playback at edge of live stream
          _seekToTime = Math.max(end - 10, end - seekableDuration);

          if (!Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isFinite"])(_seekToTime)) {
            return;
          }

          setTimeBeforeSeek(_videotag.currentTime);
          _videotag.currentTime = _seekToTime;
        }
      }
    };

    _videotag.pause();
  };

  this.seek = function (seekToPosition) {
    var seekRange = _this.getSeekRange();

    var seekToTime = seekToPosition;

    if (seekToPosition < 0) {
      seekToTime += seekRange.end;
    }

    if (!_canSeek) {
      _canSeek = !!_getSeekableEnd();
    }

    if (_canSeek) {
      _delayedSeek = 0; // setting currentTime can throw an invalid DOM state exception if the video is not ready

      try {
        _this.seeking = true;

        if (_this.isLive() && Object(providers_utils_stream_type__WEBPACK_IMPORTED_MODULE_8__["isDvr"])(seekRange.end - seekRange.start, minDvrWindow)) {
          dvrPosition = Math.min(0, seekToTime - dvrEnd);

          if (seekToPosition < 0) {
            var timeSinceUpdate = Math.min(12, (Object(utils_date__WEBPACK_IMPORTED_MODULE_16__["now"])() - dvrUpdatedTime) / 1000);
            seekToTime += timeSinceUpdate;
          }
        }

        _seekToTime = seekToTime;
        setTimeBeforeSeek(_videotag.currentTime);
        _videotag.currentTime = seekToTime;
      } catch (e) {
        _this.seeking = false;
        _delayedSeek = seekToTime;
      }
    } else {
      _delayedSeek = seekToTime; // Firefox isn't firing canplay event when in a paused state
      // https://bugzilla.mozilla.org/show_bug.cgi?id=1194624

      if (environment_environment__WEBPACK_IMPORTED_MODULE_2__["Browser"].firefox && _videotag.paused) {
        _play();
      }
    }
  };

  function _audioTrackChangeHandler() {
    var _selectedAudioTrackIndex = -1;

    var tracks = _videotag.audioTracks;

    for (var i = 0; i < tracks.length; i++) {
      if (tracks[i].enabled) {
        _selectedAudioTrackIndex = i;
        break;
      }
    }

    _setCurrentAudioTrack(_selectedAudioTrackIndex);
  }

  function _sendFullscreen(e) {
    _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["NATIVE_FULLSCREEN"], {
      target: e.target,
      jwstate: _iosFullscreenState
    });
  }

  this.setVisibility = function (state) {
    state = !!state;

    if (state || environment_environment__WEBPACK_IMPORTED_MODULE_2__["OS"].android) {
      // Changing visibility to hidden on Android < 4.2 causes
      // the pause event to be fired. This causes audio files to
      // become unplayable. Hence the video tag is always kept
      // visible on Android devices.
      Object(utils_css__WEBPACK_IMPORTED_MODULE_9__["style"])(_this.container, {
        visibility: 'visible',
        opacity: 1
      });
    } else {
      Object(utils_css__WEBPACK_IMPORTED_MODULE_9__["style"])(_this.container, {
        visibility: '',
        opacity: 0
      });
    }
  };

  this.setFullscreen = function (state) {
    state = !!state; // This implementation is for iOS and Android WebKit only
    // This won't get called if the player container can go fullscreen

    if (state) {
      try {
        var enterFullscreen = _videotag.webkitEnterFullscreen || _videotag.webkitEnterFullScreen;

        if (enterFullscreen) {
          enterFullscreen.apply(_videotag);
        }
      } catch (error) {
        // object can't go fullscreen
        return false;
      }

      return _this.getFullscreen();
    }

    var exitFullscreen = _videotag.webkitExitFullscreen || _videotag.webkitExitFullScreen;

    if (exitFullscreen) {
      exitFullscreen.apply(_videotag);
    }

    return state;
  };

  _this.getFullscreen = function () {
    return _iosFullscreenState || !!_videotag.webkitDisplayingFullscreen;
  };

  this.setCurrentQuality = function (quality) {
    if (_currentQuality === quality) {
      return;
    }

    if (quality >= 0) {
      if (_levels && _levels.length > quality) {
        _currentQuality = quality;
        visualQuality.reason = 'api';
        visualQuality.level = {};
        this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_LEVEL_CHANGED"], {
          currentQuality: quality,
          levels: _getPublicLevels(_levels)
        }); // The playerConfig is not updated automatically, because it is a clone
        // from when the provider was first initialized

        _playerConfig.qualityLabel = _levels[quality].label;

        _completeLoad(_videotag.currentTime || 0);

        _play();
      }
    }
  };

  this.setPlaybackRate = function (playbackRate) {
    // Set defaultPlaybackRate so that we do not send ratechange events when setting src
    _videotag.playbackRate = _videotag.defaultPlaybackRate = playbackRate;
  };

  this.getPlaybackRate = function () {
    return _videotag.playbackRate;
  };

  this.getCurrentQuality = function () {
    return _currentQuality;
  };

  this.getQualityLevels = function () {
    if (Array.isArray(_levels)) {
      return _levels.map(function (level) {
        return Object(providers_data_normalizer__WEBPACK_IMPORTED_MODULE_1__["qualityLevel"])(level);
      });
    }

    return [];
  };

  this.getName = function () {
    return {
      name: _name
    };
  };

  this.setCurrentAudioTrack = _setCurrentAudioTrack;
  this.getAudioTracks = _getAudioTracks;
  this.getCurrentAudioTrack = _getCurrentAudioTrack;

  function _setAudioTracks(tracks) {
    _audioTracks = null;

    if (!tracks) {
      return;
    }

    if (tracks.length) {
      for (var i = 0; i < tracks.length; i++) {
        if (tracks[i].enabled) {
          _currentAudioTrackIndex = i;
          break;
        }
      }

      if (_currentAudioTrackIndex === -1) {
        _currentAudioTrackIndex = 0;
        tracks[_currentAudioTrackIndex].enabled = true;
      }

      _audioTracks = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["map"])(tracks, function (track) {
        var _track = {
          name: track.label || track.language,
          language: track.language
        };
        return _track;
      });
    }

    _this.addTracksListener(tracks, 'change', _audioTrackChangeHandler);

    if (_audioTracks) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["AUDIO_TRACKS"], {
        currentTrack: _currentAudioTrackIndex,
        tracks: _audioTracks
      });
    }
  }

  function _setCurrentAudioTrack(index) {
    if (_videotag && _videotag.audioTracks && _audioTracks && index > -1 && index < _videotag.audioTracks.length && index !== _currentAudioTrackIndex) {
      _videotag.audioTracks[_currentAudioTrackIndex].enabled = false;
      _currentAudioTrackIndex = index;
      _videotag.audioTracks[_currentAudioTrackIndex].enabled = true;

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["AUDIO_TRACK_CHANGED"], {
        currentTrack: _currentAudioTrackIndex,
        tracks: _audioTracks
      });
    }
  }

  function _getAudioTracks() {
    return _audioTracks || [];
  }

  function _getCurrentAudioTrack() {
    return _currentAudioTrackIndex;
  }

  function isAudioStream() {
    if (_videotag.readyState < 2) {
      return;
    }

    return _videotag.videoHeight === 0;
  }

  function _setMediaType() {
    var isAudio = isAudioStream();

    if (typeof isAudio !== 'undefined') {
      var mediaType = isAudio ? 'audio' : 'video';

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_TYPE"], {
        mediaType: mediaType
      });
    }
  } // If we're live and the buffer end has remained the same for some time, mark the stream as stale and check if the stream is over


  function checkStaleStream() {
    // Never kill a stale live stream if the timeout was configured to 0
    if (_staleStreamDuration === 0) {
      return;
    }

    var endOfBuffer = Object(utils_time_ranges__WEBPACK_IMPORTED_MODULE_14__["default"])(_videotag.buffered);

    var live = _this.isLive(); // Don't end if we have noting buffered yet, or cannot get any information about the buffer


    if (live && endOfBuffer && _lastEndOfBuffer === endOfBuffer) {
      if (_staleStreamTimeout === -1) {
        _staleStreamTimeout = setTimeout(function () {
          _stale = true;
          checkStreamEnded();
        }, _staleStreamDuration);
      }
    } else {
      clearTimeouts();
      _stale = false;
    }

    _lastEndOfBuffer = endOfBuffer;
  }

  function checkStreamEnded() {
    if (_stale && _this.atEdgeOfLiveStream()) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_ERROR"], new api_errors__WEBPACK_IMPORTED_MODULE_17__["PlayerError"](api_errors__WEBPACK_IMPORTED_MODULE_17__["MSG_LIVE_STREAM_DOWN"], HTML5_ERROR_LIVE_STREAM_DOWN_OR_ENDED));

      return true;
    }

    return false;
  }

  function clearTimeouts() {
    clearTimeout(_staleStreamTimeout);
    _staleStreamTimeout = -1;
  }
}

Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(VideoProvider.prototype, providers_default__WEBPACK_IMPORTED_MODULE_11__["default"]);

VideoProvider.getName = function () {
  return {
    name: 'html5'
  };
};

/* harmony default export */ __webpack_exports__["default"] = (VideoProvider);
/**
 *
 @enum {ErrorCode} - The HTML5 live stream is down or has ended.
 */

var HTML5_ERROR_LIVE_STREAM_DOWN_OR_ENDED = 220001;

/***/ }),

/***/ "./src/js/providers/tracks-mixin.ts":
/*!******************************************!*\
  !*** ./src/js/providers/tracks-mixin.ts ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var controller_tracks_loader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! controller/tracks-loader */ "./src/js/controller/tracks-loader.ts");
/* harmony import */ var controller_tracks_helper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! controller/tracks-helper */ "./src/js/controller/tracks-helper.ts");
/* harmony import */ var providers_utils_id3Parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! providers/utils/id3Parser */ "./src/js/providers/utils/id3Parser.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");






var Tracks = {
  _itemTracks: null,
  _textTracks: null,
  _currentTextTrackIndex: -1,
  _tracksById: null,
  _cuesByTrackId: null,
  _cachedVTTCues: null,
  _metaCuesByTextTime: null,
  _unknownCount: 0,
  _activeCues: null,
  _cues: null,
  textTrackChangeHandler: null,
  addTrackHandler: null,
  cueChangeHandler: null,
  renderNatively: false,
  _initTextTracks: function _initTextTracks() {
    this._textTracks = [];
    this._tracksById = {};
    this._metaCuesByTextTime = {};
    this._cuesByTrackId = {};
    this._cachedVTTCues = {};
    this._cues = {};
    this._activeCues = {};
    this._unknownCount = 0;
  },
  addTracksListener: function addTracksListener(tracks, eventType, handler) {
    if (!tracks) {
      return;
    } // Always remove existing listener


    this.removeTracksListener(tracks, eventType, handler);

    if (this.instreamMode) {
      return;
    }

    if (tracks.addEventListener) {
      tracks.addEventListener(eventType, handler);
    } else {
      tracks['on' + eventType] = handler;
    }
  },
  removeTracksListener: function removeTracksListener(tracks, eventType, handler) {
    if (!tracks) {
      return;
    }

    if (tracks.removeEventListener && handler) {
      tracks.removeEventListener(eventType, handler);
    } else {
      tracks['on' + eventType] = null;
    }
  },
  clearTracks: function clearTracks() {
    var _this = this;

    Object(controller_tracks_loader__WEBPACK_IMPORTED_MODULE_0__["cancelXhr"])(this._itemTracks);
    var _tracksById = this._tracksById;

    if (_tracksById) {
      Object.keys(_tracksById).forEach(function (trackId) {
        if (trackId.indexOf('nativemetadata') === 0) {
          var metadataTrack = _tracksById[trackId];

          if (_this.cueChangeHandler) {
            metadataTrack.removeEventListener('cuechange', _this.cueChangeHandler);
          }

          _removeCues(_this.renderNatively, [metadataTrack], true);
        }
      });
    }

    this._itemTracks = null;
    this._textTracks = null;
    this._tracksById = null;
    this._cuesByTrackId = null;
    this._metaCuesByTextTime = null;
    this._unknownCount = 0;
    this._currentTextTrackIndex = -1;
    this._activeCues = {};
    this._cues = {};

    if (this.renderNatively) {
      var _tracks = this.video.textTracks;

      if (this.textTrackChangeHandler) {
        // Removing listener first to ensure that removing cues does not trigger it unnecessarily
        this.removeTracksListener(_tracks, 'change', this.textTrackChangeHandler);
      }

      _removeCues(this.renderNatively, _tracks, true);
    }
  },
  clearMetaCues: function clearMetaCues() {
    var _this2 = this;

    var _tracksById = this._tracksById,
        _cachedVTTCues = this._cachedVTTCues;

    if (_tracksById && _cachedVTTCues) {
      Object.keys(_tracksById).forEach(function (trackId) {
        if (trackId.indexOf('nativemetadata') === 0) {
          var metadataTrack = _tracksById[trackId];

          _removeCues(_this2.renderNatively, [metadataTrack], false);

          metadataTrack.mode = 'hidden';
          metadataTrack.inuse = true;

          if (metadataTrack._id) {
            _cachedVTTCues[metadataTrack._id] = {};
          }
        }
      });
    }
  },
  clearCueData: function clearCueData(trackId) {
    // Clear track cues to prevent duplicates
    var _cachedVTTCues = this._cachedVTTCues;

    if (_cachedVTTCues && _cachedVTTCues[trackId]) {
      _cachedVTTCues[trackId] = {};

      if (this._tracksById) {
        this._tracksById[trackId].data = [];
      }
    }
  },
  disableTextTrack: function disableTextTrack() {
    var track = this.getCurrentTextTrack();

    if (track) {
      // FF does not remove the active cue from the dom when the track is hidden, so we must disable it
      track.mode = 'disabled'; // IOS native captions does not remove the active cue from the dom when the track is disabled, so we must hide it

      var _trackId = track._id;

      if (_trackId && isNativeCaptionsOrSubtitles(_trackId) || this.renderNatively && environment_environment__WEBPACK_IMPORTED_MODULE_3__["OS"].iOS) {
        track.mode = 'hidden';
      }
    }
  },
  enableTextTrack: function enableTextTrack() {
    var track = this.getCurrentTextTrack();

    if (track) {
      track.mode = 'showing';
    }
  },
  getCurrentTextTrack: function getCurrentTextTrack() {
    if (this._textTracks) {
      return this._textTracks[this._currentTextTrackIndex];
    }
  },
  getSubtitlesTrack: function getSubtitlesTrack() {
    return this._currentTextTrackIndex;
  },
  addTextTracks: function addTextTracks(tracksArray) {
    var _this3 = this;

    var textTracks = [];

    if (!tracksArray) {
      return textTracks;
    }

    if (!this._textTracks) {
      this._initTextTracks();
    }

    tracksArray.forEach(function (itemTrack) {
      // only add valid and supported kinds https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track
      if (itemTrack.includedInManifest || itemTrack.kind && !isCaptionsOrSubtitles(itemTrack.kind)) {
        return;
      }

      var textTrackAny = _this3._createTrack(itemTrack);

      _this3._addTrackToList(textTrackAny);

      textTracks.push(textTrackAny);

      if (itemTrack.file) {
        itemTrack.data = [];
        Object(controller_tracks_loader__WEBPACK_IMPORTED_MODULE_0__["loadFile"])(itemTrack, function (vttCues) {
          textTrackAny.sideloaded = true;

          _this3.addVTTCuesToTrack(textTrackAny, vttCues);
        }, function (error) {
          _this3.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["WARNING"], error);
        });
      }
    });

    if (this._textTracks && this._textTracks.length) {
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["SUBTITLES_TRACKS"], {
        tracks: this._textTracks
      });
    }

    return textTracks;
  },
  setTextTracks: function setTextTracks(tracks) {
    var _this4 = this;

    this._currentTextTrackIndex = -1;

    if (!tracks) {
      return;
    }

    if (!this._textTracks) {
      this._initTextTracks();
    } else {
      var _tracksById = this._tracksById;
      this._activeCues = {};
      this._cues = {}; // Remove the 608 captions track that was mutated by the browser

      this._unknownCount = 0;
      this._textTracks = this._textTracks.filter(function (track) {
        var trackId = track._id;

        if (_this4.renderNatively && trackId && isNativeCaptionsOrSubtitles(trackId)) {
          delete _tracksById[trackId];
          return false;
        } else if (track.name && track.name.indexOf('Unknown') === 0) {
          _this4._unknownCount++;
        }

        if (trackId.indexOf('nativemetadata') === 0 && track.inBandMetadataTrackDispatchType === 'com.apple.streaming') {
          // Remove the ID3 track from the cache
          delete _tracksById[trackId];
        }

        return true;
      }, this);
    } // filter for 'subtitles' or 'captions' tracks


    if (tracks.length) {
      var i = 0;
      var len = tracks.length;
      var _tracksById2 = this._tracksById;
      var _cuesByTrackId = this._cuesByTrackId;

      for (i; i < len; i++) {
        var _track = tracks[i];

        var _trackId2 = _track._id || '';

        if (!_trackId2) {
          if (_track.inuse === false && isCaptionsOrSubtitles(_track.kind) && this.renderNatively) {
            // ignore native captions tracks from previous items that no longer can be re-used
            _track._id = 'native' + _track.kind + i;
            continue;
          }

          if (isCaptionsOrSubtitles(_track.kind) || _track.kind === 'metadata') {
            _trackId2 = _track._id = 'native' + _track.kind + i;

            if (!_track.label && _track.kind === 'captions') {
              // track label is read only in Safari
              // 'captions' tracks without a label need a name in order for the cc menu to work
              var labelInfo = Object(controller_tracks_helper__WEBPACK_IMPORTED_MODULE_1__["createLabel"])(_track, this._unknownCount);
              _track.name = labelInfo.label;
              this._unknownCount = labelInfo.unknownCount;
            }
          } else {
            _trackId2 = _track._id = Object(controller_tracks_helper__WEBPACK_IMPORTED_MODULE_1__["createId"])(_track, this._textTracks ? this._textTracks.length : 0);
          }

          if (_tracksById2[_trackId2]) {
            // tracks without unique ids must not be marked as "inuse"
            continue;
          }

          _track.inuse = true;
        }

        if (!_track.inuse || _tracksById2[_trackId2]) {
          continue;
        } // setup TextTrack


        if (_track.kind === 'metadata') {
          // track mode needs to be "hidden", not "showing", so that cues don't display as captions in Firefox
          _track.mode = 'hidden';

          var _handler = this.cueChangeHandler = this.cueChangeHandler || cueChangeHandler.bind(this);

          _track.removeEventListener('cuechange', _handler);

          _track.addEventListener('cuechange', _handler);

          _tracksById2[_trackId2] = _track;
        } else if (isCaptionsOrSubtitles(_track.kind)) {
          var mode = _track.mode;
          var cue = void 0; // By setting the track mode to 'hidden', we can determine if the track has cues

          _track.mode = 'hidden';

          if ((!_track.cues || !_track.cues.length) && _track.embedded) {
            // There's no method to remove tracks added via: video.addTextTrack.
            // This ensures the 608 captions track isn't added to the CC menu until it has cues
            continue;
          }

          if (mode !== 'disabled' || isNativeCaptionsOrSubtitles(_trackId2)) {
            _track.mode = mode;
          } // Parsed cues may not have been added to this track yet


          if (_cuesByTrackId[_trackId2] && !_cuesByTrackId[_trackId2].loaded) {
            var _cues2 = _cuesByTrackId[_trackId2].cues;

            while (cue = _cues2.shift()) {
              _addCueToTrack(this.renderNatively, _track, cue);
            }

            _track.mode = mode;
            _cuesByTrackId[_trackId2].loaded = true;
          }

          this._addTrackToList(_track);
        }
      }
    }

    if (this.renderNatively) {
      this.addTrackListeners(tracks);
    }

    if (this._textTracks && this._textTracks.length) {
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["SUBTITLES_TRACKS"], {
        tracks: this._textTracks
      });
    }
  },
  addTrackListeners: function addTrackListeners(tracks) {
    // Only bind and set this.textTrackChangeHandler once so that removeEventListener works
    var handler = this.textTrackChangeHandler = this.textTrackChangeHandler || textTrackChangeHandler.bind(this);
    this.removeTracksListener(tracks, 'change', handler);
    this.addTracksListener(tracks, 'change', handler);

    if (environment_environment__WEBPACK_IMPORTED_MODULE_3__["Browser"].edge || environment_environment__WEBPACK_IMPORTED_MODULE_3__["Browser"].firefox) {
      // Listen for TextTracks added to the videotag after the onloadeddata event in Edge and Firefox,
      // NOT Safari! Handling this event in Safari 12 and lower results in captions not rendering after
      // instream or live restart (JW8-10815, JW8-11006)
      handler = this.addTrackHandler = this.addTrackHandler || addTrackHandler.bind(this);
      this.removeTracksListener(tracks, 'addtrack', handler);
      this.addTracksListener(tracks, 'addtrack', handler);
    }
  },
  setupSideloadedTracks: function setupSideloadedTracks(itemTracks) {
    // Add tracks if we're starting playback or resuming after a midroll
    if (!this.renderNatively) {
      return;
    } // Determine if the tracks are the same and the embedded + sideloaded count = # of tracks in the controlbar


    itemTracks = itemTracks || null;
    var alreadyLoaded = itemTracks === this._itemTracks;

    if (!alreadyLoaded) {
      Object(controller_tracks_loader__WEBPACK_IMPORTED_MODULE_0__["cancelXhr"])(this._itemTracks);
    }

    this._itemTracks = itemTracks;

    if (!itemTracks) {
      return;
    }

    if (!alreadyLoaded) {
      this.disableTextTrack();

      this._clearSideloadedTextTracks();

      this.addTextTracks(itemTracks);
    }
  },
  setSubtitlesTrack: function setSubtitlesTrack(menuIndex) {
    if (!this.renderNatively) {
      if (this.setCurrentSubtitleTrack) {
        this.setCurrentSubtitleTrack(menuIndex - 1);
      }

      return;
    }

    if (!this._textTracks) {
      return;
    } // 0 = 'Off'


    if (menuIndex === 0) {
      this._textTracks.forEach(function (track) {
        track.mode = track.embedded ? 'hidden' : 'disabled';
      });
    } // Track index is 1 less than controlbar index to account for 'Off' = 0.
    // Prevent unnecessary track change events


    if (this._currentTextTrackIndex === menuIndex - 1) {
      return;
    } // Turn off current track


    this.disableTextTrack(); // Set the provider's index to the model's index, then show the selected track if it exists

    this._currentTextTrackIndex = menuIndex - 1;
    var track = this.getCurrentTextTrack();

    if (track) {
      track.mode = 'showing';
    } // Update the model index since the track change may have come from a browser event


    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["SUBTITLES_TRACK_CHANGED"], {
      currentTrack: this._currentTextTrackIndex + 1,
      tracks: this._textTracks
    });
  },
  createCue: function createCue(start, end, content) {
    var MetaCue = window.VTTCue || window.TextTrackCue; // Set a minimum duration for the cue
    // VTTCues must have a duration for "cuechange" to be dispatched

    var cueEnd = Math.max(end || 0, start + 0.25);
    return new MetaCue(start, cueEnd, content);
  },
  addVTTCue: function addVTTCue(cueData, cacheKey) {
    if (!this._tracksById) {
      this._initTextTracks();
    }

    var trackId = cueData.track ? cueData.track : 'native' + cueData.type;
    var track = this._tracksById[trackId];
    var label = cueData.type === 'captions' ? 'Unknown CC' : 'ID3 Metadata';
    var vttCue = cueData.cue;

    if (!track) {
      var _itemTrack = {
        kind: cueData.type,
        _id: trackId,
        label: label,
        'default': false
      };

      if (this.renderNatively || _itemTrack.kind === 'metadata') {
        track = this._createTrack(_itemTrack);
        track.embedded = true;
        this.setTextTracks(this.video.textTracks);
      } else {
        track = this.addTextTracks([_itemTrack])[0];
      }
    }

    if (this._cacheVTTCue(track, vttCue, cacheKey)) {
      var useTrackCueHelper = this.renderNatively || track.kind === 'metadata';

      if (useTrackCueHelper) {
        _addCueToTrack(useTrackCueHelper, track, vttCue);
      } else {
        track.data.push(vttCue);
      }

      return vttCue;
    }

    return null;
  },
  addVTTCuesToTrack: function addVTTCuesToTrack(track, vttCues) {
    if (!this.renderNatively) {
      return;
    }

    var trackId = track._id;
    var _tracksById = this._tracksById;
    var _cuesByTrackId = this._cuesByTrackId;
    var textTrack = _tracksById[trackId]; // the track may not be on the video tag yet

    if (!textTrack) {
      if (!_cuesByTrackId) {
        _cuesByTrackId = this._cuesByTrackId = {};
      }

      _cuesByTrackId[trackId] = {
        cues: vttCues,
        loaded: false
      };
      return;
    } // Cues already added


    if (_cuesByTrackId[trackId] && _cuesByTrackId[trackId].loaded) {
      return;
    }

    var cue;
    _cuesByTrackId[trackId] = {
      cues: vttCues,
      loaded: true
    };

    while (cue = vttCues.shift()) {
      _addCueToTrack(this.renderNatively, textTrack, cue);
    }
  },
  parseNativeID3Cues: function parseNativeID3Cues(cues, previousCues) {
    var lastCue = cues[cues.length - 1];

    if (previousCues && previousCues.length === cues.length && (lastCue._parsed || cuesMatch(previousCues[previousCues.length - 1], lastCue))) {
      return;
    }

    var dataCueSets = [];
    var parsedDataCueSets = [];
    var dataCueSetIndex = -1;
    var startTime = -1;
    var previousStart = -1;

    for (var i = 0; i < cues.length; i++) {
      var cue = cues[i];

      if (!cue._extended && !!(cue.data || cue.value)) {
        if (cue.startTime !== startTime || cue.endTime === null) {
          previousStart = startTime;
          startTime = cue.startTime;
          var previousSet = dataCueSets[dataCueSetIndex];
          dataCueSets[++dataCueSetIndex] = [];
          parsedDataCueSets[dataCueSetIndex] = []; // increase id3 cue duration to a minimum of 0.25s up to next id3 cue start to ensure
          // "cuechange" event is fired and it is added to activeCues when currentTime intersects cue range

          var gap = startTime - previousStart;

          if (previousSet && gap > 0) {
            // eslint-disable-next-line max-depth
            for (var j = 0; j < previousSet.length; j++) {
              var previousCue = previousSet[j];
              previousCue.endTime = startTime;
              previousCue._extended = true;
            }
          }
        }

        dataCueSets[dataCueSetIndex].push(cue);

        if (!cue._parsed) {
          parsedDataCueSets[dataCueSetIndex].push(cue);

          if (cue.endTime - startTime < 0.25) {
            cue.endTime = startTime + 0.25;
          }

          cue._parsed = true;
        }
      }
    }

    for (var _i = 0; _i < parsedDataCueSets.length; _i++) {
      if (parsedDataCueSets[_i].length) {
        var event = getId3CueMetaEvent(parsedDataCueSets[_i]);
        this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_META_CUE_PARSED"], event);
      }
    }
  },
  triggerActiveCues: function triggerActiveCues(currentActiveCues, previousActiveCues) {
    var _this5 = this;

    var dataCues = currentActiveCues.filter(function (cue) {
      // Prevent duplicate meta events for cues that were active in the previous "cuechange" event
      if (previousActiveCues && previousActiveCues.some(function (prevCue) {
        return cuesMatch(cue, prevCue);
      })) {
        return false;
      }

      if (cue.data) {
        return true;
      }

      var event = cue.text ? getTextCueMetaEvent(cue) : null;

      if (event) {
        if (event.metadataType === 'emsg') {
          event.metadata = event.metadata || {};
          event.metadata.messageData = cue.value;
        }

        _this5.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_META"], event);
      } else if (cue.value) {
        return true;
      }

      return false;
    });

    if (dataCues.length) {
      var event = getId3CueMetaEvent(dataCues);
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_META"], event);
    }
  },
  ensureMetaTracksActive: function ensureMetaTracksActive() {
    // Safari sometimes disables metadata tracks after seeking. It does this without warning,
    // breaking API metadata event functionality.
    // Ensure metadata tracks are enabled in "hidden" mode.
    var tracks = this.video.textTracks;
    var len = tracks.length;

    for (var i = 0; i < len; i++) {
      var _track2 = tracks[i];

      if (_track2.kind === 'metadata' && _track2.mode === 'disabled') {
        _track2.mode = 'hidden';
      }
    }
  },
  _cacheVTTCue: function _cacheVTTCue(track, vttCue, cacheKey) {
    var trackKind = track.kind;
    var trackId = track._id;
    var _cachedVTTCues = this._cachedVTTCues;

    if (!_cachedVTTCues[trackId]) {
      _cachedVTTCues[trackId] = {};
    }

    var cachedCues = _cachedVTTCues[trackId];
    var cacheKeyTime;

    switch (trackKind) {
      case 'captions':
      case 'subtitles':
        {
          // VTTCues should have unique start and end times, even in cases where there are multiple
          // active cues. This is safer than ensuring text is unique, which may be violated on seek.
          // Captions within .05s of each other are treated as unique to account for
          // quality switches where start/end times are slightly different.
          cacheKeyTime = cacheKey || Math.floor(vttCue.startTime * 20);
          var cacheLine = '_' + (vttCue.line || 'auto');
          var cacheValue = Math.floor(vttCue.endTime * 20);
          var cueExists = cachedCues[cacheKeyTime + cacheLine] || cachedCues[cacheKeyTime + 1 + cacheLine] || cachedCues[cacheKeyTime - 1 + cacheLine];

          if (cueExists && Math.abs(cueExists - cacheValue) <= 1) {
            return false;
          }

          cachedCues[cacheKeyTime + cacheLine] = cacheValue;
          return true;
        }

      case 'metadata':
        {
          var text = vttCue.data ? new Uint8Array(vttCue.data).join('') : vttCue.text;
          cacheKeyTime = cacheKey || vttCue.startTime + text;

          if (cachedCues[cacheKeyTime]) {
            return false;
          }

          cachedCues[cacheKeyTime] = vttCue.endTime;
          return true;
        }

      default:
        return false;
    }
  },
  _addTrackToList: function _addTrackToList(track) {
    this._textTracks.push(track);

    this._tracksById[track._id] = track;
  },
  _createTrack: function _createTrack(itemTrack) {
    var track;
    var labelInfo = Object(controller_tracks_helper__WEBPACK_IMPORTED_MODULE_1__["createLabel"])(itemTrack, this._unknownCount);
    var label = labelInfo.label;
    this._unknownCount = labelInfo.unknownCount;

    if (this.renderNatively || itemTrack.kind === 'metadata') {
      var _tracks2 = this.video.textTracks; // TextTrack label is read only, so we'll need to create a new track if we don't
      // already have one with the same label

      track = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_5__["findWhere"])(_tracks2, {
        label: label
      });

      if (!track) {
        track = this.video.addTextTrack(itemTrack.kind, label, itemTrack.language || '');
      }

      track.default = itemTrack.default;
      track.mode = 'disabled';
      track.inuse = true;
    } else {
      track = itemTrack;
      track.data = track.data || [];
    }

    if (!track._id) {
      track._id = Object(controller_tracks_helper__WEBPACK_IMPORTED_MODULE_1__["createId"])(itemTrack, this._textTracks ? this._textTracks.length : 0);
    }

    return track;
  },
  _clearSideloadedTextTracks: function _clearSideloadedTextTracks() {
    // Clear VTT textTracks
    if (!this._textTracks) {
      return;
    }

    var nonSideloadedTracks = this._textTracks.filter(function (track) {
      return track.embedded || track.groupid === 'subs';
    });

    this._initTextTracks();

    var _tracksById = this._tracksById;
    nonSideloadedTracks.forEach(function (track) {
      _tracksById[track._id] = track;
    });
    this._textTracks = nonSideloadedTracks;
  }
};

function textTrackChangeHandler() {
  var textTracks = this.video.textTracks;
  var inUseTracks = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_5__["filter"])(textTracks, function (track) {
    return (track.inuse || !track._id) && isCaptionsOrSubtitles(track.kind);
  });

  if (!this._textTracks || _tracksModified.call(this, inUseTracks)) {
    this.setTextTracks(textTracks);
    return;
  } // If a caption/subtitle track is showing, find its index


  var selectedTextTrackIndex = -1;

  for (var i = 0; i < this._textTracks.length; i++) {
    if (this._textTracks[i].mode === 'showing') {
      selectedTextTrackIndex = i;
      break;
    }
  } // Notifying the model when the index changes keeps the current index in sync in iOS Fullscreen mode


  if (selectedTextTrackIndex !== this._currentTextTrackIndex) {
    this.setSubtitlesTrack(selectedTextTrackIndex + 1);
  }
}

function _tracksModified(inUseTracks) {
  var _textTracks = this._textTracks;
  var _tracksById = this._tracksById; // Need to add new textTracks coming from the video tag

  if (inUseTracks.length > _textTracks.length) {
    return true;
  } // Tracks may have changed in Safari after an ad


  for (var i = 0; i < inUseTracks.length; i++) {
    var _track3 = inUseTracks[i];

    if (!_track3._id || !_tracksById[_track3._id]) {
      return true;
    }
  }

  return false;
} // Used in MS Edge to get tracks from the videotag as they're added


function addTrackHandler(e) {
  var track = e.track;

  if (track && track._id) {
    return;
  }

  this.setTextTracks(this.video.textTracks);
}

function cueChangeHandler(e) {
  var track = e.target;
  var activeCues = track.activeCues,
      cues = track.cues;
  var trackId = track._id;
  var _cues = this._cues;
  var _activeCues = this._activeCues;

  if (cues && cues.length) {
    var _previousCues = _cues[trackId];
    _cues[trackId] = Array.prototype.slice.call(cues);
    this.parseNativeID3Cues(cues, _previousCues);
  } else {
    delete _cues[trackId];
  }

  if (activeCues && activeCues.length) {
    var _previousActiveCues = _activeCues[trackId];

    var _currentActiveCues = _activeCues[trackId] = Array.prototype.slice.call(activeCues);

    this.triggerActiveCues(_currentActiveCues, _previousActiveCues);
  } else {
    delete _activeCues[trackId];
  }
} // ////////////////////
// //// PRIVATE METHODS
// ////////////////////


function _addCueToTrack(renderNatively, track, vttCue) {
  // IE/Edge will throw an exception if cues are not inserted in time order: https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/13183203/
  if (environment_environment__WEBPACK_IMPORTED_MODULE_3__["Browser"].ie) {
    var cue = vttCue;

    if (renderNatively || track.kind === 'metadata') {
      // There's no support for the VTTCue interface in IE/Edge.
      // We need to convert VTTCue to TextTrackCue before adding them to the TextTrack
      // This unfortunately removes positioning properties from the cues
      cue = new window.TextTrackCue(vttCue.startTime, vttCue.endTime, vttCue.text);

      if (vttCue.value) {
        cue.value = vttCue.value;
      }
    }

    insertCueInOrder(track, cue);
  } else {
    try {
      track.addCue(vttCue);
    } catch (error) {
      console.error(error);
    }
  }
}

function insertCueInOrder(track, vttCue) {
  var temp = []; // If the track mode is 'disabled', track.cues will be null; set it to hidden so that we can access.

  var mode = track.mode;
  track.mode = 'hidden';
  var cues = track.cues;

  if (cues) {
    for (var i = cues.length - 1; i >= 0; i--) {
      if (cues[i].startTime > vttCue.startTime) {
        temp.unshift(cues[i]);
        track.removeCue(cues[i]);
      } else {
        break;
      }
    }
  }

  try {
    track.addCue(vttCue);
    temp.forEach(function (cue) {
      return track.addCue(cue);
    });
  } catch (error) {
    console.error(error);
  } // Restore the original track state


  track.mode = mode;
}

function _removeCues(renderNatively, tracks, removeCustomAttributes) {
  if (tracks && tracks.length) {
    Object(utils_underscore__WEBPACK_IMPORTED_MODULE_5__["each"])(tracks, function (track) {
      var trackId = track._id || '';

      if (removeCustomAttributes) {
        track._id = undefined;
      } // Let IE, Edge and Safari handle cleanup of non-sideloaded text tracks for native rendering


      if ((environment_environment__WEBPACK_IMPORTED_MODULE_3__["Browser"].ie || environment_environment__WEBPACK_IMPORTED_MODULE_3__["Browser"].safari) && renderNatively && /^(native|subtitle|cc)/.test(trackId)) {
        return;
      } // Cues are inaccessible if the track is disabled. While hidden,
      // we can remove cues while the track is in a non-visible state
      // Set to disabled before hidden to ensure active cues disappear


      if (!environment_environment__WEBPACK_IMPORTED_MODULE_3__["Browser"].ie || track.mode !== 'disabled') {
        // Avoid setting the track to disabled if it is already so. This prevents an exception when trying
        // to set the mode on Edge
        track.mode = 'disabled';
        track.mode = 'hidden';
      }

      if (track.cues) {
        for (var i = track.cues.length; i--;) {
          track.removeCue(track.cues[i]);
        }
      }

      if (!track.embedded) {
        track.mode = 'disabled';
      }

      track.inuse = false;
    });
  }
}

function isCaptionsOrSubtitles(kind) {
  return kind === 'captions' || kind === 'subtitles';
}

function isNativeCaptionsOrSubtitles(trackId) {
  return /^native(?:captions|subtitles)/.test(trackId);
}

function getTextCueMetaEvent(cue) {
  var metadata;

  try {
    metadata = JSON.parse(cue.text);
  } catch (e) {
    return null;
  }

  var event = {
    metadataType: metadata.metadataType,
    metadataTime: cue.startTime,
    metadata: metadata
  };

  if (metadata.programDateTime) {
    event.programDateTime = metadata.programDateTime;
  }

  return event;
}

function getId3CueMetaEvent(dataCues) {
  var metadata = Object(providers_utils_id3Parser__WEBPACK_IMPORTED_MODULE_2__["parseID3"])(dataCues);
  var metadataTime = dataCues[0].startTime;
  return {
    metadataType: 'id3',
    metadataTime: metadataTime,
    metadata: metadata
  };
}

function cuesMatch(cue1, cue2) {
  return cue1.startTime === cue2.startTime && cue1.endTime === cue2.endTime && cue1.text === cue2.text && cue1.data === cue2.data && JSON.stringify(cue1.value) === JSON.stringify(cue2.value);
}

/* harmony default export */ __webpack_exports__["default"] = (Tracks);

/***/ }),

/***/ "./src/js/providers/utils/id3Parser.js":
/*!*********************************************!*\
  !*** ./src/js/providers/utils/id3Parser.js ***!
  \*********************************************/
/*! exports provided: utf8ArrayToStr, syncSafeInt, parseID3 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "utf8ArrayToStr", function() { return utf8ArrayToStr; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "syncSafeInt", function() { return syncSafeInt; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseID3", function() { return parseID3; });
var friendlyNames = {
  TIT2: 'title',
  TT2: 'title',
  WXXX: 'url',
  TPE1: 'artist',
  TP1: 'artist',
  TALB: 'album',
  TAL: 'album'
};
function utf8ArrayToStr(array, startingIndex) {
  // Based on code by Masanao Izumo <iz@onicos.co.jp>
  // posted at http://www.onicos.com/staff/iz/amuse/javascript/expert/utf.txt
  var len = array.length;
  var c;
  var char2;
  var char3;
  var out = '';
  var i = startingIndex || 0;

  while (i < len) {
    c = array[i++]; // If the character is 3 (END_OF_TEXT) or 0 (NULL) then skip it

    if (c === 0x00 || c === 0x03) {
      continue;
    }

    switch (c >> 4) {
      case 0:
      case 1:
      case 2:
      case 3:
      case 4:
      case 5:
      case 6:
      case 7:
        // 0xxxxxxx
        out += String.fromCharCode(c);
        break;

      case 12:
      case 13:
        // 110x xxxx   10xx xxxx
        char2 = array[i++];
        out += String.fromCharCode((c & 0x1F) << 6 | char2 & 0x3F);
        break;

      case 14:
        // 1110 xxxx  10xx xxxx  10xx xxxx
        char2 = array[i++];
        char3 = array[i++];
        out += String.fromCharCode((c & 0x0F) << 12 | (char2 & 0x3F) << 6 | (char3 & 0x3F) << 0);
        break;

      default:
    }
  }

  return out;
}

function utf16BigEndianArrayToStr(array, startingIndex) {
  var lastDoubleByte = array.length - 1;
  var out = '';
  var i = startingIndex || 0;

  while (i < lastDoubleByte) {
    if (array[i] === 254 && array[i + 1] === 255) {// Byte order mark
    } else {
      out += String.fromCharCode((array[i] << 8) + array[i + 1]);
    }

    i += 2;
  }

  return out;
}

function syncSafeInt(sizeArray) {
  var size = arrayToInt(sizeArray);
  return size & 0x0000007F | (size & 0x00007F00) >> 1 | (size & 0x007F0000) >> 2 | (size & 0x7F000000) >> 3;
}

function arrayToInt(array) {
  var sizeString = '0x';

  for (var i = 0; i < array.length; i++) {
    if (array[i] < 16) {
      sizeString += '0';
    }

    sizeString += array[i].toString(16);
  }

  return parseInt(sizeString);
}

function parseID3(activeCues) {
  if (activeCues === void 0) {
    activeCues = [];
  }

  return activeCues.reduce(function (data, cue) {
    if (!('value' in cue)) {
      // Cue is not in Safari's key/data format
      if ('data' in cue && cue.data instanceof ArrayBuffer) {
        // EdgeHTML 13.10586 cue point format - contains raw data in an ArrayBuffer.
        var oldCue = cue;
        var array = new Uint8Array(oldCue.data);
        var arrayLength = array.length;
        cue = {
          value: {
            key: '',
            data: ''
          }
        };
        var i = 10;

        while (i < 14 && i < array.length) {
          if (array[i] === 0) {
            break;
          }

          cue.value.key += String.fromCharCode(array[i]);
          i++;
        } // If the first byte is 3 (END_OF_TEXT) or 0 (NULL) then skip it


        var startPos = 19;
        var firstByte = array[startPos];

        if (firstByte === 0x03 || firstByte === 0x00) {
          firstByte = array[++startPos];
          arrayLength--;
        }

        var infoDelimiterPosition = 0; // Find info/value pair delimiter if present.
        // If first byte shows theres utf 16 encoding, there is no info since info cannot be utf 16 encoded

        if (firstByte !== 0x01 && firstByte !== 0x02) {
          for (var j = startPos + 1; j < arrayLength; j++) {
            if (array[j] === 0x00) {
              infoDelimiterPosition = j - startPos;
              break;
            }
          }
        }

        if (infoDelimiterPosition > 0) {
          var info = utf8ArrayToStr(array.subarray(startPos, startPos += infoDelimiterPosition), 0);

          if (cue.value.key === 'PRIV') {
            if (info === 'com.apple.streaming.transportStreamTimestamp') {
              var ptsIs33Bit = syncSafeInt(array.subarray(startPos, startPos += 4)) & 0x00000001;
              var transportStreamTimestamp = syncSafeInt(array.subarray(startPos, startPos += 4)) + (ptsIs33Bit ? 0x100000000 : 0);
              cue.value.data = transportStreamTimestamp;
            } else {
              cue.value.data = utf8ArrayToStr(array, startPos + 1);
            }

            cue.value.info = info;
          } else {
            cue.value.info = info;
            cue.value.data = utf8ArrayToStr(array, startPos + 1);
          }
        } else {
          var encoding = array[startPos];

          if (encoding === 1 || encoding === 2) {
            cue.value.data = utf16BigEndianArrayToStr(array, startPos + 1);
          } else {
            cue.value.data = utf8ArrayToStr(array, startPos + 1);
          }
        }
      }
    } // These friendly names mapping provides compatibility with our implementation prior to 7.3


    if (friendlyNames.hasOwnProperty(cue.value.key)) {
      data[friendlyNames[cue.value.key]] = cue.value.data;
    }
    /* The meta event includes a metadata object with flattened cue key/data pairs
     * If a cue also includes an info field, then create a collection of info/data pairs for the cue key
     *   TLEN: 03:50                                        // key: "TLEN", data: "03:50"
     *   WXXX: {"artworkURL":"http://domain.com/cover.jpg"} // key: "WXXX", info: "artworkURL" ...
     */


    if (cue.value.info) {
      var collection = data[cue.value.key];

      if (collection !== Object(collection)) {
        collection = {};
        data[cue.value.key] = collection;
      }

      collection[cue.value.info] = cue.value.data;
    } else {
      data[cue.value.key] = cue.value.data;
    }

    return data;
  }, {});
}

/***/ }),

/***/ "./src/js/providers/utils/play-promise.ts":
/*!************************************************!*\
  !*** ./src/js/providers/utils/play-promise.ts ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return createPlayPromise; });
// These properties must be redefined because they are readonly on DOMException
function createPlayPromise(video) {
  return new Promise(function (resolve, reject) {
    if (video.paused) {
      return reject(playPromiseError('NotAllowedError', 0, 'play() failed.'));
    }

    var removeEventListeners = function removeEventListeners() {
      video.removeEventListener('play', playListener);
      video.removeEventListener('playing', listener);
      video.removeEventListener('pause', listener);
      video.removeEventListener('abort', listener);
      video.removeEventListener('error', listener);
    };

    var playListener = function playListener() {
      video.addEventListener('playing', listener);
      video.addEventListener('abort', listener);
      video.addEventListener('error', listener);
      video.addEventListener('pause', listener);
    };

    var listener = function listener(e) {
      removeEventListeners();

      if (e.type === 'playing') {
        resolve();
      } else {
        var message = "The play() request was interrupted by a \"" + e.type + "\" event.";

        if (e.type === 'error') {
          return reject(playPromiseError('NotSupportedError', 9, message));
        }

        return reject(playPromiseError('AbortError', 20, message));
      }
    };

    video.addEventListener('play', playListener);
  });
}

function playPromiseError(name, code, message) {
  var error = new Error(message);
  error.name = name;
  error.code = code;
  return error;
}

/***/ }),

/***/ "./src/js/providers/utils/stream-type.ts":
/*!***********************************************!*\
  !*** ./src/js/providers/utils/stream-type.ts ***!
  \***********************************************/
/*! exports provided: isDvr, streamType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isDvr", function() { return isDvr; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "streamType", function() { return streamType; });
/** @module */

/**
 * It's DVR if the duration is not Infinity and above the minDvrWindow, Live otherwise.
 * @param {number} duration - The duration or seekable range of a stream in seconds.
 * @param {number} minDvrWindow - The duration threshold beyond which a stream should be treated as DVR instead of Live.
 * @returns {boolean} DVR or not.
 */
function isDvr(duration, minDvrWindow) {
  return duration !== Infinity && Math.abs(duration) >= Math.max(validMinDvrWindow(minDvrWindow), 0);
}
/**
 * Determine the adaptive type.
 * @param {number} duration - The duration or seekable range of a stream in seconds. Can be positive or negative.
 * Positive or non-infinite values will result in a return value of 'VOD'. Infinite values always return 'LIVE'.
 * @param {number} minDvrWindow - The duration threshold beyond which a stream should be treated as DVR instead of Live.
 * minDvrWindow should always be positive.
 * @returns {StreamType} The stream type.
 */

function streamType(duration, minDvrWindow) {
  var _streamType = 'VOD';

  if (duration === Infinity) {
    _streamType = 'LIVE';
  } else if (duration < 0) {
    _streamType = isDvr(duration, validMinDvrWindow(minDvrWindow)) ? 'DVR' : 'LIVE';
  }

  return _streamType;
}

function validMinDvrWindow(minDvrWindow) {
  return minDvrWindow === undefined ? 120 : Math.max(minDvrWindow, 0);
}

/***/ }),

/***/ "./src/js/providers/video-actions-mixin.ts":
/*!*************************************************!*\
  !*** ./src/js/providers/video-actions-mixin.ts ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_time_ranges__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/time-ranges */ "./src/js/utils/time-ranges.ts");



var VideoActionsMixin = {
  container: null,
  volume: function volume(vol) {
    this.video.volume = Math.min(Math.max(0, vol / 100), 1);
  },
  mute: function mute(state) {
    this.video.muted = !!state;

    if (!this.video.muted) {
      // Remove muted attribute once user unmutes so the video element doesn't get
      // muted by the browser when the src changes or on replay
      this.video.removeAttribute('muted');
    }
  },
  resize: function resize(width, height, stretching) {
    var video = this.video;
    var videoWidth = video.videoWidth,
        videoHeight = video.videoHeight;

    if (!width || !height || !videoWidth || !videoHeight) {
      return;
    }

    var styles = {
      objectFit: '',
      width: '',
      height: ''
    };

    if (stretching === 'uniform') {
      // Snap video to edges when the difference in aspect ratio is less than 9% and perceivable
      var playerAspectRatio = width / height;
      var videoAspectRatio = videoWidth / videoHeight;
      var edgeMatch = Math.abs(playerAspectRatio - videoAspectRatio);

      if (edgeMatch < 0.09 && edgeMatch > 0.0025) {
        styles.objectFit = 'fill';
        stretching = 'exactfit';
      }
    } // Prior to iOS 9, object-fit worked poorly
    // object-fit is not implemented in IE or Android Browser in 4.4 and lower
    // http://caniuse.com/#feat=object-fit
    // feature detection may work for IE but not for browsers where object-fit works for images only


    var fitVideoUsingTransforms = environment_environment__WEBPACK_IMPORTED_MODULE_0__["Browser"].ie || environment_environment__WEBPACK_IMPORTED_MODULE_0__["OS"].iOS && environment_environment__WEBPACK_IMPORTED_MODULE_0__["OS"].version.major < 9 || environment_environment__WEBPACK_IMPORTED_MODULE_0__["Browser"].androidNative;

    if (fitVideoUsingTransforms) {
      if (stretching !== 'uniform') {
        styles.objectFit = 'contain';
        var aspectPlayer = width / height;
        var aspectVideo = videoWidth / videoHeight; // Use transforms to center and scale video in container

        var scaleX = 1;
        var scaleY = 1;

        if (stretching === 'none') {
          if (aspectPlayer > aspectVideo) {
            scaleX = scaleY = Math.ceil(videoHeight * 100 / height) / 100;
          } else {
            scaleX = scaleY = Math.ceil(videoWidth * 100 / width) / 100;
          }
        } else if (stretching === 'fill') {
          if (aspectPlayer > aspectVideo) {
            scaleX = scaleY = aspectPlayer / aspectVideo;
          } else {
            scaleX = scaleY = aspectVideo / aspectPlayer;
          }
        } else if (stretching === 'exactfit') {
          if (aspectPlayer > aspectVideo) {
            scaleX = aspectPlayer / aspectVideo;
            scaleY = 1;
          } else {
            scaleX = 1;
            scaleY = aspectVideo / aspectPlayer;
          }
        }

        Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["transform"])(video, "matrix(" + scaleX.toFixed(2) + ", 0, 0, " + scaleY.toFixed(2) + ", 0, 0)");
      } else {
        styles.top = styles.left = styles.margin = '';
        Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["transform"])(video, '');
      }
    }

    Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["style"])(video, styles);
  },
  getContainer: function getContainer() {
    return this.container;
  },
  setContainer: function setContainer(element) {
    this.container = element;

    if (this.video.parentNode !== element) {
      element.appendChild(this.video);
    }
  },
  removeFromContainer: function removeFromContainer() {
    var container = this.container,
        video = this.video;
    this.container = null;

    if (container && container === video.parentNode) {
      container.removeChild(video);
    }
  },
  remove: function remove() {
    this.stop();
    this.destroy();
    this.removeFromContainer();
  },
  atEdgeOfLiveStream: function atEdgeOfLiveStream() {
    if (!this.isLive()) {
      return false;
    } // currentTime doesn't always get to the end of the buffered range


    var timeFudge = 2;
    return Object(utils_time_ranges__WEBPACK_IMPORTED_MODULE_2__["default"])(this.video.buffered) - this.video.currentTime <= timeFudge;
  }
};
/* harmony default export */ __webpack_exports__["default"] = (VideoActionsMixin);

/***/ }),

/***/ "./src/js/providers/video-attached-mixin.ts":
/*!**************************************************!*\
  !*** ./src/js/providers/video-attached-mixin.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var VideoAttachedMixin = {
  eventsOn_: function eventsOn_() {// noop
  },
  eventsOff_: function eventsOff_() {// noop
  },
  attachMedia: function attachMedia() {
    this.eventsOn_();
  },
  detachMedia: function detachMedia() {
    return this.eventsOff_();
  }
};
/* harmony default export */ __webpack_exports__["default"] = (VideoAttachedMixin);

/***/ }),

/***/ "./src/js/providers/video-listener-mixin.ts":
/*!**************************************************!*\
  !*** ./src/js/providers/video-listener-mixin.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_math__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/math */ "./src/js/utils/math.ts");


var VideoListenerMixin = {
  canplay: function canplay() {
    // If we're not rendering natively text tracks will be provided from another source - don't duplicate them here
    if (this.renderNatively) {
      this.setTextTracks(this.video.textTracks);
    }

    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_BUFFER_FULL"]);
  },
  play: function play() {
    this.stallTime = -1;

    if (!this.video.paused && this.state !== events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_PLAYING"]) {
      this.setState(events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_LOADING"]);
    }
  },
  loadedmetadata: function loadedmetadata() {
    var metadata = {
      metadataType: 'media',
      duration: this.getDuration(),
      height: this.video.videoHeight,
      width: this.video.videoWidth,
      seekRange: this.getSeekRange()
    };
    var drmUsed = this.drmUsed;

    if (drmUsed) {
      metadata.drm = drmUsed;
    }

    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_META"], metadata);
  },
  timeupdate: function timeupdate() {
    var currentTime = this.video.currentTime;
    var position = this.getCurrentTime();
    var duration = this.getDuration();

    if (isNaN(duration)) {
      return;
    }

    if (!this.seeking && !this.video.paused && (this.state === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_STALLED"] || this.state === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_LOADING"]) && this.stallTime !== currentTime) {
      this.stallTime = -1;
      this.setState(events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_PLAYING"]);
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["PROVIDER_FIRST_FRAME"]);
    }

    var timeEventObject = {
      position: position,
      duration: duration,
      currentTime: currentTime,
      seekRange: this.getSeekRange(),
      metadata: {
        currentTime: currentTime
      }
    };
    var latency = this.getLiveLatency();

    if (latency !== null) {
      timeEventObject.latency = latency;

      if (this.getTargetLatency) {
        var targetLatency = this.getTargetLatency();

        if (targetLatency !== null) {
          timeEventObject.targetLatency = targetLatency;
        }
      }
    } // only emit time events when playing or seeking


    if (this.state === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_PLAYING"] || this.seeking && this.state !== events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_IDLE"]) {
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_TIME"], timeEventObject);
    }
  },
  click: function click(evt) {
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["CLICK"], evt);
  },
  volumechange: function volumechange() {
    var video = this.video;
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_VOLUME"], {
      volume: Math.round(video.volume * 100)
    });
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_MUTE"], {
      mute: video.muted
    });
  },
  seeking: function seeking() {
    // TODO: Use trigger(MEDIA_SEEK) implementation from html5 removed from hlsjs/shaka providers
    if (this.state === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_LOADING"]) {
      // Ignore seeks performed by shaka-player and hls.js to jump initial buffer gap before play
      var bufferStart = this.video.buffered.length ? this.video.buffered.start(0) : -1;

      if (this.video.currentTime === bufferStart) {
        return;
      }
    } else if (this.state === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_IDLE"]) {
      return;
    }

    this.seeking = true;
  },
  seeked: function seeked() {
    if (!this.seeking) {
      return;
    }

    this.seeking = false;
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_SEEKED"]);
  },
  playing: function playing() {
    // When stalling, STATE_PLAYING is only set on timeupdate
    // because Safari and Firefox will fire "playing" before playback recovers from stalling
    if (this.stallTime === -1) {
      // Here setting STATE_PLAYING ensures a quick recovery from STATE_LOADING after seeking
      this.setState(events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_PLAYING"]);
    }

    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["PROVIDER_FIRST_FRAME"]);
  },
  pause: function pause() {
    // Sometimes the browser will fire "complete" and then a "pause" event
    if (this.state === events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_COMPLETE"]) {
      return;
    }

    if (this.video.ended) {
      return;
    }

    if (this.video.error) {
      return;
    } // If "pause" fires before "complete", we still don't want to propagate it


    if (this.video.currentTime === this.video.duration) {
      return;
    }

    this.setState(events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_PAUSED"]);
  },
  progress: function progress() {
    var dur = this.getDuration();

    if (dur <= 0 || dur === Infinity) {
      return;
    }

    var buf = this.video.buffered;

    if (!buf || buf.length === 0) {
      return;
    }

    var buffered = Object(utils_math__WEBPACK_IMPORTED_MODULE_1__["between"])(buf.end(buf.length - 1) / dur, 0, 1);
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_BUFFER"], {
      bufferPercent: buffered * 100,
      position: this.getCurrentTime(),
      duration: dur,
      currentTime: this.video.currentTime,
      seekRange: this.getSeekRange()
    });
  },
  ratechange: function ratechange() {
    this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_RATE_CHANGE"], {
      playbackRate: this.video.playbackRate
    });
  },
  ended: function ended() {
    if (this.state !== events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_IDLE"] && this.state !== events_events__WEBPACK_IMPORTED_MODULE_0__["STATE_COMPLETE"]) {
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_0__["MEDIA_COMPLETE"]);
    }
  }
};
/* harmony default export */ __webpack_exports__["default"] = (VideoListenerMixin);

/***/ }),

/***/ "./src/js/templates/floating-close-button.ts":
/*!***************************************************!*\
  !*** ./src/js/templates/floating-close-button.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (ariaLabel) {
  return "<div class=\"jw-float-icon jw-icon jw-button-color jw-reset\" aria-label=" + ariaLabel + " tabindex=\"0\">" + "</div>";
});

/***/ }),

/***/ "./src/js/templates/logo.ts":
/*!**********************************!*\
  !*** ./src/js/templates/logo.ts ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (position, hide) {
  var jwhide = hide ? ' jw-hide' : '';
  return "<div class=\"jw-logo jw-logo-" + position + jwhide + " jw-reset\"></div>";
});

/***/ }),

/***/ "./src/js/templates/player.ts":
/*!************************************!*\
  !*** ./src/js/templates/player.ts ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (id, ariaLabel) {
  return "<div id=\"" + id + "\" class=\"jwplayer jw-reset jw-state-setup\" tabindex=\"0\" aria-label=\"" + (ariaLabel || '') + "\" role=\"application\">" + "<div class=\"jw-aspect jw-reset\"></div>" + "<div class=\"jw-wrapper jw-reset\">" + "<div class=\"jw-top jw-reset\"></div>" + "<div class=\"jw-aspect jw-reset\"></div>" + "<div class=\"jw-media jw-reset\"></div>" + "<div class=\"jw-preview jw-reset\"></div>" + "<div class=\"jw-title jw-reset-text\" dir=\"auto\">" + "<div class=\"jw-title-primary jw-reset-text\"></div>" + "<div class=\"jw-title-secondary jw-reset-text\"></div>" + "</div>" + "<div class=\"jw-overlays jw-reset\"></div>" + "<div class=\"jw-hidden-accessibility\">" + "<span class=\"jw-time-update\" aria-live=\"assertive\"></span>" + "<span class=\"jw-volume-update\" aria-live=\"assertive\"></span>" + "</div>" + "</div>" + "</div>";
});

/***/ }),

/***/ "./src/js/utils/aria.ts":
/*!******************************!*\
  !*** ./src/js/utils/aria.ts ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (element, ariaLabel) {
  if (!element || !ariaLabel) {
    return;
  }

  element.setAttribute('aria-label', ariaLabel);
  element.setAttribute('role', 'button');
  element.setAttribute('tabindex', '0');
});

/***/ }),

/***/ "./src/js/utils/can-autoplay.js":
/*!**************************************!*\
  !*** ./src/js/utils/can-autoplay.js ***!
  \**************************************/
/*! exports provided: startPlayback, AUTOPLAY_ENABLED, AUTOPLAY_MUTED, AUTOPLAY_DISABLED, canAutoplay */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "startPlayback", function() { return startPlayback; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AUTOPLAY_ENABLED", function() { return AUTOPLAY_ENABLED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AUTOPLAY_MUTED", function() { return AUTOPLAY_MUTED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AUTOPLAY_DISABLED", function() { return AUTOPLAY_DISABLED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "canAutoplay", function() { return canAutoplay; });
/* harmony import */ var _providers_utils_play_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../providers/utils/play-promise */ "./src/js/providers/utils/play-promise.ts");
/* harmony import */ var _environment_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../environment/environment */ "./src/js/environment/environment.ts");
// https://github.com/video-dev/can-autoplay/tree/v3.0.0 (modified)
//
// MIT License
// Copyright (c) 2017 video-dev
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.

 // Use webkitURL or mozURL as a backup if URL was overwritten

var URL = function (global) {
  return global.URL && global.URL.createObjectURL ? global.URL : global.webkitURL || global.mozURL;
}(window);

var videoBlob;
var Blob = window.Blob;
function startPlayback(element, _ref) {
  var muted = _ref.muted;

  // Lazy instantiate video blob
  if (!videoBlob) {
    /**
     * Small video file with audio.
     * Source: https://github.com/mathiasbynens/small
     *
     * @constant
     * @default
     * @type {String}
     */
    try {
      videoBlob = new Blob([new Uint8Array([0, 0, 0, 28, 102, 116, 121, 112, 105, 115, 111, 109, 0, 0, 2, 0, 105, 115, 111, 109, 105, 115, 111, 50, 109, 112, 52, 49, 0, 0, 0, 8, 102, 114, 101, 101, 0, 0, 2, 239, 109, 100, 97, 116, 33, 16, 5, 32, 164, 27, 255, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 55, 167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 112, 33, 16, 5, 32, 164, 27, 255, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 55, 167, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 0, 2, 194, 109, 111, 111, 118, 0, 0, 0, 108, 109, 118, 104, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 232, 0, 0, 0, 47, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 1, 236, 116, 114, 97, 107, 0, 0, 0, 92, 116, 107, 104, 100, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 36, 101, 100, 116, 115, 0, 0, 0, 28, 101, 108, 115, 116, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 47, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 100, 109, 100, 105, 97, 0, 0, 0, 32, 109, 100, 104, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 172, 68, 0, 0, 8, 0, 85, 196, 0, 0, 0, 0, 0, 45, 104, 100, 108, 114, 0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 111, 117, 110, 100, 72, 97, 110, 100, 108, 101, 114, 0, 0, 0, 1, 15, 109, 105, 110, 102, 0, 0, 0, 16, 115, 109, 104, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 36, 100, 105, 110, 102, 0, 0, 0, 28, 100, 114, 101, 102, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1, 0, 0, 0, 211, 115, 116, 98, 108, 0, 0, 0, 103, 115, 116, 115, 100, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 87, 109, 112, 52, 97, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 16, 0, 0, 0, 0, 172, 68, 0, 0, 0, 0, 0, 51, 101, 115, 100, 115, 0, 0, 0, 0, 3, 128, 128, 128, 34, 0, 2, 0, 4, 128, 128, 128, 20, 64, 21, 0, 0, 0, 0, 1, 244, 0, 0, 1, 243, 249, 5, 128, 128, 128, 2, 18, 16, 6, 128, 128, 128, 1, 2, 0, 0, 0, 24, 115, 116, 116, 115, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 4, 0, 0, 0, 0, 28, 115, 116, 115, 99, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 28, 115, 116, 115, 122, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 1, 115, 0, 0, 1, 116, 0, 0, 0, 20, 115, 116, 99, 111, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 44, 0, 0, 0, 98, 117, 100, 116, 97, 0, 0, 0, 90, 109, 101, 116, 97, 0, 0, 0, 0, 0, 0, 0, 33, 104, 100, 108, 114, 0, 0, 0, 0, 0, 0, 0, 0, 109, 100, 105, 114, 97, 112, 112, 108, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 45, 105, 108, 115, 116, 0, 0, 0, 37, 169, 116, 111, 111, 0, 0, 0, 29, 100, 97, 116, 97, 0, 0, 0, 1, 0, 0, 0, 0, 76, 97, 118, 102, 53, 54, 46, 52, 48, 46, 49, 48, 49])], {
        type: 'video/mp4'
      });
    } catch (err) {
      // Resolve autoplay test in browsers that do not support Blob creation (smart TVs)
      return Promise.resolve();
    }
  } // Resolve autoplay for Tizen


  if (_environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].tizen) {
    return Promise.resolve();
  } // Configure element.


  element.muted = muted;
  element.src = URL.createObjectURL(videoBlob); // Start playback.

  return element.play() || Object(_providers_utils_play_promise__WEBPACK_IMPORTED_MODULE_0__["default"])(element);
}
var AUTOPLAY_ENABLED = 'autoplayEnabled';
var AUTOPLAY_MUTED = 'autoplayMuted';
var AUTOPLAY_DISABLED = 'autoplayDisabled';
var autoplayPagePromises = {};
function canAutoplay(mediaPool, _ref2) {
  var cancelable = _ref2.cancelable,
      _ref2$muted = _ref2.muted,
      muted = _ref2$muted === void 0 ? false : _ref2$muted,
      _ref2$allowMuted = _ref2.allowMuted,
      allowMuted = _ref2$allowMuted === void 0 ? false : _ref2$allowMuted,
      _ref2$timeout = _ref2.timeout,
      timeout = _ref2$timeout === void 0 ? 10000 : _ref2$timeout;
  var element = mediaPool.getTestElement();
  var key = muted ? 'muted' : "" + allowMuted; // Skip test if it is currently running, or test previously evaluated to AUTOPLAY_ENABLED.

  if (!autoplayPagePromises[key]) {
    // Run the first test: autoplay with specified muted setting.
    autoplayPagePromises[key] = startPlayback(element, {
      muted: muted
    }).catch(function (e) {
      // Second optional test: autoplay muted.
      if (!cancelable.cancelled() && muted === false && allowMuted) {
        muted = true;
        return startPlayback(element, {
          muted: muted
        });
      }

      throw e;
    }).then(function () {
      if (muted) {
        autoplayPagePromises[key] = null; // Clear cache.

        return AUTOPLAY_MUTED;
      }

      return AUTOPLAY_ENABLED;
    }).catch(function (error) {
      clearTimeout(timeoutId);
      autoplayPagePromises[key] = null; // Clear cache.

      error.reason = AUTOPLAY_DISABLED;
      throw error;
    });
  } // If the cancelable was canceled, abort the test.


  var promise = autoplayPagePromises[key].then(function (result) {
    clearTimeout(timeoutId);

    if (cancelable.cancelled()) {
      var error = new Error('Autoplay test was cancelled');
      error.reason = 'cancelled';
      throw error;
    }

    return result;
  }); // Return playback promise, or timeout.

  var timeoutId;
  var timer = new Promise(function (resolve, reject) {
    timeoutId = setTimeout(function () {
      autoplayPagePromises[key] = null; // Clear cache.

      var error = new Error('Autoplay test timed out');
      error.reason = 'timeout';
      reject(error);
    }, timeout);
  });
  return Promise.race([promise, timer]);
}

/***/ }),

/***/ "./src/js/utils/cancelable.ts":
/*!************************************!*\
  !*** ./src/js/utils/cancelable.ts ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return cancelable; });
function cancelable(callback) {
  var _cancelled = false;
  return {
    async: function async() {
      var _this = this;

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      return Promise.resolve().then(function () {
        if (_cancelled) {
          return;
        }

        return callback.apply(_this, args);
      });
    },
    cancel: function cancel() {
      _cancelled = true;
    },
    cancelled: function cancelled() {
      return _cancelled;
    }
  };
}

/***/ }),

/***/ "./src/js/utils/in-interaction-event.ts":
/*!**********************************************!*\
  !*** ./src/js/utils/in-interaction-event.ts ***!
  \**********************************************/
/*! exports provided: inInteraction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "inInteraction", function() { return inInteraction; });
function inInteraction(event) {
  event = event || window.event;
  return !!event && /^(?:mouse|pointer|touch|gesture|click|key)/.test(event.type);
}

/***/ }),

/***/ "./src/js/utils/svgParser.ts":
/*!***********************************!*\
  !*** ./src/js/utils/svgParser.ts ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return svgParse; });
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");

var parser;
function svgParse(svgXml) {
  if (!parser) {
    parser = new DOMParser();
  }

  return Object(utils_dom__WEBPACK_IMPORTED_MODULE_0__["sanitizeElementAttributes"])(Object(utils_dom__WEBPACK_IMPORTED_MODULE_0__["sanitizeScriptNodes"])(parser.parseFromString(svgXml, 'image/svg+xml').documentElement));
}

/***/ }),

/***/ "./src/js/utils/time-ranges.ts":
/*!*************************************!*\
  !*** ./src/js/utils/time-ranges.ts ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return endOfRange; });
function endOfRange(timeRanges) {
  if (!timeRanges || !timeRanges.length) {
    return 0;
  }

  return timeRanges.end(timeRanges.length - 1);
}

/***/ }),

/***/ "./src/js/view/captionsrenderer.js":
/*!*****************************************!*\
  !*** ./src/js/view/captionsrenderer.js ***!
  \*****************************************/
/*! exports provided: _defaults, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "_defaults", function() { return _defaults; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var _api_core_loader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../api/core-loader */ "./src/js/api/core-loader.js");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");











var _WebVTT;

var _defaults = {
  back: true,
  backgroundOpacity: 50,
  edgeStyle: null,
  fontSize: 14,
  fontOpacity: 100,
  fontScale: 0.05,
  // Default captions font size = 1/20th of the video's height
  preprocessor: utils_underscore__WEBPACK_IMPORTED_MODULE_0__["identity"],
  windowOpacity: 0
};
/**
 * Component that renders the actual captions on screen.
 * @class CaptionsRenderer
 * param {ViewModel} viewModel - The player's ViewModel instance.
 */

var CaptionsRenderer = function CaptionsRenderer(viewModel) {
  var _this = this;

  var _model = viewModel.player;

  var _options;

  var _captionsTrack;

  var _currentCues;

  var _timeEvent;

  var _display;

  var _captionsWindow;

  var _textContainer;

  var _fontScale;

  var _windowStyle;

  _display = document.createElement('div');
  _display.className = 'jw-captions jw-reset';

  this.show = function () {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_6__["addClass"])(_display, 'jw-captions-enabled');
  };

  this.hide = function () {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_6__["removeClass"])(_display, 'jw-captions-enabled');
  }; // Assign list of captions to the renderer


  this.populate = function (captions) {
    if (_model.get('renderCaptionsNatively')) {
      return;
    }

    _currentCues = [];
    _captionsTrack = captions;

    if (!captions) {
      this.renderCues();
      return;
    }

    this.selectCues(captions, _timeEvent);
  };

  this.resize = function () {
    _setFontSize();

    this.renderCues(true);
  };

  this.renderCues = function (updateBoxPosition) {
    updateBoxPosition = !!updateBoxPosition;

    if (_WebVTT) {
      _WebVTT.processCues(window, _currentCues, _display, updateBoxPosition);
    }
  };

  this.selectCues = function (track, timeEvent) {
    if (!track || !track.data || !timeEvent || _model.get('renderCaptionsNatively')) {
      return;
    }

    var pos = this.getAlignmentPosition(track, timeEvent);

    if (pos === false) {
      return;
    }

    _currentCues = this.getCurrentCues(track.data, pos);
    this.renderCues(true);
  };

  this.getCurrentCues = function (allCues, pos) {
    return Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["filter"])(allCues, function (cue) {
      return pos >= cue.startTime && (!cue.endTime || pos <= cue.endTime);
    });
  };

  this.getAlignmentPosition = function (track, timeEvent) {
    var source = track.source;
    var metadata = timeEvent.metadata;
    var time = timeEvent.currentTime; // subtitles with "source" time must be synced with "metadata[source]"

    if (source) {
      if (metadata && Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isNumber"])(metadata[source])) {
        time = metadata[source];
      }
    }

    return time;
  };

  this.clear = function () {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_6__["empty"])(_display);
  };
  /**
   * Initialize the captions renderer
   * @param {string} playerElementId - The player container's DOM id
   * @param {object} options - The captions styling configuration
   * @returns {void}
   */


  this.setup = function (playerElementId, options) {
    _captionsWindow = document.createElement('div');
    _textContainer = document.createElement('span');
    _captionsWindow.className = 'jw-captions-window jw-reset';
    _textContainer.className = 'jw-captions-text jw-reset';
    _options = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, _defaults, options);
    _fontScale = _defaults.fontScale;

    var styleCaptions = function styleCaptions() {
      _setFontScale(_options.fontSize);

      var windowColor = _options.windowColor;
      var windowOpacity = _options.windowOpacity;
      var edgeStyle = _options.edgeStyle;
      _windowStyle = {};
      var textStyle = {};

      _addTextStyle(textStyle, _options);

      if (windowColor || windowOpacity !== _defaults.windowOpacity) {
        _windowStyle.backgroundColor = Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["getRgba"])(windowColor || '#000000', windowOpacity);
      }

      _addEdgeStyle(edgeStyle, textStyle, _options.fontOpacity);

      if (!_options.back && edgeStyle === null) {
        _addEdgeStyle('uniform', textStyle);
      }

      Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["style"])(_captionsWindow, _windowStyle);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["style"])(_textContainer, textStyle);

      _setupCaptionStyles(playerElementId, textStyle);
    };

    styleCaptions();

    _captionsWindow.appendChild(_textContainer);

    _display.appendChild(_captionsWindow);

    _model.change('captionsTrack', function (model, captionsTrack) {
      this.populate(captionsTrack);
    }, this);

    _model.set('captions', _options);

    _model.on('change:captions', function (model, newOptions) {
      _options = newOptions;
      styleCaptions();
    });
  };

  this.element = function () {
    return _display;
  };

  this.destroy = function () {
    _model.off(null, null, this);

    this.off();
  };

  function _setFontScale() {
    if (!Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isFinite"])(_options.fontSize)) {
      return;
    }

    var height = _model.get('containerHeight');

    if (!height) {
      _model.once('change:containerHeight', _setFontScale, this);

      return;
    } // Adjust scale based on font size relative to the default


    _fontScale = _defaults.fontScale * (_options.userFontScale || 1) * _options.fontSize / _defaults.fontSize;
  }

  function _setFontSize() {
    var height = _model.get('containerHeight');

    if (!height) {
      return;
    }

    var fontSize;

    if (_model.get('fullscreen') && environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].iOS) {
      fontSize = null;
    } else {
      // round to 1dp to match browser precision
      var containerFontSize = height * _fontScale;
      fontSize = Math.round(getScaledFontSize(containerFontSize) * 10) / 10;
    }

    if (_model.get('renderCaptionsNatively')) {
      _setShadowDOMFontSize(_model.get('id'), fontSize);
    } else {
      // 'px' will automatically be appended if fontSize is a number
      Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["style"])(_display, {
        fontSize: fontSize
      });
    }
  }

  function getScaledFontSize(fontSize) {
    var video = _model.get('mediaElement');

    if (video && video.videoHeight) {
      var videoWidth = video.videoWidth,
          videoHeight = video.videoHeight;
      var aspectVideo = videoWidth / videoHeight; // default to container dimensions for determining font size

      var containerHeight = _model.get('containerHeight');

      var containerWidth = _model.get('containerWidth'); // Use screen dimensions when in fullscreen on mobile devices


      if (_model.get('fullscreen') && environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].mobile) {
        var _window = window,
            screen = _window.screen;

        if (screen.orientation) {
          containerHeight = screen.availHeight;
          containerWidth = screen.availWidth;
        }
      }

      if (containerWidth && containerHeight && videoWidth && videoHeight) {
        var aspectContainer = containerWidth / containerHeight;
        var height = aspectContainer > aspectVideo ? containerHeight : videoHeight * containerWidth / videoWidth;
        return height * _fontScale;
      }
    }

    return fontSize;
  }

  function _setupCaptionStyles(playerId, textStyle) {
    _setFontSize();

    _styleNativeCaptions(playerId, textStyle);

    _stylePlayerCaptions(playerId, textStyle);
  }

  function _stylePlayerCaptions(playerId, textStyle) {
    // VTT.js DOM window and text styles
    Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["css"])('#' + playerId + ' .jw-text-track-display', _windowStyle, playerId);
    Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["css"])('#' + playerId + ' .jw-text-track-cue', textStyle, playerId);
  }

  function _styleNativeCaptions(playerId, textStyle) {
    if (environment_environment__WEBPACK_IMPORTED_MODULE_1__["Browser"].safari) {
      // Only Safari uses a separate element for styling text background
      Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["css"])('#' + playerId + ' .jw-video::-webkit-media-text-track-display-backdrop', {
        backgroundColor: textStyle.backgroundColor
      }, playerId, true);
    }

    Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["css"])('#' + playerId + ' .jw-video::-webkit-media-text-track-display', _windowStyle, playerId, true);
    Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["css"])('#' + playerId + ' .jw-video::cue', textStyle, playerId, true);
  }

  function _setShadowDOMFontSize(playerId, fontSize) {
    // Set Shadow DOM font size (needs to be important to override browser's in line style)
    var selector = "#" + playerId + " .jw-video::-webkit-media-text-track-display";

    if (fontSize) {
      fontSize += 'px';

      if (environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].iOS) {
        // Force layout after exiting fullscreen
        Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["css"])(selector, {
          fontSize: 'inherit'
        }, playerId, true);
      }
    }

    _windowStyle.fontSize = fontSize;
    Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["css"])(selector, _windowStyle, playerId, true);
  }

  function _addTextStyle(textStyle, options) {
    var color = options.color;
    var fontOpacity = options.fontOpacity;

    if (color || fontOpacity !== _defaults.fontOpacity) {
      textStyle.color = Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["getRgba"])(color || '#ffffff', fontOpacity);
    }

    if (options.back) {
      var bgColor = options.backgroundColor;
      var bgOpacity = options.backgroundOpacity;

      if (bgColor !== _defaults.backgroundColor || bgOpacity !== _defaults.backgroundOpacity) {
        textStyle.backgroundColor = Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["getRgba"])(bgColor, bgOpacity);
      }
    } else {
      textStyle.background = 'transparent';
    }

    if (options.fontFamily) {
      textStyle.fontFamily = options.fontFamily;
    }

    if (options.fontStyle) {
      textStyle.fontStyle = options.fontStyle;
    }

    if (options.fontWeight) {
      textStyle.fontWeight = options.fontWeight;
    }

    if (options.textDecoration) {
      textStyle.textDecoration = options.textDecoration;
    }
  }

  function _addEdgeStyle(option, styles, fontOpacity) {
    var color = Object(utils_css__WEBPACK_IMPORTED_MODULE_5__["getRgba"])('#000000', fontOpacity);

    if (option === 'dropShadow') {
      // small drop shadow
      styles.textShadow = '0 2px 1px ' + color;
    } else if (option === 'raised') {
      // larger drop shadow
      styles.textShadow = '0 0 5px ' + color + ', 0 1px 5px ' + color + ', 0 2px 5px ' + color;
    } else if (option === 'depressed') {
      // top down shadow
      styles.textShadow = '0 -2px 1px ' + color;
    } else if (option === 'uniform') {
      // outline
      styles.textShadow = '-2px 0 1px ' + color + ',2px 0 1px ' + color + ',0 -2px 1px ' + color + ',0 2px 1px ' + color + ',-1px 1px 1px ' + color + ',1px 1px 1px ' + color + ',1px -1px 1px ' + color + ',1px 1px 1px ' + color;
    }
  }

  var _timeChange = function _timeChange(e) {
    _timeEvent = e;

    _this.selectCues(_captionsTrack, _timeEvent);
  };

  function _captionsListHandler(model, captionsList) {
    var _this2 = this;

    if (captionsList.length === 1) {
      // captionsList only contains 'off'
      return;
    } // don't load the polyfill or do unnecessary work if rendering natively


    if (!model.get('renderCaptionsNatively') && !_WebVTT) {
      loadWebVttPolyfill().catch(function (error) {
        _this2.trigger(events_events__WEBPACK_IMPORTED_MODULE_4__["WARNING"], error);
      });
      model.off('change:captionsList', _captionsListHandler, this);
    }
  }

  function loadWebVttPolyfill() {
    return __webpack_require__.e(/*! require.ensure | polyfills.webvtt */ "polyfills.webvtt").then((function (require) {
      _WebVTT = __webpack_require__(/*! polyfills/webvtt */ "./src/js/polyfills/webvtt.js").default;
    }).bind(null, __webpack_require__)).catch(Object(_api_core_loader__WEBPACK_IMPORTED_MODULE_2__["chunkLoadWarningHandler"])(301121));
  }

  _model.on('change:playlistItem', function () {
    _timeEvent = null;
    _currentCues = [];
  }, this);

  _model.on(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_SEEK"], function (e) {
    _currentCues = [];

    _timeChange(e);
  }, this);

  _model.on(events_events__WEBPACK_IMPORTED_MODULE_4__["MEDIA_TIME"], _timeChange, this);

  _model.on('subtitlesTrackData', function () {
    // update captions after a provider's subtitle track changes
    this.selectCues(_captionsTrack, _timeEvent);
  }, this);

  _model.on('change:captionsList', _captionsListHandler, this);
};

Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(CaptionsRenderer.prototype, utils_backbone_events__WEBPACK_IMPORTED_MODULE_3__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (CaptionsRenderer);

/***/ }),

/***/ "./src/js/view/controls/components/button.ts":
/*!***************************************************!*\
  !*** ./src/js/view/controls/components/button.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_svgParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/svgParser */ "./src/js/utils/svgParser.ts");
/* harmony import */ var utils_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/helpers */ "./src/js/utils/helpers.ts");



/* harmony default export */ __webpack_exports__["default"] = (function (icon, apiAction, ariaText, svgIcons) {
  var _element = document.createElement('div');

  _element.className = 'jw-icon jw-icon-inline jw-button-color jw-reset ' + icon;

  _element.setAttribute('role', 'button');

  _element.setAttribute('tabindex', '0');

  if (ariaText) {
    _element.setAttribute('aria-label', ariaText);
  }

  _element.style.display = 'none';
  var ui = new utils_ui__WEBPACK_IMPORTED_MODULE_0__["default"](_element).on('click tap enter', apiAction || utils_helpers__WEBPACK_IMPORTED_MODULE_2__["default"].noop);

  if (svgIcons) {
    Array.prototype.forEach.call(svgIcons, function (svgIcon) {
      if (typeof svgIcon === 'string') {
        _element.appendChild(Object(utils_svgParser__WEBPACK_IMPORTED_MODULE_1__["default"])(svgIcon));
      } else {
        _element.appendChild(svgIcon);
      }
    });
  }

  return {
    ui: ui,
    element: function element() {
      return _element;
    },
    toggle: function toggle(m) {
      if (m) {
        this.show();
      } else {
        this.hide();
      }
    },
    show: function show() {
      _element.style.display = '';
    },
    hide: function hide() {
      _element.style.display = 'none';
    }
  };
});

/***/ }),

/***/ "./src/js/view/controls/components/chapters.mixin.ts":
/*!***********************************************************!*\
  !*** ./src/js/view/controls/components/chapters.mixin.ts ***!
  \***********************************************************/
/*! exports provided: Cue, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Cue", function() { return Cue; });
/* harmony import */ var utils_ajax__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/ajax */ "./src/js/utils/ajax.js");
/* harmony import */ var parsers_captions_srt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! parsers/captions/srt */ "./src/js/parsers/captions/srt.ts");


var Cue = /*#__PURE__*/function () {
  function Cue(time, text, cueType) {
    this.time = time;
    this.text = text;
    this.el = document.createElement('div');
    var cssClasses = 'jw-cue jw-reset';

    if (cueType && typeof cueType === 'string') {
      cssClasses += " jw-cue-type-" + cueType;
    }

    this.el.className = cssClasses;
  }

  var _proto = Cue.prototype;

  _proto.align = function align(duration) {
    // If a percentage, use it, else calculate the percentage
    if (this.time.toString().slice(-1) === '%') {
      this.pct = this.time;
    } else {
      var percentage = this.time / duration * 100;
      this.pct = percentage + '%';
    }

    this.el.style.left = this.pct;
  };

  return Cue;
}();
var ChaptersMixin = {
  loadChapters: function loadChapters(file) {
    Object(utils_ajax__WEBPACK_IMPORTED_MODULE_0__["ajax"])(file, this.chaptersLoaded.bind(this), this.chaptersFailed, {
      plainText: true
    });
  },
  chaptersLoaded: function chaptersLoaded(evt) {
    var data = Object(parsers_captions_srt__WEBPACK_IMPORTED_MODULE_1__["default"])(evt.responseText);

    if (Array.isArray(data)) {
      // Add chapter cues directly to model which will trigger addCue()
      var existingCues = this._model.get('cues');

      var newCues = existingCues.concat(data);

      this._model.set('cues', newCues);
    }
  },
  chaptersFailed: function chaptersFailed() {
    /* */
  },
  addCue: function addCue(obj) {
    this.cues.push(new Cue(obj.begin, obj.text, obj.cueType));
  },
  drawCues: function drawCues() {
    var _this = this;

    // We won't want to draw them until we have a duration
    var duration = this._model.get('duration');

    if (!duration || duration <= 0) {
      return;
    }

    this.cues.forEach(function (cue) {
      cue.align(duration);
      cue.el.addEventListener('mouseover', function () {
        _this.activeCue = cue;
      });
      cue.el.addEventListener('mouseout', function () {
        _this.activeCue = null;
      });

      _this.elementRail.appendChild(cue.el);
    });
  },
  resetCues: function resetCues() {
    this.cues.forEach(function (cue) {
      if (cue.el.parentNode) {
        cue.el.parentNode.removeChild(cue.el);
      }
    });
    this.cues = [];
  }
};
/* harmony default export */ __webpack_exports__["default"] = (ChaptersMixin);

/***/ }),

/***/ "./src/js/view/controls/components/custom-button.ts":
/*!**********************************************************!*\
  !*** ./src/js/view/controls/components/custom-button.ts ***!
  \**********************************************************/
/*! exports provided: getCachedIcon, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCachedIcon", function() { return getCachedIcon; });
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_svgParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/svgParser */ "./src/js/utils/svgParser.ts");



var collection = {};
function getCachedIcon(svg) {
  if (!collection[svg]) {
    var icons = Object.keys(collection);

    if (icons.length > 10) {
      delete collection[icons[0]];
    }

    var element = Object(utils_svgParser__WEBPACK_IMPORTED_MODULE_2__["default"])(svg);
    collection[svg] = element;
  }

  return collection[svg].cloneNode(true);
}

var CustomButton = /*#__PURE__*/function () {
  function CustomButton(img, ariaText, callback, id, btnClass) {
    var buttonElement = document.createElement('div');
    buttonElement.className = "jw-icon jw-icon-inline jw-button-color jw-reset " + (btnClass || '');
    buttonElement.setAttribute('button', id);
    buttonElement.setAttribute('role', 'button');
    buttonElement.setAttribute('tabindex', '0');

    if (ariaText) {
      buttonElement.setAttribute('aria-label', ariaText);
    }

    var iconElement;

    if (img && img.substring(0, 4) === '<svg') {
      iconElement = getCachedIcon(img);
    } else {
      iconElement = document.createElement('div');
      iconElement.className = 'jw-icon jw-button-image jw-button-color jw-reset';

      if (img) {
        Object(utils_css__WEBPACK_IMPORTED_MODULE_0__["style"])(iconElement, {
          backgroundImage: "url(" + img + ")"
        });
      }
    }

    buttonElement.appendChild(iconElement);
    new utils_ui__WEBPACK_IMPORTED_MODULE_1__["default"](buttonElement).on('click tap enter', callback, this); // Prevent button from being focused on mousedown so that the tooltips don't remain visible until
    // the user interacts with another element on the page

    buttonElement.addEventListener('mousedown', function (e) {
      e.preventDefault();
    });
    this.id = id;
    this.buttonElement = buttonElement;
  }

  var _proto = CustomButton.prototype;

  _proto.element = function element() {
    return this.buttonElement;
  };

  _proto.toggle = function toggle(show) {
    if (show) {
      this.show();
    } else {
      this.hide();
    }
  };

  _proto.show = function show() {
    this.buttonElement.style.display = '';
  };

  _proto.hide = function hide() {
    this.buttonElement.style.display = 'none';
  };

  return CustomButton;
}();

/* harmony default export */ __webpack_exports__["default"] = (CustomButton);

/***/ }),

/***/ "./src/js/view/controls/components/menu/category-button.ts":
/*!*****************************************************************!*\
  !*** ./src/js/view/controls/components/menu/category-button.ts ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var view_controls_components_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/controls/components/button */ "./src/js/view/controls/components/button.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! view/controls/components/simple-tooltip */ "./src/js/view/controls/components/simple-tooltip.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");





var categoryButton = function categoryButton(menu) {
  var name = menu.name,
      title = menu.title;
  var icons = {
    captions: 'cc-off',
    audioTracks: 'audio-tracks',
    quality: 'quality-100',
    playbackRates: 'playback-rate'
  };
  var icon = icons[name];

  if (!icon && !menu.icon) {
    return;
  }

  var menuCategoryButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_0__["default"])("jw-settings-" + name + " jw-submenu-" + name, function (event) {
    menu.open(event);
  }, title, [menu.icon && Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["createElement"])(menu.icon) || Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_1__["cloneIcon"])(icon)]);
  var buttonElement = menuCategoryButton.element();
  buttonElement.setAttribute('name', name);
  buttonElement.setAttribute('role', 'menuitemradio');
  buttonElement.setAttribute('aria-expanded', 'false');
  buttonElement.setAttribute('aria-haspopup', 'true');
  buttonElement.setAttribute('aria-controls', menu.el.id);

  if (!('ontouchstart' in window)) {
    menuCategoryButton.tooltip = Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_2__["SimpleTooltip"])(buttonElement, name, title);
  }

  menuCategoryButton.ui.directSelect = true;
  return menuCategoryButton;
};

/* harmony default export */ __webpack_exports__["default"] = (categoryButton);

/***/ }),

/***/ "./src/js/view/controls/components/menu/menu-item.js":
/*!***********************************************************!*\
  !*** ./src/js/view/controls/components/menu/menu-item.js ***!
  \***********************************************************/
/*! exports provided: MenuItem, RadioMenuItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MenuItem", function() { return MenuItem; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RadioMenuItem", function() { return RadioMenuItem; });
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var view_controls_templates_menu_menu_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! view/controls/templates/menu/menu-item */ "./src/js/view/controls/templates/menu/menu-item.ts");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }




var MenuItem = /*#__PURE__*/function () {
  function MenuItem(_content, _action, _template) {
    if (_template === void 0) {
      _template = view_controls_templates_menu_menu_item__WEBPACK_IMPORTED_MODULE_2__["itemTemplate"];
    }

    this.el = Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["createElement"])(_template(_content));
    this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_0__["default"](this.el).on('click tap enter', _action, this);
  }

  var _proto = MenuItem.prototype;

  _proto.destroy = function destroy() {
    if (this.el.parentNode) {
      this.el.parentNode.removeChild(this.el);
    }

    this.ui.destroy();
  };

  return MenuItem;
}();
var RadioMenuItem = /*#__PURE__*/function (_MenuItem) {
  _inheritsLoose(RadioMenuItem, _MenuItem);

  function RadioMenuItem(_content, _action, _template) {
    if (_template === void 0) {
      _template = view_controls_templates_menu_menu_item__WEBPACK_IMPORTED_MODULE_2__["itemRadioButtonTemplate"];
    }

    return _MenuItem.call(this, _content, _action, _template) || this;
  }

  var _proto2 = RadioMenuItem.prototype;

  _proto2.activate = function activate() {
    if (this.active) {
      return;
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["toggleClass"])(this.el, 'jw-settings-item-active', true);
    this.el.setAttribute('aria-checked', 'true');
    this.active = true;
  };

  _proto2.deactivate = function deactivate() {
    if (!this.active) {
      return;
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["toggleClass"])(this.el, 'jw-settings-item-active', false);
    this.el.setAttribute('aria-checked', 'false');
    this.active = false;
  };

  return RadioMenuItem;
}(MenuItem);

/***/ }),

/***/ "./src/js/view/controls/components/menu/menu.js":
/*!******************************************************!*\
  !*** ./src/js/view/controls/components/menu/menu.js ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Menu; });
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var view_controls_components_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! view/controls/components/button */ "./src/js/view/controls/components/button.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var view_controls_components_menu_menu_item__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! view/controls/components/menu/menu-item */ "./src/js/view/controls/components/menu/menu-item.js");
/* harmony import */ var view_controls_templates_menu_menu__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! view/controls/templates/menu/menu */ "./src/js/view/controls/templates/menu/menu.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils */ "./src/js/view/controls/components/menu/utils.ts");
/* harmony import */ var view_controls_components_menu_category_button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! view/controls/components/menu/category-button */ "./src/js/view/controls/components/menu/category-button.ts");
/* harmony import */ var utils_language__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! utils/language */ "./src/js/utils/language.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }












var Menu = /*#__PURE__*/function (_Events) {
  _inheritsLoose(Menu, _Events);

  function Menu(_name, _title, _parentMenu, _localization, _template) {
    var _this;

    if (_template === void 0) {
      _template = view_controls_templates_menu_menu__WEBPACK_IMPORTED_MODULE_6__["MenuTemplate"];
    }

    _this = _Events.call(this) || this;
    _this.open = _this.open.bind(_assertThisInitialized(_assertThisInitialized(_this)));
    _this.close = _this.close.bind(_assertThisInitialized(_assertThisInitialized(_this)));
    _this.toggle = _this.toggle.bind(_assertThisInitialized(_assertThisInitialized(_this)));
    _this.name = _name;
    _this.title = _title || _name;
    _this.localizedPrevious = _localization.prev;
    _this.isSubmenu = !!_parentMenu;
    _this.el = Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["createElement"])(_template(_this.isSubmenu, _name, _this.title));
    _this.buttonContainer = _this.el.querySelector(".jw-" + _this.name + "-topbar-buttons");
    _this.children = {};
    _this.openMenus = [];
    _this.items = [];
    _this.visible = false;
    _this.parentMenu = _parentMenu;
    _this.mainMenu = !_this.parentMenu ? _assertThisInitialized(_assertThisInitialized(_this)) : _this.parentMenu.mainMenu;
    _this.categoryButton = null;
    _this.closeButton = _this.mainMenu.closeButton;

    if (_this.isSubmenu) {
      if (_this.parentMenu.name === _this.mainMenu.name) {
        _this.categoryButton = _this.createCategoryButton();
      }

      if (_this.parentMenu.parentMenu && !_this.mainMenu.backButton) {
        _this.mainMenu.backButton = _this.createBackButton(_this.localizedPrevious);
      }

      _this.itemsContainer = _this.createItemsContainer();

      _this.parentMenu.appendMenu(_assertThisInitialized(_assertThisInitialized(_this)));
    }

    return _this;
  }

  var _proto = Menu.prototype;

  _proto.createItemsContainer = function createItemsContainer() {
    var _this2 = this;

    var itemsContainerElement = this.el.querySelector('.jw-settings-submenu-items');
    var closeButtonElement = this.mainMenu.closeButton && this.mainMenu.closeButton.element();
    var backButtonElement = this.mainMenu.backButton && this.mainMenu.backButton.element();
    var categoryButtonElement = this.categoryButton && this.categoryButton.element();

    var getTopbar = function getTopbar() {
      return _this2.topbar && _this2.topbar.firstChild;
    };

    var onKeydown = function onKeydown(evt) {
      if (event.target.parentNode !== itemsContainerElement) {
        return;
      }

      var sourceEvent = evt.sourceEvent,
          target = evt.target;
      var topbar = getTopbar();
      var settingsElement = document.getElementsByClassName('jw-icon-settings')[0];
      var rightItem = categoryButtonElement ? Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["nextSibling"])(categoryButtonElement) : closeButtonElement;
      var leftItem = categoryButtonElement ? Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["previousSibling"])(categoryButtonElement) : backButtonElement;
      var downItem = Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["nextSibling"])(target) || topbar || itemsContainerElement.firstChild;
      var upItem = Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["previousSibling"])(target) || topbar || itemsContainerElement.lastChild;
      var key = sourceEvent && Object(_utils__WEBPACK_IMPORTED_MODULE_7__["normalizeKey"])(sourceEvent.key);
      var focusEl;

      switch (key) {
        case 'Tab':
          focusEl = sourceEvent.shiftKey ? leftItem : rightItem;
          break;

        case 'Left':
          focusEl = leftItem || _this2.close(evt) && settingsElement;
          break;

        case 'Up':
          focusEl = upItem;
          break;

        case 'Right':
          focusEl = rightItem;
          break;

        case 'Down':
          focusEl = downItem;
          break;

        case 'Esc':
          focusEl = settingsElement; // always close the main menu if coming from within a sub-menu

          _this2.mainMenu.close(event);

          break;

        default:
          break;
      }

      if (focusEl) {
        focusEl.focus();
      }

      sourceEvent.preventDefault();

      if (key !== 'Esc') {
        // only bubble event if esc key was pressed
        sourceEvent.stopPropagation();
      }
    };

    var itemsContainer = new utils_ui__WEBPACK_IMPORTED_MODULE_0__["default"](itemsContainerElement);
    itemsContainer.on('keydown', onKeydown);
    return itemsContainer;
  };

  _proto.createCategoryButton = function createCategoryButton() {
    var categoryButton = Object(view_controls_components_menu_category_button__WEBPACK_IMPORTED_MODULE_8__["default"])(this);
    return categoryButton;
  };

  _proto.createBackButton = function createBackButton(localizedPrevious) {
    var _this3 = this;

    var getPreviousMenu = function getPreviousMenu() {
      return _this3.mainMenu.backButtonTarget;
    };

    var backButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_3__["default"])('jw-settings-back', function (evt) {
      var menu = getPreviousMenu();

      if (menu) {
        menu.open(evt);
      }
    }, localizedPrevious, [Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_4__["cloneIcon"])('arrow-left')]);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["prependChild"])(this.mainMenu.topbar.el, backButton.element());
    return backButton;
  };

  _proto.setBackButtonAriaLabel = function setBackButtonAriaLabel(labelText) {
    var backButtonElement = this.mainMenu.backButton.element();
    var backButtonText = labelText ? this.localizedPrevious + ' - ' + labelText : this.localizedPrevious;
    backButtonElement.setAttribute('aria-label', backButtonText);
  };

  _proto.createTopbar = function createTopbar() {
    var topbar = Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["createElement"])("<div class=\"jw-reset jw-submenu-topbar\"></div>");
    var itemsContainer = this.itemsContainer.el;
    var settingsMenu = this.mainMenu;
    var categoryButton = this.categoryButton;
    this.topbarUI = new utils_ui__WEBPACK_IMPORTED_MODULE_0__["default"](topbar).on('keydown', function (evt) {
      var sourceEvent = evt.sourceEvent;
      var key = Object(_utils__WEBPACK_IMPORTED_MODULE_7__["normalizeKey"])(sourceEvent.key);

      var onLeft = function onLeft() {
        if (categoryButton) {
          Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["previousSibling"])(categoryButton.element()).focus();
          sourceEvent.preventDefault();
        } else {
          settingsMenu.backButton.element().focus();
        }
      };

      var onRight = function onRight() {
        if (categoryButton) {
          Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["nextSibling"])(categoryButton.element()).focus();
          sourceEvent.preventDefault();
        } else {
          settingsMenu.closeButton.element().focus();
        }
      };

      switch (key) {
        case 'Up':
          itemsContainer.lastChild.focus();
          break;

        case 'Down':
          itemsContainer.firstChild.focus();
          break;

        case 'Left':
          onLeft();
          break;

        case 'Right':
          onRight();
          break;

        case 'Tab':
          if (sourceEvent.shiftKey) {
            onLeft();
          } else {
            onRight();
          }

          break;

        default:
          break;
      }
    });
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["prependChild"])(this.el, topbar);
    return topbar;
  };

  _proto.createItems = function createItems(genericItems, action, options, Item) {
    var _this4 = this;

    if (options === void 0) {
      options = {};
    }

    if (Item === void 0) {
      Item = view_controls_components_menu_menu_item__WEBPACK_IMPORTED_MODULE_5__["RadioMenuItem"];
    }

    var itemType = this.name;
    var menuItems = genericItems.map(function (item, index) {
      var content;
      var argument;
      var additionalHTML;

      switch (itemType) {
        case 'quality':
          if (item.label === 'Auto' && index === 0) {
            content = "" + options.defaultText;
            additionalHTML = ' <span class="jw-reset jw-auto-label"></span>';
          } else {
            content = item.label;
          }

          break;

        case 'captions':
          if ((item.label === 'Off' || item.id === 'off') && index === 0) {
            content = options.defaultText;
          } else {
            content = item.label;
          }

          break;

        case 'playbackRates':
          // Normalize types before we go any further. 
          argument = item;
          content = Object(utils_language__WEBPACK_IMPORTED_MODULE_9__["isRtl"])(options.tooltipText) ? 'x' + item : item + 'x';
          break;

        case 'audioTracks':
          content = item.name;
          break;

        default:
          break;
      } // For custom items, allow options to pass through to template.


      if (!content) {
        content = item;

        if (typeof item === 'object') {
          content.options = options;
        }
      }

      var menuItemClick = function menuItemClick(evt) {
        if (menuItem.active) {
          return;
        }

        if (menuItem.deactivate) {
          _this4.items.filter(function (sibling) {
            return sibling.active === true;
          }).forEach(function (activeItem) {
            activeItem.deactivate();
          });

          var backButtonTarget = _this4.mainMenu.backButtonTarget;

          if (backButtonTarget) {
            backButtonTarget.open(evt);
          } else {
            _this4.mainMenu.close(evt);
          }
        }

        if (menuItem.activate) {
          menuItem.activate();
        }

        action(argument || index);
      };

      var menuItem = new Item(content, menuItemClick.bind(_this4));

      if (additionalHTML) {
        menuItem.el.appendChild(Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["createElement"])(additionalHTML));
      }

      return menuItem;
    });
    return menuItems;
  };

  _proto.setMenuItems = function setMenuItems(menuItems, initialSelectionIndex) {
    var _this5 = this;

    if (!menuItems) {
      this.removeMenu();
    } else {
      this.destroyItems();
      menuItems.forEach(function (menuItem) {
        _this5.items.push(menuItem);

        _this5.itemsContainer.el.appendChild(menuItem.el);
      });

      if (initialSelectionIndex > -1) {
        this.items[initialSelectionIndex].activate();
      }

      if (this.categoryButton) {
        this.categoryButton.show();
      }
    }
  };

  _proto.appendMenu = function appendMenu(childMenu) {
    if (!childMenu) {
      return;
    }

    var el = childMenu.el,
        name = childMenu.name,
        categoryButton = childMenu.categoryButton;
    this.children[name] = childMenu;

    if (categoryButton) {
      var buttonContainer = this.mainMenu.buttonContainer;
      var sharingButton = buttonContainer.querySelector('.jw-settings-sharing');
      var appendBefore = name === 'quality' ? buttonContainer.firstChild : sharingButton || this.closeButton.element();
      buttonContainer.insertBefore(categoryButton.element(), appendBefore);
    }

    this.mainMenu.el.appendChild(el);
    this.mainMenu.trigger('menuAppended', name);
  };

  _proto.removeMenu = function removeMenu(name) {
    if (!name) {
      return this.parentMenu.removeMenu(this.name);
    }

    var menu = this.children[name];

    if (!menu) {
      return;
    }

    delete this.children[name];
    menu.destroy();
    this.mainMenu.trigger('menuRemoved', name);
  };

  _proto.open = function open(evt) {
    var mainMenuVisible = this.mainMenu.visible;
    var focusEl;

    if (!this.items.length) {
      return;
    }

    var sourceEvent = evt && evt.sourceEvent;
    var firstItem = this.topbar ? this.topbar.firstChild : this.items[0].el;
    var lastItem = this.items[this.items.length - 1].el;
    var isKeydown = sourceEvent && sourceEvent.type === 'keydown';
    var key = isKeydown && Object(_utils__WEBPACK_IMPORTED_MODULE_7__["normalizeKey"])(sourceEvent.key);
    var itemTarget = key === 'Up' ? lastItem : firstItem;

    if (this.visible && !this.openMenus.length) {
      if (this.items.length && isKeydown) {
        itemTarget.focus();
      }

      return;
    }

    var mainMenu = this.mainMenu,
        parentMenu = this.parentMenu,
        categoryButton = this.categoryButton;
    parentMenu.openMenus.push(this.name);

    if (parentMenu.openMenus.length > 1) {
      parentMenu.closeChildren(this.name);
    }

    if (categoryButton) {
      categoryButton.element().setAttribute('aria-expanded', 'true');
    }

    if (parentMenu.isSubmenu) {
      parentMenu.el.classList.remove('jw-settings-submenu-active');
      mainMenu.topbar.el.classList.add('jw-nested-menu-open');
      var menuTitleElement = mainMenu.topbar.el.querySelector('.jw-settings-topbar-text');
      menuTitleElement.setAttribute('name', this.title);
      menuTitleElement.innerText = this.title;
      var parentMenuTitle = parentMenu.title;
      this.setBackButtonAriaLabel(parentMenuTitle);
      mainMenu.backButton.show();
      this.mainMenu.backButtonTarget = this.parentMenu;
      focusEl = menuTitleElement;
    } else {
      mainMenu.topbar.el.classList.remove('jw-nested-menu-open');

      if (mainMenu.backButton) {
        mainMenu.backButton.hide();
      }
    }

    this.el.classList.add('jw-settings-submenu-active');

    if (mainMenuVisible && isKeydown) {
      focusEl = itemTarget;
    } else if (!mainMenuVisible) {
      mainMenu.open(evt);
      focusEl = categoryButton.element();

      if (categoryButton && categoryButton.tooltip && !isKeydown) {
        categoryButton.tooltip.suppress = true;
      }
    }

    if (this.openMenus.length) {
      this.closeChildren();
    }

    this.el.scrollTop = 0;
    this.visible = true;
    this.el.setAttribute('aria-expanded', 'true');

    if (focusEl) {
      focusEl.focus();
    }
  };

  _proto.close = function close(evt) {
    var _this6 = this;

    // if visible, return
    if (!this.visible) {
      return;
    }

    this.visible = false;
    this.el.setAttribute('aria-expanded', 'false');
    this.el.classList.remove('jw-settings-submenu-active');

    if (this.categoryButton) {
      this.categoryButton.element().setAttribute('aria-expanded', 'false');
    }

    this.parentMenu.openMenus = this.parentMenu.openMenus.filter(function (name) {
      return name !== _this6.name;
    });

    if (!this.mainMenu.openMenus.length && this.mainMenu.visible) {
      this.mainMenu.close(evt);
    }

    if (this.openMenus.length) {
      this.closeChildren();
    }
  };

  _proto.closeChildren = function closeChildren(keepOpenName) {
    var _this7 = this;

    this.openMenus.forEach(function (menuName) {
      if (menuName === keepOpenName) {
        return;
      }

      var menu = _this7.children[menuName];

      if (menu) {
        menu.close();
      }
    });
  };

  _proto.toggle = function toggle(evt, isDefault) {
    if (isDefault && this.mainMenu.visible) {
      return this.mainMenu.close(evt);
    }

    if (this.visible) {
      this.close(evt);
    } else {
      this.open(evt);
    }
  };

  _proto.destroyItems = function destroyItems() {
    this.items.forEach(function (item) {
      item.destroy();
    });
    this.items = [];
  };

  _proto.destroy = function destroy() {
    var _this8 = this;

    Object.keys(this.children).map(function (menuName) {
      _this8.children[menuName].destroy();
    });

    if (this.categoryButton) {
      this.parentMenu.buttonContainer.removeChild(this.categoryButton.element());
      this.categoryButton.ui.destroy();
    }

    if (this.topbarUI) {
      this.topbarUI.destroy();
    }

    this.destroyItems();
    this.itemsContainer.destroy();
    var openMenus = this.parentMenu.openMenus;
    var openMenuIndex = openMenus.indexOf(this.name);

    if (openMenus.length && openMenuIndex > -1) {
      this.openMenus.splice(openMenuIndex, 1);
    }

    delete this.parentMenu;
    this.visible = false;

    if (this.el.parentNode) {
      this.el.parentNode.removeChild(this.el);
    }

    this.off();
  };

  return Menu;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_1__["default"]);



/***/ }),

/***/ "./src/js/view/controls/components/menu/settings-menu.js":
/*!***************************************************************!*\
  !*** ./src/js/view/controls/components/menu/settings-menu.js ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var view_controls_components_menu_menu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! view/controls/components/menu/menu */ "./src/js/view/controls/components/menu/menu.js");
/* harmony import */ var view_controls_components_menu_menu_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! view/controls/components/menu/menu-item */ "./src/js/view/controls/components/menu/menu-item.js");
/* harmony import */ var view_controls_templates_menu_menu_item__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! view/controls/templates/menu/menu-item */ "./src/js/view/controls/templates/menu/menu-item.ts");
/* harmony import */ var view_captionsrenderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! view/captionsrenderer */ "./src/js/view/captionsrenderer.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils */ "./src/js/view/controls/components/menu/utils.ts");
/* harmony import */ var view_controls_components_button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! view/controls/components/button */ "./src/js/view/controls/components/button.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");



function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }












var SettingsMenu = /*#__PURE__*/function (_Menu) {
  _inheritsLoose(SettingsMenu, _Menu);

  function SettingsMenu(api, model, controlbar, localization) {
    var _this;

    _this = _Menu.call(this, 'settings', localization.settings, null, localization) || this;
    _this.api = api;
    _this.model = model;
    _this.localization = localization;
    _this.controlbar = controlbar;
    _this.closeButton = createCloseButton(_this.el.querySelector(".jw-" + _this.name + "-topbar-buttons"), _this.close, localization);
    _this.backButtonTarget = null;
    _this.defaultChild = null;
    _this.topbar = createTopbar(_assertThisInitialized(_assertThisInitialized(_this)));
    _this.onDocumentClick = _this.onDocumentClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));

    _this.addEventListeners();

    return _this;
  }

  var _proto = SettingsMenu.prototype;

  _proto.setupMenu = function setupMenu(menuName, menuTitle, items, onItemSelect, defaultItemIndex, itemOptions) {
    if (!items || items.length <= 1) {
      this.removeMenu(menuName);
      return;
    }

    var menu = this.children[menuName];

    if (!menu) {
      menu = new view_controls_components_menu_menu__WEBPACK_IMPORTED_MODULE_1__["default"](menuName, menuTitle, this, this.localization);
    }

    menu.setMenuItems(menu.createItems(items, onItemSelect, itemOptions), defaultItemIndex);
    var categoryButton = menu.categoryButton && menu.categoryButton.element();

    if (this.buttonContainer.firstChild === categoryButton) {
      this.defaultChild = menu;
    }
  };

  _proto.onLevels = function onLevels(model, levels) {
    var _this2 = this;

    var menuItemOptions = {
      defaultText: this.localization.auto
    };
    this.setupMenu('quality', this.localization.hd, levels, function (index) {
      return _this2.api.setCurrentQuality(index);
    }, model.get('currentLevel') || 0, menuItemOptions);
  };

  _proto.onCurrentLevel = function onCurrentLevel(model, currentIndex) {
    var children = this.children;
    var qualityMenu = children.quality;
    var visualQuality = model.get('visualQuality');

    if (visualQuality && qualityMenu) {
      changeAutoLabel(model.get('levels'), visualQuality.level, qualityMenu, currentIndex);
    }

    if (!qualityMenu.items[currentIndex].active) {
      Object(_utils__WEBPACK_IMPORTED_MODULE_5__["selectMenuItem"])(qualityMenu, currentIndex);
    }
  };

  _proto.onVisualQuality = function onVisualQuality(model, quality) {
    var qualityMenu = this.children.quality;

    if (quality && qualityMenu) {
      changeAutoLabel(model.get('levels'), quality.level, qualityMenu, model.get('currentLevel'));
    }
  };

  _proto.onAudioTracks = function onAudioTracks(model, audioTracks) {
    var _this3 = this;

    this.setupMenu('audioTracks', this.localization.audioTracks, audioTracks, function (index) {
      return _this3.api.setCurrentAudioTrack(index);
    }, model.get('currentAudioTrack'));
  };

  _proto.onAudioTrackIndex = function onAudioTrackIndex(model, trackIndex) {
    if (!this.children.audioTracks) {
      return;
    }

    Object(_utils__WEBPACK_IMPORTED_MODULE_5__["selectMenuItem"])(this.children.audioTracks, trackIndex);
  };

  _proto.onCaptionsList = function onCaptionsList(model, captionsList) {
    var _this4 = this;

    var menuItemOptions = {
      defaultText: this.localization.off
    };
    var initialIndex = model.get('captionsIndex');
    this.setupMenu('captions', this.localization.cc, captionsList, function (index) {
      return _this4.api.setCurrentCaptions(index);
    }, initialIndex, menuItemOptions);
    var captionsMenu = this.children.captions;

    if (!captionsMenu || captionsMenu.children.captionsSettings) {
      return;
    }

    captionsMenu.topbar = captionsMenu.topbar || captionsMenu.createTopbar();
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_9__["emptyElement"])(captionsMenu.topbar);
    var captionsLocalization = this.localization.captionsStyles;
    var captionsSettingsMenu = new view_controls_components_menu_menu__WEBPACK_IMPORTED_MODULE_1__["default"]('captionsSettings', captionsLocalization.subtitleSettings, captionsMenu, this.localization);
    var open = captionsSettingsMenu.open;

    captionsSettingsMenu.open = function (e) {
      var wasVisible = captionsSettingsMenu.visible;
      open.call(captionsSettingsMenu, e);

      if (!wasVisible) {
        _this4.trigger('captionStylesOpened');
      }
    };

    var destroy = captionsSettingsMenu.destroy;

    captionsSettingsMenu.destroy = function (e) {
      captionsMenu.topbar.parentNode.removeChild(captionsMenu.topbar);
      captionsMenu.topbar = null;
      captionsMenu.topbarUI.destroy();
      destroy.call(captionsSettingsMenu, e);
    };

    var captionsSettingsButton = new view_controls_components_menu_menu_item__WEBPACK_IMPORTED_MODULE_2__["MenuItem"](this.localization.settings, captionsSettingsMenu.open);
    captionsMenu.topbar.appendChild(captionsSettingsButton.el);

    var setCaptionStyles = function setCaptionStyles(captionsOption, index) {
      var captionStyles = model.get('captions');
      var propertyName = captionsOption.name;
      var newValue = captionsOption.values[index];

      var newStyles = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, captionStyles);

      newStyles[propertyName] = newValue;

      _this4.model.set('captions', newStyles);
    };

    var persistedOptions = model.get('captions');

    var renderCaptionsSettings = function renderCaptionsSettings(isReset) {
      var resetItem = new view_controls_components_menu_menu_item__WEBPACK_IMPORTED_MODULE_2__["MenuItem"](_this4.localization.reset, function () {
        _this4.model.set('captions', Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, view_captionsrenderer__WEBPACK_IMPORTED_MODULE_4__["_defaults"]));

        renderCaptionsSettings(true);
      });
      resetItem.el.classList.add('jw-settings-reset');
      var captionsSettingsItems = [];
      Object(_utils__WEBPACK_IMPORTED_MODULE_5__["captionStyleItems"])(captionsLocalization).forEach(function (captionItem) {
        if (!isReset && persistedOptions && persistedOptions[captionItem.name]) {
          captionItem.val = persistedOptions[captionItem.name];
        } else {
          captionItem.val = captionItem.defaultVal;
        }

        var selectionIndex = captionItem.values.indexOf(captionItem.val);
        captionItem.currentSelection = captionItem.options[selectionIndex];
        var itemMenu = new view_controls_components_menu_menu__WEBPACK_IMPORTED_MODULE_1__["default"](captionItem.name, captionItem.label, captionsSettingsMenu, _this4.localization);
        var item = new view_controls_components_menu_menu_item__WEBPACK_IMPORTED_MODULE_2__["MenuItem"](captionItem, itemMenu.open, view_controls_templates_menu_menu_item__WEBPACK_IMPORTED_MODULE_3__["itemMenuTemplate"]);
        var items = itemMenu.createItems(captionItem.options, function (index) {
          var el = item.el.querySelector('.jw-settings-content-item-value');
          setCaptionStyles(captionItem, index);
          el.innerText = captionItem.options[index];
        }, null);
        itemMenu.setMenuItems(items, captionItem.values.indexOf(captionItem.val) || 0);
        captionsSettingsItems.push(item);
      });
      captionsSettingsItems.push(resetItem);
      captionsSettingsMenu.setMenuItems(captionsSettingsItems);
    };

    renderCaptionsSettings();
  };

  _proto.onPlaylistItem = function onPlaylistItem() {
    // Remove menus related to mediaModel properties. They will be populated when the model is populated.
    this.removeMenu('captions');
    this.removeMenu('audioTracks');
    this.removeMenu('quality');
    this.controlbar.elements.captionsButton.hide(); // Settings menu should not be visible when switching playlist items via controls or .load()

    if (this.visible) {
      this.close();
    }
  };

  _proto.onCaptionsIndex = function onCaptionsIndex(model, index) {
    var captionsSubmenu = this.children.captions;

    if (captionsSubmenu) {
      Object(_utils__WEBPACK_IMPORTED_MODULE_5__["selectMenuItem"])(captionsSubmenu, index);
    }

    this.controlbar.toggleCaptionsButtonState(!!index);
  };

  _proto.onPlaybackRates = function onPlaybackRates(model, playbackRates) {
    var _this5 = this;

    if (!playbackRates && model) {
      playbackRates = model.get('playbackRates');
    }

    var localization = this.localization,
        children = this.children;
    var showPlaybackRateControls = model.get('supportsPlaybackRate') && model.get('streamType') !== 'LIVE' && model.get('playbackRateControls');

    if (!showPlaybackRateControls) {
      if (children.playbackRates) {
        this.removeMenu('playbackRates');
      }

      return;
    }

    var initialSelectionIndex = playbackRates.indexOf(model.get('playbackRate'));
    var menuItemOptions = {
      tooltipText: localization.playbackRates
    };
    this.setupMenu('playbackRates', this.localization.playbackRates, playbackRates, function (playbackRate) {
      return _this5.api.setPlaybackRate(playbackRate);
    }, initialSelectionIndex, menuItemOptions);
  };

  _proto.onPlaybackRate = function onPlaybackRate(model, playbackRate) {
    var rates = model.get('playbackRates');
    var index = -1;

    if (rates) {
      index = rates.indexOf(playbackRate);
    }

    Object(_utils__WEBPACK_IMPORTED_MODULE_5__["selectMenuItem"])(this.children.playbackRates, index);
  };

  _proto.onPlaybackRateControls = function onPlaybackRateControls(model) {
    this.onPlaybackRates(model);
  };

  _proto.onCastActive = function onCastActive(model, active, previousState) {
    if (active === previousState) {
      return;
    }

    if (active) {
      this.removeMenu('audioTracks');
      this.removeMenu('quality');
      this.removeMenu('playbackRates');

      if (this.children.captions) {
        this.children.captions.removeMenu('captionsSettings');
      }
    } else {
      this.onAudioTracks(model, model.get('audioTracks'));
      this.onLevels(model, model.get('levels'));
      this.onPlaybackRates(model, model.get('playbackRates'));
      this.onCaptionsList(model, model.get('captionsList'));
    }
  };

  _proto.onChangeStreamType = function onChangeStreamType() {
    this.onPlaybackRates(this.model);
  };

  _proto.onDocumentClick = function onDocumentClick(evt) {
    if (!/jw-(settings|video|nextup-close|sharing-link|share-item)/.test(evt.target.className)) {
      this.close();
    }
  };

  _proto.addEventListeners = function addEventListeners() {
    var updateControlbarButtons = this.updateControlbarButtons,
        model = this.model;
    this.on('menuAppended menuRemoved', updateControlbarButtons, this);
    model.change('levels', this.onLevels, this);
    model.on('change:currentLevel', this.onCurrentLevel, this);
    model.on('change:visualQuality', this.onVisualQuality, this);
    model.change('audioTracks', this.onAudioTracks, this);
    model.on('change:currentAudioTrack', this.onAudioTrackIndex, this);
    model.change('captionsList', this.onCaptionsList, this);
    model.on('change:playlistItem', this.onPlaylistItem, this);
    model.change('captionsIndex', this.onCaptionsIndex, this);
    model.change('playbackRates', this.onPlaybackRates, this);
    model.change('playbackRate', this.onPlaybackRate, this);
    model.on('change:playbackRateControls', this.onPlaybackRateControls, this);
    model.on('change:castActive', this.onCastActive, this);
    model.on('change:streamType', this.onChangeStreamType, this);
  };

  _proto.open = function open(evt) {
    if (this.visible) {
      return;
    }

    this.el.parentNode.classList.add('jw-settings-open');
    this.trigger('visibility', {
      visible: true,
      evt: evt
    });
    document.addEventListener('click', this.onDocumentClick);
    this.el.setAttribute('aria-expanded', 'true');
    this.visible = true;
  };

  _proto.close = function close(evt) {
    this.el.parentNode.classList.remove('jw-settings-open');
    this.trigger('visibility', {
      visible: false,
      evt: evt
    });
    document.removeEventListener('click', this.onDocumentClick);
    this.visible = false;

    if (this.openMenus.length) {
      this.closeChildren();
    } // If closed by keypress, focus appropriate element.


    var key = Object(_utils__WEBPACK_IMPORTED_MODULE_5__["normalizeKey"])(evt && evt.sourceEvent && evt.sourceEvent.key);
    var gearButton = this.controlbar.elements.settingsButton.element();
    var focusEl;

    switch (key) {
      case 'Right':
        focusEl = Object(utils_dom__WEBPACK_IMPORTED_MODULE_9__["nextSibling"])(gearButton);
        break;

      case 'Left':
        focusEl = Object(utils_dom__WEBPACK_IMPORTED_MODULE_9__["previousSibling"])(gearButton);
        break;

      case 'Tab':
        if (evt.shiftKey) {
          focusEl = Object(utils_dom__WEBPACK_IMPORTED_MODULE_9__["previousSibling"])(gearButton);
          break;
        }

        focusEl = gearButton;
        break;

      default:
        break;
    }

    if (focusEl) {
      focusEl.focus({
        preventScroll: !event
      });
    }
  };

  _proto.updateControlbarButtons = function updateControlbarButtons(menuName) {
    var children = this.children,
        controlbar = this.controlbar,
        model = this.model;
    var shouldShowGear = !!children.quality || !!children.playbackRates || !!children.audioTracks || Object.keys(children).length > 1;
    controlbar.elements.settingsButton.toggle(shouldShowGear);

    if (children.captions) {
      controlbar.toggleCaptionsButtonState(!!model.get('captionsIndex'));
    }

    var controlBarButton = controlbar.elements[menuName + "Button"];

    if (controlBarButton) {
      var isVisible = !!children[menuName];
      controlBarButton.toggle(isVisible);
    }
  };

  _proto.destroy = function destroy() {
    _utils__WEBPACK_IMPORTED_MODULE_5__["destroyMenu"].call(this);
    document.removeEventListener('click', this.onDocumentClick);
  };

  return SettingsMenu;
}(view_controls_components_menu_menu__WEBPACK_IMPORTED_MODULE_1__["default"]);

function changeAutoLabel(levels, qualityLevel, qualityMenu, currentIndex) {
  // Return early if the label isn't "Auto" (html5 provider with multiple mp4 sources)
  if (!levels || levels[0].label !== 'Auto' || !(qualityMenu && qualityMenu.items.length)) {
    return;
  }

  var item = qualityMenu.items[0].el.querySelector('.jw-auto-label');
  var level = levels[qualityLevel.index] || {
    label: ''
  };
  item.textContent = currentIndex ? '' : level.label;
}

function createCloseButton(topbarEl, closeFunction, localization) {
  var closeButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_6__["default"])('jw-settings-close', closeFunction, localization.close, [Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_7__["cloneIcon"])('close')]);
  closeButton.show();
  closeButton.ui.on('keydown', function (evt) {
    var sourceEvent = evt.sourceEvent;
    var key = Object(_utils__WEBPACK_IMPORTED_MODULE_5__["normalizeKey"])(sourceEvent.key); // Close settings menu when enter is pressed on the close button
    // or when tab or right arrow key is pressed since it is the last element in topbar

    if (key === 'Enter' || key === 'Right' || key === 'Tab' && !sourceEvent.shiftKey) {
      closeFunction(evt);
    }
  }, this);
  topbarEl.appendChild(closeButton.element());
  return closeButton;
}

function createTopbar(mainMenu) {
  var closeButton = mainMenu.closeButton;
  var topbarEl = mainMenu.el.querySelector(".jw-settings-topbar");
  var ui = new utils_ui__WEBPACK_IMPORTED_MODULE_8__["default"](topbarEl).on('keydown', function (evt) {
    var sourceEvent = evt.sourceEvent,
        target = evt.target;
    var next = Object(utils_dom__WEBPACK_IMPORTED_MODULE_9__["nextSibling"])(target);
    var prev = Object(utils_dom__WEBPACK_IMPORTED_MODULE_9__["previousSibling"])(target);
    var key = Object(_utils__WEBPACK_IMPORTED_MODULE_5__["normalizeKey"])(sourceEvent.key);

    var onLeft = function onLeft(isTab) {
      if (prev) {
        if (!isTab) {
          prev.focus();
        }
      } else {
        mainMenu.close(evt);
      }
    };

    var onRight = function onRight() {
      if (next && closeButton.element() && target !== closeButton.element()) {
        next.focus();
      }
    };

    var onOpen = function onOpen() {
      var menuName = target.getAttribute('name');
      var targetMenu = mainMenu.children[menuName];

      if (!targetMenu && menuName && mainMenu.backButtonTarget) {
        targetMenu = mainMenu.backButtonTarget.children[menuName];
      }

      if (targetMenu && targetMenu.open) {
        targetMenu.open(evt);
      }

      return targetMenu;
    };

    switch (key) {
      case 'Esc':
        mainMenu.close(evt);
        break;

      case 'Left':
        onLeft();
        break;

      case 'Right':
        onRight();
        break;

      case 'Tab':
        if (sourceEvent.shiftKey) {
          onLeft(true);
        }

        break;

      case 'Up':
      case 'Down':
      case 'Enter':
        onOpen();
        break;

      default:
        break;
    }

    sourceEvent.stopPropagation();

    if (/13|32|37|38|39|40/.test(sourceEvent.keyCode)) {
      // Prevent keypresses from scrolling the screen
      sourceEvent.preventDefault();
      return false;
    }
  });
  return ui;
}

/* harmony default export */ __webpack_exports__["default"] = (SettingsMenu);

/***/ }),

/***/ "./src/js/view/controls/components/menu/utils.ts":
/*!*******************************************************!*\
  !*** ./src/js/view/controls/components/menu/utils.ts ***!
  \*******************************************************/
/*! exports provided: captionStyleItems, normalizeKey, destroyMenu, selectMenuItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "captionStyleItems", function() { return captionStyleItems; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizeKey", function() { return normalizeKey; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "destroyMenu", function() { return destroyMenu; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "selectMenuItem", function() { return selectMenuItem; });
var colorValues = ['#ffffff', '#000000', '#ff0000', '#00ff00', '#0000ff', '#ffff00', 'ff00ff', '#00ffff'];
var fontValues = ['Arial', 'Courier', 'Georgia', 'Impact', 'Lucida Console', 'Tahoma', 'Times New Roman', 'Trebuchet MS', 'Verdana'];
var opacityOptions = ['100%', '75%', '50%', '25%', '0%'];
var opacityValues = [100, 75, 50, 25, 0];
var colors;
var fonts;
var captionStyleItems = function captionStyleItems(localization) {
  return [{
    name: 'color',
    label: localization.color,
    options: colors || colorOptions(localization),
    values: colorValues,
    defaultVal: '#ffffff'
  }, {
    name: 'fontOpacity',
    label: localization.fontOpacity,
    options: ['100%', '75%', '25%'],
    values: [100, 75, 25],
    defaultVal: 100
  }, {
    name: 'userFontScale',
    label: localization.userFontScale,
    options: ['200%', '175%', '150%', '125%', '100%', '75%', '50%'],
    values: [2, 1.75, 1.5, 1.25, 1, 0.75, 0.5],
    defaultVal: 1
  }, {
    name: 'fontFamily',
    label: localization.fontFamily,
    options: fontValues,
    values: fontValues,
    defaultVal: 'Arial'
  }, {
    name: 'edgeStyle',
    label: localization.edgeStyle,
    options: fonts || fontOptions(localization),
    values: ['none', 'raised', 'depressed', 'uniform', 'dropShadow'],
    defaultVal: 'none'
  }, {
    name: 'backgroundColor',
    label: localization.backgroundColor,
    options: colors || colorOptions(localization),
    values: colorValues,
    defaultVal: '#000000'
  }, {
    name: 'backgroundOpacity',
    label: localization.backgroundOpacity,
    options: opacityOptions,
    values: opacityValues,
    defaultVal: 50
  }, {
    name: 'windowColor',
    label: localization.windowColor,
    options: colors || colorOptions(localization),
    values: colorValues,
    defaultVal: '#000000'
  }, {
    name: 'windowOpacity',
    label: localization.windowOpacity,
    options: ['100%', '75%', '50%', '25%', '0%'],
    values: opacityValues,
    defaultVal: 0
  }];
};
var normalizeKey = function normalizeKey(sourceEventKey) {
  return sourceEventKey && sourceEventKey.replace(/(Arrow|ape)/, '');
};

var colorOptions = function colorOptions(localization) {
  var white = localization.white,
      black = localization.black,
      red = localization.red,
      green = localization.green,
      blue = localization.blue,
      yellow = localization.yellow,
      magenta = localization.magenta,
      cyan = localization.cyan;
  colors = [white, black, red, green, blue, yellow, magenta, cyan];
  return colors;
};

var fontOptions = function fontOptions(localization) {
  var none = localization.none,
      raised = localization.raised,
      depressed = localization.depressed,
      uniform = localization.uniform,
      dropShadow = localization.dropShadow;
  fonts = [none, raised, depressed, uniform, dropShadow];
  return fonts;
};

function destroyMenu() {
  var _this = this;

  Object.keys(this.children).map(function (menuName) {
    _this.children[menuName].destroy();
  });

  if (this.model) {
    this.model.off(null, null, this);
    delete this.model;
  }

  this.off();
}
function selectMenuItem(menu, itemIndex) {
  if (menu && itemIndex > -1) {
    menu.items.forEach(function (item) {
      item.deactivate();
    });
    menu.items[itemIndex].activate();
  }
}

/***/ }),

/***/ "./src/js/view/controls/components/simple-tooltip.ts":
/*!***********************************************************!*\
  !*** ./src/js/view/controls/components/simple-tooltip.ts ***!
  \***********************************************************/
/*! exports provided: SimpleTooltip */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SimpleTooltip", function() { return SimpleTooltip; });
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");

function SimpleTooltip(attachToElement, name, text, openCallback, closeCallback) {
  var tooltipElement = document.createElement('div');
  tooltipElement.className = "jw-reset-text jw-tooltip jw-tooltip-" + name;
  tooltipElement.setAttribute('dir', 'auto');
  var textElement = document.createElement('div');
  textElement.className = 'jw-text';
  tooltipElement.appendChild(textElement);
  attachToElement.appendChild(tooltipElement);
  var instance = {
    dirty: !!text,
    opened: false,
    text: text,
    touchEvent: false,
    suppress: false,
    open: function open() {
      if (instance.touchEvent) {
        return;
      }

      if (instance.suppress) {
        instance.suppress = false;
        return;
      }

      redraw(true);

      if (openCallback) {
        openCallback();
      }
    },
    close: function close() {
      if (instance.touchEvent) {
        return;
      }

      redraw(false);

      if (closeCallback) {
        closeCallback();
      }
    },
    setText: function setText(newText) {
      if (newText !== instance.text) {
        instance.text = newText;
        instance.dirty = true;
      }

      if (instance.opened) {
        redraw(true);
      }
    }
  };

  var redraw = function redraw(opened) {
    if (opened && instance.dirty) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_0__["replaceInnerHtml"])(textElement, instance.text);
      instance.dirty = false;
    }

    instance.opened = opened;
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_0__["toggleClass"])(tooltipElement, 'jw-open', opened);
  };

  attachToElement.addEventListener('mouseover', instance.open);
  attachToElement.addEventListener('focus', instance.open);
  attachToElement.addEventListener('blur', instance.close);
  attachToElement.addEventListener('mouseout', instance.close);
  attachToElement.addEventListener('touchstart', function () {
    instance.touchEvent = true;
  }, {
    passive: true
  });
  return instance;
}

/***/ }),

/***/ "./src/js/view/controls/components/slider.ts":
/*!***************************************************!*\
  !*** ./src/js/view/controls/components/slider.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var view_controls_templates_slider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/controls/templates/slider */ "./src/js/view/controls/templates/slider.ts");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_math__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! utils/math */ "./src/js/utils/math.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }








var getRailBounds = function getRailBounds(elementRail) {
  var railBounds = Object(utils_dom__WEBPACK_IMPORTED_MODULE_5__["bounds"])(elementRail); // Partial workaround of Android 'inert-visual-viewport'
  // https://bugs.chromium.org/p/chromium/issues/detail?id=489206

  var pageXOffset = window.pageXOffset;

  if (pageXOffset && environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].android && document.body.parentElement && document.body.parentElement.getBoundingClientRect().left >= 0) {
    railBounds.left -= pageXOffset;
    railBounds.right -= pageXOffset;
  }

  return railBounds;
};

var Slider = /*#__PURE__*/function (_Events) {
  _inheritsLoose(Slider, _Events);

  function Slider(className, orientation) {
    var _this;

    _this = _Events.call(this) || this;
    _this.className = className + ' jw-background-color jw-reset';
    _this.orientation = orientation;
    return _this;
  }

  var _proto = Slider.prototype;

  _proto.setup = function setup() {
    this.el = Object(utils_dom__WEBPACK_IMPORTED_MODULE_5__["createElement"])(Object(view_controls_templates_slider__WEBPACK_IMPORTED_MODULE_0__["default"])(this.className, 'jw-slider-' + this.orientation));
    this.elementRail = this.el.getElementsByClassName('jw-slider-container')[0];
    this.elementBuffer = this.el.getElementsByClassName('jw-buffer')[0];
    this.elementProgress = this.el.getElementsByClassName('jw-progress')[0];
    this.elementThumb = this.el.getElementsByClassName('jw-knob')[0];
    this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_3__["default"](this.element(), {
      preventScrolling: true
    }).on('dragStart', this.dragStart, this).on('drag', this.dragMove, this).on('dragEnd', this.dragEnd, this).on('click tap', this.tap, this);
  };

  _proto.dragStart = function dragStart() {
    this.trigger('dragStart');
    this.railBounds = getRailBounds(this.elementRail);
  };

  _proto.dragEnd = function dragEnd(evt) {
    this.dragMove(evt);
    this.trigger('dragEnd');
  };

  _proto.dragMove = function dragMove(evt) {
    var railBounds = this.railBounds = this.railBounds ? this.railBounds : getRailBounds(this.elementRail);
    var dimension;
    var percentage;

    if (this.orientation === 'horizontal') {
      dimension = evt.pageX;

      if (dimension < railBounds.left) {
        percentage = 0;
      } else if (dimension > railBounds.right) {
        percentage = 100;
      } else {
        percentage = Object(utils_math__WEBPACK_IMPORTED_MODULE_4__["between"])((dimension - railBounds.left) / railBounds.width, 0, 1) * 100;
      }
    } else {
      dimension = evt.pageY;

      if (dimension >= railBounds.bottom) {
        percentage = 0;
      } else if (dimension <= railBounds.top) {
        percentage = 100;
      } else {
        percentage = Object(utils_math__WEBPACK_IMPORTED_MODULE_4__["between"])((railBounds.height - (dimension - railBounds.top)) / railBounds.height, 0, 1) * 100;
      }
    }

    this.render(percentage);
    this.update(percentage);
    return false;
  };

  _proto.tap = function tap(evt) {
    this.railBounds = getRailBounds(this.elementRail);
    this.dragMove(evt);
  };

  _proto.limit = function limit(percentage) {
    // modules that extend Slider can set limits on the percentage (TimeSlider)
    return percentage;
  };

  _proto.update = function update(percentage) {
    this.trigger('update', {
      percentage: percentage
    });
  };

  _proto.render = function render(percentage) {
    percentage = Math.max(0, Math.min(percentage, 100));
    var elThumb = this.elementThumb;
    var elProgress = this.elementProgress;

    if (this.orientation === 'horizontal') {
      elThumb.style.left = percentage + '%';
      elProgress.style.width = percentage + '%';
    } else {
      elThumb.style.bottom = percentage + '%';
      elProgress.style.height = percentage + '%';
    }
  };

  _proto.updateBuffer = function updateBuffer(percentage) {
    this.elementBuffer.style.width = percentage + '%';
  };

  _proto.element = function element() {
    return this.el;
  };

  return Slider;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_2__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (Slider);

/***/ }),

/***/ "./src/js/view/controls/components/thumbnails.mixin.ts":
/*!*************************************************************!*\
  !*** ./src/js/view/controls/components/thumbnails.mixin.ts ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var utils_ajax__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/ajax */ "./src/js/utils/ajax.js");
/* harmony import */ var parsers_captions_srt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! parsers/captions/srt */ "./src/js/parsers/captions/srt.ts");




function Thumbnail(obj) {
  this.begin = obj.begin;
  this.end = obj.end;
  this.img = obj.text;
}

var ThumbnailsMixin = {
  loadThumbnails: function loadThumbnails(file) {
    if (!file) {
      return;
    }

    this.vttPath = file.split('?')[0].split('/').slice(0, -1).join('/'); // Only load the first individual image file so we can get its dimensions. All others are loaded when
    // they're set as background-images.

    this.individualImage = null;
    Object(utils_ajax__WEBPACK_IMPORTED_MODULE_1__["ajax"])(file, this.thumbnailsLoaded.bind(this), this.thumbnailsFailed.bind(this), {
      plainText: true
    });
  },
  thumbnailsLoaded: function thumbnailsLoaded(evt) {
    var data = Object(parsers_captions_srt__WEBPACK_IMPORTED_MODULE_2__["default"])(evt.responseText);

    if (Array.isArray(data)) {
      data.forEach(function (obj) {
        var thumbs = this.thumbnails;
        thumbs.push(new Thumbnail(obj));
      }, this);
      this.drawCues(); // Set the initial timetip dimensions for the thumbnail

      this.showThumbnail(0);
    }
  },
  thumbnailsFailed: function thumbnailsFailed() {
    /* no-op */
  },
  chooseThumbnail: function chooseThumbnail(seconds) {
    var thumbs = this.thumbnails;
    var idx = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["sortedIndex"])(thumbs, {
      end: seconds
    }, Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["property"])('end'));

    if (idx >= thumbs.length) {
      idx = thumbs.length - 1;
    }

    var url = thumbs[idx].img;

    if (url.indexOf('://') < 0) {
      url = this.vttPath ? this.vttPath + '/' + url : url;
    }

    return url;
  },
  loadThumbnail: function loadThumbnail(seconds) {
    var url = this.chooseThumbnail(seconds);
    var style = {
      margin: '0 auto',
      backgroundPosition: '0 0'
    };
    var hashIndex = url.indexOf('#xywh');

    if (hashIndex > 0) {
      try {
        var matched = /(.+)#xywh=(\d+),(\d+),(\d+),(\d+)/.exec(url);

        if (!matched) {
          throw new Error('No match for expected thumbnail pattern');
        }

        url = matched[1];
        var xVal = parseInt(matched[2]);
        var yVAl = parseInt(matched[3]);
        style.backgroundPosition = xVal * -1 + 'px ' + yVAl * -1 + 'px';
        style.width = matched[4];
        this.timeTip.setWidth(+style.width);
        style.height = matched[5];
      } catch (e) {
        // this.vttFailed('Could not parse thumbnail');
        return;
      }
    } else if (!this.individualImage) {
      var indImg = this.individualImage = new Image();
      indImg.onload = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["bind"])(function () {
        indImg.onload = null;
        this.timeTip.image({
          width: indImg.width,
          height: indImg.height
        });
        this.timeTip.setWidth(indImg.width);
      }, this);
      indImg.src = url;
    }

    style.backgroundImage = 'url("' + url + '")';
    return style;
  },
  showThumbnail: function showThumbnail(seconds) {
    // Don't attempt to set thumbnail for small players or when a thumbnail doesn't exist
    if (this._model.get('containerWidth') <= 420 || !this.thumbnails || this.thumbnails.length < 1) {
      return;
    }

    this.timeTip.image(this.loadThumbnail(seconds));
  },
  resetThumbnails: function resetThumbnails() {
    this.timeTip.image({
      backgroundImage: '',
      width: 0,
      height: 0
    });
    this.thumbnails = [];
  }
};
/* harmony default export */ __webpack_exports__["default"] = (ThumbnailsMixin);

/***/ }),

/***/ "./src/js/view/controls/components/timeslider.ts":
/*!*******************************************************!*\
  !*** ./src/js/view/controls/components/timeslider.ts ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var utils_math__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/math */ "./src/js/utils/math.ts");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_parser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/parser */ "./src/js/utils/parser.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var view_controls_components_slider__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! view/controls/components/slider */ "./src/js/view/controls/components/slider.ts");
/* harmony import */ var view_controls_components_tooltipicon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! view/controls/components/tooltipicon */ "./src/js/view/controls/components/tooltipicon.ts");
/* harmony import */ var view_controls_components_chapters_mixin__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! view/controls/components/chapters.mixin */ "./src/js/view/controls/components/chapters.mixin.ts");
/* harmony import */ var view_controls_components_thumbnails_mixin__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! view/controls/components/thumbnails.mixin */ "./src/js/view/controls/components/thumbnails.mixin.ts");


function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }












var TimeTipIcon = /*#__PURE__*/function (_TooltipIcon) {
  _inheritsLoose(TimeTipIcon, _TooltipIcon);

  function TimeTipIcon() {
    return _TooltipIcon.apply(this, arguments) || this;
  }

  var _proto = TimeTipIcon.prototype;

  _proto.setup = function setup() {
    this.text = document.createElement('span');
    this.text.className = 'jw-text jw-reset';
    this.img = document.createElement('div');
    this.img.className = 'jw-time-thumb jw-reset';
    this.containerWidth = 0;
    this.textLength = 0;
    this.dragJustReleased = false;
    var wrapper = document.createElement('div');
    wrapper.className = 'jw-time-tip jw-reset';
    wrapper.appendChild(this.img);
    wrapper.appendChild(this.text);
    this.addContent(wrapper);
  };

  _proto.image = function image(styles) {
    Object(utils_css__WEBPACK_IMPORTED_MODULE_2__["style"])(this.img, styles);
  };

  _proto.update = function update(txt) {
    if (!this.text) {
      return;
    }

    this.text.textContent = txt;
  };

  _proto.getWidth = function getWidth() {
    if (!this.containerWidth) {
      this.setWidth();
    }

    return this.containerWidth;
  };

  _proto.setWidth = function setWidth(width) {
    var tolerance = 16; // add a little padding so the tooltip isn't flush against the edge

    if (width) {
      this.containerWidth = width + tolerance;
      return;
    }

    if (!this.tooltip) {
      return;
    }

    this.containerWidth = Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["bounds"])(this.container).width + tolerance;
  };

  _proto.resetWidth = function resetWidth() {
    this.containerWidth = 0;
  };

  return TimeTipIcon;
}(view_controls_components_tooltipicon__WEBPACK_IMPORTED_MODULE_7__["default"]);

function reasonInteraction() {
  return {
    reason: 'interaction'
  };
}

var TimeSlider = /*#__PURE__*/function (_Slider) {
  _inheritsLoose(TimeSlider, _Slider);

  function TimeSlider(_model, _api, _timeUpdateKeeper) {
    var _this;

    _this = _Slider.call(this, 'jw-slider-time', 'horizontal') || this;
    _this._model = _model;
    _this._api = _api;
    _this.timeUpdateKeeper = _timeUpdateKeeper;
    _this.timeTip = new TimeTipIcon('jw-tooltip-time', null, true);

    _this.timeTip.setup();

    _this.cues = []; // Store the attempted seek, until the previous one completes

    _this.seekThrottled = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["throttle"])(_this.performSeek, 400);
    _this.mobileHoverDistance = 5;

    _this.setup();

    return _this;
  } // These overwrite Slider methods


  var _proto2 = TimeSlider.prototype;

  _proto2.setup = function setup() {
    var _this2 = this;

    _Slider.prototype.setup.call(this);

    this._model.on('change:duration', this.onDuration, this).on('change:cues', this.updateCues, this).on('seeked', function () {
      if (!_this2._model.get('scrubbing')) {
        _this2.updateAriaText();
      }
    });

    this._model.change('position', this.onPosition, this).change('buffer', this.onBuffer, this).change('streamType', this.onStreamType, this); // Clear cues on player model's playlistItem change event


    this._model.player.change('playlistItem', this.onPlaylistItem, this);

    var sliderElement = this.el;
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["setAttribute"])(sliderElement, 'tabindex', '0');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["setAttribute"])(sliderElement, 'role', 'slider');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["setAttribute"])(sliderElement, 'aria-label', this._model.get('localization').slider);
    sliderElement.removeAttribute('aria-hidden');
    this.elementRail.appendChild(this.timeTip.element()); // Show the tooltip on while dragging (touch) moving(mouse), or moving over(mouse)

    this.ui = (this.ui || new utils_ui__WEBPACK_IMPORTED_MODULE_5__["default"](sliderElement)).on('move drag', this.showTimeTooltip, this).on('dragEnd out', this.hideTimeTooltip, this).on('click', function () {
      return sliderElement.focus();
    }).on('focus', this.updateAriaText, this);
  };

  _proto2.update = function update(percent) {
    this.seekTo = percent;
    this.seekThrottled();

    _Slider.prototype.update.apply(this, [percent]);
  };

  _proto2.dragStart = function dragStart() {
    this._model.set('scrubbing', true);

    _Slider.prototype.dragStart.call(this);
  };

  _proto2.dragEnd = function dragEnd(evt) {
    _Slider.prototype.dragEnd.apply(this, [evt]);

    this._model.set('scrubbing', false);
  };

  _proto2.onBuffer = function onBuffer(model, pct) {
    this.updateBuffer(pct);
  };

  _proto2.onPosition = function onPosition(model, position) {
    this.updateTime(position, model.get('duration'));
  };

  _proto2.onDuration = function onDuration(model, duration) {
    this.updateTime(model.get('position'), duration);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["setAttribute"])(this.el, 'aria-valuemin', 0);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["setAttribute"])(this.el, 'aria-valuemax', duration);
    this.drawCues();
  };

  _proto2.onStreamType = function onStreamType(model, streamType) {
    this.streamType = streamType;
  };

  _proto2.updateTime = function updateTime(position, duration) {
    var pct = 0;

    if (duration) {
      if (this.streamType === 'DVR') {
        var dvrSeekLimit = this._model.get('dvrSeekLimit');

        var diff = duration + dvrSeekLimit;
        var pos = position + dvrSeekLimit;
        pct = (diff - pos) / diff * 100;
      } else if (this.streamType === 'VOD' || !this.streamType) {
        // Default to VOD behavior if streamType isn't set
        pct = position / duration * 100;
      }
    }

    this.render(pct);
  };

  _proto2.onPlaylistItem = function onPlaylistItem(model, playlistItem) {
    this.reset(); //  If cues have been cleared from slider but exist on model, update cues.

    var cues = model.get('cues');

    if (!this.cues.length && cues.length) {
      this.updateCues(null, cues);
    }

    var tracks = playlistItem.tracks;
    Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["each"])(tracks, function (track) {
      if (track && track.kind && track.kind.toLowerCase() === 'thumbnails') {
        this.loadThumbnails(track.file);
      } else if (track && track.kind && track.kind.toLowerCase() === 'chapters') {
        this.loadChapters(track.file);
      }
    }, this);
  };

  _proto2.performSeek = function performSeek() {
    var percent = this.seekTo;

    var duration = this._model.get('duration');

    var position;

    if (duration === 0) {
      this._api.play(reasonInteraction());
    } else if (this.streamType === 'DVR') {
      var seekRange = this._model.get('seekRange') || {
        start: 0
      };

      var dvrSeekLimit = this._model.get('dvrSeekLimit');

      position = seekRange.start + (-duration - dvrSeekLimit) * percent / 100;

      this._api.seek(position, reasonInteraction());
    } else {
      position = percent / 100 * duration;

      this._api.seek(Math.min(position, duration - 0.25), reasonInteraction());
    }
  };

  _proto2.showTimeTooltip = function showTimeTooltip(evt) {
    var _this3 = this;

    var duration = this._model.get('duration');

    if (duration === 0) {
      return;
    }

    var playerWidth = this._model.get('containerWidth');

    var railBounds = Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["bounds"])(this.elementRail);
    var position = evt.pageX ? evt.pageX - railBounds.left : evt.x;
    position = Object(utils_math__WEBPACK_IMPORTED_MODULE_1__["between"])(position, 0, railBounds.width);
    var pct = position / railBounds.width;
    var time = duration * pct; // For DVR we need to swap it around

    if (duration < 0) {
      var dvrSeekLimit = this._model.get('dvrSeekLimit');

      duration += dvrSeekLimit;
      time = duration * pct;
      time = duration - time;
    }

    var timetipText; // With touch events, we never will get the hover events on the cues that cause cues to be active.
    // Therefore use the info we about the scroll position to detect if there is a nearby cue to be active.

    if (evt.pointerType === 'touch') {
      this.activeCue = this.cues.reduce(function (closeCue, cue) {
        if (Math.abs(position - parseInt(cue.pct) / 100 * railBounds.width) < _this3.mobileHoverDistance) {
          return cue;
        }

        return closeCue;
      }, undefined);
    }

    if (this.activeCue) {
      timetipText = this.activeCue.text;
    } else {
      var allowNegativeTime = true;
      timetipText = Object(utils_parser__WEBPACK_IMPORTED_MODULE_3__["timeFormat"])(time, allowNegativeTime); // If DVR and within live buffer

      if (duration < 0 && time > -1) {
        timetipText = 'Live';
      }
    }

    var timeTip = this.timeTip;
    timeTip.update(timetipText);

    if (this.textLength !== timetipText.length) {
      // An activeCue may cause the width of the timeTip container to change
      this.textLength = timetipText.length;
      timeTip.resetWidth();
    }

    this.showThumbnail(time);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["addClass"])(timeTip.el, 'jw-open');
    var timeTipWidth = timeTip.getWidth();
    var tolerance = playerWidth - railBounds.width;
    var timeTipPixels = 0;

    if (timeTipWidth > tolerance) {
      // timeTip may go outside the bounds of the player. Determine the amount of tolerance needed in pixels.
      timeTipPixels = (timeTipWidth - tolerance) / 2;
    }

    var safePixels = Math.round(Math.min(railBounds.width - timeTipPixels, Math.max(timeTipPixels, position)) * 4) / 4;
    Object(utils_css__WEBPACK_IMPORTED_MODULE_2__["transform"])(timeTip.el, "translateX(" + safePixels + "px)");
  };

  _proto2.hideTimeTooltip = function hideTimeTooltip() {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["removeClass"])(this.timeTip.el, 'jw-open');
  };

  _proto2.updateCues = function updateCues(model, cues) {
    var _this4 = this;

    this.resetCues();

    if (cues && cues.length) {
      cues.forEach(function (ele) {
        _this4.addCue(ele);
      });
      this.drawCues();
    }
  };

  _proto2.updateAriaText = function updateAriaText() {
    var model = this._model;
    var position = model.get('position');
    var duration = model.get('duration');
    var ariaText = Object(utils_parser__WEBPACK_IMPORTED_MODULE_3__["timeFormat"])(position);

    if (this.streamType !== 'DVR') {
      ariaText += " of " + Object(utils_parser__WEBPACK_IMPORTED_MODULE_3__["timeFormat"])(duration);
    }

    var sliderElement = this.el;

    if (document.activeElement !== sliderElement) {
      this.timeUpdateKeeper.textContent = ariaText;
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["setAttribute"])(sliderElement, 'aria-valuenow', position);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["setAttribute"])(sliderElement, 'aria-valuetext', ariaText);
  };

  _proto2.reset = function reset() {
    this.resetThumbnails();
    this.timeTip.resetWidth();
    this.textLength = 0;
  };

  return TimeSlider;
}(view_controls_components_slider__WEBPACK_IMPORTED_MODULE_6__["default"]);

Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(TimeSlider.prototype, view_controls_components_chapters_mixin__WEBPACK_IMPORTED_MODULE_8__["default"], view_controls_components_thumbnails_mixin__WEBPACK_IMPORTED_MODULE_9__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (TimeSlider);

/***/ }),

/***/ "./src/js/view/controls/components/tooltipicon.ts":
/*!********************************************************!*\
  !*** ./src/js/view/controls/components/tooltipicon.ts ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return TooltipIcon; });
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var utils_aria__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/aria */ "./src/js/utils/aria.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_svgParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/svgParser */ "./src/js/utils/svgParser.ts");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }






var TooltipIcon = /*#__PURE__*/function (_Events) {
  _inheritsLoose(TooltipIcon, _Events);

  function TooltipIcon(name, ariaText, elementShown, svgIcons) {
    var _this;

    _this = _Events.call(this) || this;
    _this.el = document.createElement('div');
    var className = 'jw-icon jw-icon-tooltip ' + name + ' jw-button-color jw-reset';

    if (!elementShown) {
      className += ' jw-hidden';
    }

    if (ariaText) {
      Object(utils_aria__WEBPACK_IMPORTED_MODULE_1__["default"])(_this.el, ariaText);
    }

    _this.el.className = className;
    _this.tooltip = document.createElement('div');
    _this.tooltip.className = 'jw-overlay jw-reset';
    _this.openClass = 'jw-open';
    _this.componentType = 'tooltip';

    _this.el.appendChild(_this.tooltip);

    if (svgIcons && svgIcons.length > 0) {
      Array.prototype.forEach.call(svgIcons, function (svgIcon) {
        if (typeof svgIcon === 'string') {
          _this.el.appendChild(Object(utils_svgParser__WEBPACK_IMPORTED_MODULE_3__["default"])(svgIcon));
        } else {
          _this.el.appendChild(svgIcon);
        }
      });
    }

    return _this;
  }

  var _proto = TooltipIcon.prototype;

  _proto.addContent = function addContent(elem) {
    if (this.content) {
      this.removeContent();
    }

    this.content = elem;
    this.tooltip.appendChild(elem);
  };

  _proto.removeContent = function removeContent() {
    if (this.content) {
      this.tooltip.removeChild(this.content);
      this.content = null;
    }
  };

  _proto.hasContent = function hasContent() {
    return !!this.content;
  };

  _proto.element = function element() {
    return this.el;
  };

  _proto.openTooltip = function openTooltip(evt) {
    if (!this.isOpen) {
      this.trigger('open-' + this.componentType, evt, {
        isOpen: true
      });
      this.isOpen = true;
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["toggleClass"])(this.el, this.openClass, this.isOpen);
    }
  };

  _proto.closeTooltip = function closeTooltip(evt) {
    if (this.isOpen) {
      this.trigger('close-' + this.componentType, evt, {
        isOpen: false
      });
      this.isOpen = false;
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["toggleClass"])(this.el, this.openClass, this.isOpen);
    }
  };

  _proto.toggleOpenState = function toggleOpenState(evt) {
    if (this.isOpen) {
      this.closeTooltip(evt);
    } else {
      this.openTooltip(evt);
    }
  };

  return TooltipIcon;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/js/view/controls/components/volumetooltipicon.ts":
/*!**************************************************************!*\
  !*** ./src/js/view/controls/components/volumetooltipicon.ts ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return VolumeTooltipIcon; });
/* harmony import */ var view_controls_components_tooltipicon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/controls/components/tooltipicon */ "./src/js/view/controls/components/tooltipicon.ts");
/* harmony import */ var view_controls_components_slider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! view/controls/components/slider */ "./src/js/view/controls/components/slider.ts");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }






var VolumeSlider = /*#__PURE__*/function (_Slider) {
  _inheritsLoose(VolumeSlider, _Slider);

  function VolumeSlider(orientation, label, styleElement) {
    var _this;

    var className = 'jw-slider-volume';

    if (orientation === 'vertical') {
      className += ' jw-volume-tip';
    }

    _this = _Slider.call(this, className, orientation) || this;

    _this.setup();

    _this.element().classList.remove('jw-background-color');

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["setAttribute"])(styleElement, 'tabindex', '0');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["setAttribute"])(styleElement, 'aria-label', label);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["setAttribute"])(styleElement, 'aria-orientation', orientation);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["setAttribute"])(styleElement, 'aria-valuemin', 0);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["setAttribute"])(styleElement, 'aria-valuemax', 100);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["setAttribute"])(styleElement, 'role', 'slider');
    _this.uiOver = new utils_ui__WEBPACK_IMPORTED_MODULE_2__["default"](styleElement) // eslint-disable-next-line @typescript-eslint/no-empty-function
    .on('click', function () {});
    return _this;
  }

  return VolumeSlider;
}(view_controls_components_slider__WEBPACK_IMPORTED_MODULE_1__["default"]);

var VolumeTooltipIcon = /*#__PURE__*/function (_TooltipIcon) {
  _inheritsLoose(VolumeTooltipIcon, _TooltipIcon);

  function VolumeTooltipIcon(_model, name, ariaText, svgIcons, horizontalContainer) {
    var _this2;

    _this2 = _TooltipIcon.call(this, name, ariaText, true, svgIcons) || this;
    _this2._model = _model;
    _this2.horizontalContainer = horizontalContainer;

    var volumeLabel = _model.get('localization').volumeSlider;

    _this2.horizontalSlider = new VolumeSlider('horizontal', volumeLabel, horizontalContainer);
    _this2.verticalSlider = new VolumeSlider('vertical', volumeLabel, _this2.tooltip);
    horizontalContainer.appendChild(_this2.horizontalSlider.element());

    _this2.addContent(_this2.verticalSlider.element());

    _this2.verticalSlider.on('update', function (evt) {
      this.trigger('update', evt);
    }, _assertThisInitialized(_assertThisInitialized(_this2)));

    _this2.horizontalSlider.on('update', function (evt) {
      this.trigger('update', evt);
    }, _assertThisInitialized(_assertThisInitialized(_this2)));

    _this2.horizontalSlider.uiOver.on('keydown', function (evt) {
      var event = evt.sourceEvent;

      switch (event.keyCode) {
        case 37:
          event.stopPropagation();

          _this2.trigger('adjustVolume', -10);

          break;

        case 39:
          event.stopPropagation();

          _this2.trigger('adjustVolume', 10);

          break;

        default:
      }
    });

    _this2.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_2__["default"](_this2.el, {
      directSelect: true
    }).on('click enter', _this2.toggleValue, _assertThisInitialized(_assertThisInitialized(_this2))).on('tap', _this2.toggleOpenState, _assertThisInitialized(_assertThisInitialized(_this2)));

    _this2.addSliderHandlers(_this2.ui);

    _this2.addSliderHandlers(_this2.horizontalSlider.uiOver);

    _this2.addSliderHandlers(_this2.verticalSlider.uiOver);

    _this2._model.change('audioMode', _this2.updateSlider, _assertThisInitialized(_assertThisInitialized(_this2)));

    return _this2;
  }

  var _proto = VolumeTooltipIcon.prototype;

  _proto.updateSlider = function updateSlider(model, audioMode) {
    var hasHorizontalSlider = model.get('horizontalVolumeSlider') || audioMode;
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["toggleClass"])(this.element(), 'jw-flag-horizontal-slider', hasHorizontalSlider ? true : false);
  };

  _proto.addSliderHandlers = function addSliderHandlers(ui) {
    var openSlider = this.openSlider,
        closeSlider = this.closeSlider;
    ui.on('over', openSlider, this).on('out', closeSlider, this).on('focus', openSlider, this).on('blur', closeSlider, this);
  };

  _proto.openSlider = function openSlider(evt) {
    _TooltipIcon.prototype.openTooltip.call(this, evt);

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["toggleClass"])(this.horizontalContainer, this.openClass, true);
  };

  _proto.closeSlider = function closeSlider(evt) {
    _TooltipIcon.prototype.closeTooltip.call(this, evt);

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["toggleClass"])(this.horizontalContainer, this.openClass, false);
    this.horizontalContainer.blur();
  };

  _proto.toggleValue = function toggleValue() {
    this.trigger('toggleValue');
  };

  _proto.destroy = function destroy() {
    this.horizontalSlider.uiOver.destroy();
    this.verticalSlider.uiOver.destroy();
    this.ui.destroy();
  };

  return VolumeTooltipIcon;
}(view_controls_components_tooltipicon__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/js/view/controls/controlbar.js":
/*!********************************************!*\
  !*** ./src/js/view/controls/controlbar.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Controlbar; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var view_controls_components_custom_button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! view/controls/components/custom-button */ "./src/js/view/controls/components/custom-button.ts");
/* harmony import */ var view_controls_components_timeslider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! view/controls/components/timeslider */ "./src/js/view/controls/components/timeslider.ts");
/* harmony import */ var view_controls_components_volumetooltipicon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! view/controls/components/volumetooltipicon */ "./src/js/view/controls/components/volumetooltipicon.ts");
/* harmony import */ var view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! view/controls/components/button */ "./src/js/view/controls/components/button.ts");
/* harmony import */ var view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! view/controls/components/simple-tooltip */ "./src/js/view/controls/components/simple-tooltip.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_parser__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! utils/parser */ "./src/js/utils/parser.ts");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_random_id_generator__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! utils/random-id-generator */ "./src/js/utils/random-id-generator.ts");















function text(name, role) {
  var element = document.createElement('span');
  element.className = 'jw-text jw-reset-text ' + name;

  if (role) {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(element, 'role', role);
  }

  Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(element, 'dir', 'auto');
  return element;
}

function textIcon(name, role) {
  var element = document.createElement('div');
  element.className = 'jw-icon jw-icon-inline jw-text jw-reset ' + name;

  if (role) {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(element, 'role', role);
  }

  return element;
}

function div(classes) {
  var element = document.createElement('div');
  element.className = "jw-reset " + classes;
  return element;
}

function createCastButton(castToggle, localization) {
  if ('WebKitPlaybackTargetAvailabilityEvent' in window) {
    var airplayButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-airplay jw-off', castToggle, localization.airplay, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('airplay-off,airplay-on'));
    Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(airplayButton.element(), 'airplay', localization.airplay);
    return airplayButton;
  } else if (environment_environment__WEBPACK_IMPORTED_MODULE_1__["Browser"].chrome && window.chrome) {
    var castLauncher = document.createElement('google-cast-launcher');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(castLauncher, 'tabindex', '-1');
    castLauncher.className += ' jw-reset';
    var castButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-cast', null, localization.cast);
    castButton.ui.off();
    var element = castButton.element();
    element.style.cursor = 'pointer';
    element.appendChild(castLauncher);
    castButton.button = castLauncher;
    Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(element, 'chromecast', localization.cast);
    return castButton;
  }
}

function reasonInteraction() {
  return {
    reason: 'interaction'
  };
}

function buttonsInFirstNotInSecond(buttonsA, buttonsB) {
  return buttonsA.filter(function (a) {
    return !buttonsB.some(function (b) {
      return b.id + b.btnClass === a.id + a.btnClass && a.callback === b.callback;
    });
  });
}

var appendChildren = function appendChildren(container, elements) {
  elements.forEach(function (e) {
    if (e.element) {
      e = e.element();
    }

    container.appendChild(e);
  });
};

var Controlbar = /*#__PURE__*/function () {
  function Controlbar(_api, _model, _accessibilityContainer) {
    var _this = this;

    Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(this, utils_backbone_events__WEBPACK_IMPORTED_MODULE_9__["default"]);

    this._api = _api;
    this._model = _model;
    this._isMobile = environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].mobile;
    this._volumeAnnouncer = _accessibilityContainer.querySelector('.jw-volume-update');

    var localization = _model.get('localization');

    var timeSlider = new view_controls_components_timeslider__WEBPACK_IMPORTED_MODULE_5__["default"](_model, _api, _accessibilityContainer.querySelector('.jw-time-update'));
    var menus = this.menus = [];
    this.ui = [];
    var volumeGroup;
    var horizontalVolumeContainer;
    var muteButton;
    var feedShownId = '';
    var vol = localization.volume; // Do not initialize volume slider or tooltip on mobile

    if (!this._isMobile) {
      horizontalVolumeContainer = document.createElement('div');
      horizontalVolumeContainer.className = 'jw-horizontal-volume-container';
      volumeGroup = new view_controls_components_volumetooltipicon__WEBPACK_IMPORTED_MODULE_6__["default"](_model, 'jw-icon-volume', vol, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('volume-0,volume-50,volume-100'), horizontalVolumeContainer);
      var volumeButtonEl = volumeGroup.element();
      menus.push(volumeGroup); // Use 'group' role so that voiceover identifies volume slider and button

      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(volumeButtonEl, 'role', 'group');

      _model.change('mute', function (model, muted) {
        var muteText = muted ? localization.unmute : localization.mute;
        Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(volumeButtonEl, 'aria-label', muteText + ' button');
      }, this);
    } else if (!_model.get('sdkplatform') && !(environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].iOS && environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].version.major < 10)) {
      // Do not show the volume toggle in the mobile SDKs or <iOS10
      // Clone icons so that can be used in volumeGroup
      var svgIcons = Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('volume-0,volume-100');
      muteButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-volume', function () {
        _api.setMute();
      }, vol, svgIcons);
    }

    var nextButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-next', function () {
      _api.next({
        feedShownId: feedShownId,
        reason: 'interaction'
      });
    }, localization.next, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('next'));
    var settingsButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-settings jw-settings-submenu-button', function (event) {
      _this.trigger('settingsInteraction', 'quality', true, event);
    }, localization.settings, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('settings'));
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(settingsButton.element(), 'aria-haspopup', 'true');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(settingsButton.element(), 'aria-controls', 'jw-settings-menu');
    var captionsButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-cc jw-settings-submenu-button', function (event) {
      _this.trigger('settingsInteraction', 'captions', false, event);
    }, localization.cc, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('cc-off,cc-on'));
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(captionsButton.element(), 'aria-haspopup', 'true');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(captionsButton.element(), 'aria-controls', 'jw-settings-submenu-captions');
    var liveButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-text-live', function () {
      _this.goToLiveEdge();
    }, localization.liveBroadcast);
    liveButton.element().textContent = localization.liveBroadcast;
    var elements = this.elements = {
      alt: text('jw-text-alt', 'status'),
      play: Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-playback', function () {
        _api.playToggle(reasonInteraction());
      }, localization.play, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('play,pause,stop')),
      rewind: Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-rewind', function () {
        _this.rewind();
      }, localization.rewind, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('rewind')),
      live: liveButton,
      next: nextButton,
      elapsed: textIcon('jw-text-elapsed', 'timer'),
      countdown: textIcon('jw-text-countdown', 'timer'),
      time: timeSlider,
      duration: textIcon('jw-text-duration', 'timer'),
      mute: muteButton,
      volumetooltip: volumeGroup,
      horizontalVolumeContainer: horizontalVolumeContainer,
      cast: createCastButton(function () {
        _api.castToggle();
      }, localization),
      imaFullscreen: Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-fullscreen', function () {
        _api.setFullscreen();
      }, localization.fullscreen, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('fullscreen-off,fullscreen-on')),
      fullscreen: Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_7__["default"])('jw-icon-fullscreen', function () {
        _api.setFullscreen();
      }, localization.fullscreen, Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcons"])('fullscreen-off,fullscreen-on')),
      spacer: div('jw-spacer'),
      buttonContainer: div('jw-button-container'),
      settingsButton: settingsButton,
      captionsButton: captionsButton
    }; // Add text tooltips

    var captionsTip = Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(captionsButton.element(), 'captions', localization.cc);

    var onCaptionsChanged = function onCaptionsChanged(model) {
      var currentCaptions = model.get('captionsList')[model.get('captionsIndex')];
      var newText = localization.cc;

      if (currentCaptions && currentCaptions.label !== 'Off') {
        newText = currentCaptions.label;
      }

      captionsTip.setText(newText);
    };

    var playPauseStopTooltip = Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(elements.play.element(), 'play', localization.play);

    this.setPlayText = function (newLocalization) {
      playPauseStopTooltip.setText(newLocalization);
    };

    var nextElement = elements.next.element();
    var nextUpTip = Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(nextElement, 'next', localization.nextUp, function () {
      var nextUp = _model.get('nextUp');

      if (!nextUp) {
        return;
      }

      feedShownId = Object(utils_random_id_generator__WEBPACK_IMPORTED_MODULE_13__["genId"])(utils_random_id_generator__WEBPACK_IMPORTED_MODULE_13__["FEED_SHOWN_ID_LENGTH"]);

      _this.trigger('nextShown', {
        mode: nextUp.mode,
        ui: 'nextup',
        itemsShown: [nextUp],
        feedData: nextUp.feedData,
        reason: 'hover',
        feedShownId: feedShownId
      });
    }, function () {
      feedShownId = '';
    });
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(nextElement, 'dir', 'auto');
    Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(elements.rewind.element(), 'rewind', localization.rewind);
    Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(elements.settingsButton.element(), 'settings', localization.settings);
    var fullscreenTips = [Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(elements.fullscreen.element(), 'fullscreen', localization.fullscreen), Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(elements.imaFullscreen.element())];
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["addClass"])(elements.imaFullscreen.element(), 'jw-fullscreen-ima'); // Filter out undefined elements

    var buttonLayout = [elements.play, elements.rewind, elements.next, elements.volumetooltip, elements.imaFullscreen, elements.mute, elements.horizontalVolumeContainer, elements.alt, elements.live, elements.elapsed, elements.countdown, elements.duration, elements.spacer, elements.cast, elements.captionsButton, elements.settingsButton, elements.fullscreen].filter(function (e) {
      return e;
    });
    var layout = [elements.time, elements.buttonContainer].filter(function (e) {
      return e;
    });
    this.el = document.createElement('div');
    this.el.className = 'jw-controlbar jw-reset';
    appendChildren(elements.buttonContainer, buttonLayout);
    appendChildren(this.el, layout);

    var logo = _model.get('logo');

    if (logo && logo.position === 'control-bar') {
      this.addLogo(logo);
    } // Initial State


    elements.play.show();
    elements.fullscreen.show();

    if (elements.mute) {
      elements.mute.show();
    } // Listen for model changes


    _model.change('volume', this.onVolume, this);

    _model.change('mute', function (model, muted) {
      _this.renderVolume(muted, model.get('volume'));
    }, this);

    _model.change('state', this.onState, this);

    _model.change('duration', this.onDuration, this);

    _model.change('position', this.onElapsed, this);

    _model.change('fullscreen', function (model, val) {
      var fullscreenElements = [_this.elements.fullscreen.element(), _this.elements.imaFullscreen.element()];

      for (var i = 0; i < fullscreenElements.length; i++) {
        var element = fullscreenElements[i];
        Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["toggleClass"])(fullscreenElements[i], 'jw-off', val);
        var fullscreenText = model.get('fullscreen') ? localization.exitFullscreen : localization.fullscreen;
        fullscreenTips[i].setText(fullscreenText);
        Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(element, 'aria-label', fullscreenText);
      }
    }, this);

    _model.change('streamType', this.onStreamTypeChange, this);

    _model.change('dvrLive', function (model, dvrLive) {
      var liveBroadcast = localization.liveBroadcast,
          notLive = localization.notLive;

      var liveElement = _this.elements.live.element();

      var dvrNotLive = dvrLive === false; // jw-dvr-live: Player is in DVR mode but not at the live edge.

      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["toggleClass"])(liveElement, 'jw-dvr-live', dvrNotLive);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(liveElement, 'aria-label', dvrNotLive ? notLive : liveBroadcast);
      liveElement.textContent = dvrNotLive ? notLive : liveBroadcast;
    }, this);

    _model.change('altText', this.setAltText, this);

    _model.change('customButtons', this.updateButtons, this);

    _model.on('change:captionsIndex', onCaptionsChanged, this);

    _model.on('change:captionsList', onCaptionsChanged, this);

    _model.change('nextUp', function (model, nextUp) {
      feedShownId = Object(utils_random_id_generator__WEBPACK_IMPORTED_MODULE_13__["genId"])(utils_random_id_generator__WEBPACK_IMPORTED_MODULE_13__["FEED_SHOWN_ID_LENGTH"]);
      var tipText = localization.nextUp;

      if (nextUp && nextUp.title) {
        tipText += ": " + nextUp.title;
      }

      nextUpTip.setText(tipText);
      elements.next.toggle(!!nextUp);
    }, this);

    _model.change('audioMode', this.onAudioMode, this);

    if (elements.cast) {
      _model.change('castAvailable', this.onCastAvailable, this);

      _model.change('castActive', this.onCastActive, this);
    } // Event listeners
    // Volume sliders do not exist on mobile so don't assign listeners to them.


    if (elements.volumetooltip) {
      elements.volumetooltip.on('update', function (pct) {
        var val = pct.percentage;

        this._api.setVolume(val);
      }, this);
      elements.volumetooltip.on('toggleValue', function () {
        this._api.setMute();
      }, this);
      elements.volumetooltip.on('adjustVolume', function (evt) {
        this.trigger('adjustVolume', evt);
      }, this);
    }

    if (elements.cast && elements.cast.button) {
      var castUi = elements.cast.ui.on('click tap enter', function (evt) {
        // controlbar cast button needs to manually trigger a click
        // on the native cast button for taps and enter key
        if (evt.type !== 'click') {
          elements.cast.button.click();
        }

        this._model.set('castClicked', true);
      }, this);
      this.ui.push(castUi);
    }

    var durationUi = new utils_ui__WEBPACK_IMPORTED_MODULE_12__["default"](elements.duration).on('click tap enter', function () {
      if (this._model.get('streamType') === 'DVR') {
        // Seek to "Live" position within live buffer, but not before current position
        var currentPosition = this._model.get('position');

        var dvrSeekLimit = this._model.get('dvrSeekLimit');

        this._api.seek(Math.max(-dvrSeekLimit, currentPosition), reasonInteraction());
      }
    }, this);
    this.ui.push(durationUi); // When the control bar is interacted with, trigger a user action event

    var controlbarUi = new utils_ui__WEBPACK_IMPORTED_MODULE_12__["default"](this.el).on('click tap drag', function () {
      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_2__["USER_ACTION"]);
    }, this);
    this.ui.push(controlbarUi);
    menus.forEach(function (ele) {
      ele.on('open-tooltip', _this.closeMenus, _this);
    });
  }

  var _proto = Controlbar.prototype;

  _proto.onVolume = function onVolume(model, pct) {
    this.renderVolume(model.get('mute'), pct);
  };

  _proto.renderVolume = function renderVolume(muted, vol) {
    var mute = this.elements.mute;
    var volumeGroup = this.elements.volumetooltip; // mute, volume, and volumetooltip do not exist on mobile devices.

    if (mute) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["toggleClass"])(mute.element(), 'jw-off', muted);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["toggleClass"])(mute.element(), 'jw-full', !muted);
    }

    if (volumeGroup) {
      var volume = muted ? 0 : vol;
      var volumeButtonEl = volumeGroup.element();
      volumeGroup.verticalSlider.render(volume);
      volumeGroup.horizontalSlider.render(volume);
      var tooltip = volumeGroup.tooltip,
          horizontalContainer = volumeGroup.horizontalContainer;
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["toggleClass"])(volumeButtonEl, 'jw-off', muted);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["toggleClass"])(volumeButtonEl, 'jw-full', vol >= 75 && !muted);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(tooltip, 'aria-valuenow', volume);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(horizontalContainer, 'aria-valuenow', volume);
      var ariaText = "Volume " + volume + "%";
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(tooltip, 'aria-valuetext', ariaText);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(horizontalContainer, 'aria-valuetext', ariaText);

      if (document.activeElement !== tooltip && document.activeElement !== horizontalContainer) {
        this._volumeAnnouncer.textContent = ariaText;
      }
    }
  };

  _proto.onCastAvailable = function onCastAvailable(model, val) {
    this.elements.cast.toggle(val);
  };

  _proto.onCastActive = function onCastActive(model, val) {
    this.elements.fullscreen.toggle(!val);
    this.elements.imaFullscreen.toggle(!val);

    if (this.elements.cast.button) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["toggleClass"])(this.elements.cast.button, 'jw-off', !val);
    }
  };

  _proto.onElapsed = function onElapsed(model, position) {
    var elapsedTime;
    var countdownTime;
    var duration = model.get('duration');

    if (model.get('streamType') === 'DVR') {
      var currentPosition = Math.ceil(position);

      var dvrSeekLimit = this._model.get('dvrSeekLimit');

      var time = currentPosition >= -dvrSeekLimit ? '' : '-' + Object(utils_parser__WEBPACK_IMPORTED_MODULE_11__["timeFormat"])(-(position + dvrSeekLimit));
      elapsedTime = countdownTime = time;
      model.set('dvrLive', currentPosition >= -dvrSeekLimit);
    } else {
      elapsedTime = Object(utils_parser__WEBPACK_IMPORTED_MODULE_11__["timeFormat"])(position);
      countdownTime = Object(utils_parser__WEBPACK_IMPORTED_MODULE_11__["timeFormat"])(duration - position);
    }

    this.elements.elapsed.textContent = elapsedTime;
    this.elements.countdown.textContent = countdownTime;
  };

  _proto.onDuration = function onDuration(model, val) {
    this.elements.duration.textContent = Object(utils_parser__WEBPACK_IMPORTED_MODULE_11__["timeFormat"])(Math.abs(val));
  };

  _proto.onAudioMode = function onAudioMode(model, val) {
    var timeSlider = this.elements.time.element();

    if (val) {
      this.elements.buttonContainer.insertBefore(timeSlider, this.elements.elapsed);
    } else {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["prependChild"])(this.el, timeSlider);
    }
  };

  _proto.element = function element() {
    return this.el;
  };

  _proto.setAltText = function setAltText(model, altText) {
    this.elements.alt.textContent = altText;
  } // Close menus if it has no event.
  ;

  _proto.closeMenus = function closeMenus(evt) {
    this.menus.forEach(function (ele) {
      if (!evt || evt.target !== ele.el) {
        ele.closeTooltip(evt);
      }
    });
  };

  _proto.rewind = function rewind() {
    var rewindPosition;
    var startPosition = 0;

    var currentTime = this._model.get('currentTime');

    if (currentTime) {
      rewindPosition = currentTime - 10;
    } else {
      rewindPosition = this._model.get('position') - 10; // duration is negative in DVR mode

      if (this._model.get('streamType') === 'DVR') {
        startPosition = this._model.get('duration');
      }
    } // Seek 10s back. Seek value should be >= 0 in VOD mode and >= (negative) duration in DVR mode


    this._api.seek(Math.max(rewindPosition, startPosition), reasonInteraction());
  };

  _proto.onState = function onState(model, state) {
    var localization = model.get('localization');
    var label = localization.play;
    this.setPlayText(label);

    if (state === events_events__WEBPACK_IMPORTED_MODULE_2__["STATE_PLAYING"]) {
      if (model.get('streamType') !== 'LIVE') {
        label = localization.pause;
        this.setPlayText(label);
      } else {
        label = localization.stop;
        this.setPlayText(label);
      }
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(this.elements.play.element(), 'aria-label', label);
  };

  _proto.onStreamTypeChange = function onStreamTypeChange(model, streamType) {
    var liveMode = streamType === 'LIVE';
    var dvrMode = streamType === 'DVR'; // Hide rewind button when in LIVE mode

    if (this.elements.rewind) {
      this.elements.rewind.toggle(!liveMode);
    }

    this.elements.live.toggle(liveMode || dvrMode);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(this.elements.live.element(), 'tabindex', liveMode ? '-1' : '0');
    this.elements.duration.style.display = dvrMode ? 'none' : '';
    this.onDuration(model, model.get('duration'));
    this.onState(model, model.get('state'));
  };

  _proto.addLogo = function addLogo(logo) {
    var buttonContainer = this.elements.buttonContainer;
    var logoButton = new view_controls_components_custom_button__WEBPACK_IMPORTED_MODULE_4__["default"](logo.file, this._model.get('localization').logo, function () {
      if (logo.link) {
        Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["openLink"])(logo.link, '_blank', {
          rel: 'noreferrer'
        });
      }
    }, 'logo', 'jw-logo-button');

    if (!logo.link) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["setAttribute"])(logoButton.element(), 'tabindex', '-1');
    }

    buttonContainer.insertBefore(logoButton.element(), buttonContainer.querySelector('.jw-spacer').nextSibling);
  };

  _proto.goToLiveEdge = function goToLiveEdge() {
    if (this._model.get('streamType') === 'DVR') {
      // Seek to "Live" position within live buffer, but not before the dvr position which must be negative
      var dvrPosition = Math.min(this._model.get('position'), -1);

      var dvrSeekLimit = this._model.get('dvrSeekLimit');

      this._api.seek(Math.max(-dvrSeekLimit, dvrPosition), reasonInteraction());

      this._api.play(reasonInteraction());
    }
  };

  _proto.updateButtons = function updateButtons(model, newButtons, oldButtons) {
    // If buttons are undefined exit, buttons are only removed if newButtons is an array
    if (!newButtons) {
      return;
    }

    var buttonContainer = this.elements.buttonContainer;
    var addedButtons;
    var removedButtons; // On model.change these obects are the same and all buttons need to be added

    if (newButtons === oldButtons || !oldButtons) {
      addedButtons = newButtons;
    } else {
      addedButtons = buttonsInFirstNotInSecond(newButtons, oldButtons);
      removedButtons = buttonsInFirstNotInSecond(oldButtons, newButtons);
      this.removeButtons(buttonContainer, removedButtons);
    }

    for (var i = addedButtons.length - 1; i >= 0; i--) {
      var buttonProps = addedButtons[i];
      var newButton = new view_controls_components_custom_button__WEBPACK_IMPORTED_MODULE_4__["default"](buttonProps.img, buttonProps.tooltip, buttonProps.callback, buttonProps.id, buttonProps.btnClass);

      if (buttonProps.tooltip) {
        Object(view_controls_components_simple_tooltip__WEBPACK_IMPORTED_MODULE_8__["SimpleTooltip"])(newButton.element(), buttonProps.id, buttonProps.tooltip);
      }

      var firstButton = void 0;

      if (newButton.id === 'related') {
        firstButton = this.elements.settingsButton.element();
      } else if (newButton.id === 'share') {
        firstButton = buttonContainer.querySelector('[button="related"]') || this.elements.settingsButton.element();
      } else {
        firstButton = this.elements.spacer.nextSibling;

        if (firstButton && firstButton.getAttribute('button') === 'logo') {
          firstButton = firstButton.nextSibling;
        }
      }

      buttonContainer.insertBefore(newButton.element(), firstButton);
    }
  };

  _proto.removeButtons = function removeButtons(buttonContainer, buttonsToRemove) {
    for (var i = buttonsToRemove.length; i--;) {
      var buttonElement = buttonContainer.querySelector("[button=\"" + buttonsToRemove[i].id + "\"]");

      if (buttonElement) {
        buttonContainer.removeChild(buttonElement);
      }
    }
  };

  _proto.toggleCaptionsButtonState = function toggleCaptionsButtonState(active) {
    var captionsButton = this.elements.captionsButton;

    if (!captionsButton) {
      return;
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_10__["toggleClass"])(captionsButton.element(), 'jw-off', !active);
  };

  _proto.destroy = function destroy() {
    var _this2 = this;

    this._model.off(null, null, this);

    Object.keys(this.elements).forEach(function (elementName) {
      var el = _this2.elements[elementName];

      if (el && typeof el.destroy === 'function') {
        _this2.elements[elementName].destroy();
      }
    });
    this.ui.forEach(function (ui) {
      ui.destroy();
    });
    this.ui = [];
  };

  return Controlbar;
}();



/***/ }),

/***/ "./src/js/view/controls/controls.js":
/*!******************************************!*\
  !*** ./src/js/view/controls/controls.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Controls; });
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var utils_math__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/math */ "./src/js/utils/math.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_date__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/date */ "./src/js/utils/date.ts");
/* harmony import */ var view_controls_components_button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! view/controls/components/button */ "./src/js/view/controls/components/button.ts");
/* harmony import */ var view_controls_controlbar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! view/controls/controlbar */ "./src/js/view/controls/controlbar.js");
/* harmony import */ var view_controls_display_container__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! view/controls/display-container */ "./src/js/view/controls/display-container.ts");
/* harmony import */ var view_controls_nextuptooltip__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! view/controls/nextuptooltip */ "./src/js/view/controls/nextuptooltip.js");
/* harmony import */ var view_controls_rightclick__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! view/controls/rightclick */ "./src/js/view/controls/rightclick.js");
/* harmony import */ var view_controls_components_menu_settings_menu_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! view/controls/components/menu/settings-menu.js */ "./src/js/view/controls/components/menu/settings-menu.js");
/* harmony import */ var view_utils_breakpoint__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! view/utils/breakpoint */ "./src/js/view/utils/breakpoint.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var view_error_container__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! view/error-container */ "./src/js/view/error-container.ts");
/* harmony import */ var api_players__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! api/players */ "./src/js/api/players.js");
/* harmony import */ var view_controls_info_overlay__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! view/controls/info-overlay */ "./src/js/view/controls/info-overlay.js");
/* harmony import */ var view_controls_shortcuts_tooltip__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! view/controls/shortcuts-tooltip */ "./src/js/view/controls/shortcuts-tooltip.ts");
/* harmony import */ var view_floating_floating_close_button__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! view/floating/floating-close-button */ "./src/js/view/floating/floating-close-button.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





















__webpack_require__(/*! css/controls.less */ "./src/css/controls.less"); // Allows preventScrolling focus option on IE/Safari.


__webpack_require__(/*! focus-options-polyfill */ "./node_modules/focus-options-polyfill/index.js");

var ACTIVE_TIMEOUT = environment_environment__WEBPACK_IMPORTED_MODULE_0__["OS"].mobile ? 4000 : 2000; // Keys which bypass keyboard shortcuts being off

var ALWAYS_ALLOWED_KEYS = [27];
view_error_container__WEBPACK_IMPORTED_MODULE_14__["default"].cloneIcon = view_controls_icons__WEBPACK_IMPORTED_MODULE_13__["cloneIcon"];
api_players__WEBPACK_IMPORTED_MODULE_15__["default"].forEach(function (api) {
  if (api.getState() === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_ERROR"]) {
    var errorIconContainer = api.getContainer().querySelector('.jw-error-msg .jw-icon');

    if (errorIconContainer && !errorIconContainer.hasChildNodes()) {
      errorIconContainer.appendChild(view_error_container__WEBPACK_IMPORTED_MODULE_14__["default"].cloneIcon('error'));
    }
  }
});

var reasonInteraction = function reasonInteraction() {
  return {
    reason: 'interaction'
  };
};

var Controls = /*#__PURE__*/function (_Events) {
  _inheritsLoose(Controls, _Events);

  function Controls(context, playerContainer) {
    var _this;

    _this = _Events.call(this) || this; // Alphabetic order
    // Any property on the prototype should be initialized here first

    _this.activeTimeout = -1;
    _this.inactiveTime = 0;
    _this.context = context;
    _this.controlbar = null;
    _this.displayContainer = null;
    _this.backdrop = null;
    _this.enabled = true;
    _this.instreamState = null;
    _this.keydownCallback = null;
    _this.keyupCallback = null;
    _this.blurCallback = null;
    _this.mute = null;
    _this.nextUpToolTip = null;
    _this.playerContainer = playerContainer;
    _this.wrapperElement = playerContainer.querySelector('.jw-wrapper');
    _this.rightClickMenu = null;
    _this.settingsMenu = null;
    _this.shortcutsTooltip = null;
    _this.showing = false;
    _this.muteChangeCallback = null;
    _this.unmuteCallback = null;
    _this.logo = null;
    _this.div = null;
    _this.dimensions = {};
    _this.infoOverlay = null;

    _this.userInactiveTimeout = function () {
      // Rerun at the scheduled time if remaining time is greater than the display refresh rate
      var remainingTime = _this.inactiveTime - Object(utils_date__WEBPACK_IMPORTED_MODULE_5__["now"])();

      if (_this.inactiveTime && remainingTime > 16) {
        _this.activeTimeout = setTimeout(_this.userInactiveTimeout, remainingTime);
        return;
      }

      if (_this.playerContainer.querySelector('.jw-tab-focus')) {
        _this.resetActiveTimeout();

        return;
      }

      _this.userInactive();
    };

    return _this;
  }

  var _proto = Controls.prototype;

  _proto.resetActiveTimeout = function resetActiveTimeout() {
    clearTimeout(this.activeTimeout);
    this.activeTimeout = -1;
    this.inactiveTime = 0;
  };

  _proto.enable = function enable(api, model) {
    var _this2 = this;

    var element = this.context.createElement('div');
    element.className = 'jw-controls jw-reset';
    this.div = element;
    var backdrop = this.context.createElement('div');
    backdrop.className = 'jw-controls-backdrop jw-reset';
    this.backdrop = backdrop;
    this.logo = this.playerContainer.querySelector('.jw-logo');
    var touchMode = model.get('touchMode');

    this.focusPlayerElement = function () {
      if (model.get('isFloating')) {
        _this2.wrapperElement.querySelector('video').focus({
          preventScroll: true
        });
      } else {
        _this2.playerContainer.focus({
          preventScroll: true
        });
      }
    }; // Display Buttons


    if (!this.displayContainer) {
      var displayContainer = new view_controls_display_container__WEBPACK_IMPORTED_MODULE_8__["default"](model, api);
      displayContainer.buttons.display.on('click tap enter', function () {
        _this2.trigger(events_events__WEBPACK_IMPORTED_MODULE_1__["DISPLAY_CLICK"]);

        _this2.userActive(1000);

        api.playToggle(reasonInteraction());

        _this2.focusPlayerElement();
      });
      this.div.appendChild(displayContainer.element());
      this.displayContainer = displayContainer;
    } // Touch UI mode when we're on mobile and we have a percentage height or we can fit the large UI in


    this.infoOverlay = new view_controls_info_overlay__WEBPACK_IMPORTED_MODULE_16__["default"](element, model, api, function (visible) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["toggleClass"])(_this2.div, 'jw-info-open', visible);

      if (visible) {
        //  Focus modal close button on open
        _this2.div.querySelector('.jw-info-close').focus();
      } else {
        _this2.focusPlayerElement();
      }
    }); //  Add keyboard shortcuts if not on mobi;e

    if (!environment_environment__WEBPACK_IMPORTED_MODULE_0__["OS"].mobile) {
      this.shortcutsTooltip = new view_controls_shortcuts_tooltip__WEBPACK_IMPORTED_MODULE_17__["default"](this.wrapperElement, api, model, function (visible) {
        if (!visible) {
          _this2.focusPlayerElement();
        }
      });
    }

    this.rightClickMenu = new view_controls_rightclick__WEBPACK_IMPORTED_MODULE_10__["default"](this.infoOverlay, this.shortcutsTooltip);

    if (touchMode) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["addClass"])(this.playerContainer, 'jw-flag-touch');
    }

    this.rightClickMenu.setup(model, this.playerContainer, this.wrapperElement); // Floating Close Button

    var floatingConfig = model.get('floating');

    if (floatingConfig) {
      var floatCloseButton = new view_floating_floating_close_button__WEBPACK_IMPORTED_MODULE_18__["default"](element, model.get('localization').close);
      var doNotForward = true;
      floatCloseButton.on(events_events__WEBPACK_IMPORTED_MODULE_1__["USER_ACTION"], function () {
        return _this2.trigger('dismissFloating', {
          doNotForward: doNotForward
        });
      });

      if (floatingConfig.dismissible !== false) {
        Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["addClass"])(this.playerContainer, 'jw-floating-dismissible');
      }
    } // Controlbar


    var controlbar = this.controlbar = new view_controls_controlbar__WEBPACK_IMPORTED_MODULE_7__["default"](api, model, this.playerContainer.querySelector('.jw-hidden-accessibility'));
    controlbar.on(events_events__WEBPACK_IMPORTED_MODULE_1__["USER_ACTION"], function () {
      _this2.off('userInactive', _this2.focusPlayerElement, _this2);

      _this2.once('userInactive', _this2.focusPlayerElement, _this2);

      _this2.userActive();
    });
    controlbar.on('nextShown', function (data) {
      this.trigger('nextShown', data);
    }, this);
    controlbar.on('adjustVolume', adjustVolume, this); // Next Up Tooltip

    if (model.get('nextUpDisplay') && !controlbar.nextUpToolTip) {
      var nextUpToolTip = new view_controls_nextuptooltip__WEBPACK_IMPORTED_MODULE_9__["default"](model, api, this.playerContainer);
      nextUpToolTip.on('all', this.trigger, this);
      nextUpToolTip.setup(this.context);
      controlbar.nextUpToolTip = nextUpToolTip; // NextUp needs to be behind the controlbar to not block other tooltips

      this.div.appendChild(nextUpToolTip.element());
    }

    this.div.appendChild(controlbar.element());
    var localization = model.get('localization');
    var settingsMenu = this.settingsMenu = new view_controls_components_menu_settings_menu_js__WEBPACK_IMPORTED_MODULE_11__["default"](api, model.player, this.controlbar, localization);
    var lastState = null;
    settingsMenu.on('menuVisibility', function (_ref) {
      var visible = _ref.visible,
          evt = _ref.evt;
      var state = model.get('state');
      var settingsInteraction = {
        reason: 'settingsInteraction'
      };
      var settingsButton = _this2.controlbar.elements.settingsButton;
      var isKeyEvent = (evt && evt.sourceEvent || evt || {}).type === 'keydown';
      var activeTimeout = visible || isKeyEvent ? 0 : ACTIVE_TIMEOUT; // Trigger userActive so that a dismissive click outside the player can hide the controlbar

      _this2.userActive(activeTimeout);

      if (Object(view_utils_breakpoint__WEBPACK_IMPORTED_MODULE_12__["getBreakpoint"])(model.get('containerWidth')) < 2) {
        if (visible && state === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PLAYING"]) {
          // Pause playback on open if we're currently playing
          api.pause(settingsInteraction);
        } else if (!visible && state === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PAUSED"] && lastState === events_events__WEBPACK_IMPORTED_MODULE_1__["STATE_PLAYING"]) {
          // Resume playback on close if we are paused and were playing before
          api.play(settingsInteraction);
        }
      }

      lastState = state;

      if (!visible && isKeyEvent && settingsButton) {
        settingsButton.element().focus();
      } else if (evt) {
        _this2.focusPlayerElement();
      }
    });
    settingsMenu.on('captionStylesOpened', function () {
      return _this2.trigger('captionStylesOpened');
    });
    controlbar.on('settingsInteraction', function (submenuName, isDefault, event) {
      if (isDefault) {
        return settingsMenu.defaultChild.toggle(event, true);
      }

      settingsMenu.children[submenuName].toggle(event);
    });

    if (environment_environment__WEBPACK_IMPORTED_MODULE_0__["OS"].mobile) {
      this.div.appendChild(settingsMenu.el);
    } else {
      this.playerContainer.setAttribute('aria-describedby', 'jw-shortcuts-tooltip-explanation');
      this.div.insertBefore(settingsMenu.el, controlbar.element());
    } // Unmute Autoplay behavior.


    var setupUnmuteAutoplay = function setupUnmuteAutoplay(_model) {
      if (_model.get('autostartMuted')) {
        var unmuteCallback = function unmuteCallback() {
          return _this2.unmuteAutoplay(api, _model);
        };

        var muteChangeCallback = function muteChangeCallback(muteModel, val) {
          if (!val) {
            unmuteCallback();
          }
        }; // Show unmute botton only on mobile.


        if (environment_environment__WEBPACK_IMPORTED_MODULE_0__["OS"].mobile) {
          _this2.mute = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_6__["default"])('jw-autostart-mute jw-off', unmuteCallback, _model.get('localization').unmute, [Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_13__["cloneIcon"])('volume-0')]);

          _this2.mute.show();

          _this2.div.appendChild(_this2.mute.element());
        } // Set mute state in the controlbar


        controlbar.renderVolume(true, _model.get('volume')); // Hide the controlbar until the autostart flag is removed

        Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["addClass"])(_this2.playerContainer, 'jw-flag-autostart');

        _model.on('change:autostartFailed', unmuteCallback, _this2);

        _model.on('change:autostartMuted change:mute', muteChangeCallback, _this2);

        _this2.muteChangeCallback = muteChangeCallback;
        _this2.unmuteCallback = unmuteCallback;
      }
    };

    model.once('change:autostartMuted', setupUnmuteAutoplay);
    setupUnmuteAutoplay(model); // Keyboard Commands

    function adjustSeek(amount) {
      var min = 0;
      var max = model.get('duration');
      var position = model.get('position');

      if (model.get('streamType') === 'DVR') {
        var dvrSeekLimit = model.get('dvrSeekLimit');
        min = max;
        max = Math.max(position, -dvrSeekLimit);
      }

      var newSeek = Object(utils_math__WEBPACK_IMPORTED_MODULE_3__["between"])(position + amount, min, max);
      api.seek(newSeek, reasonInteraction());
    }

    function adjustVolume(amount) {
      var newVol = Object(utils_math__WEBPACK_IMPORTED_MODULE_3__["between"])(model.get('volume') + amount, 0, 100);
      api.setVolume(newVol);
    }

    var handleKeydown = function handleKeydown(evt) {
      // If Meta keys return
      if (evt.ctrlKey || evt.metaKey) {
        // Let event bubble upwards
        return true;
      }

      var menuHidden = !_this2.settingsMenu || !_this2.settingsMenu.visible;
      var shortcutsEnabled = model.get('enableShortcuts') === true;
      var adMode = _this2.instreamState;

      if (!shortcutsEnabled && ALWAYS_ALLOWED_KEYS.indexOf(evt.keyCode) === -1) {
        return;
      }

      switch (evt.keyCode) {
        case 27:
          // Esc
          if (model.get('fullscreen')) {
            api.setFullscreen(false);

            _this2.playerContainer.blur();

            _this2.userInactive();
          } else {
            var related = api.getPlugin('related');

            if (related) {
              related.close({
                type: 'escape'
              });
            }
          } //  Close all modals on esc press.


          if (_this2.rightClickMenu.el) {
            _this2.rightClickMenu.hideMenuHandler();
          }

          if (_this2.infoOverlay.visible) {
            _this2.infoOverlay.close();
          }

          if (_this2.shortcutsTooltip) {
            _this2.shortcutsTooltip.close();
          }

          break;

        case 13: // enter

        case 32:
          // space
          if (document.activeElement.classList.contains('jw-switch') && evt.keyCode === 13) {
            // Let event bubble up so the spacebar can control the toggle if focused on
            return true;
          }

          api.playToggle(reasonInteraction());
          break;

        case 37:
          // left-arrow, if shortcuts are enabled, not adMode, and settings menu is hidden
          if (!adMode && menuHidden) {
            adjustSeek(-5);
          }

          break;

        case 39:
          // right-arrow, if shortcuts are enabled, not adMode, and settings menu is hidden
          if (!adMode && menuHidden) {
            adjustSeek(5);
          }

          break;

        case 38:
          // up-arrow, if shortcuts are enabled and settings menu is hidden
          if (menuHidden) {
            adjustVolume(10);
          }

          break;

        case 40:
          // down-arrow, if shortcuts are enabled and settings menu is hidden
          if (menuHidden) {
            adjustVolume(-10);
          }

          break;

        case 67:
          {
            // c-key, if shortcuts are enabled
            var captionsList = api.getCaptionsList();
            var listLength = captionsList.length;

            if (listLength) {
              var nextIndex = (api.getCurrentCaptions() + 1) % listLength;
              api.setCurrentCaptions(nextIndex);
            }

            break;
          }

        case 77:
          // m-key, if shortcuts are enabled
          api.setMute();
          break;

        case 70:
          // f-key, if shortcuts are enabled
          api.setFullscreen();
          break;

        case 191:
          // ? key
          if (_this2.shortcutsTooltip) {
            _this2.shortcutsTooltip.toggleVisibility();
          }

          break;

        default:
          if (evt.keyCode >= 48 && evt.keyCode <= 59) {
            // if 0-9 number key, move to n/10 of the percentage of the video
            var number = evt.keyCode - 48;
            var newSeek = number / 10 * model.get('duration');
            api.seek(newSeek, reasonInteraction());
          }

      }

      if (/13|32|37|38|39|40/.test(evt.keyCode)) {
        // Prevent keypresses from scrolling the screen
        evt.preventDefault();
        return false;
      }
    };

    this.playerContainer.addEventListener('keydown', handleKeydown);
    this.keydownCallback = handleKeydown;

    var handleKeyup = function handleKeyup(evt) {
      switch (evt.keyCode) {
        case 9:
          {
            // tab, keep controls active when navigating inside the player
            var insideContainer = _this2.playerContainer.contains(evt.target);

            var activeTimeout = insideContainer ? 0 : ACTIVE_TIMEOUT;

            _this2.userActive(activeTimeout);

            break;
          }

        case 32:
          // space
          evt.preventDefault();
          break;

        default:
          break;
      }
    };

    this.playerContainer.addEventListener('keyup', handleKeyup);
    this.keyupCallback = handleKeyup; // Hide controls when focus leaves the player

    var blurCallback = function blurCallback(evt) {
      _this2.off('userInactive', _this2.focusPlayerElement, _this2);

      var focusedElement = evt.relatedTarget || document.querySelector(':focus');

      if (!focusedElement) {
        return;
      }

      var insideContainer = _this2.playerContainer.contains(focusedElement);

      if (!insideContainer) {
        _this2.userInactive();
      }
    };

    this.playerContainer.addEventListener('blur', blurCallback, true);
    this.blurCallback = blurCallback; //  Remove new shortcut tooltip description after first read.

    var onRemoveShortcutsDescription = function onRemoveShortcutsDescription() {
      var ariaDescriptionId = _this2.playerContainer.getAttribute('aria-describedby'); //  Remove tooltip description after first focus.


      if (ariaDescriptionId === 'jw-shortcuts-tooltip-explanation') {
        _this2.playerContainer.removeAttribute('aria-describedby');
      }

      _this2.playerContainer.removeEventListener('blur', onRemoveShortcutsDescription, true);
    };

    if (this.shortcutsTooltip) {
      this.playerContainer.addEventListener('blur', onRemoveShortcutsDescription, true);
      this.onRemoveShortcutsDescription = onRemoveShortcutsDescription;
    } // Show controls when enabled


    this.userActive();
    this.addControls();
    this.addBackdrop();
    model.set('controlsEnabled', true);
  };

  _proto.addControls = function addControls() {
    // Put the controls element inside the wrapper
    this.wrapperElement.appendChild(this.div);
  };

  _proto.disable = function disable(model) {
    var nextUpToolTip = this.nextUpToolTip,
        settingsMenu = this.settingsMenu,
        infoOverlay = this.infoOverlay,
        controlbar = this.controlbar,
        rightClickMenu = this.rightClickMenu,
        shortcutsTooltip = this.shortcutsTooltip,
        playerContainer = this.playerContainer,
        div = this.div;
    clearTimeout(this.activeTimeout);
    this.activeTimeout = -1;
    this.off();
    model.off(null, null, this);
    model.set('controlsEnabled', false);

    if (div.parentNode) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["removeClass"])(playerContainer, 'jw-flag-touch');
      div.parentNode.removeChild(div);
    }

    if (controlbar) {
      controlbar.destroy();
    }

    if (rightClickMenu) {
      rightClickMenu.destroy();
    }

    if (this.keydownCallback) {
      playerContainer.removeEventListener('keydown', this.keydownCallback);
    }

    if (this.keyupCallback) {
      playerContainer.removeEventListener('keyup', this.keyupCallback);
    }

    if (this.blurCallback) {
      playerContainer.removeEventListener('blur', this.blurCallback);
    }

    if (this.onRemoveShortcutsDescription) {
      playerContainer.removeEventListener('blur', this.onRemoveShortcutsDescription);
    }

    if (this.displayContainer) {
      this.displayContainer.destroy();
    }

    if (nextUpToolTip) {
      nextUpToolTip.destroy();
    }

    if (settingsMenu) {
      settingsMenu.destroy();
    }

    if (infoOverlay) {
      infoOverlay.destroy();
    }

    if (shortcutsTooltip) {
      shortcutsTooltip.destroy();
    }

    this.removeBackdrop();
  };

  _proto.controlbarHeight = function controlbarHeight() {
    if (!this.dimensions.cbHeight) {
      this.dimensions.cbHeight = this.controlbar.element().clientHeight;
    }

    return this.dimensions.cbHeight;
  };

  _proto.element = function element() {
    return this.div;
  };

  _proto.resize = function resize() {
    this.dimensions = {};
  };

  _proto.unmuteAutoplay = function unmuteAutoplay(api, model) {
    var autostartSucceeded = !model.get('autostartFailed');
    var mute = model.get('mute'); // If autostart succeeded, it means the user has chosen to unmute the video,
    // so we should update the model, setting mute to false

    if (autostartSucceeded) {
      mute = false;
    } else {
      // Don't try to play again when viewable since it will keep failing
      model.set('playOnViewable', false);
    }

    if (this.muteChangeCallback) {
      model.off('change:autostartMuted change:mute', this.muteChangeCallback);
      this.muteChangeCallback = null;
    }

    if (this.unmuteCallback) {
      model.off('change:autostartFailed', this.unmuteCallback);
      this.unmuteCallback = null;
    }

    model.set('autostartFailed', undefined);
    model.set('autostartMuted', undefined);
    api.setMute(mute); // the model's mute value may not have changed. ensure the controlbar's mute button is in the right state

    this.controlbar.renderVolume(mute, model.get('volume'));

    if (this.mute) {
      this.mute.hide();
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["removeClass"])(this.playerContainer, 'jw-flag-autostart');
    this.userActive();
  };

  _proto.mouseMove = function mouseMove(event) {
    var insideControlbar = this.controlbar.element().contains(event.target);
    var insideNextUp = this.controlbar.nextUpToolTip && this.controlbar.nextUpToolTip.element().contains(event.target);
    var insideLogo = this.logo && this.logo.contains(event.target);
    var activeTimeout = insideControlbar || insideNextUp || insideLogo ? 0 : ACTIVE_TIMEOUT;
    this.userActive(activeTimeout);
  };

  _proto.userActive = function userActive(timeout) {
    if (timeout === void 0) {
      timeout = ACTIVE_TIMEOUT;
    }

    if (timeout > 0) {
      this.inactiveTime = Object(utils_date__WEBPACK_IMPORTED_MODULE_5__["now"])() + timeout;

      if (this.activeTimeout === -1) {
        this.activeTimeout = setTimeout(this.userInactiveTimeout, timeout);
      }
    } else {
      this.resetActiveTimeout();
    }

    if (!this.showing) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["removeClass"])(this.playerContainer, 'jw-flag-user-inactive');
      this.showing = true;
      this.trigger('userActive');
    }
  };

  _proto.userInactive = function userInactive() {
    clearTimeout(this.activeTimeout);
    this.activeTimeout = -1;

    if (this.settingsMenu.visible) {
      return;
    }

    this.inactiveTime = 0;
    this.showing = false;
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["addClass"])(this.playerContainer, 'jw-flag-user-inactive');
    this.trigger('userInactive');
  };

  _proto.addBackdrop = function addBackdrop() {
    // Put the backdrop element on top of overlays during instream mode
    // otherwise keep it behind captions and on top of preview poster
    var element = this.instreamState ? this.div : this.wrapperElement.querySelector('.jw-captions');
    this.wrapperElement.insertBefore(this.backdrop, element);
  };

  _proto.removeBackdrop = function removeBackdrop() {
    var parent = this.backdrop.parentNode;

    if (parent) {
      parent.removeChild(this.backdrop);
    }
  };

  _proto.setupInstream = function setupInstream() {
    this.instreamState = true; // Call Controls.userActivity to display the UI temporarily for the start of the ad

    this.userActive();
    this.addBackdrop();

    if (this.settingsMenu) {
      this.settingsMenu.close();
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["removeClass"])(this.playerContainer, 'jw-flag-autostart');
    this.controlbar.elements.time.element().setAttribute('tabindex', '-1');
  };

  _proto.destroyInstream = function destroyInstream(model) {
    this.instreamState = null;
    this.addBackdrop();

    if (model.get('autostartMuted')) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_4__["addClass"])(this.playerContainer, 'jw-flag-autostart');
    }

    this.controlbar.elements.time.element().setAttribute('tabindex', '0');
  };

  return Controls;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_2__["default"]);



/***/ }),

/***/ "./src/js/view/controls/display-container.ts":
/*!***************************************************!*\
  !*** ./src/js/view/controls/display-container.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return DisplayContainer; });
/* harmony import */ var view_controls_templates_display_container__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/controls/templates/display-container */ "./src/js/view/controls/templates/display-container.ts");
/* harmony import */ var view_controls_rewind_display_icon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! view/controls/rewind-display-icon */ "./src/js/view/controls/rewind-display-icon.ts");
/* harmony import */ var view_controls_play_display_icon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! view/controls/play-display-icon */ "./src/js/view/controls/play-display-icon.ts");
/* harmony import */ var view_controls_next_display_icon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! view/controls/next-display-icon */ "./src/js/view/controls/next-display-icon.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");







var DisplayContainer = /*#__PURE__*/function () {
  function DisplayContainer(model, api) {
    this.el = Object(utils_dom__WEBPACK_IMPORTED_MODULE_5__["createElement"])(Object(view_controls_templates_display_container__WEBPACK_IMPORTED_MODULE_0__["default"])(model.get('localization')));
    var container = this.el.querySelector('.jw-display-controls');
    var buttons = {};
    addButton('rewind', Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_4__["cloneIcons"])('rewind'), view_controls_rewind_display_icon__WEBPACK_IMPORTED_MODULE_1__["default"], container, buttons, model, api);
    addButton('display', Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_4__["cloneIcons"])('play,pause,buffer,replay'), view_controls_play_display_icon__WEBPACK_IMPORTED_MODULE_2__["default"], container, buttons, model, api);
    addButton('next', Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_4__["cloneIcons"])('next'), view_controls_next_display_icon__WEBPACK_IMPORTED_MODULE_3__["default"], container, buttons, model, api);
    this.container = container;
    this.buttons = buttons;
  }

  var _proto = DisplayContainer.prototype;

  _proto.element = function element() {
    return this.el;
  };

  _proto.destroy = function destroy() {
    var buttons = this.buttons;
    Object.keys(buttons).forEach(function (name) {
      if (buttons[name].ui) {
        buttons[name].ui.destroy();
      }
    });
  };

  return DisplayContainer;
}();



function addButton(name, iconElements, ButtonClass, container, buttons, model, api) {
  var buttonElement = container.querySelector(".jw-display-icon-" + name);
  var iconContainer = container.querySelector(".jw-icon-" + name);
  iconElements.forEach(function (icon) {
    iconContainer.appendChild(icon);
  });
  buttons[name] = new ButtonClass(model, api, buttonElement);
}

/***/ }),

/***/ "./src/js/view/controls/icons.ts":
/*!***************************************!*\
  !*** ./src/js/view/controls/icons.ts ***!
  \***************************************/
/*! exports provided: cloneIcon, cloneIcons */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cloneIcon", function() { return cloneIcon; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cloneIcons", function() { return cloneIcons; });
/* harmony import */ var assets_SVG_buffer_svg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! assets/SVG/buffer.svg */ "./src/assets/SVG/buffer.svg");
/* harmony import */ var assets_SVG_buffer_svg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_buffer_svg__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var assets_SVG_replay_svg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! assets/SVG/replay.svg */ "./src/assets/SVG/replay.svg");
/* harmony import */ var assets_SVG_replay_svg__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_replay_svg__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var assets_SVG_playback_error_svg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! assets/SVG/playback-error.svg */ "./src/assets/SVG/playback-error.svg");
/* harmony import */ var assets_SVG_playback_error_svg__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_playback_error_svg__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var assets_SVG_play_svg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! assets/SVG/play.svg */ "./src/assets/SVG/play.svg");
/* harmony import */ var assets_SVG_play_svg__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_play_svg__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var assets_SVG_pause_svg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! assets/SVG/pause.svg */ "./src/assets/SVG/pause.svg");
/* harmony import */ var assets_SVG_pause_svg__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_pause_svg__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var assets_SVG_rewind_10_svg__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! assets/SVG/rewind-10.svg */ "./src/assets/SVG/rewind-10.svg");
/* harmony import */ var assets_SVG_rewind_10_svg__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_rewind_10_svg__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var assets_SVG_next_svg__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! assets/SVG/next.svg */ "./src/assets/SVG/next.svg");
/* harmony import */ var assets_SVG_next_svg__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_next_svg__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var assets_SVG_stop_svg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! assets/SVG/stop.svg */ "./src/assets/SVG/stop.svg");
/* harmony import */ var assets_SVG_stop_svg__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_stop_svg__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var assets_SVG_volume_0_svg__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! assets/SVG/volume-0.svg */ "./src/assets/SVG/volume-0.svg");
/* harmony import */ var assets_SVG_volume_0_svg__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_volume_0_svg__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var assets_SVG_volume_50_svg__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! assets/SVG/volume-50.svg */ "./src/assets/SVG/volume-50.svg");
/* harmony import */ var assets_SVG_volume_50_svg__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_volume_50_svg__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var assets_SVG_volume_100_svg__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! assets/SVG/volume-100.svg */ "./src/assets/SVG/volume-100.svg");
/* harmony import */ var assets_SVG_volume_100_svg__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_volume_100_svg__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var assets_SVG_captions_on_svg__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! assets/SVG/captions-on.svg */ "./src/assets/SVG/captions-on.svg");
/* harmony import */ var assets_SVG_captions_on_svg__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_captions_on_svg__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var assets_SVG_captions_off_svg__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! assets/SVG/captions-off.svg */ "./src/assets/SVG/captions-off.svg");
/* harmony import */ var assets_SVG_captions_off_svg__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_captions_off_svg__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var assets_SVG_airplay_on_svg__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! assets/SVG/airplay-on.svg */ "./src/assets/SVG/airplay-on.svg");
/* harmony import */ var assets_SVG_airplay_on_svg__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_airplay_on_svg__WEBPACK_IMPORTED_MODULE_13__);
/* harmony import */ var assets_SVG_airplay_off_svg__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! assets/SVG/airplay-off.svg */ "./src/assets/SVG/airplay-off.svg");
/* harmony import */ var assets_SVG_airplay_off_svg__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_airplay_off_svg__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var assets_SVG_arrow_left_svg__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! assets/SVG/arrow-left.svg */ "./src/assets/SVG/arrow-left.svg");
/* harmony import */ var assets_SVG_arrow_left_svg__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_arrow_left_svg__WEBPACK_IMPORTED_MODULE_15__);
/* harmony import */ var assets_SVG_arrow_right_svg__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! assets/SVG/arrow-right.svg */ "./src/assets/SVG/arrow-right.svg");
/* harmony import */ var assets_SVG_arrow_right_svg__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_arrow_right_svg__WEBPACK_IMPORTED_MODULE_16__);
/* harmony import */ var assets_SVG_playback_rate_svg__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! assets/SVG/playback-rate.svg */ "./src/assets/SVG/playback-rate.svg");
/* harmony import */ var assets_SVG_playback_rate_svg__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_playback_rate_svg__WEBPACK_IMPORTED_MODULE_17__);
/* harmony import */ var assets_SVG_settings_svg__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! assets/SVG/settings.svg */ "./src/assets/SVG/settings.svg");
/* harmony import */ var assets_SVG_settings_svg__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_settings_svg__WEBPACK_IMPORTED_MODULE_18__);
/* harmony import */ var assets_SVG_audio_tracks_svg__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! assets/SVG/audio-tracks.svg */ "./src/assets/SVG/audio-tracks.svg");
/* harmony import */ var assets_SVG_audio_tracks_svg__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_audio_tracks_svg__WEBPACK_IMPORTED_MODULE_19__);
/* harmony import */ var assets_SVG_quality_100_svg__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! assets/SVG/quality-100.svg */ "./src/assets/SVG/quality-100.svg");
/* harmony import */ var assets_SVG_quality_100_svg__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_quality_100_svg__WEBPACK_IMPORTED_MODULE_20__);
/* harmony import */ var assets_SVG_fullscreen_not_svg__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! assets/SVG/fullscreen-not.svg */ "./src/assets/SVG/fullscreen-not.svg");
/* harmony import */ var assets_SVG_fullscreen_not_svg__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_fullscreen_not_svg__WEBPACK_IMPORTED_MODULE_21__);
/* harmony import */ var assets_SVG_fullscreen_svg__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! assets/SVG/fullscreen.svg */ "./src/assets/SVG/fullscreen.svg");
/* harmony import */ var assets_SVG_fullscreen_svg__WEBPACK_IMPORTED_MODULE_22___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_fullscreen_svg__WEBPACK_IMPORTED_MODULE_22__);
/* harmony import */ var assets_SVG_close_svg__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! assets/SVG/close.svg */ "./src/assets/SVG/close.svg");
/* harmony import */ var assets_SVG_close_svg__WEBPACK_IMPORTED_MODULE_23___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_close_svg__WEBPACK_IMPORTED_MODULE_23__);
/* harmony import */ var assets_SVG_jw_logo_svg__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! assets/SVG/jw-logo.svg */ "./src/assets/SVG/jw-logo.svg");
/* harmony import */ var assets_SVG_jw_logo_svg__WEBPACK_IMPORTED_MODULE_24___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_jw_logo_svg__WEBPACK_IMPORTED_MODULE_24__);
/* harmony import */ var utils_svgParser__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! utils/svgParser */ "./src/js/utils/svgParser.ts");


























var collection = null;
function cloneIcon(name) {
  var icon = getCollection().querySelector(nameToClass(name));

  if (icon) {
    return clone(icon);
  }

  if (true) {
    throw new Error('Icon not found ' + name);
  }

  return null;
}
function cloneIcons(names) {
  var icons = getCollection().querySelectorAll(names.split(',').map(nameToClass).join(','));

  if ( true && !icons.length) {
    throw new Error('Icons not found ' + names);
  }

  return Array.prototype.map.call(icons, function (icon) {
    return clone(icon);
  });
}

function nameToClass(name) {
  return ".jw-svg-icon-" + name;
}

function clone(icon) {
  return icon.cloneNode(true);
}

function getCollection() {
  if (!collection) {
    collection = parseCollection();
  }

  return collection;
}

function parseCollection() {
  return Object(utils_svgParser__WEBPACK_IMPORTED_MODULE_25__["default"])('<xml>' + assets_SVG_buffer_svg__WEBPACK_IMPORTED_MODULE_0___default.a + assets_SVG_replay_svg__WEBPACK_IMPORTED_MODULE_1___default.a + assets_SVG_playback_error_svg__WEBPACK_IMPORTED_MODULE_2___default.a + assets_SVG_play_svg__WEBPACK_IMPORTED_MODULE_3___default.a + assets_SVG_pause_svg__WEBPACK_IMPORTED_MODULE_4___default.a + assets_SVG_rewind_10_svg__WEBPACK_IMPORTED_MODULE_5___default.a + assets_SVG_next_svg__WEBPACK_IMPORTED_MODULE_6___default.a + assets_SVG_stop_svg__WEBPACK_IMPORTED_MODULE_7___default.a + assets_SVG_volume_0_svg__WEBPACK_IMPORTED_MODULE_8___default.a + assets_SVG_volume_50_svg__WEBPACK_IMPORTED_MODULE_9___default.a + assets_SVG_volume_100_svg__WEBPACK_IMPORTED_MODULE_10___default.a + assets_SVG_captions_on_svg__WEBPACK_IMPORTED_MODULE_11___default.a + assets_SVG_captions_off_svg__WEBPACK_IMPORTED_MODULE_12___default.a + assets_SVG_airplay_on_svg__WEBPACK_IMPORTED_MODULE_13___default.a + assets_SVG_airplay_off_svg__WEBPACK_IMPORTED_MODULE_14___default.a + assets_SVG_arrow_left_svg__WEBPACK_IMPORTED_MODULE_15___default.a + assets_SVG_arrow_right_svg__WEBPACK_IMPORTED_MODULE_16___default.a + assets_SVG_playback_rate_svg__WEBPACK_IMPORTED_MODULE_17___default.a + assets_SVG_settings_svg__WEBPACK_IMPORTED_MODULE_18___default.a + assets_SVG_audio_tracks_svg__WEBPACK_IMPORTED_MODULE_19___default.a + assets_SVG_quality_100_svg__WEBPACK_IMPORTED_MODULE_20___default.a + assets_SVG_fullscreen_not_svg__WEBPACK_IMPORTED_MODULE_21___default.a + assets_SVG_fullscreen_svg__WEBPACK_IMPORTED_MODULE_22___default.a + assets_SVG_close_svg__WEBPACK_IMPORTED_MODULE_23___default.a + assets_SVG_jw_logo_svg__WEBPACK_IMPORTED_MODULE_24___default.a + '</xml>');
}

/***/ }),

/***/ "./src/js/view/controls/info-overlay.js":
/*!**********************************************!*\
  !*** ./src/js/view/controls/info-overlay.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var view_controls_templates_info_overlay__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/controls/templates/info-overlay */ "./src/js/view/controls/templates/info-overlay.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var view_controls_components_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! view/controls/components/button */ "./src/js/view/controls/components/button.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var utils_parser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/parser */ "./src/js/utils/parser.ts");






/* harmony default export */ __webpack_exports__["default"] = (function (container, model, api, onVisibility) {
  var template = Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["createElement"])(Object(view_controls_templates_info_overlay__WEBPACK_IMPORTED_MODULE_0__["default"])());
  var infoOverlayInteraction = 'infoOverlayInteraction';
  var appended = false;
  var lastState = null;
  var visible = false;

  var documentClickHandler = function documentClickHandler(e) {
    if (!/jw-info/.test(e.target.className)) {
      instance.close();
    }
  };

  var append = function append() {
    var closeButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_3__["default"])('jw-info-close', function () {
      instance.close();
    }, model.get('localization').close, [Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_4__["cloneIcon"])('close')]);
    closeButton.show();
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["prependChild"])(template, closeButton.element());
    attachListeners();
    container.appendChild(template);
    appended = true;
  };

  function shouldTrackUser() {
    var analytics = api.getPlugin('jwpsrv');

    if (analytics && typeof analytics.doNotTrackUser === 'function') {
      return !analytics.doNotTrackUser();
    } // Always track user if "doNotTrackUser" isnt available on the ping plugin.


    return true;
  }

  function attachListeners() {
    var titleContainer = template.querySelector('.jw-info-title');
    var durationContainer = template.querySelector('.jw-info-duration');
    var descriptionContainer = template.querySelector('.jw-info-description');
    var clientIdContainer = template.querySelector('.jw-info-clientid');
    model.change('playlistItem', function (changeModel, item) {
      var description = item.description,
          title = item.title;
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["replaceInnerHtml"])(descriptionContainer, description || '');
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["replaceInnerHtml"])(titleContainer, title || 'Unknown Title');
    });
    model.change('duration', function (changeModel, duration) {
      var streamType = model.get('streamType');
      var durationText = '';

      switch (streamType) {
        case 'LIVE':
          durationText = 'Live';
          break;

        case 'DVR':
          durationText = 'DVR';
          break;

        default:
          if (duration) {
            durationText = Object(utils_parser__WEBPACK_IMPORTED_MODULE_5__["timeFormat"])(duration);
          }

      }

      durationContainer.textContent = durationText;
    }, instance);
    clientIdContainer.textContent = shouldTrackUser() ? "Client ID: " + getClientId() : '';
  }

  var instance = {
    open: function open() {
      if (!appended) {
        append();
      } // addClass(template, openClass);


      document.addEventListener('click', documentClickHandler);
      visible = true;
      var state = model.get('state');

      if (state === events_events__WEBPACK_IMPORTED_MODULE_2__["STATE_PLAYING"]) {
        api.pause(infoOverlayInteraction);
      }

      lastState = state;
      onVisibility(true);
    },
    close: function close() {
      // removeClass(template, openClass);
      document.removeEventListener('click', documentClickHandler);
      visible = false;
      var state = model.get('state');

      if (state === events_events__WEBPACK_IMPORTED_MODULE_2__["STATE_PAUSED"] && lastState === events_events__WEBPACK_IMPORTED_MODULE_2__["STATE_PLAYING"]) {
        api.play(infoOverlayInteraction);
      }

      lastState = null;
      onVisibility(false);
    },
    destroy: function destroy() {
      this.close();
      model.off(null, null, this);
    }
  };
  Object.defineProperties(instance, {
    visible: {
      enumerable: true,
      get: function get() {
        return visible;
      }
    }
  });
  return instance;
});

function getClientId() {
  try {
    return window.localStorage.jwplayerLocalId;
  } catch (e) {
    return 'none';
  }
}

/***/ }),

/***/ "./src/js/view/controls/next-display-icon.ts":
/*!***************************************************!*\
  !*** ./src/js/view/controls/next-display-icon.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return NextDisplayIcon; });
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");


var NextDisplayIcon = /*#__PURE__*/function () {
  function NextDisplayIcon(model, api, element) {
    var iconDisplay = element.querySelector('.jw-icon');
    this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_0__["default"](iconDisplay).on('click tap enter', function () {
      api.next({
        reason: 'interaction'
      });
    });
    model.change('nextUp', function (nextUpChangeModel, nextUp) {
      element.style.visibility = nextUp ? '' : 'hidden';
    });
    this.el = element;
  }

  var _proto = NextDisplayIcon.prototype;

  _proto.element = function element() {
    return this.el;
  };

  return NextDisplayIcon;
}();



/***/ }),

/***/ "./src/js/view/controls/nextuptooltip.js":
/*!***********************************************!*\
  !*** ./src/js/view/controls/nextuptooltip.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return NextUpTooltip; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var view_controls_templates_nextup__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! view/controls/templates/nextup */ "./src/js/view/controls/templates/nextup.ts");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var utils_strings__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! utils/strings */ "./src/js/utils/strings.ts");
/* harmony import */ var utils_random_id_generator__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! utils/random-id-generator */ "./src/js/utils/random-id-generator.ts");
/* harmony import */ var utils_parser__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! utils/parser */ "./src/js/utils/parser.ts");











var NextUpTooltip = /*#__PURE__*/function () {
  function NextUpTooltip(_model, _api, playerElement) {
    Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(this, utils_backbone_events__WEBPACK_IMPORTED_MODULE_5__["default"]);

    this._model = _model;
    this._api = _api;
    this._playerElement = playerElement;
    this.localization = _model.get('localization');
    this.state = 'tooltip';
    this.enabled = false;
    this.shown = false;
    this.feedShownId = '';
    this.closeUi = null;
    this.tooltipUi = null;
    this.reset();
  }

  var _proto = NextUpTooltip.prototype;

  _proto.setup = function setup(context) {
    this.container = context.createElement('div');
    this.container.className = 'jw-nextup-container jw-reset';
    var element = Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["createElement"])(Object(view_controls_templates_nextup__WEBPACK_IMPORTED_MODULE_1__["default"])());
    element.querySelector('.jw-nextup-close').appendChild(Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_6__["cloneIcon"])('close'));
    this.addContent(element);
    this.closeButton = this.content.querySelector('.jw-nextup-close');
    this.closeButton.setAttribute('aria-label', this.localization.close);
    this.tooltip = this.content.querySelector('.jw-nextup-tooltip');
    var viewModel = this._model;
    var playerViewModel = viewModel.player; // Next Up is hidden until we get a valid NextUp item from the nextUp event

    this.enabled = false; // Events

    viewModel.on('change:nextUp', this.onNextUp, this); // Listen for duration changes to determine the offset from the end for when next up should be shown

    playerViewModel.change('duration', this.onDuration, this); // Listen for position changes so we can show the tooltip when the offset has been crossed

    playerViewModel.change('position', this.onElapsed, this);
    playerViewModel.change('streamType', this.onStreamType, this);
    playerViewModel.change('state', function (stateChangeModel, state) {
      if (state === 'complete') {
        this.toggle(false);
      }
    }, this); // Close button

    this.closeUi = new utils_ui__WEBPACK_IMPORTED_MODULE_4__["default"](this.closeButton, {
      directSelect: true
    }).on('click tap enter', function () {
      this.nextUpSticky = false;
      this.toggle(false);
    }, this); // Tooltip

    this.tooltipUi = new utils_ui__WEBPACK_IMPORTED_MODULE_4__["default"](this.tooltip).on('click tap', this.click, this);
  };

  _proto.loadThumbnail = function loadThumbnail(url) {
    this.nextUpImage = new Image();

    this.nextUpImage.onload = function () {
      this.nextUpImage.onload = null;
    }.bind(this);

    this.nextUpImage.src = url;
    return {
      backgroundImage: 'url("' + url + '")'
    };
  };

  _proto.click = function click() {
    var fsiBeforeClose = this.feedShownId;
    this.reset();

    this._api.next({
      feedShownId: fsiBeforeClose,
      reason: 'interaction'
    });
  };

  _proto.toggle = function toggle(show, reason) {
    if (!this.enabled) {
      return;
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["toggleClass"])(this.container, 'jw-nextup-sticky', !!this.nextUpSticky);

    if (this.shown !== show) {
      this.shown = show;
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["toggleClass"])(this.container, 'jw-nextup-container-visible', show);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["toggleClass"])(this._playerElement, 'jw-flag-nextup', show);

      var nextUp = this._model.get('nextUp');

      if (show && nextUp) {
        this.feedShownId = Object(utils_random_id_generator__WEBPACK_IMPORTED_MODULE_8__["genId"])(utils_random_id_generator__WEBPACK_IMPORTED_MODULE_8__["FEED_SHOWN_ID_LENGTH"]);
        this.trigger('nextShown', {
          mode: nextUp.mode,
          ui: 'nextup',
          itemsShown: [nextUp],
          feedData: nextUp.feedData,
          reason: reason,
          feedShownId: this.feedShownId
        });
      } else {
        this.feedShownId = '';
      }
    }
  };

  _proto.setNextUpItem = function setNextUpItem(nextUpItem) {
    var _this = this;

    // Give the previous item time to complete its animation
    setTimeout(function () {
      // Set thumbnail
      _this.thumbnail = _this.content.querySelector('.jw-nextup-thumbnail');
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["toggleClass"])(_this.content, 'jw-nextup-thumbnail-visible', !!nextUpItem.image);

      if (nextUpItem.image) {
        var thumbnailStyle = _this.loadThumbnail(nextUpItem.image);

        Object(utils_css__WEBPACK_IMPORTED_MODULE_2__["style"])(_this.thumbnail, thumbnailStyle);
      } // Set header


      _this.header = _this.content.querySelector('.jw-nextup-header');
      _this.header.textContent = Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["createElement"])(_this.localization.nextUp).textContent; // Set title

      _this.title = _this.content.querySelector('.jw-nextup-title');
      var title = nextUpItem.title; // createElement is used to leverage 'textContent', to protect against developers passing a title with html styling.

      _this.title.textContent = title ? Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["createElement"])(title).textContent : ''; // Set duration

      var duration = nextUpItem.duration;

      if (duration) {
        _this.duration = _this.content.querySelector('.jw-nextup-duration');
        _this.duration.textContent = typeof duration === 'number' ? Object(utils_parser__WEBPACK_IMPORTED_MODULE_9__["timeFormat"])(duration) : duration;
      }
    }, 500);
  };

  _proto.onNextUp = function onNextUp(model, nextUp) {
    this.reset();

    if (!nextUp) {
      nextUp = {
        showNextUp: false
      };
    }

    this.enabled = !!(nextUp.title || nextUp.image);

    if (this.enabled) {
      if (!nextUp.showNextUp) {
        // The related plugin will countdown the nextUp item
        this.nextUpSticky = false;
        this.toggle(false);
      }

      this.setNextUpItem(nextUp);
    }
  };

  _proto.onDuration = function onDuration(model, duration) {
    if (!duration) {
      return;
    }

    var configOffset = model.get('nextupoffset');
    var offset = -10;

    if (configOffset) {
      offset = Object(utils_strings__WEBPACK_IMPORTED_MODULE_7__["offsetToSeconds"])(configOffset, duration);
    }

    if (offset < 0) {
      // Determine offset from the end. Duration may change.
      offset += duration;
    } // If config offset is percentage, make sure it's at least 5 seconds from end of video.


    if (Object(utils_strings__WEBPACK_IMPORTED_MODULE_7__["isPercentage"])(configOffset) && duration - 5 < offset) {
      offset = duration - 5;
    }

    this.offset = offset;
  };

  _proto.onElapsed = function onElapsed(model, val) {
    var nextUpSticky = this.nextUpSticky;

    if (!this.enabled || nextUpSticky === false) {
      return;
    } // Show nextup during VOD streams if:
    // - in playlist mode but not playing an ad
    // - autoplaying in related mode and autoplaytimer is set to 0


    var showUntilEnd = val >= this.offset;

    if (showUntilEnd && nextUpSticky === undefined) {
      // show if nextUpSticky is unset
      this.nextUpSticky = showUntilEnd;
      this.toggle(showUntilEnd, 'time');
    } else if (!showUntilEnd && nextUpSticky) {
      // reset if there was a backward seek
      this.reset();
    }
  };

  _proto.onStreamType = function onStreamType(model, streamType) {
    if (streamType !== 'VOD') {
      this.nextUpSticky = false;
      this.toggle(false);
    }
  };

  _proto.element = function element() {
    return this.container;
  };

  _proto.addContent = function addContent(elem) {
    if (this.content) {
      this.removeContent();
    }

    this.content = elem;
    this.container.appendChild(elem);
  };

  _proto.removeContent = function removeContent() {
    if (this.content) {
      this.container.removeChild(this.content);
      this.content = null;
    }
  };

  _proto.reset = function reset() {
    this.nextUpSticky = undefined;
    this.toggle(false);
  };

  _proto.destroy = function destroy() {
    this.off();

    this._model.off(null, null, this);

    if (this.closeUi) {
      this.closeUi.destroy();
    }

    if (this.tooltipUi) {
      this.tooltipUi.destroy();
    }
  };

  return NextUpTooltip;
}();



/***/ }),

/***/ "./src/js/view/controls/play-display-icon.ts":
/*!***************************************************!*\
  !*** ./src/js/view/controls/play-display-icon.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return PlayDisplayIcon; });
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





var PlayDisplayIcon = /*#__PURE__*/function (_Events) {
  _inheritsLoose(PlayDisplayIcon, _Events);

  function PlayDisplayIcon(_model, api, element) {
    var _this;

    _this = _Events.call(this) || this;

    var localization = _model.get('localization');

    var iconDisplay = element.querySelector('.jw-icon');
    _this.icon = iconDisplay;
    _this.el = element;
    _this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_1__["default"](iconDisplay).on('click tap enter', function (evt) {
      _this.trigger(evt.type);
    });

    _model.on('change:state', function (model, newState) {
      var newStateLabel;

      switch (newState) {
        case 'buffering':
          newStateLabel = localization.buffer;
          break;

        case 'playing':
          newStateLabel = localization.pause;
          break;

        case 'idle':
        case 'paused':
          newStateLabel = localization.playback;
          break;

        case 'complete':
          newStateLabel = localization.replay;
          break;

        default:
          newStateLabel = '';
          break;
      }

      if (newStateLabel !== '') {
        iconDisplay.setAttribute('aria-label', newStateLabel);
      } else {
        iconDisplay.removeAttribute('aria-label');
      }
    });

    if (_model.get('displayPlaybackLabel')) {
      var iconText = _this.icon.getElementsByClassName('jw-idle-icon-text')[0];

      if (!iconText) {
        iconText = Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["createElement"])("<div class=\"jw-idle-icon-text\">" + localization.playback + "</div>");
        Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["addClass"])(_this.icon, 'jw-idle-label');

        _this.icon.appendChild(iconText);
      }
    }

    return _this;
  }

  var _proto = PlayDisplayIcon.prototype;

  _proto.element = function element() {
    return this.el;
  };

  return PlayDisplayIcon;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/js/view/controls/rewind-display-icon.ts":
/*!*****************************************************!*\
  !*** ./src/js/view/controls/rewind-display-icon.ts ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return RewindDisplayIcon; });
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");


var RewindDisplayIcon = /*#__PURE__*/function () {
  function RewindDisplayIcon(model, api, element) {
    var iconDisplay = element.querySelector('.jw-icon');
    this.el = element;
    this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_0__["default"](iconDisplay).on('click tap enter', function () {
      var currentPosition = model.get('position');
      var duration = model.get('duration');
      var rewindPosition = currentPosition - 10;
      var startPosition = 0; // duration is negative in DVR mode

      if (model.get('streamType') === 'DVR') {
        startPosition = duration;
      } // Seek 10s back. Seek value should be >= 0 in VOD mode and >= (negative) duration in DVR mode


      api.seek(Math.max(rewindPosition, startPosition));
    });
  }

  var _proto = RewindDisplayIcon.prototype;

  _proto.element = function element() {
    return this.el;
  };

  return RewindDisplayIcon;
}();



/***/ }),

/***/ "./src/js/view/controls/rightclick.js":
/*!********************************************!*\
  !*** ./src/js/view/controls/rightclick.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return RightClick; });
/* harmony import */ var view_controls_templates_rightclick__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/controls/templates/rightclick */ "./src/js/view/controls/templates/rightclick.js");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var version__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! version */ "./src/js/version.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_language__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! utils/language */ "./src/js/utils/language.js");







var EDITION_MAP = {
  free: 0,
  pro: 1,
  premium: 2,
  ads: 3,
  invalid: 4,
  enterprise: 6,
  trial: 7,
  platinum: 8,
  starter: 9,
  business: 10,
  developer: 11
};

function createDomElement(html) {
  var element = Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["createElement"])(html);
  var logoContainer = element.querySelector('.jw-rightclick-logo');

  if (logoContainer) {
    logoContainer.appendChild(Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_1__["cloneIcon"])('jwplayer-logo'));
  }

  return element;
}

var RightClick = /*#__PURE__*/function () {
  function RightClick(infoOverlay, shortcutsTooltip) {
    this.infoOverlay = infoOverlay;
    this.shortcutsTooltip = shortcutsTooltip;
  }

  var _proto = RightClick.prototype;

  _proto.buildArray = function buildArray() {
    var semverParts = version__WEBPACK_IMPORTED_MODULE_2__["version"].split('+');
    var majorMinorPatchPre = semverParts[0];
    var model = this.model;
    var edition = model.get('edition');
    var poweredBy = model.get('localization').poweredBy;
    var versionSpan = "<span class=\"jw-reset\">JW Player " + majorMinorPatchPre + "</span>";
    var menu = {
      items: [{
        type: 'info'
      }, {
        title: Object(utils_language__WEBPACK_IMPORTED_MODULE_6__["isRtl"])(poweredBy) ? versionSpan + " " + poweredBy : poweredBy + " " + versionSpan,
        type: 'link',
        featured: true,
        showLogo: true,
        link: "https://jwplayer.com/learn-more?e=" + EDITION_MAP[edition]
      }]
    };
    var menuItems = menu.items;

    if (this.shortcutsTooltip) {
      menuItems.splice(menuItems.length - 1, 0, {
        type: 'keyboardShortcuts'
      });
    }

    return menu;
  };

  _proto.rightClick = function rightClick(evt) {
    this.lazySetup();

    if (this.mouseOverContext) {
      // right click on menu item should execute it
      return false;
    }

    this.hideMenu();
    this.showMenu(evt);
    this.addHideMenuHandlers();
  };

  _proto.getOffset = function getOffset(evt) {
    var playerBounds = Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["bounds"])(this.wrapperElement);
    var x = evt.pageX - playerBounds.left;
    var y = evt.pageY - playerBounds.top; // move menu up on touch devices
    // so it is not be blocked by fingers

    if (this.model.get('touchMode')) {
      y -= 100;
    }

    return {
      x: x,
      y: y
    };
  };

  _proto.showMenu = function showMenu(evt) {
    var _this = this;

    // Offset relative to player element
    var off = this.getOffset(evt);
    this.el.style.left = off.x + 'px';
    this.el.style.top = off.y + 'px';
    this.outCount = 0;
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["addClass"])(this.playerContainer, 'jw-flag-rightclick-open');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["addClass"])(this.el, 'jw-open');
    clearTimeout(this._menuTimeout);
    this._menuTimeout = setTimeout(function () {
      return _this.hideMenu();
    }, 3000);
    return false;
  };

  _proto.hideMenu = function hideMenu(evt) {
    if (evt && this.el && this.el.contains(evt.target)) {
      // Do not hide menu when clicking inside menu
      return;
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["removeClass"])(this.playerContainer, 'jw-flag-rightclick-open');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["removeClass"])(this.el, 'jw-open');
  };

  _proto.lazySetup = function lazySetup() {
    var _this2 = this;

    var html = Object(view_controls_templates_rightclick__WEBPACK_IMPORTED_MODULE_0__["default"])(this.buildArray(), this.model.get('localization'));

    if (this.el) {
      if (this.html !== html) {
        this.html = html;
        var newEl = createDomElement(html);
        Object(utils_dom__WEBPACK_IMPORTED_MODULE_3__["emptyElement"])(this.el);

        for (var i = newEl.childNodes.length; i--;) {
          this.el.appendChild(newEl.firstChild);
        }
      }

      return;
    }

    this.html = html;
    this.el = createDomElement(this.html);
    this.wrapperElement.appendChild(this.el);

    this.hideMenuHandler = function (e) {
      return _this2.hideMenu(e);
    };

    this.overHandler = function () {
      _this2.mouseOverContext = true;
    };

    this.outHandler = function (evt) {
      _this2.mouseOverContext = false;

      if (evt.relatedTarget && !_this2.el.contains(evt.relatedTarget) && ++_this2.outCount > 1) {
        _this2.hideMenu();
      }
    };

    this.infoOverlayHandler = function () {
      // Open the info overlay if clicked, and hide the rightclick menu
      _this2.mouseOverContext = false;

      _this2.hideMenu();

      _this2.infoOverlay.open();
    };

    this.shortcutsTooltipHandler = function () {
      // Open the info overlay if clicked, and hide the rightclick menu
      _this2.mouseOverContext = false;

      _this2.hideMenu();

      _this2.shortcutsTooltip.open();
    };
  };

  _proto.setup = function setup(_model, _playerContainer, _wrapperElement) {
    this.wrapperElement = _wrapperElement;
    this.model = _model;
    this.mouseOverContext = false;
    this.playerContainer = _playerContainer;
    this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_5__["default"](_wrapperElement).on('longPress', this.rightClick, this);
  };

  _proto.addHideMenuHandlers = function addHideMenuHandlers() {
    this.removeHideMenuHandlers();
    this.wrapperElement.addEventListener('touchstart', this.hideMenuHandler);
    document.addEventListener('touchstart', this.hideMenuHandler);

    if (!environment_environment__WEBPACK_IMPORTED_MODULE_4__["OS"].mobile) {
      this.wrapperElement.addEventListener('click', this.hideMenuHandler);
      document.addEventListener('click', this.hideMenuHandler); // Track if the mouse is above the menu or not

      this.el.addEventListener('mouseover', this.overHandler);
      this.el.addEventListener('mouseout', this.outHandler);
    }

    this.el.querySelector('.jw-info-overlay-item').addEventListener('click', this.infoOverlayHandler);

    if (this.shortcutsTooltip) {
      this.el.querySelector('.jw-shortcuts-item').addEventListener('click', this.shortcutsTooltipHandler);
    }
  };

  _proto.removeHideMenuHandlers = function removeHideMenuHandlers() {
    if (this.wrapperElement) {
      this.wrapperElement.removeEventListener('click', this.hideMenuHandler);
      this.wrapperElement.removeEventListener('touchstart', this.hideMenuHandler);
    }

    if (this.el) {
      this.el.querySelector('.jw-info-overlay-item').removeEventListener('click', this.infoOverlayHandler);
      this.el.removeEventListener('mouseover', this.overHandler);
      this.el.removeEventListener('mouseout', this.outHandler);

      if (this.shortcutsTooltip) {
        this.el.querySelector('.jw-shortcuts-item').removeEventListener('click', this.shortcutsTooltipHandler);
      }
    }

    document.removeEventListener('click', this.hideMenuHandler);
    document.removeEventListener('touchstart', this.hideMenuHandler);
  };

  _proto.destroy = function destroy() {
    clearTimeout(this._menuTimeout);
    this.removeHideMenuHandlers();

    if (this.el) {
      this.hideMenu();
      this.hideMenuHandler = null;
      this.el = null;
    }

    if (this.wrapperElement) {
      this.wrapperElement.oncontextmenu = null;
      this.wrapperElement = null;
    }

    if (this.model) {
      this.model = null;
    }

    if (this.ui) {
      this.ui.destroy();
      this.ui = null;
    }
  };

  return RightClick;
}();



/***/ }),

/***/ "./src/js/view/controls/shortcuts-tooltip.ts":
/*!***************************************************!*\
  !*** ./src/js/view/controls/shortcuts-tooltip.ts ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var view_controls_templates_shortcuts_tooltip__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/controls/templates/shortcuts-tooltip */ "./src/js/view/controls/templates/shortcuts-tooltip.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var view_controls_components_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! view/controls/components/button */ "./src/js/view/controls/components/button.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");







function getShortcuts(shortcuts) {
  var playPause = shortcuts.playPause,
      volumeToggle = shortcuts.volumeToggle,
      fullscreenToggle = shortcuts.fullscreenToggle,
      seekPercent = shortcuts.seekPercent,
      increaseVolume = shortcuts.increaseVolume,
      decreaseVolume = shortcuts.decreaseVolume,
      seekForward = shortcuts.seekForward,
      seekBackward = shortcuts.seekBackward,
      spacebar = shortcuts.spacebar,
      captionsToggle = shortcuts.captionsToggle;
  return [{
    key: spacebar,
    description: playPause
  }, {
    key: '↑',
    description: increaseVolume
  }, {
    key: '↓',
    description: decreaseVolume
  }, {
    key: '→',
    description: seekForward
  }, {
    key: '←',
    description: seekBackward
  }, {
    key: 'c',
    description: captionsToggle
  }, {
    key: 'f',
    description: fullscreenToggle
  }, {
    key: 'm',
    description: volumeToggle
  }, {
    key: '0-9',
    description: seekPercent
  }];
}

/* harmony default export */ __webpack_exports__["default"] = (function (container, api, model, onVisibility) {
  var isOpen = false;
  var lastState = null;
  var shortcuts = model.get('localization').shortcuts;
  var template = Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["createElement"])(Object(view_controls_templates_shortcuts_tooltip__WEBPACK_IMPORTED_MODULE_0__["default"])(getShortcuts(shortcuts), shortcuts.keyboardShortcuts));
  var settingsInteraction = {
    reason: 'settingsInteraction'
  };
  var shortcutToggleUi = new utils_ui__WEBPACK_IMPORTED_MODULE_2__["default"](template.querySelector('.jw-switch'));

  var open = function open() {
    shortcutToggleUi.el.setAttribute('aria-checked', model.get('enableShortcuts'));
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["addClass"])(template, 'jw-open');
    lastState = model.get('state');
    template.querySelector('.jw-shortcuts-close').focus();
    document.addEventListener('click', documentClickHandler);
    isOpen = true;
    api.pause(settingsInteraction);
    onVisibility(true);
  };

  var close = function close() {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["removeClass"])(template, 'jw-open');
    document.removeEventListener('click', documentClickHandler);
    isOpen = false;

    if (lastState === events_events__WEBPACK_IMPORTED_MODULE_5__["STATE_PLAYING"]) {
      api.play(settingsInteraction);
    }

    onVisibility(false);
  };

  var destroy = function destroy() {
    close();
    shortcutToggleUi.destroy();
  };

  var documentClickHandler = function documentClickHandler(e) {
    var target = e.target;

    if (!/jw-shortcuts|jw-switch/.test(target.className)) {
      close();
    }
  };

  var toggleClickHandler = function toggleClickHandler(e) {
    var toggle = e.currentTarget;
    var isChecked = toggle.getAttribute('aria-checked') !== 'true';
    toggle.setAttribute('aria-checked', isChecked.toString());
    model.set('enableShortcuts', isChecked);
  };

  var toggleVisibility = function toggleVisibility() {
    if (isOpen) {
      close();
    } else {
      open();
    }
  };

  var render = function render() {
    var closeButton = Object(view_controls_components_button__WEBPACK_IMPORTED_MODULE_3__["default"])('jw-shortcuts-close', close, model.get('localization').close, [Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_4__["cloneIcon"])('close')]); //  Append close button to modal.

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["prependChild"])(template, closeButton.element());
    closeButton.show(); //  Append modal to container

    container.appendChild(template);
    shortcutToggleUi.on('click tap enter', toggleClickHandler);
  };

  render();
  return {
    el: template,
    open: open,
    close: close,
    destroy: destroy,
    toggleVisibility: toggleVisibility
  };
});

/***/ }),

/***/ "./src/js/view/controls/templates/display-container.ts":
/*!*************************************************************!*\
  !*** ./src/js/view/controls/templates/display-container.ts ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var view_controls_templates_display_icon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/controls/templates/display-icon */ "./src/js/view/controls/templates/display-icon.ts");

/* harmony default export */ __webpack_exports__["default"] = (function (localization) {
  return "<div class=\"jw-display jw-reset\">" + "<div class=\"jw-display-container jw-reset\">" + "<div class=\"jw-display-controls jw-reset\">" + Object(view_controls_templates_display_icon__WEBPACK_IMPORTED_MODULE_0__["default"])('rewind', localization.rewind) + Object(view_controls_templates_display_icon__WEBPACK_IMPORTED_MODULE_0__["default"])('display', localization.playback) + Object(view_controls_templates_display_icon__WEBPACK_IMPORTED_MODULE_0__["default"])('next', localization.next) + "</div>" + "</div>" + "</div>";
});

/***/ }),

/***/ "./src/js/view/controls/templates/display-icon.ts":
/*!********************************************************!*\
  !*** ./src/js/view/controls/templates/display-icon.ts ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (iconName, ariaLabel) {
  if (iconName === void 0) {
    iconName = '';
  }

  if (ariaLabel === void 0) {
    ariaLabel = '';
  }

  return "<div class=\"jw-display-icon-container jw-display-icon-" + iconName + " jw-reset\">" + ("<div class=\"jw-icon jw-icon-" + iconName + " jw-button-color jw-reset\" role=\"button\" tabindex=\"0\" aria-label=\"" + ariaLabel + "\"></div>") + "</div>";
});

/***/ }),

/***/ "./src/js/view/controls/templates/info-overlay.ts":
/*!********************************************************!*\
  !*** ./src/js/view/controls/templates/info-overlay.ts ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function () {
  return "<div class=\"jw-reset jw-info-overlay jw-modal\">" + "<div class=\"jw-reset jw-info-container\">" + "<div class=\"jw-reset-text jw-info-title\" dir=\"auto\"></div>" + "<div class=\"jw-reset-text jw-info-duration\" dir=\"auto\"></div>" + "<div class=\"jw-reset-text jw-info-description\" dir=\"auto\"></div>" + "</div>" + "<div class=\"jw-reset jw-info-clientid\"></div>" + "</div>";
});

/***/ }),

/***/ "./src/js/view/controls/templates/menu/menu-item.ts":
/*!**********************************************************!*\
  !*** ./src/js/view/controls/templates/menu/menu-item.ts ***!
  \**********************************************************/
/*! exports provided: itemTemplate, itemMenuTemplate, itemRadioButtonTemplate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "itemTemplate", function() { return itemTemplate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "itemMenuTemplate", function() { return itemMenuTemplate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "itemRadioButtonTemplate", function() { return itemRadioButtonTemplate; });
/* harmony import */ var assets_SVG_arrow_right_svg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! assets/SVG/arrow-right.svg */ "./src/assets/SVG/arrow-right.svg");
/* harmony import */ var assets_SVG_arrow_right_svg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(assets_SVG_arrow_right_svg__WEBPACK_IMPORTED_MODULE_0__);

var itemTemplate = function itemTemplate(content) {
  return "<button type=\"button\" class=\"jw-reset-text jw-settings-content-item\" aria-label=\"" + content + "\" dir=\"auto\">" + content + "</button>";
};
var itemMenuTemplate = function itemMenuTemplate(_ref) {
  var label = _ref.label,
      name = _ref.name,
      currentSelection = _ref.currentSelection;
  return "<button type=\"button\" class=\"jw-reset-text jw-settings-content-item\" aria-label=\"" + label + "\" aria-controls=\"jw-settings-submenu-" + name + "\" dir=\"auto\" aria-haspopup=\"true\">" + ("" + label) + "<div class='jw-reset jw-settings-value-wrapper'>" + ("<div class=\"jw-reset-text jw-settings-content-item-value\">" + currentSelection + "</div>") + ("<div class=\"jw-reset-text jw-settings-content-item-arrow\">" + assets_SVG_arrow_right_svg__WEBPACK_IMPORTED_MODULE_0___default.a + "</div>") + "</div>" + "</button>";
};
var itemRadioButtonTemplate = function itemRadioButtonTemplate(content) {
  return "<button type=\"button\" class=\"jw-reset-text jw-settings-content-item\" aria-label=\"" + content + "\" role=\"menuitemradio\" aria-checked=\"false\" dir=\"auto\">" + ("" + content) + "</button>";
};

/***/ }),

/***/ "./src/js/view/controls/templates/menu/menu.ts":
/*!*****************************************************!*\
  !*** ./src/js/view/controls/templates/menu/menu.ts ***!
  \*****************************************************/
/*! exports provided: MenuTemplate, TizenMenuTemplate, TizenSubmenuTemplate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MenuTemplate", function() { return MenuTemplate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TizenMenuTemplate", function() { return TizenMenuTemplate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TizenSubmenuTemplate", function() { return TizenSubmenuTemplate; });
var MenuTemplate = function MenuTemplate(isSubmenu, name) {
  return isSubmenu ? "<div id=\"jw-settings-submenu-" + name + "\" class=\"jw-reset jw-settings-submenu jw-settings-submenu-" + name + "\" role=\"menu\" aria-expanded=\"false\">" + "<div class=\"jw-reset jw-settings-submenu-items\"></div>" + "</div>" : "<div id=\"jw-settings-menu\" class=\"jw-reset jw-settings-menu\" role=\"menu\" aria-expanded=\"false\">" + "<div class=\"jw-reset jw-settings-topbar\" role=\"menubar\">" + "<div class=\"jw-reset jw-settings-topbar-text\" tabindex=\"0\"></div>" + "<div class=\"jw-reset jw-settings-topbar-buttons\"></div>" + "</div>" + "</div>";
};
var TizenMenuTemplate = function TizenMenuTemplate(isSubmenu, name) {
  return isSubmenu ? "<div id=\"jw-settings-submenu-" + name + "\" class=\"jw-reset jw-settings-submenu jw-settings-submenu-" + name + "\" role=\"menu\" aria-expanded=\"false\">" + "<div class=\"jw-reset jw-settings-submenu-items\"></div>" + "</div>" : "<div id=\"jw-settings-menu-tizen\" class=\"jw-reset jw-settings-menu-tizen\" role=\"menu\" aria-expanded=\"false\"></div>";
};
var TizenSubmenuTemplate = function TizenSubmenuTemplate(isSubmenu, name, title) {
  return "<div id=\"jw-settings-submenu-" + name + "\" class=\"jw-reset jw-settings-submenu-tizen jw-settings-submenu-" + name + "\">" + ("<div class=\"jw-reset jw-reset-text jw-settings-topbar-text\">" + title + "</div>") + "<div class=\"jw-reset jw-settings-submenu-items\"></div>" + "</div>";
};

/***/ }),

/***/ "./src/js/view/controls/templates/nextup.ts":
/*!**************************************************!*\
  !*** ./src/js/view/controls/templates/nextup.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (header, title, duration, closeAriaLabel) {
  if (header === void 0) {
    header = '';
  }

  if (title === void 0) {
    title = '';
  }

  if (duration === void 0) {
    duration = '';
  }

  if (closeAriaLabel === void 0) {
    closeAriaLabel = '';
  }

  return "<div class=\"jw-nextup jw-background-color jw-reset\">" + "<div class=\"jw-nextup-tooltip jw-reset\">" + "<div class=\"jw-nextup-thumbnail jw-reset\"></div>" + "<div class=\"jw-nextup-body jw-reset\">" + ("<div class=\"jw-nextup-header jw-reset\">" + header + "</div>") + ("<div class=\"jw-nextup-title jw-reset-text\" dir=\"auto\">" + title + "</div>") + ("<div class=\"jw-nextup-duration jw-reset\">" + duration + "</div>") + "</div>" + "</div>" + ("<button type=\"button\" class=\"jw-icon jw-nextup-close jw-reset\" aria-label=\"" + closeAriaLabel + "\"></button>") + "</div>";
});

/***/ }),

/***/ "./src/js/view/controls/templates/rightclick.js":
/*!******************************************************!*\
  !*** ./src/js/view/controls/templates/rightclick.js ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (menu, localization) {
  var _menu$items = menu.items,
      items = _menu$items === void 0 ? [] : _menu$items;
  var menuItems = items.map(function (item) {
    return rightClickItem(item, localization);
  });
  return "<div class=\"jw-rightclick jw-reset\">" + ("<ul class=\"jw-rightclick-list jw-reset\">" + menuItems.join('') + "</ul>") + "</div>";
});

var rightClickItem = function rightClickItem(item, localization) {
  var featured = item.featured,
      showLogo = item.showLogo,
      type = item.type;
  item.logo = showLogo ? "<span class=\"jw-rightclick-logo jw-reset\"></span>" : '';
  return "<li class=\"jw-reset jw-rightclick-item " + (featured ? 'jw-featured' : '') + "\">" + itemContentTypes[type](item, localization) + "</li>";
};

var itemContentTypes = {
  link: function link(_ref) {
    var _link = _ref.link,
        title = _ref.title,
        logo = _ref.logo;
    return "<a href=\"" + (_link || '') + "\" class=\"jw-rightclick-link jw-reset-text\" target=\"_blank\" rel=\"noreferrer\" dir=\"auto\">" + logo + (title || '') + "</a>";
  },
  info: function info(item, localization) {
    return "<button type=\"button\" class=\"jw-reset-text jw-rightclick-link jw-info-overlay-item\" dir=\"auto\">" + localization.videoInfo + "</button>";
  },
  share: function share(item, localization) {
    return "<button type=\"button\" class=\"jw-reset-text jw-rightclick-link jw-share-item\" dir=\"auto\">" + localization.sharing.heading + "</button>";
  },
  keyboardShortcuts: function keyboardShortcuts(item, localization) {
    return "<button type=\"button\" class=\"jw-reset-text jw-rightclick-link jw-shortcuts-item\" dir=\"auto\">" + localization.shortcuts.keyboardShortcuts + "</button>";
  }
};

/***/ }),

/***/ "./src/js/view/controls/templates/shortcuts-tooltip.ts":
/*!*************************************************************!*\
  !*** ./src/js/view/controls/templates/shortcuts-tooltip.ts ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (shortcuts, title) {
  //  Iterate all shortcuts to create list of them.
  var list = shortcuts.map(function (shortcut) {
    return "<div class=\"jw-shortcuts-row jw-reset\">" + ("<span class=\"jw-shortcuts-description jw-reset\">" + shortcut.description + "</span>") + ("<span class=\"jw-shortcuts-key jw-reset\">" + shortcut.key + "</span>") + "</div>";
  }).join('');
  return "<div class=\"jw-shortcuts-tooltip jw-modal jw-reset\" title=\"" + title + "\">" + "<span class=\"jw-hidden\" id=\"jw-shortcuts-tooltip-explanation\">" + "Press shift question mark to access a list of keyboard shortcuts" + "</span>" + "<div class=\"jw-reset jw-shortcuts-container\">" + "<div class=\"jw-reset jw-shortcuts-header\">" + ("<span class=\"jw-reset jw-shortcuts-title\">" + title + "</span>") + ("<button role=\"switch\" aria-label=\"" + title + "\" class=\"jw-reset jw-switch\">") + "<span class=\"jw-reset jw-switch-knob\"></span>" + "<span class=\"jw-reset-text jw-switch-enabled\">Enabled</span>" + "<span class=\"jw-reset-text jw-switch-disabled\">Disabled</span>" + "</button>" + "</div>" + "<div class=\"jw-reset jw-shortcuts-tooltip-list\">" + "<div class=\"jw-shortcuts-tooltip-descriptions jw-reset\">" + ("" + list) + "</div>" + "</div>" + "</div>" + "</div>";
});

/***/ }),

/***/ "./src/js/view/controls/templates/slider.ts":
/*!**************************************************!*\
  !*** ./src/js/view/controls/templates/slider.ts ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (className, orientation) {
  if (className === void 0) {
    className = '';
  }

  if (orientation === void 0) {
    orientation = '';
  }

  return "<div class=\"" + className + " " + orientation + " jw-reset\" aria-hidden=\"true\">" + "<div class=\"jw-slider-container jw-reset\">" + "<div class=\"jw-rail jw-reset\"></div>" + "<div class=\"jw-buffer jw-reset\"></div>" + "<div class=\"jw-progress jw-reset\"></div>" + "<div class=\"jw-knob jw-reset\"></div>" + "</div>" + "</div>";
});

/***/ }),

/***/ "./src/js/view/floating/floating-close-button.js":
/*!*******************************************************!*\
  !*** ./src/js/view/floating/floating-close-button.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return FloatingCloseButton; });
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var templates_floating_close_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! templates/floating-close-button */ "./src/js/templates/floating-close-button.ts");
/* harmony import */ var view_controls_icons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! view/controls/icons */ "./src/js/view/controls/icons.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }








var FloatingCloseButton = /*#__PURE__*/function (_Events) {
  _inheritsLoose(FloatingCloseButton, _Events);

  function FloatingCloseButton(container, ariaLabel) {
    var _this;

    _this = _Events.call(this) || this;
    _this.element = Object(utils_dom__WEBPACK_IMPORTED_MODULE_0__["createElement"])(Object(templates_floating_close_button__WEBPACK_IMPORTED_MODULE_2__["default"])(ariaLabel));

    _this.element.appendChild(Object(view_controls_icons__WEBPACK_IMPORTED_MODULE_3__["cloneIcon"])('close'));

    _this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_1__["default"](_this.element, {
      directSelect: true
    }).on('click tap enter', function () {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_5__["USER_ACTION"]);
    });
    container.appendChild(_this.element);
    return _this;
  }

  var _proto = FloatingCloseButton.prototype;

  _proto.destroy = function destroy() {
    if (this.element) {
      this.ui.destroy();
      this.element.parentNode.removeChild(this.element);
      this.element = null;
    }
  };

  return FloatingCloseButton;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_4__["default"]);



/***/ }),

/***/ "./src/js/view/floating/floating-controller.ts":
/*!*****************************************************!*\
  !*** ./src/js/view/floating/floating-controller.ts ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return FloatingController; });
/* harmony import */ var view_floating_floating_drag_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! view/floating/floating-drag-ui */ "./src/js/view/floating/floating-drag-ui.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_browser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/browser */ "./src/js/utils/browser.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var view_utils_views_manager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! view/utils/views-manager */ "./src/js/view/utils/views-manager.js");
/* harmony import */ var view_utils_player_size__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! view/utils/player-size */ "./src/js/view/utils/player-size.ts");










var FLOATING_TOP_OFFSET = 62;
var _floatingPlayer = null;
var fpContainer = {
  floatingPlayer: _floatingPlayer
};
Object.defineProperty(fpContainer, 'floatingPlayer', {
  get: function get() {
    return _floatingPlayer;
  },
  set: function set(val) {
    if (val === _floatingPlayer) {
      return;
    }

    _floatingPlayer = val;
    var watchersToRun = watchers.slice();
    watchers.length = 0;
    watchersToRun.forEach(function (fc) {
      fc.startFloating();
    });
  }
});
var watchers = [];

var addFPWatcher = function addFPWatcher(fc) {
  if (watchers.indexOf(fc) !== -1) {
    return;
  }

  watchers.push(fc);
};

var removeFPWatcher = function removeFPWatcher(fc) {
  var watcherIDX = watchers.indexOf(fc);

  if (watcherIDX !== -1) {
    watchers.splice(watcherIDX, 1);
  }
};

var FloatingController = /*#__PURE__*/function () {
  function FloatingController(model, playerBounds, elements, isMobile) {
    if (isMobile === void 0) {
      isMobile = environment_environment__WEBPACK_IMPORTED_MODULE_1__["OS"].mobile;
    }

    this._playerEl = elements.player;
    this._wrapperEl = elements.wrapper;
    this._preview = elements.preview;
    this._model = model;
    this._floatingUI = new view_floating_floating_drag_ui__WEBPACK_IMPORTED_MODULE_0__["default"](this._wrapperEl);
    this._floatingStoppedForever = false;
    this._lastIntRatio = 0;
    this._playerBounds = playerBounds;
    this._isMobile = isMobile;
    this._mobileCheckCanFire = true;
    this._boundThrottledMobileFloatScrollHandler = this.throttledMobileFloatScrollHandler.bind(this);
    this._boundInitFloatingBehavior = this.initFloatingBehavior.bind(this);
  }

  var _proto = FloatingController.prototype;

  _proto.setup = function setup() {
    this._model.change('floating', this._boundInitFloatingBehavior);
  };

  _proto.initFloatingBehavior = function initFloatingBehavior() {
    // Don't reinitialize this behavior if the user dismissed the floating player
    if (this._floatingStoppedForever) {
      return;
    } // Setup floating scroll handler


    view_utils_views_manager__WEBPACK_IMPORTED_MODULE_7__["default"].removeScrollHandler(this._boundThrottledMobileFloatScrollHandler);
    removeFPWatcher(this);

    if (this.getFloatingConfig()) {
      var fm = this.getFloatMode();

      if (fm === 'notVisible') {
        if (this._isMobile) {
          view_utils_views_manager__WEBPACK_IMPORTED_MODULE_7__["default"].addScrollHandler(this._boundThrottledMobileFloatScrollHandler);

          this._boundThrottledMobileFloatScrollHandler();
        } else {
          this.checkFloatIntersection();
        }
      } else if (fm === 'always') {
        this.startFloating();
      } else if (fm === 'never') {
        this.stopFloating();
      }
    }
  };

  _proto.updatePlayerBounds = function updatePlayerBounds(pb) {
    this._playerBounds = pb;
  };

  _proto.getFloatingConfig = function getFloatingConfig() {
    return this._model.get('floating');
  };

  _proto.getFloatMode = function getFloatMode() {
    var fc = this.getFloatingConfig();
    return fc && fc.mode || 'notVisible';
  };

  _proto.resize = function resize() {
    if (this._model.get('isFloating')) {
      this.updateFloatingSize();
    }
  };

  _proto.fosMobileBehavior = function fosMobileBehavior() {
    return this._isMobile && !Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["deviceIsLandscape"])() && !this._model.get('fullscreen');
  };

  _proto.shouldFloatOnViewable = function shouldFloatOnViewable() {
    var state = this._model.get('state');

    return state !== events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_IDLE"] && state !== events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_ERROR"] && state !== events_events__WEBPACK_IMPORTED_MODULE_4__["STATE_COMPLETE"];
  };

  _proto.startFloating = function startFloating(mobileFloatIntoPlace) {
    var _this = this;

    var playerBounds = this._playerBounds;

    if (this.getFloatingPlayer() === null) {
      this.setFloatingPlayer(this._playerEl);

      this._model.set('isFloating', true);

      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["addClass"])(this._playerEl, 'jw-flag-floating');

      if (mobileFloatIntoPlace) {
        // Creates a dynamic animation where the top of the current player
        // Smoothly transitions into the expected floating space in the event
        // we can't start floating at 62px
        Object(utils_css__WEBPACK_IMPORTED_MODULE_6__["style"])(this._wrapperEl, {
          transform: "translateY(-" + (FLOATING_TOP_OFFSET - playerBounds.top) + "px)"
        });
        setTimeout(function () {
          Object(utils_css__WEBPACK_IMPORTED_MODULE_6__["style"])(_this._wrapperEl, {
            transform: 'translateY(0)',
            transition: 'transform 150ms cubic-bezier(0, 0.25, 0.25, 1)'
          });
        });
      } // Copy background from preview element


      var previewEl = this._preview.el;
      Object(utils_css__WEBPACK_IMPORTED_MODULE_6__["style"])(this._playerEl, {
        backgroundImage: previewEl.style.backgroundImage
      });
      this.updateFloatingSize();

      if (!this._model.get('instreamMode')) {
        this._floatingUI.enable();
      } // Perform resize and trigger "float" event responsively to prevent layout thrashing


      this._model.trigger('forceResponsiveListener', {});
    } else if (this.getFloatingPlayer() !== this._playerEl && this.getFloatMode() === 'always') {
      addFPWatcher(this);
    }
  };

  _proto.stopFloating = function stopFloating(forever, mobileFloatIntoPlace) {
    var _this2 = this;

    if (forever) {
      this._floatingStoppedForever = true;
      view_utils_views_manager__WEBPACK_IMPORTED_MODULE_7__["default"].removeScrollHandler(this._boundThrottledMobileFloatScrollHandler);
    }

    if (this.getFloatingPlayer() !== this._playerEl) {
      return;
    }

    this.setFloatingPlayer(null);

    this._model.set('isFloating', false);

    var playerBounds = this._playerBounds;

    var resetFloatingStyles = function resetFloatingStyles() {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["removeClass"])(_this2._playerEl, 'jw-flag-floating');

      _this2._model.trigger('forceAspectRatioChange', {}); // Wrapper should inherit from parent unless floating.


      Object(utils_css__WEBPACK_IMPORTED_MODULE_6__["style"])(_this2._playerEl, {
        backgroundImage: null
      }); // Reset to avoid flicker.

      Object(utils_css__WEBPACK_IMPORTED_MODULE_6__["style"])(_this2._wrapperEl, {
        maxWidth: null,
        width: null,
        height: null,
        transform: null,
        transition: null,
        'transition-timing-function': null
      });
    };

    if (mobileFloatIntoPlace) {
      // Reverses a dynamic animation where the top of the current player
      // Smoothly transitions into the expected static space in the event
      // we didn't start floating at 62px
      Object(utils_css__WEBPACK_IMPORTED_MODULE_6__["style"])(this._wrapperEl, {
        transform: "translateY(-" + (FLOATING_TOP_OFFSET - playerBounds.top) + "px)",
        'transition-timing-function': 'ease-out'
      });
      setTimeout(resetFloatingStyles, 150);
    } else {
      resetFloatingStyles();
    }

    this.disableFloatingUI(); // Perform resize and trigger "float" event responsively to prevent layout thrashing

    this._model.trigger('forceResponsiveListener', {});
  };

  _proto.updateFloatingSize = function updateFloatingSize() {
    var playerBounds = this._playerBounds; // Always use aspect ratio to determine floating player size
    // This allows us to support fixed pixel width/height or 100%*100% by matching the player container

    var width = this._model.get('width');

    var height = this._model.get('height');

    var styles = Object(view_utils_player_size__WEBPACK_IMPORTED_MODULE_8__["getPlayerSizeStyles"])(this._model, width);
    styles.maxWidth = Math.min(400, playerBounds.width);

    if (!this._model.get('aspectratio')) {
      var containerWidth = playerBounds.width;
      var containerHeight = playerBounds.height;
      var aspectRatio = containerHeight / containerWidth || 0.5625; // (fallback to 16 by 9)

      if (Object(utils_underscore__WEBPACK_IMPORTED_MODULE_5__["isNumber"])(width) && Object(utils_underscore__WEBPACK_IMPORTED_MODULE_5__["isNumber"])(height)) {
        aspectRatio = height / width;
      }

      this._model.trigger('forceAspectRatioChange', {
        ratio: aspectRatio * 100 + '%'
      });
    }

    Object(utils_css__WEBPACK_IMPORTED_MODULE_6__["style"])(this._wrapperEl, styles);
  };

  _proto.enableFloatingUI = function enableFloatingUI() {
    this._floatingUI.enable();
  };

  _proto.disableFloatingUI = function disableFloatingUI() {
    this._floatingUI.disable();
  };

  _proto.setFloatingPlayer = function setFloatingPlayer(container) {
    fpContainer.floatingPlayer = container;
  };

  _proto.getFloatingPlayer = function getFloatingPlayer() {
    return fpContainer.floatingPlayer;
  };

  _proto.destroy = function destroy() {
    if (this.getFloatingPlayer() === this._playerEl) {
      this.setFloatingPlayer(null);
    }

    if (this.getFloatingConfig() && this._isMobile) {
      view_utils_views_manager__WEBPACK_IMPORTED_MODULE_7__["default"].removeScrollHandler(this._boundThrottledMobileFloatScrollHandler);
    }

    removeFPWatcher(this);

    this._model.off('change:floating', this._boundInitFloatingBehavior);
  };

  _proto.updateFloating = function updateFloating(intersectionRatio, mobileFloatIntoPlace) {
    // Player is 50% visible or less and no floating player already in the DOM. Player is not in iframe
    var shouldFloat = intersectionRatio < 0.5 && !Object(utils_browser__WEBPACK_IMPORTED_MODULE_3__["isIframe"])() && this.shouldFloatOnViewable();

    if (shouldFloat) {
      this.startFloating(mobileFloatIntoPlace);
    } else {
      this.stopFloating(false, mobileFloatIntoPlace);
    }
  } // Functions for handler float on scroll (mobile)
  ;

  _proto.checkFloatOnScroll = function checkFloatOnScroll() {
    if (this.getFloatMode() !== 'notVisible') {
      return;
    }

    var floating = this._model.get('isFloating');

    var pb = this._playerBounds;
    var enoughRoomForFloat = pb.top < FLOATING_TOP_OFFSET;
    var scrollPos = window.scrollY || window.pageYOffset;
    var hasCrossedThreshold = enoughRoomForFloat ? pb.top <= scrollPos : pb.top <= scrollPos + FLOATING_TOP_OFFSET;

    if (!floating && hasCrossedThreshold) {
      this.updateFloating(0, enoughRoomForFloat);
    } else if (floating && !hasCrossedThreshold) {
      this.updateFloating(1, enoughRoomForFloat);
    }
  };

  _proto.throttledMobileFloatScrollHandler = function throttledMobileFloatScrollHandler() {
    var _this3 = this;

    if (!this.fosMobileBehavior() || !this._model.get('inDom')) {
      return;
    }

    clearTimeout(this._mobileDebounceTimeout);
    this._mobileDebounceTimeout = setTimeout(this.checkFloatOnScroll.bind(this), 150);

    if (!this._mobileCheckCanFire) {
      return;
    }

    this._mobileCheckCanFire = false;
    this.checkFloatOnScroll();
    setTimeout(function () {
      _this3._mobileCheckCanFire = true;
    }, 50);
  } // End functions for float on scroll (mobile)
  ;

  _proto.checkFloatIntersection = function checkFloatIntersection(ratio) {
    var ratioIsNumber = typeof ratio === 'number';
    var intersectionRatio = ratioIsNumber ? ratio : this._lastIntRatio; // Ensure even if floating mode was not `notVisible` to start, that any change takes
    //  into account any instance of seeing the player

    this._canFloat = this._canFloat || intersectionRatio >= 0.5;

    if (this.getFloatingConfig() && this.getFloatMode() === 'notVisible' && !this.fosMobileBehavior() && !this._floatingStoppedForever) {
      // Only start floating if player has been mostly visible at least once.
      if (this._canFloat) {
        this.updateFloating(intersectionRatio);
      }
    }

    if (ratioIsNumber) {
      this._lastIntRatio = ratio;
    }
  };

  _proto.updateStyles = function updateStyles() {
    if (!this._floatingStoppedForever && this.getFloatingConfig() && this.getFloatMode() === 'notVisible') {
      this._boundThrottledMobileFloatScrollHandler();
    }
  };

  return FloatingController;
}();



/***/ }),

/***/ "./src/js/view/floating/floating-drag-ui.js":
/*!**************************************************!*\
  !*** ./src/js/view/floating/floating-drag-ui.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return FloatingDragUI; });
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");




var FloatingDragUI = /*#__PURE__*/function () {
  function FloatingDragUI(element) {
    this.container = element;
    this.input = element.querySelector('.jw-media');
  }

  var _proto = FloatingDragUI.prototype;

  _proto.disable = function disable() {
    var container = this.container;

    if (container) {
      // 'Dragged' state is reset so the transition animation can fire again if the player re-floats.
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["removeClass"])(container, 'jw-floating-dragged');
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["removeClass"])(container, 'jw-floating-dragging');
      setWillChange(container, 'auto');
    }

    if (this.ui) {
      this.ui.destroy();
      this.ui = null;
    }
  };

  _proto.enable = function enable() {
    var container = this.container,
        input = this.input;
    var startX;
    var startY;
    var deltaX;
    var deltaY;
    var x = 0;
    var y = 0; // A min/max delta is assigned to prevent the player from being dragged off screen.

    var minDeltaX;
    var minDeltaY;
    var maxDeltaX;
    var maxDeltaY;
    this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_0__["default"](input, {
      preventScrolling: true
    }).on('dragStart', function (e) {
      var pageX = e.pageX,
          pageY = e.pageY;
      var _window = window,
          innerWidth = _window.innerWidth,
          innerHeight = _window.innerHeight;
      var offsetLeft = container.offsetLeft,
          offsetTop = container.offsetTop,
          offsetWidth = container.offsetWidth,
          offsetHeight = container.offsetHeight;
      startX = pageX;
      startY = pageY;
      minDeltaX = -offsetLeft;
      minDeltaY = -offsetTop;
      maxDeltaX = calculateMax(innerWidth, offsetLeft, offsetWidth);
      maxDeltaY = calculateMax(innerHeight, offsetTop, offsetHeight); // Class prevents initial animation styles from overriding translate styling.

      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["addClass"])(container, 'jw-floating-dragged');
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["addClass"])(container, 'jw-floating-dragging');
      setWillChange(container, 'transform');
    }).on('drag', function (e) {
      var pageX = e.pageX,
          pageY = e.pageY;
      deltaX = calculateDelta(x, pageX, startX, maxDeltaX, minDeltaX);
      deltaY = calculateDelta(y, pageY, startY, maxDeltaY, minDeltaY);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["transform"])(container, "translate(" + deltaX + "px, " + deltaY + "px)");
    }).on('dragEnd', function () {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_2__["removeClass"])(container, 'jw-floating-dragging');
      setWillChange(container, 'auto');
      x = deltaX;
      y = deltaY;
    });
  };

  return FloatingDragUI;
}();



var calculateMax = function calculateMax(windowLength, offset, length) {
  return windowLength - offset - length;
};

var calculateDelta = function calculateDelta(last, current, first, max, min) {
  return Math.max(Math.min(last + current - first, max), min);
};

var setWillChange = function setWillChange(element, willChange) {
  return Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["style"])(element, {
    willChange: willChange
  });
};

/***/ }),

/***/ "./src/js/view/logo.js":
/*!*****************************!*\
  !*** ./src/js/view/logo.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Logo; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var templates_logo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! templates/logo */ "./src/js/templates/logo.ts");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");








var LogoDefaults = {
  linktarget: '_blank',
  margin: 8,
  hide: false,
  position: 'top-right'
};
function Logo(_model) {
  Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(this, utils_backbone_events__WEBPACK_IMPORTED_MODULE_6__["default"]);

  var _logo;

  var _settings;

  var _img = new Image();

  this.setup = function () {
    _settings = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, LogoDefaults, _model.get('logo'));
    _settings.position = _settings.position || LogoDefaults.position;
    _settings.hide = _settings.hide.toString() === 'true'; // We should only create a logo in the display container when
    // it is not supposed to be in the control bar, as it will
    // handle the creation in that case

    if (!_settings.file || _settings.position === 'control-bar') {
      return;
    }

    if (!_logo) {
      _logo = Object(utils_dom__WEBPACK_IMPORTED_MODULE_5__["createElement"])(Object(templates_logo__WEBPACK_IMPORTED_MODULE_1__["default"])(_settings.position, _settings.hide));
    }

    _model.set('logo', _settings); // apply styles onload when image width and height are known


    _img.onload = function () {
      // update logo style
      var height = this.height;
      var width = this.width;
      var styles = {
        backgroundImage: 'url("' + this.src + '")'
      };

      if (_settings.margin !== LogoDefaults.margin) {
        var positions = /(\w+)-(\w+)/.exec(_settings.position);

        if (positions.length === 3) {
          styles['margin-' + positions[1]] = _settings.margin;
          styles['margin-' + positions[2]] = _settings.margin;
        }
      } // Constraint logo size to 15% of their respective player dimension


      var maxHeight = _model.get('containerHeight') * 0.15;
      var maxWidth = _model.get('containerWidth') * 0.15;

      if (height > maxHeight || width > maxWidth) {
        var logoAR = width / height;
        var videoAR = maxWidth / maxHeight;

        if (videoAR > logoAR) {
          // height = max dimension
          height = maxHeight;
          width = maxHeight * logoAR;
        } else {
          // width = max dimension
          width = maxWidth;
          height = maxWidth / logoAR;
        }
      }

      styles.width = Math.round(width);
      styles.height = Math.round(height);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_4__["style"])(_logo, styles); // update title

      _model.set('logoWidth', styles.width);
    };

    _img.src = _settings.file;

    if (_settings.link) {
      _logo.setAttribute('tabindex', '0');

      _logo.setAttribute('aria-label', _model.get('localization').logo);
    }

    this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_3__["default"](_logo).on('click tap enter', function (evt) {
      if (evt && evt.stopPropagation) {
        evt.stopPropagation();
      }

      this.trigger(events_events__WEBPACK_IMPORTED_MODULE_2__["LOGO_CLICK"], {
        link: _settings.link,
        linktarget: _settings.linktarget
      });
    }, this);
  };

  this.setContainer = function (container) {
    if (_logo) {
      container.appendChild(_logo);
    }
  };

  this.element = function () {
    return _logo;
  };

  this.position = function () {
    return _settings.position;
  };

  this.destroy = function () {
    _img.onload = null;

    if (this.ui) {
      this.ui.destroy();
    }
  };
}

/***/ }),

/***/ "./src/js/view/preview.ts":
/*!********************************!*\
  !*** ./src/js/view/preview.ts ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");


var Preview = /*#__PURE__*/function () {
  function Preview(_model) {
    this.model = _model;
    this.image = null;
  }

  var _proto = Preview.prototype;

  _proto.setup = function setup(el) {
    this.el = el;
    this.hasZoomThumbnail = this.model.get('_abZoomThumbnail');

    if (this.hasZoomThumbnail) {
      this.zoomOriginX = Math.ceil(Math.random() * 100) + '%';
      this.zoomOriginY = Math.ceil(Math.random() * 100) + '%';
      this.model.on('change:viewable', this.pauseZoomThumbnail, this);
      this.model.on('change:isFloating', this.enableZoomThumbnail, this);
    }
  };

  _proto.setImage = function setImage(img) {
    // Remove onload function from previous image
    var image = this.image;

    if (image) {
      image.onload = null;
    }

    this.image = null;
    var backgroundImage = '';

    if (typeof img === 'string') {
      backgroundImage = 'url("' + img + '")';
      image = this.image = new Image();
      image.src = img;
    }

    if (this.hasZoomThumbnail) {
      this.imageEl = document.createElement('div');
      Object(utils_css__WEBPACK_IMPORTED_MODULE_0__["style"])(this.imageEl, {
        backgroundImage: backgroundImage
      });

      if (this.el) {
        this.el.appendChild(this.imageEl);
      }

      this.enableZoomThumbnail();
    } else {
      Object(utils_css__WEBPACK_IMPORTED_MODULE_0__["style"])(this.el, {
        backgroundImage: backgroundImage
      });
    }
  };

  _proto.enableZoomThumbnail = function enableZoomThumbnail() {
    var _this = this;

    if (!this.hasZoomThumbnail || this.model.get('isFloating')) {
      return;
    }

    clearTimeout(this.zoomThumbnailTimeout);
    this.zoomThumbnailTimeout = setTimeout(function () {
      if (_this.imageEl) {
        _this.imageEl.classList.add('jw-ab-zoom-thumbnail');

        _this.imageEl.style.transformOrigin = _this.zoomOriginX + ' ' + _this.zoomOriginY;
      }
    }, 2000);
  };

  _proto.pauseZoomThumbnail = function pauseZoomThumbnail() {
    clearTimeout(this.zoomThumbnailTimeout);

    if (this.imageEl) {
      this.imageEl.style.animationPlayState = this.model.get('viewable') ? 'running' : 'paused';
    }
  };

  _proto.removeZoomThumbnail = function removeZoomThumbnail() {
    clearTimeout(this.zoomThumbnailTimeout);

    if (this.imageEl) {
      this.imageEl.classList.remove('jw-ab-zoom-thumbnail');
    }
  };

  _proto.resize = function resize(width, height, stretching) {
    var _this2 = this;

    if (stretching === 'uniform') {
      if (width) {
        this.playerAspectRatio = width / height;
      }

      if (!this.playerAspectRatio || !this.image || !validState(this.model.get('state'))) {
        return;
      } // snap image to edges when the difference in aspect ratio is less than 9%


      var image = this.image;
      var backgroundSize = null;

      if (image) {
        if (image.width === 0) {
          image.onload = function () {
            _this2.resize(width, height, stretching);
          };

          return;
        }

        var imageAspectRatio = image.width / image.height;

        if (Math.abs(this.playerAspectRatio - imageAspectRatio) < 0.09) {
          backgroundSize = 'cover';
        }
      }

      Object(utils_css__WEBPACK_IMPORTED_MODULE_0__["style"])(this.el, {
        backgroundSize: backgroundSize
      });
    }
  };

  _proto.element = function element() {
    return this.el;
  };

  _proto.destroy = function destroy() {
    if (this.hasZoomThumbnail) {
      this.removeZoomThumbnail();
      this.model.off(null, null, this);
    }
  };

  return Preview;
}();

function validState(state) {
  return state === 'complete' || state === 'idle' || state === 'error' || state === 'buffering';
}

/* harmony default export */ __webpack_exports__["default"] = (Preview);

/***/ }),

/***/ "./src/js/view/title.ts":
/*!******************************!*\
  !*** ./src/js/view/title.ts ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");




var Title = /*#__PURE__*/function () {
  function Title(_model) {
    this.model = _model.player;
    this.truncated = _model.get('__ab_truncated') && !environment_environment__WEBPACK_IMPORTED_MODULE_2__["Browser"].ie;
  } // This is normally shown/hidden by states
  //   these are only used for when no title exists


  var _proto = Title.prototype;

  _proto.hide = function hide() {
    Object(utils_css__WEBPACK_IMPORTED_MODULE_0__["style"])(this.el, {
      display: 'none'
    });
  };

  _proto.show = function show() {
    Object(utils_css__WEBPACK_IMPORTED_MODULE_0__["style"])(this.el, {
      display: ''
    });
  };

  _proto.setup = function setup(titleEl) {
    this.el = titleEl;

    if (!this.el) {
      return;
    } // Perform the DOM search only once


    var arr = this.el.getElementsByTagName('div');
    this.title = arr[0];
    this.description = arr[1];

    if (this.truncated) {
      this.el.classList.add('jw-ab-truncated');
    }

    this.model.on('change:logoWidth', this.update, this);
    this.model.change('playlistItem', this.playlistItem, this);
  };

  _proto.update = function update(model) {
    var titleStyle = {};
    var logo = model.get('logo');

    if (logo) {
      // Only use Numeric or pixel ("Npx") margin values
      var margin = 1 * parseInt(('' + logo.margin).replace('px', ''));
      var padding = model.get('logoWidth') + (isNaN(margin) ? 0 : margin + 10);

      if (logo.position === 'top-left') {
        titleStyle.paddingLeft = padding;
      } else if (logo.position === 'top-right') {
        titleStyle.paddingRight = padding;
      }
    }

    Object(utils_css__WEBPACK_IMPORTED_MODULE_0__["style"])(this.el, titleStyle);
  };

  _proto.playlistItem = function playlistItem(model, item) {
    if (!item) {
      return;
    }

    if (model.get('displaytitle') || model.get('displaydescription')) {
      var title = '';
      var description = '';

      if (item.title && model.get('displaytitle')) {
        title = item.title;
      }

      if (item.description && model.get('displaydescription')) {
        description = item.description;
      }

      this.updateText(title, description);
    } else {
      this.hide();
    }
  };

  _proto.updateText = function updateText(title, description) {
    if (!this.title || !this.description) {
      return;
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["replaceInnerHtml"])(this.title, title);
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_1__["replaceInnerHtml"])(this.description, description);

    if (this.title.firstChild || this.description.firstChild) {
      this.show();
    } else {
      this.hide();
    }
  };

  _proto.element = function element() {
    return this.el;
  };

  return Title;
}();

/* harmony default export */ __webpack_exports__["default"] = (Title);

/***/ }),

/***/ "./src/js/view/utils/audio-mode.ts":
/*!*****************************************!*\
  !*** ./src/js/view/utils/audio-mode.ts ***!
  \*****************************************/
/*! exports provided: CONTROLBAR_ONLY_HEIGHT, isAudioMode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CONTROLBAR_ONLY_HEIGHT", function() { return CONTROLBAR_ONLY_HEIGHT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAudioMode", function() { return isAudioMode; });
var CONTROLBAR_ONLY_HEIGHT = 44;
var isAudioMode = function isAudioMode(model) {
  var playerHeight = model.get('height');

  if (model.get('aspectratio')) {
    return false;
  }

  if (typeof playerHeight === 'string' && playerHeight.indexOf('%') > -1) {
    return false;
  } // Coerce into Number (don't parse out CSS units)


  var verticalPixels = playerHeight * 1 || NaN;
  verticalPixels = !isNaN(verticalPixels) ? verticalPixels : model.get('containerHeight');

  if (!verticalPixels) {
    return false;
  }

  return !!(verticalPixels && verticalPixels <= CONTROLBAR_ONLY_HEIGHT);
};

/***/ }),

/***/ "./src/js/view/utils/breakpoint.ts":
/*!*****************************************!*\
  !*** ./src/js/view/utils/breakpoint.ts ***!
  \*****************************************/
/*! exports provided: getBreakpoint, setBreakpoint */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getBreakpoint", function() { return getBreakpoint; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setBreakpoint", function() { return setBreakpoint; });
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");

function getBreakpoint(width) {
  var breakpoint = -1;

  if (width >= 1280) {
    breakpoint = 7;
  } else if (width >= 960) {
    breakpoint = 6;
  } else if (width >= 800) {
    breakpoint = 5;
  } else if (width >= 640) {
    breakpoint = 4;
  } else if (width >= 540) {
    breakpoint = 3;
  } else if (width >= 420) {
    breakpoint = 2;
  } else if (width >= 320) {
    breakpoint = 1;
  } else if (width >= 250) {
    breakpoint = 0;
  }

  return breakpoint;
}
function setBreakpoint(playerElement, breakpointNumber) {
  var breakpointClass = 'jw-breakpoint-' + breakpointNumber;
  Object(utils_dom__WEBPACK_IMPORTED_MODULE_0__["replaceClass"])(playerElement, /jw-breakpoint--?\d+/, breakpointClass);
}

/***/ }),

/***/ "./src/js/view/utils/clickhandler.ts":
/*!*******************************************!*\
  !*** ./src/js/view/utils/clickhandler.ts ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return ClickHandler; });
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }





var ClickHandler = /*#__PURE__*/function (_Events) {
  _inheritsLoose(ClickHandler, _Events);

  function ClickHandler(model, element) {
    var _this;

    _this = _Events.call(this) || this;

    _this.revertAlternateClickHandlers();

    _this.domElement = element;
    _this.model = model;
    _this.ui = new utils_ui__WEBPACK_IMPORTED_MODULE_1__["default"](element).on('click tap', _this.clickHandler, _assertThisInitialized(_assertThisInitialized(_this))).on('doubleClick doubleTap', function () {
      if (this.alternateDoubleClickHandler) {
        this.alternateDoubleClickHandler();
        return;
      }

      this.trigger('doubleClick');
    }, _assertThisInitialized(_assertThisInitialized(_this)));
    return _this;
  }

  var _proto = ClickHandler.prototype;

  _proto.destroy = function destroy() {
    if (this.ui) {
      this.ui.destroy();
      this.ui = null;
      this.domElement = null;
      this.model = null;
      this.revertAlternateClickHandlers();
    }
  };

  _proto.clickHandler = function clickHandler(evt) {
    if (!this.model) {
      return;
    }

    if (this.alternateClickHandler) {
      this.alternateClickHandler(evt);
      return;
    }

    this.trigger(evt.type === events_events__WEBPACK_IMPORTED_MODULE_0__["CLICK"] ? 'click' : 'tap');
  };

  _proto.element = function element() {
    return this.domElement;
  };

  _proto.setAlternateClickHandlers = function setAlternateClickHandlers(clickHandler, doubleClickHandler) {
    this.alternateClickHandler = clickHandler;
    this.alternateDoubleClickHandler = doubleClickHandler || null;
  };

  _proto.revertAlternateClickHandlers = function revertAlternateClickHandlers() {
    this.alternateClickHandler = null;
    this.alternateDoubleClickHandler = null;
  };

  return ClickHandler;
}(utils_backbone_events__WEBPACK_IMPORTED_MODULE_2__["default"]);



/***/ }),

/***/ "./src/js/view/utils/player-size.ts":
/*!******************************************!*\
  !*** ./src/js/view/utils/player-size.ts ***!
  \******************************************/
/*! exports provided: getPlayerSizeStyles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPlayerSizeStyles", function() { return getPlayerSizeStyles; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var view_utils_audio_mode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! view/utils/audio-mode */ "./src/js/view/utils/audio-mode.ts");


function getPlayerSizeStyles(model, playerWidth, playerHeight, resetAspectMode) {
  var styles = {
    width: playerWidth
  }; // when jwResize is called remove aspectMode and force layout

  if (resetAspectMode && playerHeight !== undefined) {
    model.set('aspectratio', null);
  }

  if (!model.get('aspectratio')) {
    // If the height is a pixel value (number) greater than 0, snap it to the minimum supported height
    // Allow zero to mean "hide the player"
    var height = playerHeight;

    if (Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isNumber"])(height) && height !== 0) {
      height = Math.max(height, view_utils_audio_mode__WEBPACK_IMPORTED_MODULE_1__["CONTROLBAR_ONLY_HEIGHT"]);
    }

    styles.height = height;
  }

  return styles;
}

/***/ }),

/***/ "./src/js/view/utils/request-fullscreen-helper.js":
/*!********************************************************!*\
  !*** ./src/js/view/utils/request-fullscreen-helper.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var DOCUMENT_FULLSCREEN_EVENTS = ['fullscreenchange', 'webkitfullscreenchange', 'mozfullscreenchange', 'MSFullscreenChange'];
/* harmony default export */ __webpack_exports__["default"] = (function (elementContext, documentContext, changeCallback) {
  var _requestFullscreen = elementContext.requestFullscreen || elementContext.webkitRequestFullscreen || elementContext.webkitRequestFullScreen || elementContext.mozRequestFullScreen || elementContext.msRequestFullscreen;

  var _exitFullscreen = documentContext.exitFullscreen || documentContext.webkitExitFullscreen || documentContext.webkitCancelFullScreen || documentContext.mozCancelFullScreen || documentContext.msExitFullscreen;

  var _supportsDomFullscreen = !!(_requestFullscreen && _exitFullscreen);

  for (var i = DOCUMENT_FULLSCREEN_EVENTS.length; i--;) {
    documentContext.addEventListener(DOCUMENT_FULLSCREEN_EVENTS[i], changeCallback);
  }

  return {
    events: DOCUMENT_FULLSCREEN_EVENTS,
    supportsDomFullscreen: function supportsDomFullscreen() {
      return _supportsDomFullscreen;
    },
    requestFullscreen: function requestFullscreen() {
      _requestFullscreen.call(elementContext, {
        navigationUI: 'hide'
      });
    },
    exitFullscreen: function exitFullscreen() {
      if (this.fullscreenElement() !== null) {
        _exitFullscreen.apply(documentContext);
      }
    },
    fullscreenElement: function fullscreenElement() {
      var fullscreenElement = documentContext.fullscreenElement,
          webkitCurrentFullScreenElement = documentContext.webkitCurrentFullScreenElement,
          mozFullScreenElement = documentContext.mozFullScreenElement,
          msFullscreenElement = documentContext.msFullscreenElement;

      if (fullscreenElement === null) {
        return fullscreenElement;
      }

      return fullscreenElement || webkitCurrentFullScreenElement || mozFullScreenElement || msFullscreenElement;
    },
    destroy: function destroy() {
      for (var _i = DOCUMENT_FULLSCREEN_EVENTS.length; _i--;) {
        documentContext.removeEventListener(DOCUMENT_FULLSCREEN_EVENTS[_i], changeCallback);
      }
    }
  };
});

/***/ }),

/***/ "./src/js/view/utils/skin.js":
/*!***********************************!*\
  !*** ./src/js/view/utils/skin.js ***!
  \***********************************/
/*! exports provided: normalizeSkin, handleColorOverrides */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizeSkin", function() { return normalizeSkin; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "handleColorOverrides", function() { return handleColorOverrides; });
/* harmony import */ var utils_strings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/strings */ "./src/js/utils/strings.ts");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");


function normalizeSkin(skinConfig) {
  if (!skinConfig) {
    skinConfig = {};
  }

  var active = skinConfig.active;
  var inactive = skinConfig.inactive;
  var background = skinConfig.background;
  var colors = {};
  colors.controlbar = getControlBar(skinConfig.controlbar);
  colors.timeslider = getTimeSlider(skinConfig.timeslider);
  colors.menus = getMenus(skinConfig.menus);
  colors.tooltips = getTooltips(skinConfig.tooltips);

  function getControlBar(controlBarConfig) {
    if (controlBarConfig || active || inactive || background) {
      var config = {};
      controlBarConfig = controlBarConfig || {};
      config.iconsActive = controlBarConfig.iconsActive || active;
      config.icons = controlBarConfig.icons || inactive;
      config.text = controlBarConfig.text || inactive;
      config.background = controlBarConfig.background || background;
      return config;
    }
  }

  function getTimeSlider(timesliderConfig) {
    if (timesliderConfig || active) {
      var config = {};
      timesliderConfig = timesliderConfig || {};
      config.progress = timesliderConfig.progress || active;
      config.rail = timesliderConfig.rail;
      return config;
    }
  }

  function getMenus(menusConfig) {
    if (menusConfig || active || inactive || background) {
      var config = {};
      menusConfig = menusConfig || {};
      config.text = menusConfig.text || inactive;
      config.textActive = menusConfig.textActive || active;
      config.background = menusConfig.background || background;
      return config;
    }
  }

  function getTooltips(tooltipsConfig) {
    if (tooltipsConfig || inactive || background) {
      var config = {};
      tooltipsConfig = tooltipsConfig || {};
      config.text = tooltipsConfig.text || inactive;
      config.background = tooltipsConfig.background || background;
      return config;
    }
  }

  return colors;
}
function handleColorOverrides(playerId, skin) {
  if (!skin) {
    return;
  }

  function addStyle(elements, attr, value, extendParent) {
    if (!value) {
      return;
    }
    /* if extendParent is true, bundle the first selector of
     element string to the player element instead of defining it as a
     child of the player element (default). i.e. #player.sel-1 .sel-2 vs. #player .sel-1 .sel-2 */


    elements = Object(utils_strings__WEBPACK_IMPORTED_MODULE_0__["prefix"])(elements, '#' + playerId + (extendParent ? '' : ' '));
    var o = {};
    o[attr] = value;
    Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])(elements.join(', '), o, playerId);
  } // These will use standard style names for CSS since they are added directly to a style sheet
  // Using background instead of background-color so we don't have to clear gradients with background-image


  if (skin.controlbar) {
    styleControlbar(skin.controlbar);
  }

  if (skin.timeslider) {
    styleTimeslider(skin.timeslider);
  }

  if (skin.menus) {
    styleMenus(skin.menus);
  }

  if (skin.tooltips) {
    styleTooltips(skin.tooltips);
  }

  if (skin.menus) {
    insertGlobalColorClasses(skin.menus);
  }

  function styleControlbar(config) {
    addStyle([// controlbar text colors
    '.jw-controlbar .jw-icon-inline.jw-text', '.jw-title-primary', '.jw-title-secondary'], 'color', config.text);

    if (config.icons) {
      addStyle([// controlbar button colors
      '.jw-button-color:not(.jw-icon-cast)', '.jw-button-color.jw-toggle.jw-off:not(.jw-icon-cast)'], 'color', config.icons);
      addStyle(['.jw-display-icon-container .jw-button-color'], 'color', config.icons); // Chromecast overrides
      // Can't use addStyle since it will camel case the style name

      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-icon-cast google-cast-launcher.jw-off", "{--disconnected-color: " + config.icons + "}", playerId);
    }

    if (config.iconsActive) {
      addStyle(['.jw-display-icon-container .jw-button-color:hover', '.jw-display-icon-container .jw-button-color:focus'], 'color', config.iconsActive); // Apply active color

      addStyle([// Toggle and menu button active colors
      '.jw-button-color.jw-toggle:not(.jw-icon-cast)', '.jw-button-color:hover:not(.jw-icon-cast)', '.jw-button-color:focus:not(.jw-icon-cast)', '.jw-button-color.jw-toggle.jw-off:hover:not(.jw-icon-cast)'], 'color', config.iconsActive);
      addStyle(['.jw-svg-icon-buffer'], 'fill', config.icons); // Chromecast overrides
      // Can't use addStyle since it will camel case the style name

      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-icon-cast:hover google-cast-launcher.jw-off", "{--disconnected-color: " + config.iconsActive + "}", playerId);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-icon-cast:focus google-cast-launcher.jw-off", "{--disconnected-color: " + config.iconsActive + "}", playerId);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-icon-cast google-cast-launcher.jw-off:focus", "{--disconnected-color: " + config.iconsActive + "}", playerId);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-icon-cast google-cast-launcher", "{--connected-color: " + config.iconsActive + "}", playerId);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-icon-cast google-cast-launcher:focus", "{--connected-color: " + config.iconsActive + "}", playerId);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-icon-cast:hover google-cast-launcher", "{--connected-color: " + config.iconsActive + "}", playerId);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-icon-cast:focus google-cast-launcher", "{--connected-color: " + config.iconsActive + "}", playerId);
    } // A space is purposefully left before '.jw-settings-topbar' since extendParent is set to true in order to append ':not(.jw-state-idle)'


    addStyle([' .jw-settings-topbar', ':not(.jw-state-idle) .jw-controlbar', '.jw-flag-audio-player .jw-controlbar'], 'background', config.background, true);
  }

  function styleTimeslider(config) {
    var progress = config.progress;

    if (progress !== 'none') {
      addStyle(['.jw-progress', '.jw-knob'], 'background-color', progress);
      addStyle(['.jw-buffer'], 'background-color', Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["getRgba"])(progress, 50));
    }

    addStyle(['.jw-rail'], 'background-color', config.rail);
    addStyle(['.jw-background-color.jw-slider-time', '.jw-slider-time .jw-cue'], 'background-color', config.background);
  }

  function styleMenus(config) {
    addStyle(['.jw-option', '.jw-toggle.jw-off', '.jw-skip .jw-skip-icon', '.jw-nextup-tooltip', '.jw-nextup-close', '.jw-settings-content-item', '.jw-related-title'], 'color', config.text);
    addStyle(['.jw-option.jw-active-option', '.jw-option:not(.jw-active-option):hover', '.jw-option:not(.jw-active-option):focus', '.jw-settings-content-item:hover', '.jw-nextup-tooltip:hover', '.jw-nextup-tooltip:focus', '.jw-nextup-close:hover'], 'color', config.textActive);
    addStyle(['.jw-nextup', '.jw-settings-menu'], 'background', config.background);
  }

  function styleTooltips(config) {
    addStyle(['.jw-skip', '.jw-tooltip .jw-text', '.jw-time-tip .jw-text'], 'background-color', config.background);
    addStyle(['.jw-time-tip', '.jw-tooltip'], 'color', config.background);
    addStyle(['.jw-skip'], 'border', 'none');
    addStyle(['.jw-skip .jw-text', '.jw-skip .jw-icon', '.jw-time-tip .jw-text', '.jw-tooltip .jw-text'], 'color', config.text);
  } // Set global colors, used by related plugin
  // If a color is undefined simple-style-loader won't add their styles to the dom


  function insertGlobalColorClasses(config) {
    if (config.textActive) {
      var activeColorSet = {
        color: config.textActive,
        borderColor: config.textActive,
        stroke: config.textActive
      };
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-color-active", activeColorSet, playerId);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-color-active-hover:hover", activeColorSet, playerId);
    }

    if (config.text) {
      var inactiveColorSet = {
        color: config.text,
        borderColor: config.text,
        stroke: config.text
      };
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-color-inactive", inactiveColorSet, playerId);
      Object(utils_css__WEBPACK_IMPORTED_MODULE_1__["css"])("#" + playerId + " .jw-color-inactive-hover:hover", inactiveColorSet, playerId);
    }
  }
}

/***/ }),

/***/ "./src/js/view/utils/visibility.js":
/*!*****************************************!*\
  !*** ./src/js/view/utils/visibility.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getVisibility; });
function getVisibility(model, element) {
  // Set visibility to 1 if we're in fullscreen
  if (model.get('fullscreen')) {
    return 1;
  } // Set visibility to 0 if we're not in the active tab


  if (!model.get('activeTab')) {
    return 0;
  } // Set visibility to 1 if we're floating in the active tab


  if (model.get('isFloating')) {
    return 1;
  } // Otherwise, set it to the intersection ratio reported from the intersection observer


  var intersectionRatio = model.get('intersectionRatio');

  if (intersectionRatio === undefined) {
    // Get intersectionRatio through brute force
    intersectionRatio = computeVisibility(element); // Disregard intersectionRatio if it returns that the player is viewable in iFrame

    if (window.top !== window.self && intersectionRatio) {
      return 0;
    }
  }

  return intersectionRatio;
}

function computeVisibility(target) {
  var html = document.documentElement;
  var body = document.body;
  var rootRect = {
    top: 0,
    left: 0,
    right: html.clientWidth || body.clientWidth,
    width: html.clientWidth || body.clientWidth,
    bottom: html.clientHeight || body.clientHeight,
    height: html.clientHeight || body.clientHeight
  };

  if (!body.contains(target)) {
    return 0;
  } // If the element isn't displayed, an intersection can't happen.


  if (window.getComputedStyle(target).display === 'none') {
    return 0;
  }

  var targetRect = getBoundingClientRect(target);

  if (!targetRect) {
    return 0;
  }

  var intersectionRect = targetRect;
  var parent = target.parentNode;
  var atRoot = false;

  while (!atRoot) {
    var parentRect = null;

    if (parent === body || parent === html || parent.nodeType !== 1) {
      atRoot = true;
      parentRect = rootRect;
    } else if (window.getComputedStyle(parent).overflow !== 'visible') {
      parentRect = getBoundingClientRect(parent);
    }

    if (parentRect) {
      intersectionRect = computeRectIntersection(parentRect, intersectionRect);

      if (!intersectionRect) {
        return 0;
      }
    }

    parent = parent.parentNode;
  }

  var targetArea = targetRect.width * targetRect.height;
  var intersectionArea = intersectionRect.width * intersectionRect.height;
  return targetArea ? intersectionArea / targetArea : 0;
}

function getBoundingClientRect(el) {
  try {
    return el.getBoundingClientRect();
  } catch (e) {
    /* ignore Windows 7 IE11 "Unspecified error" */
  }
}

function computeRectIntersection(rect1, rect2) {
  var top = Math.max(rect1.top, rect2.top);
  var bottom = Math.min(rect1.bottom, rect2.bottom);
  var left = Math.max(rect1.left, rect2.left);
  var right = Math.min(rect1.right, rect2.right);
  var width = right - left;
  var height = bottom - top;
  return width >= 0 && height >= 0 && {
    top: top,
    bottom: bottom,
    left: left,
    right: right,
    width: width,
    height: height
  };
}

/***/ }),

/***/ "./src/js/view/view-model.ts":
/*!***********************************!*\
  !*** ./src/js/view/view-model.ts ***!
  \***********************************/
/*! exports provided: PlayerViewModel, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayerViewModel", function() { return PlayerViewModel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return ViewModel; });
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var model_simplemodel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! model/simplemodel */ "./src/js/model/simplemodel.ts");



function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }


var changeEventRegEx = /^change:(.+)$/;

function dispatchDiffChangeEvents(viewModel, newAttributes, oldAttributes) {
  Object.keys(newAttributes).forEach(function (attr) {
    if (attr in newAttributes && newAttributes[attr] !== oldAttributes[attr]) {
      viewModel.trigger("change:" + attr, viewModel, newAttributes[attr], oldAttributes[attr]);
    }
  });
}

function removeListeners(instance, viewModel) {
  if (instance) {
    instance.off(null, null, viewModel);
  }
}

var PlayerViewModel = /*#__PURE__*/function (_SimpleModel) {
  _inheritsLoose(PlayerViewModel, _SimpleModel);

  function PlayerViewModel(playerModel, eventFilter) {
    var _this;

    _this = _SimpleModel.call(this) || this;
    _this._model = playerModel;
    _this._mediaModel = null;

    Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(playerModel.attributes, {
      altText: '',
      fullscreen: false,
      logoWidth: 0,
      scrubbing: false
    });

    playerModel.on('all', function (type, objectOrEvent, value, previousValue) {
      if (objectOrEvent === playerModel) {
        objectOrEvent = _assertThisInitialized(_assertThisInitialized(_this));
      }

      if (!eventFilter || eventFilter(type, objectOrEvent, value, previousValue)) {
        _this.trigger(type, objectOrEvent, value, previousValue);
      }
    }, _assertThisInitialized(_assertThisInitialized(_this)));
    playerModel.on('change:mediaModel', function (model, mediaModel) {
      _this.mediaModel = mediaModel;
    }, _assertThisInitialized(_assertThisInitialized(_this)));
    return _this;
  }

  var _proto = PlayerViewModel.prototype;

  _proto.get = function get(attr) {
    var mediaModel = this._mediaModel;

    if (mediaModel && attr in mediaModel.attributes) {
      return mediaModel.get(attr);
    }

    return this._model.get(attr);
  };

  _proto.set = function set(attr, val) {
    return this._model.set(attr, val);
  };

  _proto.getVideo = function getVideo() {
    return this._model.getVideo();
  };

  _proto.destroy = function destroy() {
    removeListeners(this._model, this);
    removeListeners(this._mediaModel, this);
    this.off();
  };

  _createClass(PlayerViewModel, [{
    key: "mediaModel",
    set: function set(mediaModel) {
      var _this2 = this;

      var previousMediaModel = this._mediaModel;
      removeListeners(previousMediaModel, this);
      this._mediaModel = mediaModel;
      mediaModel.on('all', function (type, objectOrEvent, value, previousValue) {
        if (objectOrEvent === mediaModel) {
          objectOrEvent = _this2;
        }

        _this2.trigger(type, objectOrEvent, value, previousValue);
      }, this);

      if (previousMediaModel) {
        dispatchDiffChangeEvents(this, mediaModel.attributes, previousMediaModel.attributes);
      }
    }
  }]);

  return PlayerViewModel;
}(model_simplemodel__WEBPACK_IMPORTED_MODULE_1__["default"]);

var ViewModel = /*#__PURE__*/function (_PlayerViewModel) {
  _inheritsLoose(ViewModel, _PlayerViewModel);

  function ViewModel(playerModel) {
    var _this3;

    _this3 = _PlayerViewModel.call(this, playerModel, function (type) {
      // Do not propagate attribute changes from the player model for attributes present in instream
      var instreamModel = _this3._instreamModel;

      if (instreamModel) {
        var match = changeEventRegEx.exec(type);

        if (match) {
          var attr = match[1];

          if (attr in instreamModel.attributes) {
            return false;
          }
        }
      }

      return true;
    }) || this;
    _this3._instreamModel = null;
    _this3._playerViewModel = new PlayerViewModel(_this3._model);
    playerModel.on('change:instream', function (model, instream) {
      _this3.instreamModel = instream ? instream.model : null;
    }, _assertThisInitialized(_assertThisInitialized(_this3)));
    return _this3;
  }

  var _proto2 = ViewModel.prototype;

  _proto2.get = function get(attr) {
    var mediaModel = this._mediaModel;

    if (mediaModel && attr in mediaModel.attributes) {
      return mediaModel.get(attr);
    }

    var instreamModel = this._instreamModel;

    if (instreamModel && attr in instreamModel.attributes) {
      return instreamModel.get(attr);
    }

    return this._model.get(attr);
  };

  _proto2.getVideo = function getVideo() {
    var instreamModel = this._instreamModel;

    if (instreamModel && instreamModel.getVideo()) {
      return instreamModel.getVideo();
    }

    return _PlayerViewModel.prototype.getVideo.call(this);
  };

  _proto2.destroy = function destroy() {
    _PlayerViewModel.prototype.destroy.call(this);

    removeListeners(this._instreamModel, this);
  };

  _createClass(ViewModel, [{
    key: "player",
    get: function get() {
      return this._playerViewModel;
    }
  }, {
    key: "instreamModel",
    set: function set(instreamModel) {
      var _this4 = this;

      var previousInstream = this._instreamModel;
      removeListeners(previousInstream, this);

      this._model.off('change:mediaModel', null, this);

      this._instreamModel = instreamModel;
      this.trigger('instreamMode', !!instreamModel);

      if (instreamModel) {
        instreamModel.on('all', function (type, objectOrEvent, value, previousValue) {
          if (objectOrEvent === instreamModel) {
            objectOrEvent = _this4;
          }

          _this4.trigger(type, objectOrEvent, value, previousValue);
        }, this);
        instreamModel.change('mediaModel', function (model, mediaModel) {
          _this4.mediaModel = mediaModel;
        }, this);
        dispatchDiffChangeEvents(this, instreamModel.attributes, this._model.attributes);
      } else if (previousInstream) {
        this._model.change('mediaModel', function (model, mediaModel) {
          _this4.mediaModel = mediaModel;
        }, this);

        var mergedAttributes = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, this._model.attributes, previousInstream.attributes);

        dispatchDiffChangeEvents(this, this._model.attributes, mergedAttributes);
      }
    }
  }]);

  return ViewModel;
}(PlayerViewModel);



/***/ }),

/***/ "./src/js/view/view.js":
/*!*****************************!*\
  !*** ./src/js/view/view.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_underscore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/underscore */ "./src/js/utils/underscore.js");
/* harmony import */ var templates_player__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! templates/player */ "./src/js/templates/player.ts");
/* harmony import */ var view_error_container__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! view/error-container */ "./src/js/view/error-container.ts");
/* harmony import */ var view_utils_audio_mode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! view/utils/audio-mode */ "./src/js/view/utils/audio-mode.ts");
/* harmony import */ var view_utils_views_manager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! view/utils/views-manager */ "./src/js/view/utils/views-manager.js");
/* harmony import */ var view_utils_visibility__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! view/utils/visibility */ "./src/js/view/utils/visibility.js");
/* harmony import */ var utils_active_tab__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! utils/active-tab */ "./src/js/utils/active-tab.ts");
/* harmony import */ var utils_request_animation_frame__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! utils/request-animation-frame */ "./src/js/utils/request-animation-frame.ts");
/* harmony import */ var view_utils_breakpoint__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! view/utils/breakpoint */ "./src/js/view/utils/breakpoint.ts");
/* harmony import */ var view_utils_skin__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! view/utils/skin */ "./src/js/view/utils/skin.js");
/* harmony import */ var environment_environment__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! environment/environment */ "./src/js/environment/environment.ts");
/* harmony import */ var controller_controls_loader__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! controller/controls-loader */ "./src/js/controller/controls-loader.js");
/* harmony import */ var events_events__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! events/events */ "./src/js/events/events.ts");
/* harmony import */ var utils_backbone_events__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! utils/backbone.events */ "./src/js/utils/backbone.events.ts");
/* harmony import */ var utils_dom__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! utils/dom */ "./src/js/utils/dom.js");
/* harmony import */ var utils_browser__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! utils/browser */ "./src/js/utils/browser.ts");
/* harmony import */ var utils_css__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! utils/css */ "./src/js/utils/css.js");
/* harmony import */ var view_utils_request_fullscreen_helper__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! view/utils/request-fullscreen-helper */ "./src/js/view/utils/request-fullscreen-helper.js");
/* harmony import */ var utils_ui__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! utils/ui */ "./src/js/utils/ui.js");
/* harmony import */ var view_utils_clickhandler__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! view/utils/clickhandler */ "./src/js/view/utils/clickhandler.ts");
/* harmony import */ var view_captionsrenderer__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! view/captionsrenderer */ "./src/js/view/captionsrenderer.js");
/* harmony import */ var view_logo__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! view/logo */ "./src/js/view/logo.js");
/* harmony import */ var view_preview__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! view/preview */ "./src/js/view/preview.ts");
/* harmony import */ var view_title__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! view/title */ "./src/js/view/title.ts");
/* harmony import */ var view_floating_floating_controller__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! view/floating/floating-controller */ "./src/js/view/floating/floating-controller.ts");
/* harmony import */ var view_utils_resize_listener__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! view/utils/resize-listener */ "./src/js/view/utils/resize-listener.js");
/* harmony import */ var view_utils_player_size__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! view/utils/player-size */ "./src/js/view/utils/player-size.ts");





























if (true) {
  __webpack_require__(/*! css/jwplayer.less */ "./src/css/jwplayer.less");
}

var ControlsModule;
var _isMobile = environment_environment__WEBPACK_IMPORTED_MODULE_10__["OS"].mobile;
var _isIE = environment_environment__WEBPACK_IMPORTED_MODULE_10__["Browser"].ie;

function View(_api, _model) {
  var _this3 = this;

  var _this = Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["extend"])(this, utils_backbone_events__WEBPACK_IMPORTED_MODULE_13__["default"], {
    isSetup: false,
    api: _api,
    model: _model
  });

  var _localization = _model.get('localization');

  var _playerElement = Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["createElement"])(Object(templates_player__WEBPACK_IMPORTED_MODULE_1__["default"])(_model.get('id'), _localization.player));

  var _wrapperElement = _playerElement.querySelector('.jw-wrapper');

  var _videoLayer = _playerElement.querySelector('.jw-media');

  var _preview = new view_preview__WEBPACK_IMPORTED_MODULE_22__["default"](_model, _api);

  var _title = new view_title__WEBPACK_IMPORTED_MODULE_23__["default"](_model);

  var _captionsRenderer = new view_captionsrenderer__WEBPACK_IMPORTED_MODULE_20__["default"](_model);

  _captionsRenderer.on('all', _this.trigger, _this);

  var _logo;

  var _lastWidth;

  var _lastHeight;

  var _currentlyFloating;

  var _resizeMediaTimeout = -1;

  var _resizeContainerRequestId = -1;

  var _stateClassRequestId = -1;

  var firstFloatCfg = _model.get('floating');

  this.dismissible = firstFloatCfg && firstFloatCfg.dismissible;
  var playerBounds = {};
  var floatingController = new view_floating_floating_controller__WEBPACK_IMPORTED_MODULE_24__["default"](_model, playerBounds, {
    player: _playerElement,
    wrapper: _wrapperElement,
    preview: _preview
  });
  var displayClickHandler;
  var fullscreenHelpers;
  var focusHelper;
  var _breakpoint = null;
  var _controls = null;

  function reasonInteraction() {
    return {
      reason: 'interaction'
    };
  } // Compute player size, handle DOM removal/insertion, add to views-manager


  this.updateBounds = function () {
    Object(utils_request_animation_frame__WEBPACK_IMPORTED_MODULE_7__["cancelAnimationFrame"])(_resizeContainerRequestId);

    var currentElement = _getCurrentElement();

    var inDOM = document.body.contains(currentElement);
    var rect = Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["bounds"])(currentElement);
    var containerWidth = Math.round(rect.width);
    var containerHeight = Math.round(rect.height);
    playerBounds = Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["bounds"])(_playerElement);
    floatingController.updatePlayerBounds(playerBounds); // If the container is the same size as before, return early

    if (containerWidth === _lastWidth && containerHeight === _lastHeight) {
      // Listen for player to be added to DOM
      if (!_lastWidth || !_lastHeight) {
        _responsiveListener();
      }

      _model.set('inDom', inDOM);

      return;
    } // If we have bad values for either dimension, return early


    if (!containerWidth || !containerHeight) {
      // If we haven't established player size, try again
      if (!_lastWidth || !_lastHeight) {
        _responsiveListener();
      }
    } // Don't update container dimensions to 0, 0 when not in DOM


    if (containerWidth || containerHeight || inDOM) {
      _model.set('containerWidth', containerWidth);

      _model.set('containerHeight', containerHeight);
    }

    _model.set('inDom', inDOM);

    if (inDOM) {
      view_utils_views_manager__WEBPACK_IMPORTED_MODULE_4__["default"].observe(_playerElement);
    }
  }; // Apply styles and classes based on player size


  this.updateStyles = function () {
    var containerWidth = _model.get('containerWidth');

    var containerHeight = _model.get('containerHeight');

    updateContainerStyles(containerWidth, containerHeight);

    if (_controls) {
      _controls.resize(containerWidth, containerHeight);
    }

    _resizeMedia(containerWidth, containerHeight);

    _captionsRenderer.resize();

    floatingController.updateStyles();
  }; // Dispatch UI events for changes in player size


  this.checkResized = function () {
    var containerWidth = _model.get('containerWidth');

    var containerHeight = _model.get('containerHeight');

    var floating = _model.get('isFloating');

    if (containerWidth !== _lastWidth || containerHeight !== _lastHeight) {
      if (!this.resizeListener) {
        this.resizeListener = new view_utils_resize_listener__WEBPACK_IMPORTED_MODULE_25__["default"](_wrapperElement, this, _model);
      }

      _lastWidth = containerWidth;
      _lastHeight = containerHeight;

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_12__["RESIZE"], {
        width: containerWidth,
        height: containerHeight
      });

      var breakpoint = Object(view_utils_breakpoint__WEBPACK_IMPORTED_MODULE_8__["getBreakpoint"])(containerWidth);

      if (_breakpoint !== breakpoint) {
        _breakpoint = breakpoint;

        _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_12__["BREAKPOINT"], {
          breakpoint: _breakpoint
        });
      }
    }

    if (floating !== _currentlyFloating) {
      _currentlyFloating = floating;

      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_12__["FLOAT"], {
        floating: floating
      });

      updateVisibility();
    }
  };

  function _responsiveListener() {
    Object(utils_request_animation_frame__WEBPACK_IMPORTED_MODULE_7__["cancelAnimationFrame"])(_resizeContainerRequestId);
    _resizeContainerRequestId = Object(utils_request_animation_frame__WEBPACK_IMPORTED_MODULE_7__["requestAnimationFrame"])(_responsiveUpdate);
  }

  this.responsiveListener = _responsiveListener;

  function _responsiveUpdate() {
    if (!_this.isSetup) {
      return;
    }

    _this.updateBounds();

    _this.updateStyles();

    _this.checkResized();
  }

  function updateContainerStyles(width, height) {
    // Set responsive player classes
    if (Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isNumber"])(width) && Object(utils_underscore__WEBPACK_IMPORTED_MODULE_0__["isNumber"])(height)) {
      var breakpoint = Object(view_utils_breakpoint__WEBPACK_IMPORTED_MODULE_8__["getBreakpoint"])(width);
      Object(view_utils_breakpoint__WEBPACK_IMPORTED_MODULE_8__["setBreakpoint"])(_playerElement, breakpoint);
      var smallPlayer = breakpoint < 2;
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-small-player', smallPlayer);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-orientation-portrait', height > width);
    } // Only change audio player mode when controls are enabled


    if (_model.get('controls')) {
      var audioMode = Object(view_utils_audio_mode__WEBPACK_IMPORTED_MODULE_3__["isAudioMode"])(_model);
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-audio-player', audioMode);

      _model.set('audioMode', audioMode);
    }
  }

  this.setup = function () {
    _preview.setup(_playerElement.querySelector('.jw-preview'));

    _title.setup(_playerElement.querySelector('.jw-title'));

    _logo = new view_logo__WEBPACK_IMPORTED_MODULE_21__["default"](_model);

    _logo.setup();

    _logo.setContainer(_wrapperElement);

    _logo.on(events_events__WEBPACK_IMPORTED_MODULE_12__["LOGO_CLICK"], _logoClickHandler); // captions rendering


    _captionsRenderer.setup(_playerElement.id, _model.get('captions')); // captions should be placed behind controls, and not hidden when controls are hidden


    _title.element().parentNode.insertBefore(_captionsRenderer.element(), _title.element()); // Display Click and Double Click Handling


    displayClickHandler = clickHandlerHelper(_api, _model, _videoLayer);
    focusHelper = new utils_ui__WEBPACK_IMPORTED_MODULE_18__["default"](_playerElement).on('click', function () {});
    fullscreenHelpers = Object(view_utils_request_fullscreen_helper__WEBPACK_IMPORTED_MODULE_17__["default"])(_playerElement, document, _fullscreenChangeHandler, _model);

    _model.on('change:hideAdsControls', function (model, val) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-ads-hide-controls', val);
    });

    _model.on('change:scrubbing', function (model, val) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-dragging', val);
    });

    _model.on('change:playRejected', function (model, val) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-play-rejected', val);
    }); // Native fullscreen (coming through from the provider)


    _model.on(events_events__WEBPACK_IMPORTED_MODULE_12__["NATIVE_FULLSCREEN"], _nativeFullscreenChangeHandler);

    _model.on("change:" + events_events__WEBPACK_IMPORTED_MODULE_12__["MEDIA_VISUAL_QUALITY"], function () {
      _resizeMedia();

      _captionsRenderer.resize();
    });

    var playerViewModel = _model.player;
    playerViewModel.on('change:errorEvent', _errorHandler);

    _model.change('stretching', onStretchChange);

    var width = _model.get('width');

    var height = _model.get('height');

    var styles = Object(view_utils_player_size__WEBPACK_IMPORTED_MODULE_26__["getPlayerSizeStyles"])(_model, width, height);
    Object(utils_css__WEBPACK_IMPORTED_MODULE_16__["style"])(_playerElement, styles);

    _model.change('aspectratio', onAspectRatioChange);

    updateContainerStyles(width, height);

    if (!_model.get('controls')) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["addClass"])(_playerElement, 'jw-flag-controls-hidden');
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["removeClass"])(_playerElement, 'jw-floating-dismissible');
    }

    if (_isIE) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["addClass"])(_playerElement, 'jw-ie');
    }

    var skin = _model.get('skin') || {};

    if (skin.name) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["replaceClass"])(_playerElement, /jw-skin-\S+/, 'jw-skin-' + skin.name);
    }

    var skinColors = Object(view_utils_skin__WEBPACK_IMPORTED_MODULE_9__["normalizeSkin"])(skin);
    Object(view_utils_skin__WEBPACK_IMPORTED_MODULE_9__["handleColorOverrides"])(_model.get('id'), skinColors); // adds video tag to video layer

    _model.set('mediaContainer', _videoLayer);

    _model.set('iFrame', environment_environment__WEBPACK_IMPORTED_MODULE_10__["Features"].iframe);

    _model.set('activeTab', Object(utils_active_tab__WEBPACK_IMPORTED_MODULE_6__["default"])());

    _model.set('touchMode', _isMobile && (typeof height === 'string' || height >= view_utils_audio_mode__WEBPACK_IMPORTED_MODULE_3__["CONTROLBAR_ONLY_HEIGHT"]));

    view_utils_views_manager__WEBPACK_IMPORTED_MODULE_4__["default"].add(this);

    if (_model.get('enableGradient') && !_isIE) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["addClass"])(_playerElement, 'jw-ab-drop-shadow');
    }

    this.isSetup = true;

    _model.trigger('viewSetup', _playerElement);

    var inDOM = document.body.contains(_playerElement);

    if (inDOM) {
      view_utils_views_manager__WEBPACK_IMPORTED_MODULE_4__["default"].observe(_playerElement);
    }

    _model.set('inDom', inDOM); // Floating event triggers


    _model.on('forceAspectRatioChange', function (evtArgs) {
      var ar = evtArgs.ratio || _model.get('aspectratio');

      onAspectRatioChange(_model, ar);
    });

    _model.on('forceResponsiveListener', _responsiveListener);

    floatingController.setup();
  };

  function updateVisibility() {
    _model.set('visibility', Object(view_utils_visibility__WEBPACK_IMPORTED_MODULE_5__["default"])(_model, _playerElement));
  }

  this.init = function () {
    this.updateBounds();

    _model.on('change:fullscreen', _fullscreen);

    _model.on('change:activeTab', updateVisibility);

    _model.on('change:fullscreen', updateVisibility);

    _model.on('change:intersectionRatio', updateVisibility);

    _model.on('change:visibility', redraw);

    _model.on('instreamMode', function (instreamMode) {
      if (instreamMode) {
        setupInstream();
      } else {
        destroyInstream();
      }
    });

    updateVisibility(); // Always draw first player for icons to load

    if (view_utils_views_manager__WEBPACK_IMPORTED_MODULE_4__["default"].size() === 1 && !_model.get('visibility')) {
      redraw(_model, 1, 0);
    }

    var playerViewModel = _model.player;

    _model.change('state', _stateHandler);

    playerViewModel.change('controls', changeControls);

    _model.change('streamType', _setLiveMode);

    _model.change('mediaType', _onMediaTypeChange);

    playerViewModel.change('playlistItem', function (model, item) {
      onPlaylistItem(model, item);
    }); // Triggering 'resize' resulting in player 'ready'

    _lastWidth = _lastHeight = null;
    this.initFloatingBehavior();
    this.checkResized();
  };

  function changeControls(model, enable) {
    var controlsEvent = {
      controls: enable
    };

    if (enable) {
      ControlsModule = controller_controls_loader__WEBPACK_IMPORTED_MODULE_11__["ControlsLoader"].controls;

      if (!ControlsModule) {
        controlsEvent.loadPromise = Object(controller_controls_loader__WEBPACK_IMPORTED_MODULE_11__["loadControls"])().then(function (Controls) {
          ControlsModule = Controls; // Check that controls is still true after the loader promise resolves

          var enabledState = model.get('controls');

          if (enabledState) {
            addControls();
          }

          return enabledState;
        });
        controlsEvent.loadPromise.catch(function (error) {
          _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_12__["WARNING"], error);
        });
      } else {
        addControls();
      }
    } else {
      _this.removeControls();
    } // Only trigger controls events after the player and view are set up (and has width/height)


    if (_lastWidth && _lastHeight) {
      _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_12__["CONTROLS"], controlsEvent);
    }
  }

  function addControls() {
    var controls = new ControlsModule(document, _this.element());

    _this.addControls(controls);
  }

  function redraw(model, visibility, lastVisibility) {
    if (visibility && !lastVisibility) {
      _stateHandler(model, model.get('state'));

      _this.updateStyles();
    }
  }

  function clickHandlerHelper(api, model, videoLayer) {
    var clickHandler = new view_utils_clickhandler__WEBPACK_IMPORTED_MODULE_19__["default"](model, videoLayer);
    var controls = model.get('controls');
    clickHandler.on({
      click: function click() {
        _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_12__["DISPLAY_CLICK"]); // Ensures that Firefox focuses the container not the video tag for aria compatibility


        _getCurrentElement().focus();

        if (_controls) {
          if (settingsMenuVisible()) {
            _controls.settingsMenu.close();
          } else if (infoOverlayVisible()) {
            _controls.infoOverlay.close();
          } else {
            api.playToggle(reasonInteraction());
          }
        }
      },
      tap: function tap() {
        _this.trigger(events_events__WEBPACK_IMPORTED_MODULE_12__["DISPLAY_CLICK"]);

        if (settingsMenuVisible()) {
          _controls.settingsMenu.close();
        }

        if (infoOverlayVisible()) {
          _controls.infoOverlay.close();
        }

        var state = model.get('state');

        if (controls && (state === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_IDLE"] || state === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_COMPLETE"] || model.get('instream') && state === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_PAUSED"])) {
          api.playToggle(reasonInteraction());
        }

        if (controls && state === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_PAUSED"]) {
          // Toggle visibility of the controls when tapping the media
          // Do not add mobile toggle "jw-flag-controls-hidden" in these cases
          if (model.get('instream') || model.get('castActive') || model.get('mediaType') === 'audio') {
            return;
          }

          Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-controls-hidden');

          if (_this.dismissible) {
            Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-floating-dismissible', Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["hasClass"])(_playerElement, 'jw-flag-controls-hidden'));
          }

          _captionsRenderer.renderCues(true);
        } else if (_controls) {
          if (!_controls.showing) {
            _controls.userActive();
          } else {
            _controls.userInactive();
          }
        }
      },
      doubleClick: function doubleClick() {
        return _controls && api.setFullscreen();
      }
    });

    if (!_isMobile) {
      _playerElement.addEventListener('mousemove', moveHandler);

      _playerElement.addEventListener('mouseover', overHandler);

      _playerElement.addEventListener('mouseout', outHandler);
    }

    return clickHandler;
  }

  function moveHandler(event) {
    if (_controls) {
      _controls.mouseMove(event);
    }
  }

  function overHandler(event) {
    if (_controls && !_controls.showing && event.target.nodeName === 'IFRAME') {
      _controls.userActive();
    }
  }

  function outHandler(event) {
    // If controls are showing and mouse moves out to relatedTarget not within playerElement, call userActive().
    // Also call userActive() if event does not contain relatedTarget if player is in iFrame. (relatedTarget = null)
    if (_controls && _controls.showing && (event.relatedTarget && !_playerElement.contains(event.relatedTarget) || !event.relatedTarget && environment_environment__WEBPACK_IMPORTED_MODULE_10__["Features"].iframe)) {
      _controls.userActive();
    }
  }

  function onStretchChange(model, newVal) {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["replaceClass"])(_playerElement, /jw-stretch-\S+/, 'jw-stretch-' + newVal);
  }

  function onAspectRatioChange(model, aspectratio) {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-aspect-mode', !!aspectratio);

    var aspectRatioContainer = _playerElement.querySelectorAll('.jw-aspect');

    Object(utils_css__WEBPACK_IMPORTED_MODULE_16__["style"])(aspectRatioContainer, {
      paddingTop: aspectratio || null
    });

    if (_this.isSetup && aspectratio && !model.get('isFloating')) {
      Object(utils_css__WEBPACK_IMPORTED_MODULE_16__["style"])(_playerElement, Object(view_utils_player_size__WEBPACK_IMPORTED_MODULE_26__["getPlayerSizeStyles"])(model, model.get('width')));

      _responsiveUpdate();
    }
  }

  function _logoClickHandler(evt) {
    if (!evt.link) {
      if (_model.get('controls')) {
        _api.playToggle(reasonInteraction());
      }
    } else {
      _api.pause(reasonInteraction());

      _api.setFullscreen(false);

      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["openLink"])(evt.link, evt.linktarget, {
        rel: 'noreferrer'
      });
    }
  }

  this.initFloatingBehavior = function () {
    floatingController.initFloatingBehavior();
  };

  this.addControls = function (controls) {
    var _this2 = this;

    _controls = controls;
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["removeClass"])(_playerElement, 'jw-flag-controls-hidden');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-floating-dismissible', this.dismissible);
    controls.enable(_api, _model); // refresh breakpoint and timeslider classes

    if (_lastHeight) {
      updateContainerStyles(_lastWidth, _lastHeight);
      controls.resize(_lastWidth, _lastHeight);

      _captionsRenderer.renderCues(true);
    }

    controls.on('userActive userInactive', function () {
      var state = _model.get('state');

      if (state === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_PLAYING"] || state === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_BUFFERING"]) {
        _captionsRenderer.renderCues(true);
      }
    });
    controls.on('dismissFloating', function () {
      _this2.stopFloating(true);

      _api.pause({
        reason: 'interaction'
      });
    });
    controls.on('all', _this.trigger, _this);

    if (_model.get('instream')) {
      _controls.setupInstream();
    }
  };

  this.removeControls = function () {
    if (_controls) {
      _controls.disable(_model);

      _controls = null;
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["addClass"])(_playerElement, 'jw-flag-controls-hidden');
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["removeClass"])(_playerElement, 'jw-floating-dismissible');
  }; // Perform the switch to fullscreen


  var _fullscreen = function _fullscreen(model, state) {
    // Unmute the video so volume can be adjusted with native controls in fullscreen
    if (state && _controls && model.get('autostartMuted')) {
      _controls.unmuteAutoplay(_api, model);
    }

    if (fullscreenHelpers.supportsDomFullscreen()) {
      if (state) {
        fullscreenHelpers.requestFullscreen();
      } else {
        fullscreenHelpers.exitFullscreen();
      }

      _toggleDOMFullscreen(_playerElement, state);
    } else if (_isIE) {
      _toggleDOMFullscreen(_playerElement, state);
    } else {
      // Request media element fullscreen (iOS)
      var instream = model.get('instream');
      var instreamProvider = instream ? instream.provider : null;
      var provider = model.getVideo() || instreamProvider;

      if (provider && provider.setFullscreen) {
        provider.setFullscreen(state);
      }
    }
  };

  function _resizeMedia(containerWidth, containerHeight) {
    if (!containerWidth || isNaN(1 * containerWidth)) {
      containerWidth = _model.get('containerWidth');

      if (!containerWidth) {
        return;
      }
    }

    if (!containerHeight || isNaN(1 * containerHeight)) {
      containerHeight = _model.get('containerHeight');

      if (!containerHeight) {
        return;
      }
    }

    if (_preview) {
      _preview.resize(containerWidth, containerHeight, _model.get('stretching'));
    }

    var provider = _model.getVideo();

    if (!provider) {
      return;
    }

    provider.resize(containerWidth, containerHeight, _model.get('stretching'));
  }

  this.resize = function (playerWidth, playerHeight) {
    var styles = Object(view_utils_player_size__WEBPACK_IMPORTED_MODULE_26__["getPlayerSizeStyles"])(_model, playerWidth, playerHeight, true);
    var widthSet = playerWidth !== undefined;
    var heightSet = playerHeight !== undefined;

    if (widthSet && heightSet) {
      _model.set('width', playerWidth);

      _model.set('height', playerHeight);
    }

    Object(utils_css__WEBPACK_IMPORTED_MODULE_16__["style"])(_playerElement, styles);
    floatingController.resize();

    _responsiveUpdate();
  };

  this.resizeMedia = _resizeMedia;

  function _isNativeFullscreen() {
    // Return whether or not we're in native fullscreen
    if (fullscreenHelpers.supportsDomFullscreen()) {
      var fsElement = fullscreenHelpers.fullscreenElement();
      return !!(fsElement && fsElement === _playerElement);
    } // If native fullscreen is not available, return video fullscreen state


    var provider = _model.getVideo();

    return provider.getFullScreen();
  }

  function _nativeFullscreenChangeHandler(event) {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-ios-fullscreen', event.jwstate);

    _fullscreenChangeHandler(event);
  }

  function _fullscreenChangeHandler(event) {
    var modelState = _model.get('fullscreen');

    var newState = event.jwstate !== undefined ? event.jwstate : _isNativeFullscreen(); // If fullscreen was triggered by something other than the player
    //  then we want to sync up our internal state

    if (modelState !== newState) {
      _model.set('fullscreen', newState);
    }

    _responsiveListener();

    clearTimeout(_resizeMediaTimeout);
    _resizeMediaTimeout = setTimeout(_resizeMedia, 200);
  }

  function _toggleDOMFullscreen(playerElement, fullscreenState) {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(playerElement, 'jw-flag-fullscreen', fullscreenState);
    Object(utils_css__WEBPACK_IMPORTED_MODULE_16__["style"])(document.body, {
      overflowY: fullscreenState ? 'hidden' : ''
    });

    if (fullscreenState && _controls) {
      // When going into fullscreen, we want the control bar to fade after a few seconds
      _controls.userActive();
    }

    _resizeMedia();

    _responsiveListener();
  }

  function _setLiveMode(model, streamType) {
    var live = streamType === 'LIVE';
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-live', live);
  }

  function _onMediaTypeChange(model, val) {
    var isAudioFile = val === 'audio';
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-media-audio', isAudioFile);
    var element = isAudioFile ? _videoLayer : _videoLayer.nextSibling; // Put the preview element before the media element in order to display browser captions
    // otherwise keep it on top of the media element to display captions with the captions renderer

    _preview.el.parentNode.insertBefore(_preview.el, element);
  }

  function _errorHandler(model, errorEvent) {
    if (!errorEvent) {
      _title.playlistItem(model, model.get('playlistItem'));

      return;
    }

    var errorContainer = Object(view_error_container__WEBPACK_IMPORTED_MODULE_2__["default"])(model, errorEvent);

    if (view_error_container__WEBPACK_IMPORTED_MODULE_2__["default"].cloneIcon) {
      errorContainer.querySelector('.jw-icon').appendChild(view_error_container__WEBPACK_IMPORTED_MODULE_2__["default"].cloneIcon('error'));
    }

    _title.hide();

    _playerElement.appendChild(errorContainer.firstChild);

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-flag-audio-player', !!model.get('audioMode'));
  }

  function _stateHandler(model, newState, oldState) {
    if (!_this.isSetup) {
      return;
    }

    if (oldState === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_ERROR"]) {
      var errorContainer = _playerElement.querySelector('.jw-error-msg');

      if (errorContainer) {
        errorContainer.parentNode.removeChild(errorContainer);
      }
    }

    Object(utils_request_animation_frame__WEBPACK_IMPORTED_MODULE_7__["cancelAnimationFrame"])(_stateClassRequestId);

    if (newState === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_PLAYING"]) {
      _stateUpdate(newState);
    } else {
      _stateClassRequestId = Object(utils_request_animation_frame__WEBPACK_IMPORTED_MODULE_7__["requestAnimationFrame"])(function () {
        return _stateUpdate(newState);
      });
    }
  }

  function _stateUpdate(state) {
    if (_model.get('controls') && state !== events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_PAUSED"] && Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["hasClass"])(_playerElement, 'jw-flag-controls-hidden')) {
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["removeClass"])(_playerElement, 'jw-flag-controls-hidden');
      Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["toggleClass"])(_playerElement, 'jw-floating-dismissible', _this.dismissible);
    }

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["replaceClass"])(_playerElement, /jw-state-\S+/, 'jw-state-' + state);

    switch (state) {
      case events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_ERROR"]:
        _this.stopFloating();

      /* falls through to update captions renderer */

      case events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_IDLE"]:
      case events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_COMPLETE"]:
        if (_captionsRenderer) {
          _captionsRenderer.hide();
        }

        if (_preview) {
          _preview.enableZoomThumbnail();
        }

        break;

      default:
        if (_captionsRenderer) {
          _captionsRenderer.show();

          if (state === events_events__WEBPACK_IMPORTED_MODULE_12__["STATE_PAUSED"] && _controls && !_controls.showing) {
            _captionsRenderer.renderCues(true);
          }
        }

        if (_preview) {
          _preview.removeZoomThumbnail();
        }

        break;
    }
  }

  function setMediaTitleAttribute(model, playlistItem) {
    var videotag = model.get('mediaElement'); // chromecast provider does not support video tags

    if (!videotag) {
      return;
    } // Writing a string to innerHTML completely decodes multiple-encoded strings


    var body = Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["htmlToParentElement"])(playlistItem.title || '');
    videotag.setAttribute('title', body.textContent);
  }

  this.setPosterImage = function (item, preview) {
    preview.setImage(item && item.image);
  };

  var onPlaylistItem = function onPlaylistItem(model, item) {
    _this3.setPosterImage(item, _preview); // Set the title attribute of the video tag to display background media information on mobile devices


    if (_isMobile) {
      setMediaTitleAttribute(model, item);
    }
  };

  var settingsMenuVisible = function settingsMenuVisible() {
    var settingsMenu = _controls && _controls.settingsMenu;
    return !!(settingsMenu && settingsMenu.visible);
  };

  var infoOverlayVisible = function infoOverlayVisible() {
    var info = _controls && _controls.infoOverlay;
    return !!(info && info.visible);
  };

  var setupInstream = function setupInstream() {
    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["addClass"])(_playerElement, 'jw-flag-ads');

    if (_controls) {
      _controls.setupInstream();
    }

    floatingController.disableFloatingUI();
  };

  var destroyInstream = function destroyInstream() {
    if (!displayClickHandler) {
      // view was destroyed
      return;
    }

    if (_controls) {
      _controls.destroyInstream(_model);
    }

    if (floatingController.getFloatingPlayer() === _playerElement && !Object(utils_browser__WEBPACK_IMPORTED_MODULE_15__["isIframe"])()) {
      floatingController.enableFloatingUI();
    }

    _this.setAltText('');

    Object(utils_dom__WEBPACK_IMPORTED_MODULE_14__["removeClass"])(_playerElement, ['jw-flag-ads', 'jw-flag-ads-hide-controls']);

    _model.set('hideAdsControls', false); // Make sure that the provider's media element is returned to the DOM after instream mode


    var provider = _model.getVideo();

    if (provider) {
      provider.setContainer(_videoLayer);
    } // reset display click handler


    displayClickHandler.revertAlternateClickHandlers();
  };

  this.setAltText = function (text) {
    _model.set('altText', text);
  };

  this.clickHandler = function () {
    return displayClickHandler;
  };

  this.getContainer = this.element = function () {
    return _playerElement;
  };

  this.getWrapper = function () {
    return _wrapperElement;
  };

  this.controlsContainer = function () {
    if (_controls) {
      return _controls.element();
    }

    return null;
  };

  this.getSafeRegion = function (excludeControlbar) {
    if (excludeControlbar === void 0) {
      excludeControlbar = true;
    }

    var safeRegion = {
      x: 0,
      y: 0,
      width: _lastWidth || 0,
      height: _lastHeight || 0
    };

    if (_controls) {
      // Subtract controlbar from the bottom when using one
      if (excludeControlbar) {
        safeRegion.height -= _controls.controlbarHeight();
      }
    }

    return safeRegion;
  };

  this.setCaptions = function (captionsStyle) {
    _captionsRenderer.clear();

    _captionsRenderer.setup(_model.get('id'), captionsStyle);

    _captionsRenderer.resize();
  };

  this.setIntersection = function (entry) {
    // Round as the IntersectionObserver polyfill sometimes returns ±0.00XXX.
    var intersectionRatio = Math.round(entry.intersectionRatio * 100) / 100;

    _model.set('intersectionRatio', intersectionRatio);

    this.checkFloatIntersection(intersectionRatio);
  };

  this.checkFloatIntersection = function (intersectionRatio) {
    floatingController.checkFloatIntersection(intersectionRatio);
  };

  function _getCurrentElement() {
    return _model.get('isFloating') ? _wrapperElement : _playerElement;
  }

  this.stopFloating = function (forever, mobileFloatIntoPlace) {
    floatingController.stopFloating(forever, mobileFloatIntoPlace);
  };

  this.destroy = function () {
    _model.destroy();

    _preview.destroy();

    view_utils_views_manager__WEBPACK_IMPORTED_MODULE_4__["default"].unobserve(_playerElement);
    view_utils_views_manager__WEBPACK_IMPORTED_MODULE_4__["default"].remove(this);
    this.isSetup = false;
    this.off();
    Object(utils_request_animation_frame__WEBPACK_IMPORTED_MODULE_7__["cancelAnimationFrame"])(_resizeContainerRequestId);
    clearTimeout(_resizeMediaTimeout);

    if (focusHelper) {
      focusHelper.destroy();
      focusHelper = null;
    }

    if (fullscreenHelpers) {
      fullscreenHelpers.destroy();
      fullscreenHelpers = null;
    }

    if (_controls) {
      _controls.disable(_model);
    }

    if (displayClickHandler) {
      displayClickHandler.destroy();

      _playerElement.removeEventListener('mousemove', moveHandler);

      _playerElement.removeEventListener('mouseout', outHandler);

      _playerElement.removeEventListener('mouseover', overHandler);

      displayClickHandler = null;
    }

    _captionsRenderer.destroy();

    if (_logo) {
      _logo.destroy();

      _logo = null;
    }

    Object(utils_css__WEBPACK_IMPORTED_MODULE_16__["clearCss"])(_model.get('id'));

    if (this.resizeListener) {
      this.resizeListener.destroy();
      delete this.resizeListener;
    }

    floatingController.destroy();
  };
}

/* harmony default export */ __webpack_exports__["default"] = (View);

/***/ })

}]);
//# sourceMappingURL=jwplayer.core.controls.polyfills.html5.c57b7bef86dba4bab5ae.map